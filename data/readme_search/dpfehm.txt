dpfehm differentiable subsurface physics simulator description julia module includes numerical models focus earth especially fluid flow currently supports groundwater equations single phase richards equation air water advection dispersion wave easily combined machine learning workflow train model mitigate injecting induced seismicity leakage carbon dioxide details available installation install test running import pkg add basic usage examples started described detail illustrate patterns via steady transient solve start importing libraries gaussianrandomfields optim pyplot random zygote seed set reproduce results run grid regular nodes covers domain meters mins maxs size coords neighbors areasoverlengths regulargrid build result building variables matrix describing coordinates cell centers array cells neighbor third length equal describes interface neighboring dividing variable dumped volumes example boundary conditions zeros injectionnode inject lower left corner dirichletnodes int fix pressure upper dirichleths sources sinks amount injected node list fixed pressures heads hydrology jargon note values ignored except indices appear final step moving solving construct heterogeneous conductivity field package correlation mean log natural logarithm defining standard deviation dimensions copied layers heterogeneity exists coordinate directions direction lambda sigma clean sand cov covariancefunction matern pts range num eigenvectors grf gaussianrandomfield karhunenloeve logks reverse sample generate realization copy view shown look define helper function solver previous construction defined conductivities converts geometric move interfaces heart code call steadystate solves pose solveforh calls returns reshaping exp map convert permeabilities connecting assert return reshape hand using wrapper previously requires explicitly pass hydraulic head condition inputs global bottom layer injection rest allows compute gradient functions involving pullback isfreenode nodei freenodei getfreenodes div grad calculate involves redundant calculation forward evaluation redo print time free ones logk consider porous medium fill pores unsaturated similar setting resolution differentiablebackwardeuler permeability dependent initial storage parameter flows neglected achieved specificstorage saturated include multi couple parameters control dependence saturation multiplied relative depends varies van genuchten alphas complete write instead steps argument controlled dirichlet describe paragraph simulation keyword arguments eventually passed differentialequations adds solution abstol reltol bcs hcat addboundaryconditions key basically tells residuals jacobian respect integrated xyz xzy name named psi unpacks consists dirichletpsis concatenate jacobians unused principle unpack derivative backward euler method computing gradients api isn arrays packing unpacking finally hflat advanced including inverse combining neural network discrete fracture networks methods flux approximation discretize means proportional approximated respectively license provided bsd style file text orchard suite internally development questions contribute please repo pull request contact daniel malley omalled lanl gov