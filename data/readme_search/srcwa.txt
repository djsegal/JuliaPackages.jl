srcwa scatter matrix rigorously coupled wave analysis implemented julia solves maxwell equations periodically patterned multilayers optically isotropic materials currently supporting computation reflection transmission layerwise absorption arbitrary plane incidence usage defining reciprocal space grid using maximum vector dnx dny create grids equtions electric magnetic fields dealt terms frequency wavevector real coordinate define highes index lattice zeroth element accuracy result cost time dealing structures homeogenous lateral directions resulting left zero scaling desired periodicity theta incident angle degrees propagation direction surface normal phi azimuth lambda wavelength uni cell size epsilon ref halfspace device relative permittivity kin obtain vectors unit scale rcwa implementation conditions set avoid numerical singularities sufficiently errors overshadow imperfectly choice length units consistent returned values free aka diagonal matrices required calculation normalized field components impinging tra refspace effective impedance modes traspace freespace normalization sref scattering stra require halfspaces modeled thickness corresponding measurement directly additional losses phase shift steps firstly calculated minimal simulation model basically yields fresnel equation comprised layer building eps plain compute inside inclusion outside fill factor circft fourier transform circular ellipft elliptic rectft rectangular linearalgebra distribution concatenate layers homogenous constructed simple similar addition incorporate function obtained waves propagate permittivities couple interfaces individual prepare source calculate amplitudes polarization arte reflected rte power atte transmitted tte artm rtm attm ttm easy polarizations sabove sint sbelow ate atm method calculates difference electromagnetic entering leaving realgrid square data ain aout bin bout stackamp amplitude expansion actual computed eigenmodes transformed eigenstates component converted references whittaker culshaw treatment multilayer photonic phys rev marco liscidini dario gerace lucio claudio andreani sipe asymmetric cells birefringent media raymond rumpf improved formulation semi analytical methods thatis convention progress electromagnetics research