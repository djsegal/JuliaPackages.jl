effects add irtools master https github com mikeinnes implementation effect handlers julia aka algebraic free monads etc lot continuations exceptions coroutines backtracking package aims provide define examples caveat emptor compiler designed handle code reserves complain slow theoretically composes nicely thoroughly tested list monad allows write functions return single result actually returning results choose element array int tuple rand backtrack error program written set valid pythagorean triples control flow example solve queens follows function nqueens persistent row abs enumerate diagonal push handler using struct flip binary begin max true false