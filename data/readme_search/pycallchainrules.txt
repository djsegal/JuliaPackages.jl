pycallchainrules julia lot existing useful differentiable python code pytorch jax etc pycall seamless wonder takes differentiate library aims ideal thanks pabloferz cpu gpu array copies via dlpack basic usage install dependencies using run pyprogramname pip torch functorch example torchmodulewrapper zygote indim outdim module linear subclassing jlwrap batchsize input randn float output target loss sum grad gradient cuda assert functional device version jaxfunctionwrapper stax pyto init lin apply dense params random prngkey map wrap jit mixing recommended disable preallocation setting environment variable xla client preallocate false current limitations types wrapped functions tensors nested tuples keyword arguments arrays support differentiation