restacker immutables stack julia immutable objects containing heap allocated sometimes using view degrade performance substantially provides api object restack avoid pitfall tends happen crosses inlined function call boundaries depth stackoverflow answer tim holy discussions discourse julialang example consider simple computation kernel noinline inbounds eachindex raw array benchmarktools randn benchmark zero trial memory estimate bytes allocs minimum time median mean maximum samples evals sample ing destination fix calling fast vector version notice slight increase consumption creates examples directory type struct abc equivalent mutable return input identity triple equality means change behavior program benefit run sacrificing slightly compile notes experimental unsafe construct breaks assumption code relying finalize hood types directly invoking expression skips evaluating user defined constructors minimizes overhead