praytools former traintools rename created internal package name developing split personality collection routines simplify boring stuff messing training nns mainly various versions distributed parallel ptrain loss preparesamples opt iterations cby threads nthreads ttrain performs assuming function additive differing called single thread calls prepare minibatch dividebatch int divides sub batches dispatched separated calculate gradient immediately means return batch functions tree reduction algorithm complexity reducing gradients log loop stops callback similar flux train taking output argument convenient floating averages loading data background backgrounddataloader loadfun executes times loaded items retrieved blocking wait till available call issued moment stop structure destroyed add samples randn rand bdl forget run julia initevalcby initializes simple history accuracy model