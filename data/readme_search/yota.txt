reverse mode automatic differentiation static dynamic graphs usage mutable struct linear abstractarray forward loss sum rand val grad object type gradientresult holding gradients input variables scalars tensors returns gradient value structs dictionary field path pairs julia dict tuple symbol array float entry conjunction update function modify fields continue previous example println epoch note simplified doesn actually represent error minimized quickly goes zero realistic complex examples vae custom derivatives add using diffrule macro list allowed variable names logistic exp expression stands derivative functions accepting keyword arguments instead import nnlib conv data filter pass yota generate call passed original pad corresponding nodiff pattern stops backpropagating distinguish matched placeholders fixed symbols rules means return primal listed diff phs foo starting considered placeholder bar tracer tape package steps record primitive operations onto trough recording operation simply construct directly trace print inp const typeof broadcast irtools collect calls execution divided recorded traced ones default set defined primitives includes beasts getproperty specify argument backpropagation executed compiled benchmarktools play compile btime allocations bytes cuda support cuarray supported encounter issue arrays don ordinary please file bug experimental records time loop iterative exactly iterations replaying values effect applies standard nevertheless provides pseudo capabilities caching results generated tapes eliminate cost tracing avoids repeated optimization tell true feature removed future versions