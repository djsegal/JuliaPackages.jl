magmathermokinematics understanding magmatic systems evolve rock record interpreted wide range earth scientists easy versatile package simulates thermal evolution consisting kinematically emplaced dikes axisymmetric geometries account parallel cpu gpu finite difference discretization employed energy equation combined semi lagrangian advection tracers track magma host shifted accommodate space intruding sills using analytical models penny shaped cracks elastic media cooling crystallizing latent heat effects simulate zircon age distributions example scripts scenarios contents lines dependencies installation simple emplacement crust period shown code including visualization key load required packages views function maincode model parameters width height density capacity conductivity geot geothermal gradient center dike thickness intrusion temperature injectioninterval kyr inject kyrs maxtime maximum simulation time ran size domain randomly angles diketype elasticdike type injected squaredike resolution grid cells direction diffusivity min stable timestep explicit int floor timesteps ntr inserted initialize numerical arrays set geometry initial structure reference radius linear profile phi dphi solidfraction compute solid fractio preparation visualisation inj injectvol vec melt zeros loop add cen rand vary angle orientation near vertical depth else shallower specify random location fixed vol injectdike move hostrocks volume println added total round digits rate fraction perform diffusion step tnew rho lateral boundary conditions flux free bottom top constant updatetracers update info evolved sum vector mod heatmap aspect ratio xlims ylims lajolla clims xlabel ylabel title dpi fontsize colorbar nuuk plot layout frame anim gif fps create animation return main start molten label none png routines inserts dimensions computes variable downloaded minor changes movie computed laptop compared parallelstencil finitedifferences writevtk init stencil threads float length coordinates array initializations coordinate crd collect iterators product generate vectors transfer coords vtk paraview output isdir viz false mkdir loadpath pvd collection vark vtkfile meltfraction outfiles save result script files visualized software statefile reproduce available rely solver structarrays aray tracer structures generation simplify setting specifying properties interpolations interpolate staticarrays speed installed automatically install plots plotting vtr anyways useful installing julia usual manner test pkg registed testing suite run performs tests compares results solutions encounter examples download codes current directory include finally previously system version