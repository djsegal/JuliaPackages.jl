magmathermokinematics understanding magmatic systems wide range earth scientists easy versatile package simulates thermal evolution following intrusion dikes sills axisymmetric geometries account parallel cpu gpu finite difference discretization employed energy equation combined semi lagrangian advection tracers track emplaced magma kinematically host rock shifted accommodate space intruding including using analytical models penny shaped cracks elastic media cooling crystallizing latent heat effects simulate zircon age distributions example scripts scenarios contents lines dependencies installation simple emplacement crust period shown code visualization key const false environment float initialize stencil else diffusion load calling plots views function maincode grid creategrid size extent domain num numeric params verbose nonlinear solver options set material parameters matparam setmaterialparams name phase density constantdensity heatcapacity constantheatcapacity conductivity constantconductivity watt latentheat constantlatentheat melting meltingparam caricchi geot geothermal gradient width thickness dike temperature injectioninterval kyr inject kyrs maxtime maximum simulation time ran randomly angles diketype elasticdike type injected squaredike diffusivity minimum stable timestep required explicit floor int timesteps ntr inserted array initializations arrays createarrays dict rho tnew buffers matrix undef phi melt similar phases cuda ones gridarray coord structarray tracer reference radius initial linear profile preparation visualisation env gkswstype nul isdir viz mkdir loadpath anim animation string inj injectvol vec zeros loop add cen max min rand vary center angle orientation near vertical depth shallower specify random location fixed vol injectdike move hostrocks data volume println added total round digits rate step perform copy update properties updatetracers info assign evolved sum prod fraction vector mod heatmap aspect ratio xlims ylims lajolla clims xlabel ylabel title dpi fontsize colorbar nuuk plot layout frame gif fps create return main start molten label none png routines inserts dimensions computes variable multicore processor chances advantage julia multiple threads linux macos check nthreads include provided directory file pwd happen machine nvidia graphics card build run substantially faster changing flag true downloaded minor changes movie computed laptop writevtk vtk paraview output pvd collection vtkfile meltfraction store fields outfiles save result script files visualized software statefile reproduce available rely parallelstencil geoparams define etc structarrays generate aray structures generation simplify setting specifying interpolations interpolate staticarrays speed installed automatically install plotting vtr packages anyways useful installing usual manner test pkg dependecies testing suite performs tests compares results solutions encounter examples makie download codes current finally previously system version running benchmark comparing versus geneva gregor weber luca ucla oscar lovera research zassy ongoing development project funded european council solvers mechanical multiphysics compute stress deformation follow modular reusable approach various componentys defined external usable ultimately easier write apply natural capacity subsequently look currently infrastructure functionality internals expected change regular basis related kinematic degrees sophistication recent effort described aware source openly binary format makes straightforward understand actually inside existing gpus dufek bergantz lower crustal genesis preservation stochastic framework evaluation basalt interaction journal petrology annen blundy sparks intermediate silicic magmas deep hot zones simpson pinel frequency magnitude volcanic eruptions controlled injection buoyancy nature geoscience tierney schmitt silva voluminous plutonism quiescence revealed thermochemical modeling geology melnik utkin bindeman chamber formation accretion thermo compositional model emphasis implication records geophys res solid preprint