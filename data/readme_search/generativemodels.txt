generativemodels library contains collection generative models trainable conditionaldists conjuction flux probability measures divergence defined ipmeasures package aims experimenting easy example check build conventional variational autoencoder vae reconstructs mnist reconstructing load training dataset using mldatasets train traindata float flat reshape size gpu data dataloader batchsize shuffle true define parameters input length xlength latent vector zlength hdim int encoder diagonal variance dimension model wrapped conditionalmvnormal return tuple appropriate mvnormal mean hence splitlayer returns vectors constrained positive mapping trained output enc map chain dense relu identity softplus conditional called rand decoder multivariate normal scalar dec create maximize elbo loss params opt adam info epoch test reconstructions corresponding space shown cpu testdata plot