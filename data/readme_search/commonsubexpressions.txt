commonsubexpressions julia package provides cse macro performs common subexpression elimination means piece code foo function evaluated times produce moves expression loop evaluates arbitrarily complex nested expressions handled result efficient inv plus wrap entire definitions blocks caveats results correct please carefully report issues called block wrapped pure effects enforce verify change behavior program happen expected brief aside purity mean calling somehow changes beyond value returns trivial effect counter global increases time addition mutates input arguments changing constitutes visualization transformation visualized using treeview simple example currently construct data flow graph dataflow instead relatively steps initialize set disqualified symbols list setup commands walk tree repeatedly performing assignment operation encountered add target call constants replace current newly generated symbol append assigns return transformed prepended procedure ensures cache functions inputs assuming calls required