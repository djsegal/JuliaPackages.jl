arrayallez add odot matrix multiplication index tensor rand mat reshape using einsum variants gradient definitions specifying left tracked likewise ordinary bmm timesbar batched understands trailing dimensions size corresponding defined dimnames propagate names nameddims log exp conveniently choose yeppp appleaccelerate intelvectormath requiring installed fallback version loop threads arrays precisely mutates copies besides scale rows columns iscale divides inv element wise inverse mutating versions instead simple broadcast ones simply rmul commands attempt define gradients tracker ans zygote caveat emptor forward input backward terrible idea param randn sum data true grad package defines prod overwriting incorrect cumprod array experiment lrucache space copy similar sim float btime bytes functions opt dropdims macro wraps reductions dims trunc int vectorize comprehensive wrapper strided adds broadcasting loopvectorization avx black magic