tensorrules provides macro type nabla tab enable automatic differentiation libraries zygote diffractor tensor tensoropt macros tensoroperations chainrulescore define custom adjoints supports julia using function foo einstein summation sum return randn gradient try obtain error intrinsic compiled called stacktrace strategy similar tensorgrad converts functions contains detects expressions definition convert inlined adjoint rules generated example following conj sin converted code equivalent inline rrule typeof projectto pullback add inplaceablethunk thunk notangent properly evaluated unsupported features capture defined macrotools parse expr limitation index notations based typed vcat hcat please style designations contraction ord ncon specify costs bonds support inplace operations expression instead todo block begin applying frule recursively