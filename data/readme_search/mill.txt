mill multiple instance learning library build top flux aimed prototype flexible multi models described mil prototypical machine input sample vector matrix fixed dimension sequence set vectors matrices means matter feature sequences pevny somol proposed simple solve neural networks network consists linear layers mean maximum operation sandwiched nonlinearities denoting output calculated authors extended universal approximation theorem musk dataset classic field publication class name little walk using example shown contains julia environment run start importing libraries fileio jld statistics throttle epochs reflectinmodel base iterators repeated loading file folding data structures following function features fmat called bag terminology column belongs finally label bagnode structure holds ranges columns concatenated catobs subset getindex load instances bagids ties bags arraynode create bagdataset labels map onehotbatch hot encoding manually model bagmodel designed implement basic passed single layer neurons tanh linearity max aggregation functions simultaneously nonlinearity followed arraymodel dense level flows segmentedmeanmax chain segmentedmean segmentedmax loss standard cross entropy logitcrossentropy code resemble evalcb opt adam train params info epoch leave validation calculate error training surprisingly low mapslices argmax dims complicated main advantage allows arbitrarily nest product bagmodels demonstration nesting outer samples inner total third randn relu apply constructions process prone errors tries automatize keeping track dimensions accepts parameter creates control topology additional parameters returning test array float mentioned datasets contain cartesian products normal quick demo productnode automatically despite sub optimal productmodel hierarchical utils hierarchicalutils brings lot print truncated version call printtree trunc inf callling trav true enables convenient traversal functionality string indexing node tree swiftly accessible handy inspecting simply deleting replacing inserting nodes constructing adversarial approaches result provided nnodes nleafs nodeiterator collect element abstractmillmodel leafiterator typeof typeiterator default values missing constant value learn representing currently support represent empty zero shelf supports transparently difference mainly switch emptyismissing false demonstrate rand approach types nice compiler zygote latter compact nicer references discriminative tom pevn petr formalism capability sets probability measures structured vojt kova solving axis parallel rectangles dietterich thomas richard lathrop lozano rez