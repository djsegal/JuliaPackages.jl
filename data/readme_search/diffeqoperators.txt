diffeqoperators construct finite difference operators discretize partial differential equation boundary conditions method lines reduces system ordinary equations solved differentialequations centered upwind provided domains dimension arbitrarily spaced grids accuracy dimensions grid optimized convolution routine nnlib care avoid unnecessary allocations operator concretised array bandedmatrix sparse matrix simplest shown figure act set samples function interior input numerical vector output sampled derivatives derivative requested constructed centereddifference argument indicates means exact rounding polynomial degree lower condition compute simple dirichlet eltype definitions calculated matrices abuse notation particular example linear affine form constant consequence concretized interpolating adjacent near middle approximated centre define values required close fit interpolated leftmost rightmost including ghost appends boundaries combinations polynomials vectors coefficients called stencils takes returns acts assigned satisfies left hand library precisely functions naturally stored similar taking downwards axis easy columnwise horizontal transposing rightward code read haven seen arguments dimensional julia multiplication defined applying arrays require complicated error prone series reshape permutation types parameterised supplied type parameter equivalent row wise sheet doc multidimbc supposed multiple don currently constructors follows int approximation len coeff func upwinddifference directional discretization assumed differencing occurs columns terms spacing uniform length direction operational coefficient sets abstractarray matching spatially dependent value actions lazy meaning memory allocated similarly performed building additionally mul allocating applications concretizations following sparsematrixcsc blockbandedmatrix overloaded efficient vec contraction concretizes matter kroncker product formulation action built match implemented node approach discretized domain closure using nxn periodic constructor periodicbc provides robin variables correspond robinbc helpers exist neumann dirichletbc zero fixes union abstractvector neumannbc implements generalization represents generalbc lazily appending appropriate extended version utilizes special copying data ghostderivative derivativeoperator produces composition operations unless free matrixfreeoperator args size opnorm true ishermitian false explicitly jacobian jacvecoperator autodiff compositions multiplying build diffeqoperatorcomposition adding diffeqoperatorcombination diffeqoperator scalar produce diffeqscaledoperator inherit efficiency composed utilize cache