xdiff expression differentiation package unique differentiate vector valued expressions einstein notation gradients scalar functions typicial machine learning please xgrad instead stabilized version adding useful featues frequently derivatives nevertheless continue using pin espresso supporting symbolic approach finding tensor unlike automatic packages output ready derivative suitable optimization code generation takes set example values returns calculates value variable argument similar expected data type size vectors semicolon looks sum rand quote create mem zeros float zero tmp dtmp default generates highly optimized buffers stored dictionary generate slower readable vectorcodegen ctx dict codegen indexing eincodegen function provides convenient interface generating evaluate include file note try extract body written doesn smoothly ommon isn available defined repl experience load filename module limitations loops supported conditional branching operators introduce discontinuity potentially resulting complex heavy piecewise rewritten analytical form aggregation conditions expressed multiplication planned submit issue specific feature level differentiated follows parsed exgraph primitive assignments single calls evaluated determine types shape variables forward pass reverse mode propagated backward input aren represented exprssions exploit pipeline act transformed einraph indexed variant eingraph partial computed element wise rules optionally converted vectorized