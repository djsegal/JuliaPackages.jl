pretend test doubles library main idea annotate functions mockable easily stub calls function patch usage following examples demonstrate basic framework activate macro add apply conditionally fallback verification foo bar spy called exactly mocking thirdparty methods base sin real fakesin anonymous curry mocked design notes rewrites method definition wrapping logic switched activated returns true basically looks store signature found singleton object existing body executed sets user supplied running exits current scope unwound previous hence applied ensures clean slate whenever patches track executions difference expects set third party little tricky mock overcome issue define package delegate call convenience front expanded name class julia created time fly common closures consider easy don follows related projects libraries available fit look alternatives mocks annotated site simplemock cool implements using cassette machinery