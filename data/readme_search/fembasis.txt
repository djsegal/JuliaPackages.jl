fembasis contains interpolation routines standard finite element function spaces ansatz coordinates domain functions calculated symbolically efficient code concrete example generate basis node tetrahedron write create tet quadratic tetrahedral resulting struct abstractbasis base pure size type return int length reference tensors tensor float eval vector vec assert begin dbasis unusual elements defined pyramid descibed implement defining shape calculus taking care partial derivatives pyr linear internal variables variable dof hierarchical nurbs common fem calculations calculate jacobian gradient respect displacement unit square using quad grad result