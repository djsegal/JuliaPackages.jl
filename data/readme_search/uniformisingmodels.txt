uniformisingmodels connected ferromagnetic ising model uniform coupling strength described boltzmann distribution exactly solvable polynomial time quantity cost normalization free energy sample configuration average entropy sum spins site magnetizations pair correlations example add construct uniformising instance using random rng mersennetwister randn compute stuff exp logz probability rand prob pdf single variables expected value avg pairwise notes internals rely dynamic programming implementation efficient happy learn