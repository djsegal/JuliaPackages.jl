<div id="readme" class="md" data-path="readme.md"><article class="markdown-body entry-content container-lg" itemprop="text"><h1 dir="auto"><a id="user-content-marketdatafeedsjl" class="anchor" aria-hidden="true" href="#marketdatafeedsjl"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a>MarketDataFeeds.jl</h1>
<p dir="auto">A lightweight, easily extensible interface to a range of financial data feeds (Polygon.io, IBKR WebClient API).</p>
<p dir="auto">You may find some examples in <a href="test/runtests.jl">test/runtests.jl</a>.</p>
<p dir="auto">If you are interested in a <a href="https://www.nginx.com" rel="nofollow">NGINX</a> proxy to IBKR WebClient (to peacefully enforce the pacing limits), take a look at a config generator <a href="ibkr-proxy/make-proxy.jl">make-proxy.jl</a>.</p>
<h2 dir="auto"><a id="user-content-historical-market-data-retrieval" class="anchor" aria-hidden="true" href="#historical-market-data-retrieval"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a>Historical Market Data Retrieval</h2>
<p dir="auto"><a id="user-content-marketdatafeeds.aggregates" href="#MarketDataFeeds.aggregates">#</a>
<strong><code>MarketDataFeeds.aggregates</code></strong> — <em>Function</em>.</p>
<div class="highlight highlight-source-julia notranslate position-relative overflow-auto" dir="auto" data-snippet-clipboard-copy-content="aggregates(source=&quot;POLYGON&quot;; &lt;keyword arguments&gt;)"><pre><span class="pl-c1">aggregates</span>(source<span class="pl-k">=</span><span class="pl-s"><span class="pl-pds">"</span>POLYGON<span class="pl-pds">"</span></span>; <span class="pl-k">&lt;</span>keyword arguments<span class="pl-k">&gt;</span>)</pre></div>
<p dir="auto">Get aggregate bars for an instrument over a given date range in custom time window sizes from given data source.</p>
<p dir="auto">Return a tuple of series attributes and a matrix where bars correspond to rows, respectively.</p>
<p dir="auto">Keyword arguments generally correspond to request parameters for respective data providers.</p>
<p dir="auto"><strong>Data Sources</strong></p>
<ul dir="auto">
<li><code>:POLYGON</code>: polygon.io REST API; requires <code>apiKey</code> (<code>POLYGON_API_KEY</code> environment var by default). For keyword arguments, see <a href="https://polygon.io/docs/stocks/get_v2_aggs_ticker__stocksticker__range__multiplier___timespan___from___to" rel="nofollow">polygon.io's docs</a></li>
<li><code>:IBKR</code>: IBKR WebClient API; for keyword arguments, see <a href="https://www.interactivebrokers.com/api/doc.html#tag/Market-Data/paths/~1hmds~1history/get" rel="nofollow">IBKR docs</a></li>
</ul>
<p dir="auto"><a id="user-content-marketdatafeeds.aggregates_h5" href="#MarketDataFeeds.aggregates_h5">#</a>
<strong><code>MarketDataFeeds.aggregates_h5</code></strong> — <em>Function</em>.</p>
<div class="highlight highlight-source-julia notranslate position-relative overflow-auto" dir="auto" data-snippet-clipboard-copy-content="aggregates_h5(source=Val(:POLYGON); path, &lt;keyword arguments&gt;)"><pre><span class="pl-c1">aggregates_h5</span>(source<span class="pl-k">=</span><span class="pl-c1">Val</span>(<span class="pl-c1">:POLYGON</span>); path, <span class="pl-k">&lt;</span>keyword arguments<span class="pl-k">&gt;</span>)</pre></div>
<p dir="auto">Get aggregate bars for an instrument from a given data source, and save the result with associated metadata as an attributed HDF5 file.</p>
<p dir="auto">Reduces to a call to <a href="#MarketDataFeeds.aggregates"><code>aggregates</code></a>.</p>
<p dir="auto">Provide keyword argument <code>path</code> for the file name. Other keyword arguments are passed to <a href="#MarketDataFeeds.aggregates"><code>aggregates</code></a>.</p>
<p dir="auto"><a id="user-content-marketdatafeeds.sync!" href="#MarketDataFeeds.sync!">#</a>
<strong><code>MarketDataFeeds.sync!</code></strong> — <em>Function</em>.</p>
<div class="highlight highlight-source-julia notranslate position-relative overflow-auto" dir="auto" data-snippet-clipboard-copy-content="sync!(paths; to=now(UTC))"><pre><span class="pl-c1">sync!</span>(paths; to<span class="pl-k">=</span><span class="pl-c1">now</span>(UTC))</pre></div>
<p dir="auto">Update HDF5 files with aggregates in <code>paths</code> (a path or a vector of paths, incl. directories) up to time <code>to</code>.</p>
<div class="highlight highlight-source-julia notranslate position-relative overflow-auto" dir="auto" data-snippet-clipboard-copy-content="sync!(f::HDF5.File; to=now(UTC))"><pre><span class="pl-c1">sync!</span>(f<span class="pl-k">::</span><span class="pl-c1">HDF5.File</span>; to<span class="pl-k">=</span><span class="pl-c1">now</span>(UTC))</pre></div>
<p dir="auto">Update a HDF5 file with aggregates up to time <code>to</code>.</p>
<p dir="auto"><strong>Pro tip:</strong> Data synchronization agents are provided in <a href="agents/aggregates-sync">agents/aggregates-sync</a>.</p>
<p dir="auto"><a id="user-content-marketdatafeeds.change_provider!" href="#MarketDataFeeds.change_provider!">#</a>
<strong><code>MarketDataFeeds.change_provider!</code></strong> — <em>Function</em>.</p>
<div class="highlight highlight-source-julia notranslate position-relative overflow-auto" dir="auto" data-snippet-clipboard-copy-content="change_provider!(source=&quot;IBKR&quot;, paths; &lt;keyword arguments&gt;)"><pre><span class="pl-c1">change_provider!</span>(source<span class="pl-k">=</span><span class="pl-s"><span class="pl-pds">"</span>IBKR<span class="pl-pds">"</span></span>, paths; <span class="pl-k">&lt;</span>keyword arguments<span class="pl-k">&gt;</span>)</pre></div>
<p dir="auto">Change the feed of market data stores in <code>paths</code> (a path or a vector of paths, incl. directories) to <code>source</code>. The original group <code>bars</code> will be replaced by a view into it. File's metadata will be updated accordingly (special care has to be taken with timespan conversion - see <code>IBKR_PERIODS</code>, <code>POLYGON_PERIODS</code>).</p>
<p dir="auto">Reduces to <code>_change_provider</code>.</p>
<h2 dir="auto"><a id="user-content-market-snapshots" class="anchor" aria-hidden="true" href="#market-snapshots"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a>Market Snapshots</h2>
<p dir="auto"><a id="user-content-marketdatafeeds.snapshot" href="#MarketDataFeeds.snapshot">#</a>
<strong><code>MarketDataFeeds.snapshot</code></strong> — <em>Function</em>.</p>
<div class="highlight highlight-source-julia notranslate position-relative overflow-auto" dir="auto" data-snippet-clipboard-copy-content="snapshot(source=&quot;IBKR&quot;; &lt;keyword arguments&gt;)"><pre><span class="pl-c1">snapshot</span>(source<span class="pl-k">=</span><span class="pl-s"><span class="pl-pds">"</span>IBKR<span class="pl-pds">"</span></span>; <span class="pl-k">&lt;</span>keyword arguments<span class="pl-k">&gt;</span>)</pre></div>
<p dir="auto">Get instantaneous market snapshot.</p>
<p dir="auto">Keyword arguments generally correspond to request parameters for respective data providers.</p>
<p dir="auto"><strong>Data Sources</strong></p>
<ul dir="auto">
<li><code>:IBKR</code>: IBKR WebClient; for keyword arguments, see <a href="https://www.interactivebrokers.com/api/doc.html#tag/Market-Data/paths/~1md~1snapshot/get" rel="nofollow">IBKR docs</a></li>
</ul>
</article></div>