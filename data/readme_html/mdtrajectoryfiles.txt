<div id="readme" class="md" data-path="README.md"><article class="markdown-body entry-content container-lg" itemprop="text"><h1 dir="auto"><a id="user-content-mdtrajectoryfiles" class="anchor" aria-hidden="true" href="#mdtrajectoryfiles"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a>MDTrajectoryFiles</h1>
<p dir="auto">Aim of this package is to provide <strong>low level</strong> and <strong>native</strong> (in the sense of no foreign language dependency) Julia access to trajectory files. At the moment only XTC and DCD files are supported, other formats will eventually be implemented, Amber .nc and Desmond .dtr being next in line.</p>
<p dir="auto">API unstable and may evolve quickly. For each <code>struct XXXFile</code> handle the following methods are provided:</p>
<div class="highlight highlight-source-julia notranslate position-relative overflow-auto" dir="auto" data-snippet-clipboard-copy-content="XXXFile(filename, mode) # constructor
read_atoms(handle::XXXFile, frame, AbstractArray(3, natoms))
read_atoms(handle::XXXFile, frame, AbstractArray(3, natoms), selection::BitVector)
read_box(handle::XXXFile, frame, AbstractArray(XXX dependent))
write_frame(handle::XXXFile, frame, box, atoms)"><pre><span class="pl-c1">XXXFile</span>(filename, mode) <span class="pl-c"><span class="pl-c">#</span> constructor</span>
<span class="pl-c1">read_atoms</span>(handle<span class="pl-k">::</span><span class="pl-c1">XXXFile</span>, frame, <span class="pl-c1">AbstractArray</span>(<span class="pl-c1">3</span>, natoms))
<span class="pl-c1">read_atoms</span>(handle<span class="pl-k">::</span><span class="pl-c1">XXXFile</span>, frame, <span class="pl-c1">AbstractArray</span>(<span class="pl-c1">3</span>, natoms), selection<span class="pl-k">::</span><span class="pl-c1">BitVector</span>)
<span class="pl-c1">read_box</span>(handle<span class="pl-k">::</span><span class="pl-c1">XXXFile</span>, frame, <span class="pl-c1">AbstractArray</span>(XXX dependent))
<span class="pl-c1">write_frame</span>(handle<span class="pl-k">::</span><span class="pl-c1">XXXFile</span>, frame, box, atoms)</pre></div>
<p dir="auto">Also, among different <code>struct XXXFile</code>s, a few common proprieties are provided:</p>
<div class="highlight highlight-source-julia notranslate position-relative overflow-auto" dir="auto" data-snippet-clipboard-copy-content="XXXFile.natoms::Int
XXXFile.nframes::Int
XXXFile.time::Vector{Float32}(nframes)"><pre>XXXFile<span class="pl-k">.</span>natoms<span class="pl-k">::</span><span class="pl-c1">Int</span>
XXXFile<span class="pl-k">.</span>nframes<span class="pl-k">::</span><span class="pl-c1">Int</span>
XXXFile<span class="pl-k">.</span>time<span class="pl-k">::</span><span class="pl-c1">Vector{Float32}</span>(nframes)</pre></div>
<h2 dir="auto"><a id="user-content-units" class="anchor" aria-hidden="true" href="#units"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a>Units</h2>
<ul dir="auto">
<li>time: ps</li>
<li>distance: Å</li>
</ul>
<h2 dir="auto"><a id="user-content-file-handles" class="anchor" aria-hidden="true" href="#file-handles"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a>File Handles</h2>
<p dir="auto"><code>XtcFile</code> Feature complete and blazingly fast (reads @ ~2x with respect to C implementation).</p>
<p dir="auto"><code>DcdFile</code> Reads and writes DCD files <strong>without</strong> fixed atoms (support may come in the future), 4th dimension is ignored. Due to the lack of standardization this needs more testing (at the moment only OpenMM and NAMD), you can help providing your datasets.</p>
<h2 dir="auto"><a id="user-content-examples" class="anchor" aria-hidden="true" href="#examples"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a>Examples</h2>
<h3 dir="auto"><a id="user-content-coordinates" class="anchor" aria-hidden="true" href="#coordinates"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a>Coordinates</h3>
<div class="highlight highlight-source-julia notranslate position-relative overflow-auto" dir="auto" data-snippet-clipboard-copy-content="julia&gt; using MDTrajectoryFiles

julia&gt; spam=XtcFile(&quot;/home/uliano/spam.xtc&quot;,&quot;r&quot;)
XtcFile(&quot;/home/uliano/spam.xtc&quot; open for &quot;r&quot; 11 frames with 5558 atoms each)

julia&gt; coords=Array{Float32}(undef, 3, spam.natoms, spam.nframes);

julia&gt; for frame in 1:spam.nframes
           read_xtc_atoms(spam, frame, view(coords, :, :, frame))
       end

julia&gt; coords
3×5558×11 Array{Float32, 3}:
[:, :, 1] =
 22.37  22.21  23.12  22.78  21.19  …  16.76  16.45  17.44  17.73  16.79
 18.9   18.33  18.22  19.91  18.91     14.77  13.73   3.44   3.34   2.74
 18.93  17.99  19.39  18.73  19.76     29.57  30.63  33.15  32.24  33.27

[:, :, 2] =
 18.01  17.4   17.39  18.68  18.73  …  21.43  20.14  22.95  22.85  23.78
 19.94  20.44  19.49  20.72  18.77     11.64  10.88  33.61  32.99  33.37
 12.97  13.74  12.16  12.55  13.62      5.17   5.39  35.77  36.49  35.36

;;; … "><pre>julia<span class="pl-k">&gt;</span> <span class="pl-k">using</span> MDTrajectoryFiles

julia<span class="pl-k">&gt;</span> spam<span class="pl-k">=</span><span class="pl-c1">XtcFile</span>(<span class="pl-s"><span class="pl-pds">"</span>/home/uliano/spam.xtc<span class="pl-pds">"</span></span>,<span class="pl-s"><span class="pl-pds">"</span>r<span class="pl-pds">"</span></span>)
<span class="pl-c1">XtcFile</span>(<span class="pl-s"><span class="pl-pds">"</span>/home/uliano/spam.xtc<span class="pl-pds">"</span></span> open <span class="pl-k">for</span> <span class="pl-s"><span class="pl-pds">"</span>r<span class="pl-pds">"</span></span> <span class="pl-c1">11</span> frames with <span class="pl-c1">5558</span> atoms each)

julia<span class="pl-k">&gt;</span> coords<span class="pl-k">=</span><span class="pl-c1">Array</span><span class="pl-c1">{Float32}</span>(undef, <span class="pl-c1">3</span>, spam<span class="pl-k">.</span>natoms, spam<span class="pl-k">.</span>nframes);

julia<span class="pl-k">&gt;</span> <span class="pl-k">for</span> frame <span class="pl-k">in</span> <span class="pl-c1">1</span><span class="pl-k">:</span>spam<span class="pl-k">.</span>nframes
           <span class="pl-c1">read_xtc_atoms</span>(spam, frame, <span class="pl-c1">view</span>(coords, :, :, frame))
       <span class="pl-k">end</span>

julia<span class="pl-k">&gt;</span> coords
<span class="pl-c1">3</span><span class="pl-k">×</span><span class="pl-c1">5558</span><span class="pl-k">×</span><span class="pl-c1">11</span> Array{Float32, <span class="pl-c1">3</span>}<span class="pl-k">:</span>
[:, :, <span class="pl-c1">1</span>] <span class="pl-k">=</span>
 <span class="pl-c1">22.37</span>  <span class="pl-c1">22.21</span>  <span class="pl-c1">23.12</span>  <span class="pl-c1">22.78</span>  <span class="pl-c1">21.19</span>  …  <span class="pl-c1">16.76</span>  <span class="pl-c1">16.45</span>  <span class="pl-c1">17.44</span>  <span class="pl-c1">17.73</span>  <span class="pl-c1">16.79</span>
 <span class="pl-c1">18.9</span>   <span class="pl-c1">18.33</span>  <span class="pl-c1">18.22</span>  <span class="pl-c1">19.91</span>  <span class="pl-c1">18.91</span>     <span class="pl-c1">14.77</span>  <span class="pl-c1">13.73</span>   <span class="pl-c1">3.44</span>   <span class="pl-c1">3.34</span>   <span class="pl-c1">2.74</span>
 <span class="pl-c1">18.93</span>  <span class="pl-c1">17.99</span>  <span class="pl-c1">19.39</span>  <span class="pl-c1">18.73</span>  <span class="pl-c1">19.76</span>     <span class="pl-c1">29.57</span>  <span class="pl-c1">30.63</span>  <span class="pl-c1">33.15</span>  <span class="pl-c1">32.24</span>  <span class="pl-c1">33.27</span>

[:, :, <span class="pl-c1">2</span>] <span class="pl-k">=</span>
 <span class="pl-c1">18.01</span>  <span class="pl-c1">17.4</span>   <span class="pl-c1">17.39</span>  <span class="pl-c1">18.68</span>  <span class="pl-c1">18.73</span>  …  <span class="pl-c1">21.43</span>  <span class="pl-c1">20.14</span>  <span class="pl-c1">22.95</span>  <span class="pl-c1">22.85</span>  <span class="pl-c1">23.78</span>
 <span class="pl-c1">19.94</span>  <span class="pl-c1">20.44</span>  <span class="pl-c1">19.49</span>  <span class="pl-c1">20.72</span>  <span class="pl-c1">18.77</span>     <span class="pl-c1">11.64</span>  <span class="pl-c1">10.88</span>  <span class="pl-c1">33.61</span>  <span class="pl-c1">32.99</span>  <span class="pl-c1">33.37</span>
 <span class="pl-c1">12.97</span>  <span class="pl-c1">13.74</span>  <span class="pl-c1">12.16</span>  <span class="pl-c1">12.55</span>  <span class="pl-c1">13.62</span>      <span class="pl-c1">5.17</span>   <span class="pl-c1">5.39</span>  <span class="pl-c1">35.77</span>  <span class="pl-c1">36.49</span>  <span class="pl-c1">35.36</span>

;;; … </pre></div>
<h3 dir="auto"><a id="user-content-time-vector" class="anchor" aria-hidden="true" href="#time-vector"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a>Time vector</h3>
<div class="highlight highlight-source-julia notranslate position-relative overflow-auto" dir="auto" data-snippet-clipboard-copy-content="julia&gt; spam.time
11-element Vector{Float32}:
    0.0
  100.0
  200.0
  300.0
  400.0
  500.0
  600.0
  700.0
  800.0
  900.0
 1000.0

julia&gt; 
"><pre>julia<span class="pl-k">&gt;</span> spam<span class="pl-k">.</span>time
<span class="pl-c1">11</span><span class="pl-k">-</span>element Vector{Float32}<span class="pl-k">:</span>
    <span class="pl-c1">0.0</span>
  <span class="pl-c1">100.0</span>
  <span class="pl-c1">200.0</span>
  <span class="pl-c1">300.0</span>
  <span class="pl-c1">400.0</span>
  <span class="pl-c1">500.0</span>
  <span class="pl-c1">600.0</span>
  <span class="pl-c1">700.0</span>
  <span class="pl-c1">800.0</span>
  <span class="pl-c1">900.0</span>
 <span class="pl-c1">1000.0</span>

julia<span class="pl-k">&gt;</span> 
</pre></div>
<h3 dir="auto"><a id="user-content-unit-cell" class="anchor" aria-hidden="true" href="#unit-cell"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a>Unit Cell</h3>
<div class="highlight highlight-source-julia notranslate position-relative overflow-auto" dir="auto" data-snippet-clipboard-copy-content="julia&gt; periodicbox = Matrix{Float32}(undef, 3, 3);

julia&gt; read_xtc_box(spam, 1, periodicbox)

julia&gt; periodicbox
3×3 Matrix{Float32}:
 39.0   0.0   0.0
  0.0  39.0   0.0
  0.0   0.0  39.0

julia&gt; "><pre>julia<span class="pl-k">&gt;</span> periodicbox <span class="pl-k">=</span> <span class="pl-c1">Matrix</span><span class="pl-c1">{Float32}</span>(undef, <span class="pl-c1">3</span>, <span class="pl-c1">3</span>);

julia<span class="pl-k">&gt;</span> <span class="pl-c1">read_xtc_box</span>(spam, <span class="pl-c1">1</span>, periodicbox)

julia<span class="pl-k">&gt;</span> periodicbox
<span class="pl-c1">3</span><span class="pl-k">×</span><span class="pl-c1">3</span> Matrix{Float32}<span class="pl-k">:</span>
 <span class="pl-c1">39.0</span>   <span class="pl-c1">0.0</span>   <span class="pl-c1">0.0</span>
  <span class="pl-c1">0.0</span>  <span class="pl-c1">39.0</span>   <span class="pl-c1">0.0</span>
  <span class="pl-c1">0.0</span>   <span class="pl-c1">0.0</span>  <span class="pl-c1">39.0</span>

julia<span class="pl-k">&gt;</span> </pre></div>
<h3 dir="auto"><a id="user-content-atom-selection" class="anchor" aria-hidden="true" href="#atom-selection"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a>Atom Selection</h3>
<div class="highlight highlight-source-julia notranslate position-relative overflow-auto" dir="auto" data-snippet-clipboard-copy-content="julia&gt; spam = XtcFile(&quot;/home/uliano/spam.xtc&quot;, &quot;r&quot;)
XtcFile(&quot;/home/uliano/spam.xtc&quot; open for &quot;r&quot; 11 frames with 5558 atoms each)

julia&gt; selection = falses(spam.natoms);

julia&gt; selection[10:20] .=true;

julia&gt; selection[30:40] .=true;

julia&gt; frames = falses(11);

julia&gt; frames[1:2:11] .= true;

julia&gt; coords = Array{Float64}(undef, 3, 22, 6);

julia&gt; k = 1;

julia&gt; for frame in 1:11
           if frames[frame]
               read_atoms(spam, frame, view(coords, :, :, k), selection)
               k += 1
           end
       end

julia&gt; coords
3×22×6 Array{Float64, 3}:
[:, :, 1] =
 19.33  18.72  18.69  19.4   17.69  18.13  18.18  17.14  17.14  16.17  … 
 19.51  21.43  22.0   21.93  21.41  19.35  19.24  18.87  19.24  17.9     
 21.4   20.81  19.86  21.54  21.21  19.76  18.53  20.53  21.46  20.25    

[:, :, 2] =
 22.06  20.08  19.1   20.27  19.97  20.86  21.51  19.73  19.25  19.09  …
 22.98  22.23  22.23  21.16  22.98  24.1   25.11  24.12  23.25  25.25   
 16.96  16.74  17.26  16.5   15.92  18.18  17.97  18.89  18.94  19.53   

;;; … "><pre>julia<span class="pl-k">&gt;</span> spam <span class="pl-k">=</span> <span class="pl-c1">XtcFile</span>(<span class="pl-s"><span class="pl-pds">"</span>/home/uliano/spam.xtc<span class="pl-pds">"</span></span>, <span class="pl-s"><span class="pl-pds">"</span>r<span class="pl-pds">"</span></span>)
<span class="pl-c1">XtcFile</span>(<span class="pl-s"><span class="pl-pds">"</span>/home/uliano/spam.xtc<span class="pl-pds">"</span></span> open <span class="pl-k">for</span> <span class="pl-s"><span class="pl-pds">"</span>r<span class="pl-pds">"</span></span> <span class="pl-c1">11</span> frames with <span class="pl-c1">5558</span> atoms each)

julia<span class="pl-k">&gt;</span> selection <span class="pl-k">=</span> <span class="pl-c1">falses</span>(spam<span class="pl-k">.</span>natoms);

julia<span class="pl-k">&gt;</span> selection[<span class="pl-c1">10</span><span class="pl-k">:</span><span class="pl-c1">20</span>] <span class="pl-k">.=</span><span class="pl-c1">true</span>;

julia<span class="pl-k">&gt;</span> selection[<span class="pl-c1">30</span><span class="pl-k">:</span><span class="pl-c1">40</span>] <span class="pl-k">.=</span><span class="pl-c1">true</span>;

julia<span class="pl-k">&gt;</span> frames <span class="pl-k">=</span> <span class="pl-c1">falses</span>(<span class="pl-c1">11</span>);

julia<span class="pl-k">&gt;</span> frames[<span class="pl-c1">1</span><span class="pl-k">:</span><span class="pl-c1">2</span><span class="pl-k">:</span><span class="pl-c1">11</span>] <span class="pl-k">.=</span> <span class="pl-c1">true</span>;

julia<span class="pl-k">&gt;</span> coords <span class="pl-k">=</span> <span class="pl-c1">Array</span><span class="pl-c1">{Float64}</span>(undef, <span class="pl-c1">3</span>, <span class="pl-c1">22</span>, <span class="pl-c1">6</span>);

julia<span class="pl-k">&gt;</span> k <span class="pl-k">=</span> <span class="pl-c1">1</span>;

julia<span class="pl-k">&gt;</span> <span class="pl-k">for</span> frame <span class="pl-k">in</span> <span class="pl-c1">1</span><span class="pl-k">:</span><span class="pl-c1">11</span>
           <span class="pl-k">if</span> frames[frame]
               <span class="pl-c1">read_atoms</span>(spam, frame, <span class="pl-c1">view</span>(coords, :, :, k), selection)
               k <span class="pl-k">+=</span> <span class="pl-c1">1</span>
           <span class="pl-k">end</span>
       <span class="pl-k">end</span>

julia<span class="pl-k">&gt;</span> coords
<span class="pl-c1">3</span><span class="pl-k">×</span><span class="pl-c1">22</span><span class="pl-k">×</span><span class="pl-c1">6</span> Array{Float64, <span class="pl-c1">3</span>}<span class="pl-k">:</span>
[:, :, <span class="pl-c1">1</span>] <span class="pl-k">=</span>
 <span class="pl-c1">19.33</span>  <span class="pl-c1">18.72</span>  <span class="pl-c1">18.69</span>  <span class="pl-c1">19.4</span>   <span class="pl-c1">17.69</span>  <span class="pl-c1">18.13</span>  <span class="pl-c1">18.18</span>  <span class="pl-c1">17.14</span>  <span class="pl-c1">17.14</span>  <span class="pl-c1">16.17</span>  … 
 <span class="pl-c1">19.51</span>  <span class="pl-c1">21.43</span>  <span class="pl-c1">22.0</span>   <span class="pl-c1">21.93</span>  <span class="pl-c1">21.41</span>  <span class="pl-c1">19.35</span>  <span class="pl-c1">19.24</span>  <span class="pl-c1">18.87</span>  <span class="pl-c1">19.24</span>  <span class="pl-c1">17.9</span>     
 <span class="pl-c1">21.4</span>   <span class="pl-c1">20.81</span>  <span class="pl-c1">19.86</span>  <span class="pl-c1">21.54</span>  <span class="pl-c1">21.21</span>  <span class="pl-c1">19.76</span>  <span class="pl-c1">18.53</span>  <span class="pl-c1">20.53</span>  <span class="pl-c1">21.46</span>  <span class="pl-c1">20.25</span>    

[:, :, <span class="pl-c1">2</span>] <span class="pl-k">=</span>
 <span class="pl-c1">22.06</span>  <span class="pl-c1">20.08</span>  <span class="pl-c1">19.1</span>   <span class="pl-c1">20.27</span>  <span class="pl-c1">19.97</span>  <span class="pl-c1">20.86</span>  <span class="pl-c1">21.51</span>  <span class="pl-c1">19.73</span>  <span class="pl-c1">19.25</span>  <span class="pl-c1">19.09</span>  …
 <span class="pl-c1">22.98</span>  <span class="pl-c1">22.23</span>  <span class="pl-c1">22.23</span>  <span class="pl-c1">21.16</span>  <span class="pl-c1">22.98</span>  <span class="pl-c1">24.1</span>   <span class="pl-c1">25.11</span>  <span class="pl-c1">24.12</span>  <span class="pl-c1">23.25</span>  <span class="pl-c1">25.25</span>   
 <span class="pl-c1">16.96</span>  <span class="pl-c1">16.74</span>  <span class="pl-c1">17.26</span>  <span class="pl-c1">16.5</span>   <span class="pl-c1">15.92</span>  <span class="pl-c1">18.18</span>  <span class="pl-c1">17.97</span>  <span class="pl-c1">18.89</span>  <span class="pl-c1">18.94</span>  <span class="pl-c1">19.53</span>   

;;; … </pre></div>
</article></div>