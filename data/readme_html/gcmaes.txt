<div id="readme" class="md" data-path="README.md"><article class="markdown-body entry-content container-lg" itemprop="text"><h1 dir="auto"><a id="user-content-gradient-based-covariance-matrix-adaptation-evolutionary-strategy-for-real-blackbox--optimization" class="anchor" aria-hidden="true" href="#gradient-based-covariance-matrix-adaptation-evolutionary-strategy-for-real-blackbox--optimization"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a>Gradient-based Covariance Matrix Adaptation Evolutionary Strategy for Real Blackbox  Optimization</h1>
<p dir="auto"><a href="https://github.com/AStupidBear/GCMAES.jl/actions"><img src="https://github.com/AStupidBear/GCMAES.jl/workflows/CI/badge.svg" alt="Build Status" style="max-width: 100%;"></a>
<a href="https://codecov.io/gh/AStupidBear/GCMAES.jl" rel="nofollow"><img src="https://camo.githubusercontent.com/b6fd982399b0c785347d46826dfd27838758505be2ea07f21b317e02856edaa0/68747470733a2f2f636f6465636f762e696f2f67682f41537475706964426561722f47434d4145532e6a6c2f6272616e63682f6d61737465722f67726170682f62616467652e737667" alt="Coverage" data-canonical-src="https://codecov.io/gh/AStupidBear/GCMAES.jl/branch/master/graph/badge.svg" style="max-width: 100%;"></a></p>
<h2 dir="auto"><a id="user-content-installation" class="anchor" aria-hidden="true" href="#installation"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a>Installation</h2>
<div class="highlight highlight-source-julia notranslate position-relative overflow-auto" dir="auto" data-snippet-clipboard-copy-content="using Pkg
pkg&quot;add GCMAES&quot;"><pre><span class="pl-k">using</span> Pkg
<span class="pl-s"><span class="pl-pds"><span class="pl-c1">pkg</span>"</span>add GCMAES<span class="pl-pds">"</span></span></pre></div>
<h2 dir="auto"><a id="user-content-features" class="anchor" aria-hidden="true" href="#features"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a>Features</h2>
<ul dir="auto">
<li>use low level BLAS operations to ensure performance</li>
<li>use <code>Elemental</code> to do distributed eigendecomposition, which is crutial for high dimensional (&gt;10000) problem</li>
<li>compatible with <code>julia</code>'s native parallelism</li>
<li>compatible with <code>MPI.jl</code>, therefore suitable to be run on clusters without good TCP connections</li>
<li>handling constraints and transformations</li>
</ul>
<h2 dir="auto"><a id="user-content-basic-usage" class="anchor" aria-hidden="true" href="#basic-usage"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a>Basic Usage</h2>
<div class="highlight highlight-source-julia notranslate position-relative overflow-auto" dir="auto" data-snippet-clipboard-copy-content="using GCMAES
D = 2000            # dimension of x
x0 = fill(0.3, D)   # initial x
σ0 = 0.2            # initial search variance
lo = fill(-5.12, D) # lower bound for each dimension
hi = fill(5.12, D)  # upper bound for each dimension"><pre><span class="pl-k">using</span> GCMAES
D <span class="pl-k">=</span> <span class="pl-c1">2000</span>            <span class="pl-c"><span class="pl-c">#</span> dimension of x</span>
x0 <span class="pl-k">=</span> <span class="pl-c1">fill</span>(<span class="pl-c1">0.3</span>, D)   <span class="pl-c"><span class="pl-c">#</span> initial x</span>
σ0 <span class="pl-k">=</span> <span class="pl-c1">0.2</span>            <span class="pl-c"><span class="pl-c">#</span> initial search variance</span>
lo <span class="pl-k">=</span> <span class="pl-c1">fill</span>(<span class="pl-k">-</span><span class="pl-c1">5.12</span>, D) <span class="pl-c"><span class="pl-c">#</span> lower bound for each dimension</span>
hi <span class="pl-k">=</span> <span class="pl-c1">fill</span>(<span class="pl-c1">5.12</span>, D)  <span class="pl-c"><span class="pl-c">#</span> upper bound for each dimension</span></pre></div>
<p dir="auto">Minimize a blackbox function</p>
<div class="highlight highlight-source-julia notranslate position-relative overflow-auto" dir="auto" data-snippet-clipboard-copy-content="rastrigin(x) = 10length(x) + sum(x.^2 .- 10 .* cos.(2π .* x))
xmin, fmin, status = GCMAES.minimize(rastrigin, x0, σ0, lo, hi, maxiter = 200)"><pre><span class="pl-en">rastrigin</span>(x) <span class="pl-k">=</span> <span class="pl-c1">10</span><span class="pl-c1">length</span>(x) <span class="pl-k">+</span> <span class="pl-c1">sum</span>(x<span class="pl-k">.^</span><span class="pl-c1">2</span> <span class="pl-k">.-</span> <span class="pl-c1">10</span> <span class="pl-k">.*</span> <span class="pl-c1">cos</span>.(<span class="pl-c1">2</span>π <span class="pl-k">.*</span> x))
xmin, fmin, status <span class="pl-k">=</span> GCMAES<span class="pl-k">.</span><span class="pl-c1">minimize</span>(rastrigin, x0, σ0, lo, hi, maxiter <span class="pl-k">=</span> <span class="pl-c1">200</span>)</pre></div>
<p dir="auto">If the optimization terminate prematurely before <code>maxiter</code> is reached, <code>status</code> will be <code>1</code>, otherwise <code>0</code>.</p>
<p dir="auto">A checkpoint file named <code>CMAES.bson</code> will be created in the current working directory during optimization, which will be loaded back to initilize <code>CMAESOpt</code> if dimensions are equal.</p>
<h2 dir="auto"><a id="user-content-incoporating-gradient" class="anchor" aria-hidden="true" href="#incoporating-gradient"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a>Incoporating Gradient</h2>
<p dir="auto">You can speed up the optimization process by providing additional gradient infomation if the loss function is differentialble but noisy. The evolution part can help escaping local minima while the gradient part can speed up convergence in non-noisy regions.</p>
<div class="highlight highlight-source-julia notranslate position-relative overflow-auto" dir="auto" data-snippet-clipboard-copy-content="using ForwardDiff
∇rastrigin(x) = ForwardDiff.gradient(rastrigin, x)
GCMAES.minimize((rastrigin, ∇rastrigin), x0, σ0, lo, hi, maxiter = 200)"><pre><span class="pl-k">using</span> ForwardDiff
<span class="pl-en">∇rastrigin</span>(x) <span class="pl-k">=</span> ForwardDiff<span class="pl-k">.</span><span class="pl-c1">gradient</span>(rastrigin, x)
GCMAES<span class="pl-k">.</span><span class="pl-c1">minimize</span>((rastrigin, ∇rastrigin), x0, σ0, lo, hi, maxiter <span class="pl-k">=</span> <span class="pl-c1">200</span>)</pre></div>
<p dir="auto">You can also enable <code>autodiff</code> and then <code>GCMAES</code> will internally use <code>Zygote</code> to do the gradient calculation</p>
<div class="highlight highlight-source-julia notranslate position-relative overflow-auto" dir="auto" data-snippet-clipboard-copy-content="using Zygote
GCMAES.minimize((rastrigin, ∇rastrigin), x0, σ0, lo, hi, maxiter = 200, autodiff = true)"><pre><span class="pl-k">using</span> Zygote
GCMAES<span class="pl-k">.</span><span class="pl-c1">minimize</span>((rastrigin, ∇rastrigin), x0, σ0, lo, hi, maxiter <span class="pl-k">=</span> <span class="pl-c1">200</span>, autodiff <span class="pl-k">=</span> <span class="pl-c1">true</span>)</pre></div>
<h2 dir="auto"><a id="user-content-parallel-usage" class="anchor" aria-hidden="true" href="#parallel-usage"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a>Parallel Usage</h2>
<p dir="auto">Just simply add <code>@mpirun</code> before <code>GCMAES.minimize</code></p>
<div class="highlight highlight-source-julia notranslate position-relative overflow-auto" dir="auto" data-snippet-clipboard-copy-content="# ....
@mpirun GCMAES.minimize(...)
# ...."><pre><span class="pl-c"><span class="pl-c">#</span> ....</span>
<span class="pl-c1">@mpirun</span> GCMAES<span class="pl-k">.</span><span class="pl-c1">minimize</span>(<span class="pl-k">...</span>)
<span class="pl-c"><span class="pl-c">#</span> ....</span></pre></div>
<p dir="auto">Then you can use <code>mpirun -n N julia ...</code> or <code>julia -p N ...</code> to start your job.</p>
</article></div>