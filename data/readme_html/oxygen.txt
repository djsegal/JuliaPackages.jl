<div id="readme" class="md" data-path="README.md"><article class="markdown-body entry-content container-lg" itemprop="text"><h1 dir="auto"><a id="user-content-oxygenjl" class="anchor" aria-hidden="true" href="#oxygenjl"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a>Oxygen.jl</h1>

<div dir="auto">
  <br>
  <p align="center" dir="auto"><a target="_blank" rel="noopener noreferrer" href="oxygen.png"><img src="oxygen.png" width="20%" style="max-width: 100%;"></a></p>
  <p align="center" dir="auto">
    <strong>A breath of fresh air for programming web apps in Julia.</strong>
  </p>
  <p align="center" dir="auto">
    <a href="https://juliahub.com/ui/Packages/Oxygen/JtS3f" rel="nofollow"><img src="https://camo.githubusercontent.com/7cd61421f9083f165cccd8b2cce28f40248a83d0954dec4885d8898d7bb37c6e/68747470733a2f2f6a756c69616875622e636f6d2f646f63732f4f787967656e2f76657273696f6e2e7376673f746f6b656e3d3747563858314339384d" alt="Version" data-canonical-src="https://juliahub.com/docs/Oxygen/version.svg?token=7GV8X1C98M" style="max-width: 100%;"></a>
    <a href="https://ndortega.github.io/Oxygen.jl/stable/" rel="nofollow"><img src="https://camo.githubusercontent.com/c97f0a5f2ae95755f64a27f1aa8d9a17462941fd3d6c907c7630abd5d3e60acf/68747470733a2f2f696d672e736869656c64732e696f2f62616467652f646f63732d737461626c652d626c75652e737667" alt="documentation stable" data-canonical-src="https://img.shields.io/badge/docs-stable-blue.svg" style="max-width: 100%;"></a>
    <a href="https://github.com/ndortega/Oxygen.jl/actions/workflows/ci.yml"><img src="https://github.com/ndortega/Oxygen.jl/actions/workflows/ci.yml/badge.svg" alt="Build Status" style="max-width: 100%;"></a>
    <a href="https://codecov.io/gh/ndortega/Oxygen.jl" rel="nofollow"><img src="https://camo.githubusercontent.com/6fc4fc19b589b79a7db99243a484c701b72f80bb49bed8def35decbda866f797/68747470733a2f2f636f6465636f762e696f2f67682f6e646f72746567612f4f787967656e2e6a6c2f6272616e63682f6d61737465722f67726170682f62616467652e7376673f746f6b656e3d3747563858314339384d" alt="Coverage Status" data-canonical-src="https://codecov.io/gh/ndortega/Oxygen.jl/branch/master/graph/badge.svg?token=7GV8X1C98M" style="max-width: 100%;"></a>
  </p>
</div>

<h2 dir="auto"><a id="user-content-about" class="anchor" aria-hidden="true" href="#about"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a>About</h2>
<p dir="auto">Oxygen is a micro-framework built on top of the HTTP.jl library.
Breathe easy knowing you can quickly spin up a web server with abstractions you're already familiar with.</p>
<h2 dir="auto"><a id="user-content-features" class="anchor" aria-hidden="true" href="#features"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a>Features</h2>
<ul dir="auto">
<li>Straightforward routing (<code>@get</code>, <code>@post</code>, <code>@put</code>, <code>@patch</code>, <code>@delete</code> and <code>@route</code> macros)</li>
<li>Auto-generated swagger documentation</li>
<li>Out-of-the-box JSON serialization &amp; deserialization (customizable)</li>
<li>Type definition support for path parameters</li>
<li>Built-in multithreading support</li>
<li>Built-in Cron Scheduling (on endpoints &amp; functions)</li>
<li>Middleware chaining (at the application, router, and route levels)</li>
<li>Static &amp; Dynamic file hosting</li>
<li>Route tagging</li>
<li>Repeat tasks</li>
</ul>
<h2 dir="auto"><a id="user-content-installation" class="anchor" aria-hidden="true" href="#installation"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a>Installation</h2>
<div class="highlight highlight-source-julia notranslate position-relative overflow-auto" dir="auto" data-snippet-clipboard-copy-content="pkg&gt; add Oxygen"><pre>pkg<span class="pl-k">&gt;</span> add Oxygen</pre></div>
<h2 dir="auto"><a id="user-content-minimalistic-example" class="anchor" aria-hidden="true" href="#minimalistic-example"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a>Minimalistic Example</h2>
<p dir="auto">Create a web-server with very few lines of code</p>
<div class="highlight highlight-source-julia notranslate position-relative overflow-auto" dir="auto" data-snippet-clipboard-copy-content="using Oxygen
using HTTP

@get &quot;/greet&quot; function(req::HTTP.Request)
    return &quot;hello world!&quot;
end

# start the web server
serve()"><pre><span class="pl-k">using</span> Oxygen
<span class="pl-k">using</span> HTTP

<span class="pl-c1">@get</span> <span class="pl-s"><span class="pl-pds">"</span>/greet<span class="pl-pds">"</span></span> <span class="pl-k">function</span>(req<span class="pl-k">::</span><span class="pl-c1">HTTP.Request</span>)
    <span class="pl-k">return</span> <span class="pl-s"><span class="pl-pds">"</span>hello world!<span class="pl-pds">"</span></span>
<span class="pl-k">end</span>

<span class="pl-c"><span class="pl-c">#</span> start the web server</span>
<span class="pl-c1">serve</span>()</pre></div>
<h2 dir="auto"><a id="user-content-request-handlers" class="anchor" aria-hidden="true" href="#request-handlers"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a>Request handlers</h2>
<p dir="auto">Request handlers are just functions, which means there are many valid ways to express them</p>
<ul dir="auto">
<li>
<p dir="auto">Request handlers don't have to be defined where the routes are. They can be imported from other modules and spread across multiple files</p>
</li>
<li>
<p dir="auto">Just like the request handlers, routes can be declared across multiple modules and files</p>
</li>
</ul>
<div class="highlight highlight-source-julia notranslate position-relative overflow-auto" dir="auto" data-snippet-clipboard-copy-content="using Oxygen

@get &quot;/greet&quot; function()
    &quot;hello world!&quot;
end

@get &quot;/saluer&quot; () -&gt; begin
    &quot;Bonjour le monde!&quot;
end

@get &quot;/saludar&quot; () -&gt; &quot;¡Hola Mundo!&quot;
@get &quot;/salutare&quot; f() = &quot;ciao mondo!&quot;

# This function can be declared in another module
function subtract(req, a::Float64, b::Float64)
  return a - b
end

# register foreign request handlers like this
@get &quot;/subtract/{a}/{b}&quot; subtract

# start the web server
serve()"><pre><span class="pl-k">using</span> Oxygen

<span class="pl-c1">@get</span> <span class="pl-s"><span class="pl-pds">"</span>/greet<span class="pl-pds">"</span></span> <span class="pl-k">function</span>()
    <span class="pl-s"><span class="pl-pds">"</span>hello world!<span class="pl-pds">"</span></span>
<span class="pl-k">end</span>

<span class="pl-c1">@get</span> <span class="pl-s"><span class="pl-pds">"</span>/saluer<span class="pl-pds">"</span></span> () <span class="pl-k">-&gt;</span> <span class="pl-k">begin</span>
    <span class="pl-s"><span class="pl-pds">"</span>Bonjour le monde!<span class="pl-pds">"</span></span>
<span class="pl-k">end</span>

<span class="pl-c1">@get</span> <span class="pl-s"><span class="pl-pds">"</span>/saludar<span class="pl-pds">"</span></span> () <span class="pl-k">-&gt;</span> <span class="pl-s"><span class="pl-pds">"</span>¡Hola Mundo!<span class="pl-pds">"</span></span>
<span class="pl-c1">@get</span> <span class="pl-s"><span class="pl-pds">"</span>/salutare<span class="pl-pds">"</span></span> <span class="pl-en">f</span>() <span class="pl-k">=</span> <span class="pl-s"><span class="pl-pds">"</span>ciao mondo!<span class="pl-pds">"</span></span>

<span class="pl-c"><span class="pl-c">#</span> This function can be declared in another module</span>
<span class="pl-k">function</span> <span class="pl-en">subtract</span>(req, a<span class="pl-k">::</span><span class="pl-c1">Float64</span>, b<span class="pl-k">::</span><span class="pl-c1">Float64</span>)
  <span class="pl-k">return</span> a <span class="pl-k">-</span> b
<span class="pl-k">end</span>

<span class="pl-c"><span class="pl-c">#</span> register foreign request handlers like this</span>
<span class="pl-c1">@get</span> <span class="pl-s"><span class="pl-pds">"</span>/subtract/{a}/{b}<span class="pl-pds">"</span></span> subtract

<span class="pl-c"><span class="pl-c">#</span> start the web server</span>
<span class="pl-c1">serve</span>()</pre></div>
<h2 dir="auto"><a id="user-content-path-parameters" class="anchor" aria-hidden="true" href="#path-parameters"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a>Path parameters</h2>
<p dir="auto">Path parameters are declared with braces and are passed directly to your request handler.</p>
<div class="highlight highlight-source-julia notranslate position-relative overflow-auto" dir="auto" data-snippet-clipboard-copy-content="using Oxygen

# use path params without type definitions (defaults to Strings)
@get &quot;/add/{a}/{b}&quot; function(req, a, b)
    return parse(Float64, a) + parse(Float64, b)
end

# use path params with type definitions (they are automatically converted)
@get &quot;/multiply/{a}/{b}&quot; function(req, a::Float64, b::Float64)
    return a * b
end

# The order of the parameters doesn't matter (just the name matters)
@get &quot;/subtract/{a}/{b}&quot; function(req, b::Int64, a::Int64)
    return a - b
end

# start the web server
serve()"><pre><span class="pl-k">using</span> Oxygen

<span class="pl-c"><span class="pl-c">#</span> use path params without type definitions (defaults to Strings)</span>
<span class="pl-c1">@get</span> <span class="pl-s"><span class="pl-pds">"</span>/add/{a}/{b}<span class="pl-pds">"</span></span> <span class="pl-k">function</span>(req, a, b)
    <span class="pl-k">return</span> <span class="pl-c1">parse</span>(Float64, a) <span class="pl-k">+</span> <span class="pl-c1">parse</span>(Float64, b)
<span class="pl-k">end</span>

<span class="pl-c"><span class="pl-c">#</span> use path params with type definitions (they are automatically converted)</span>
<span class="pl-c1">@get</span> <span class="pl-s"><span class="pl-pds">"</span>/multiply/{a}/{b}<span class="pl-pds">"</span></span> <span class="pl-k">function</span>(req, a<span class="pl-k">::</span><span class="pl-c1">Float64</span>, b<span class="pl-k">::</span><span class="pl-c1">Float64</span>)
    <span class="pl-k">return</span> a <span class="pl-k">*</span> b
<span class="pl-k">end</span>

<span class="pl-c"><span class="pl-c">#</span> The order of the parameters doesn't matter (just the name matters)</span>
<span class="pl-c1">@get</span> <span class="pl-s"><span class="pl-pds">"</span>/subtract/{a}/{b}<span class="pl-pds">"</span></span> <span class="pl-k">function</span>(req, b<span class="pl-k">::</span><span class="pl-c1">Int64</span>, a<span class="pl-k">::</span><span class="pl-c1">Int64</span>)
    <span class="pl-k">return</span> a <span class="pl-k">-</span> b
<span class="pl-k">end</span>

<span class="pl-c"><span class="pl-c">#</span> start the web server</span>
<span class="pl-c1">serve</span>()</pre></div>
<h2 dir="auto"><a id="user-content-query-parameters" class="anchor" aria-hidden="true" href="#query-parameters"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a>Query parameters</h2>
<p dir="auto">Use the <code>queryparams()</code> function to extract and parse parameters from the url</p>
<div class="highlight highlight-source-julia notranslate position-relative overflow-auto" dir="auto" data-snippet-clipboard-copy-content="using Oxygen
using HTTP

@get &quot;/query&quot; function(req::HTTP.Request)
    # extract &amp; return the query params from the request object
    return queryparams(req)
end

# start the web server
serve()"><pre><span class="pl-k">using</span> Oxygen
<span class="pl-k">using</span> HTTP

<span class="pl-c1">@get</span> <span class="pl-s"><span class="pl-pds">"</span>/query<span class="pl-pds">"</span></span> <span class="pl-k">function</span>(req<span class="pl-k">::</span><span class="pl-c1">HTTP.Request</span>)
    <span class="pl-c"><span class="pl-c">#</span> extract &amp; return the query params from the request object</span>
    <span class="pl-k">return</span> <span class="pl-c1">queryparams</span>(req)
<span class="pl-k">end</span>

<span class="pl-c"><span class="pl-c">#</span> start the web server</span>
<span class="pl-c1">serve</span>()</pre></div>
<h2 dir="auto"><a id="user-content-interpolating-variables-into-endpoints" class="anchor" aria-hidden="true" href="#interpolating-variables-into-endpoints"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a>Interpolating variables into endpoints</h2>
<p dir="auto">You can interpolate variables directly into the paths, which makes dynamically registering routes a breeze</p>
<p dir="auto">(Thanks to @anandijain for the idea)</p>
<div class="highlight highlight-source-julia notranslate position-relative overflow-auto" dir="auto" data-snippet-clipboard-copy-content="using Oxygen

operations = Dict(&quot;add&quot; =&gt; +, &quot;multiply&quot; =&gt; *)
for (pathname, operator) in operations
    @get &quot;/$pathname/{a}/{b}&quot; function (req, a::Float64, b::Float64)
        return operator(a, b)
    end
end

# start the web server
serve()"><pre><span class="pl-k">using</span> Oxygen

operations <span class="pl-k">=</span> <span class="pl-c1">Dict</span>(<span class="pl-s"><span class="pl-pds">"</span>add<span class="pl-pds">"</span></span> <span class="pl-k">=&gt;</span> <span class="pl-k">+</span>, <span class="pl-s"><span class="pl-pds">"</span>multiply<span class="pl-pds">"</span></span> <span class="pl-k">=&gt;</span> <span class="pl-k">*</span>)
<span class="pl-k">for</span> (pathname, operator) <span class="pl-k">in</span> operations
    <span class="pl-c1">@get</span> <span class="pl-s"><span class="pl-pds">"</span>/<span class="pl-v">$pathname</span>/{a}/{b}<span class="pl-pds">"</span></span> <span class="pl-k">function</span> (req, a<span class="pl-k">::</span><span class="pl-c1">Float64</span>, b<span class="pl-k">::</span><span class="pl-c1">Float64</span>)
        <span class="pl-k">return</span> <span class="pl-c1">operator</span>(a, b)
    <span class="pl-k">end</span>
<span class="pl-k">end</span>

<span class="pl-c"><span class="pl-c">#</span> start the web server</span>
<span class="pl-c1">serve</span>()</pre></div>
<h2 dir="auto"><a id="user-content-return-json" class="anchor" aria-hidden="true" href="#return-json"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a>Return JSON</h2>
<p dir="auto">All objects are automatically deserialized into JSON using the JSON3 library</p>
<div class="highlight highlight-source-julia notranslate position-relative overflow-auto" dir="auto" data-snippet-clipboard-copy-content="using Oxygen
using HTTP

@get &quot;/data&quot; function(req::HTTP.Request)
    return Dict(&quot;message&quot; =&gt; &quot;hello!&quot;, &quot;value&quot; =&gt; 99.3)
end

# start the web server
serve()"><pre><span class="pl-k">using</span> Oxygen
<span class="pl-k">using</span> HTTP

<span class="pl-c1">@get</span> <span class="pl-s"><span class="pl-pds">"</span>/data<span class="pl-pds">"</span></span> <span class="pl-k">function</span>(req<span class="pl-k">::</span><span class="pl-c1">HTTP.Request</span>)
    <span class="pl-k">return</span> <span class="pl-c1">Dict</span>(<span class="pl-s"><span class="pl-pds">"</span>message<span class="pl-pds">"</span></span> <span class="pl-k">=&gt;</span> <span class="pl-s"><span class="pl-pds">"</span>hello!<span class="pl-pds">"</span></span>, <span class="pl-s"><span class="pl-pds">"</span>value<span class="pl-pds">"</span></span> <span class="pl-k">=&gt;</span> <span class="pl-c1">99.3</span>)
<span class="pl-k">end</span>

<span class="pl-c"><span class="pl-c">#</span> start the web server</span>
<span class="pl-c1">serve</span>()</pre></div>
<h2 dir="auto"><a id="user-content-deserialize--serialize-custom-structs" class="anchor" aria-hidden="true" href="#deserialize--serialize-custom-structs"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a>Deserialize &amp; Serialize custom structs</h2>
<p dir="auto">Oxygen provides some out-of-the-box serialization &amp; deserialization for most objects but requires the use of StructTypes when converting structs</p>
<div class="highlight highlight-source-julia notranslate position-relative overflow-auto" dir="auto" data-snippet-clipboard-copy-content="using Oxygen
using HTTP
using StructTypes

struct Animal
    id::Int
    type::String
    name::String
end

# Add a supporting struct type definition so JSON3 can serialize &amp; deserialize automatically
StructTypes.StructType(::Type{Animal}) = StructTypes.Struct()

@get &quot;/get&quot; function(req::HTTP.Request)
    # serialize struct into JSON automatically (because we used StructTypes)
    return Animal(1, &quot;cat&quot;, &quot;whiskers&quot;)
end

@post &quot;/echo&quot; function(req::HTTP.Request)
    # deserialize JSON from the request body into an Animal struct
    animal = json(req, Animal)
    # serialize struct back into JSON automatically (because we used StructTypes)
    return animal
end

# start the web server
serve()"><pre><span class="pl-k">using</span> Oxygen
<span class="pl-k">using</span> HTTP
<span class="pl-k">using</span> StructTypes

<span class="pl-k">struct</span> Animal
    id<span class="pl-k">::</span><span class="pl-c1">Int</span>
    type<span class="pl-k">::</span><span class="pl-c1">String</span>
    name<span class="pl-k">::</span><span class="pl-c1">String</span>
<span class="pl-k">end</span>

<span class="pl-c"><span class="pl-c">#</span> Add a supporting struct type definition so JSON3 can serialize &amp; deserialize automatically</span>
StructTypes<span class="pl-k">.</span><span class="pl-en">StructType</span>(<span class="pl-k">::</span><span class="pl-c1">Type{Animal}</span>) <span class="pl-k">=</span> StructTypes<span class="pl-k">.</span><span class="pl-c1">Struct</span>()

<span class="pl-c1">@get</span> <span class="pl-s"><span class="pl-pds">"</span>/get<span class="pl-pds">"</span></span> <span class="pl-k">function</span>(req<span class="pl-k">::</span><span class="pl-c1">HTTP.Request</span>)
    <span class="pl-c"><span class="pl-c">#</span> serialize struct into JSON automatically (because we used StructTypes)</span>
    <span class="pl-k">return</span> <span class="pl-c1">Animal</span>(<span class="pl-c1">1</span>, <span class="pl-s"><span class="pl-pds">"</span>cat<span class="pl-pds">"</span></span>, <span class="pl-s"><span class="pl-pds">"</span>whiskers<span class="pl-pds">"</span></span>)
<span class="pl-k">end</span>

<span class="pl-c1">@post</span> <span class="pl-s"><span class="pl-pds">"</span>/echo<span class="pl-pds">"</span></span> <span class="pl-k">function</span>(req<span class="pl-k">::</span><span class="pl-c1">HTTP.Request</span>)
    <span class="pl-c"><span class="pl-c">#</span> deserialize JSON from the request body into an Animal struct</span>
    animal <span class="pl-k">=</span> <span class="pl-c1">json</span>(req, Animal)
    <span class="pl-c"><span class="pl-c">#</span> serialize struct back into JSON automatically (because we used StructTypes)</span>
    <span class="pl-k">return</span> animal
<span class="pl-k">end</span>

<span class="pl-c"><span class="pl-c">#</span> start the web server</span>
<span class="pl-c1">serve</span>()</pre></div>
<h2 dir="auto"><a id="user-content-routers" class="anchor" aria-hidden="true" href="#routers"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a>Routers</h2>
<p dir="auto">The <code>router()</code> function is an HOF (higher order function) that allows you to reuse the same path prefix &amp; properties across multiple endpoints. This is helpful when your api starts to grow and you want to keep your path operations organized.</p>
<p dir="auto">Below are the arguments the <code>router()</code> function can take:</p>
<div class="highlight highlight-source-julia notranslate position-relative overflow-auto" dir="auto" data-snippet-clipboard-copy-content="router(prefix::String; tags::Vector, middleware::Vector, interval::Real, cron::String)"><pre><span class="pl-c1">router</span>(prefix<span class="pl-k">::</span><span class="pl-c1">String</span>; tags<span class="pl-k">::</span><span class="pl-c1">Vector</span>, middleware<span class="pl-k">::</span><span class="pl-c1">Vector</span>, interval<span class="pl-k">::</span><span class="pl-c1">Real</span>, cron<span class="pl-k">::</span><span class="pl-c1">String</span>)</pre></div>
<ul dir="auto">
<li><code>tags</code> - are used to organize endpoints in the autogenerated docs</li>
<li><code>middleware</code> - is used to setup router &amp; route-specific middleware</li>
<li><code>interval</code> - is used to support repeat actions (<em>calling a request handler on a set interval in seconds</em>)</li>
<li><code>cron</code> - is used to specify a cron expression that determines when to call the request handler.</li>
</ul>
<div class="highlight highlight-source-julia notranslate position-relative overflow-auto" dir="auto" data-snippet-clipboard-copy-content="using Oxygen

# Any routes that use this router will be automatically grouped 
# under the 'math' tag in the autogenerated documenation
math = router(&quot;/math&quot;, tags=[&quot;math&quot;])

# You can also assign route specific tags
@get math(&quot;/multiply/{a}/{b}&quot;, tags=[&quot;multiplication&quot;]) function(req, a::Float64, b::Float64)
    return a * b
end

@get math(&quot;/divide/{a}/{b}&quot;) function(req, a::Float64, b::Float64)
    return a / b
end

serve()"><pre><span class="pl-k">using</span> Oxygen

<span class="pl-c"><span class="pl-c">#</span> Any routes that use this router will be automatically grouped </span>
<span class="pl-c"><span class="pl-c">#</span> under the 'math' tag in the autogenerated documenation</span>
math <span class="pl-k">=</span> <span class="pl-c1">router</span>(<span class="pl-s"><span class="pl-pds">"</span>/math<span class="pl-pds">"</span></span>, tags<span class="pl-k">=</span>[<span class="pl-s"><span class="pl-pds">"</span>math<span class="pl-pds">"</span></span>])

<span class="pl-c"><span class="pl-c">#</span> You can also assign route specific tags</span>
<span class="pl-c1">@get</span> <span class="pl-c1">math</span>(<span class="pl-s"><span class="pl-pds">"</span>/multiply/{a}/{b}<span class="pl-pds">"</span></span>, tags<span class="pl-k">=</span>[<span class="pl-s"><span class="pl-pds">"</span>multiplication<span class="pl-pds">"</span></span>]) <span class="pl-k">function</span>(req, a<span class="pl-k">::</span><span class="pl-c1">Float64</span>, b<span class="pl-k">::</span><span class="pl-c1">Float64</span>)
    <span class="pl-k">return</span> a <span class="pl-k">*</span> b
<span class="pl-k">end</span>

<span class="pl-c1">@get</span> <span class="pl-c1">math</span>(<span class="pl-s"><span class="pl-pds">"</span>/divide/{a}/{b}<span class="pl-pds">"</span></span>) <span class="pl-k">function</span>(req, a<span class="pl-k">::</span><span class="pl-c1">Float64</span>, b<span class="pl-k">::</span><span class="pl-c1">Float64</span>)
    <span class="pl-k">return</span> a <span class="pl-k">/</span> b
<span class="pl-k">end</span>

<span class="pl-c1">serve</span>()</pre></div>
<h2 dir="auto"><a id="user-content-cron-scheduling" class="anchor" aria-hidden="true" href="#cron-scheduling"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a>Cron Scheduling</h2>
<p dir="auto">Oxygen comes with a built-in cron scheduling system that allows you to call endpoints and functions automatically when the cron expression matches the current time.</p>
<p dir="auto">When a job is scheduled, a new task is created and runs in the background. Each task uses its given cron expression and the current time to determine how long it needs to sleep before it can execute.</p>
<p dir="auto">The cron parser in Oxygen is based on the same specifications as the one used in Spring. You can find more information about this on the <a href="https://docs.spring.io/spring-framework/docs/current/javadoc-api/org/springframework/scheduling/support/CronExpression.html" rel="nofollow">Spring Cron Expressions</a> page.</p>
<h3 dir="auto"><a id="user-content-cron-expression-syntax" class="anchor" aria-hidden="true" href="#cron-expression-syntax"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a>Cron Expression Syntax</h3>
<p dir="auto">The following is a breakdown of what each parameter in our cron expression represents. While our specification closely resembles the one defined by Spring, it's not an exact 1-to-1 match.</p>
<div class="snippet-clipboard-content notranslate position-relative overflow-auto" data-snippet-clipboard-copy-content="The string has six single space-separated time and date fields:

 ┌───────────── second (0-59)
 │ ┌───────────── minute (0 - 59)
 │ │ ┌───────────── hour (0 - 23)
 │ │ │ ┌───────────── day of the month (1 - 31)
 │ │ │ │ ┌───────────── month (1 - 12) (or JAN-DEC)
 │ │ │ │ │ ┌───────────── day of the week (1 - 7)
 │ │ │ │ │ │          (Monday is 1, Tue is 2... and Sunday is 7)
 │ │ │ │ │ │
 * * * * * *"><pre class="notranslate"><code>The string has six single space-separated time and date fields:

 ┌───────────── second (0-59)
 │ ┌───────────── minute (0 - 59)
 │ │ ┌───────────── hour (0 - 23)
 │ │ │ ┌───────────── day of the month (1 - 31)
 │ │ │ │ ┌───────────── month (1 - 12) (or JAN-DEC)
 │ │ │ │ │ ┌───────────── day of the week (1 - 7)
 │ │ │ │ │ │          (Monday is 1, Tue is 2... and Sunday is 7)
 │ │ │ │ │ │
 * * * * * *
</code></pre></div>
<p dir="auto">Partial expressions are also supported, which means that subsequent expressions can be left out (they are defaulted to <code>'*'</code>).</p>
<div class="highlight highlight-source-julia notranslate position-relative overflow-auto" dir="auto" data-snippet-clipboard-copy-content="# In this example we see only the `seconds` part of the expression is defined. 
# This means that all following expressions are automatically defaulted to '*' expressions
@cron &quot;*/2&quot; function()
    println(&quot;runs every 2 seconds&quot;)
end"><pre><span class="pl-c"><span class="pl-c">#</span> In this example we see only the `seconds` part of the expression is defined. </span>
<span class="pl-c"><span class="pl-c">#</span> This means that all following expressions are automatically defaulted to '*' expressions</span>
<span class="pl-c1">@cron</span> <span class="pl-s"><span class="pl-pds">"</span>*/2<span class="pl-pds">"</span></span> <span class="pl-k">function</span>()
    <span class="pl-c1">println</span>(<span class="pl-s"><span class="pl-pds">"</span>runs every 2 seconds<span class="pl-pds">"</span></span>)
<span class="pl-k">end</span></pre></div>
<h3 dir="auto"><a id="user-content-scheduling-endpoints" class="anchor" aria-hidden="true" href="#scheduling-endpoints"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a>Scheduling Endpoints</h3>
<p dir="auto">The <code>router()</code> function has a keyword argument called <code>cron</code>, which accepts a cron expression that determines when an endpoint is called. Just like the other keyword arguments, it can be reused by endpoints that share routers or be overridden by inherited endpoints.</p>
<div class="highlight highlight-source-julia notranslate position-relative overflow-auto" dir="auto" data-snippet-clipboard-copy-content="# execute at 8, 9 and 10 o'clock of every day.
@get router(&quot;/cron-example&quot;, cron=&quot;0 0 8-10 * * *&quot;) function(req)
    println(&quot;here&quot;)
end

# execute this endpoint every 5 seconds (whenever current_seconds % 5 == 0)
every5 = router(&quot;/cron&quot;, cron=&quot;*/5&quot;)

# this endpoint inherits the cron expression
@get every5(&quot;/first&quot;) function(req)
    println(&quot;first&quot;)
end

# Now this endpoint executes every 2 seconds ( whenever current_seconds % 2 == 0 ) instead of every 5
@get every5(&quot;/second&quot;, cron=&quot;*/2&quot;) function(req)
    println(&quot;second&quot;)
end"><pre><span class="pl-c"><span class="pl-c">#</span> execute at 8, 9 and 10 o'clock of every day.</span>
<span class="pl-c1">@get</span> <span class="pl-c1">router</span>(<span class="pl-s"><span class="pl-pds">"</span>/cron-example<span class="pl-pds">"</span></span>, cron<span class="pl-k">=</span><span class="pl-s"><span class="pl-pds">"</span>0 0 8-10 * * *<span class="pl-pds">"</span></span>) <span class="pl-k">function</span>(req)
    <span class="pl-c1">println</span>(<span class="pl-s"><span class="pl-pds">"</span>here<span class="pl-pds">"</span></span>)
<span class="pl-k">end</span>

<span class="pl-c"><span class="pl-c">#</span> execute this endpoint every 5 seconds (whenever current_seconds % 5 == 0)</span>
every5 <span class="pl-k">=</span> <span class="pl-c1">router</span>(<span class="pl-s"><span class="pl-pds">"</span>/cron<span class="pl-pds">"</span></span>, cron<span class="pl-k">=</span><span class="pl-s"><span class="pl-pds">"</span>*/5<span class="pl-pds">"</span></span>)

<span class="pl-c"><span class="pl-c">#</span> this endpoint inherits the cron expression</span>
<span class="pl-c1">@get</span> <span class="pl-c1">every5</span>(<span class="pl-s"><span class="pl-pds">"</span>/first<span class="pl-pds">"</span></span>) <span class="pl-k">function</span>(req)
    <span class="pl-c1">println</span>(<span class="pl-s"><span class="pl-pds">"</span>first<span class="pl-pds">"</span></span>)
<span class="pl-k">end</span>

<span class="pl-c"><span class="pl-c">#</span> Now this endpoint executes every 2 seconds ( whenever current_seconds % 2 == 0 ) instead of every 5</span>
<span class="pl-c1">@get</span> <span class="pl-c1">every5</span>(<span class="pl-s"><span class="pl-pds">"</span>/second<span class="pl-pds">"</span></span>, cron<span class="pl-k">=</span><span class="pl-s"><span class="pl-pds">"</span>*/2<span class="pl-pds">"</span></span>) <span class="pl-k">function</span>(req)
    <span class="pl-c1">println</span>(<span class="pl-s"><span class="pl-pds">"</span>second<span class="pl-pds">"</span></span>)
<span class="pl-k">end</span></pre></div>
<h3 dir="auto"><a id="user-content-scheduling-functions" class="anchor" aria-hidden="true" href="#scheduling-functions"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a>Scheduling Functions</h3>
<p dir="auto">In addition to scheduling endpoints, you can also use the new <code>@cron</code> macro to schedule functions. This is useful if you want to run code at specific times without making it visible or callable in the API.</p>
<div class="highlight highlight-source-julia notranslate position-relative overflow-auto" dir="auto" data-snippet-clipboard-copy-content="@cron &quot;*/2&quot; function()
    println(&quot;runs every 2 seconds&quot;)
end

@cron &quot;0 0/30 8-10 * * *&quot; function()
  println(&quot;runs at 8:00, 8:30, 9:00, 9:30, 10:00 and 10:30 every day&quot;)
end"><pre><span class="pl-c1">@cron</span> <span class="pl-s"><span class="pl-pds">"</span>*/2<span class="pl-pds">"</span></span> <span class="pl-k">function</span>()
    <span class="pl-c1">println</span>(<span class="pl-s"><span class="pl-pds">"</span>runs every 2 seconds<span class="pl-pds">"</span></span>)
<span class="pl-k">end</span>

<span class="pl-c1">@cron</span> <span class="pl-s"><span class="pl-pds">"</span>0 0/30 8-10 * * *<span class="pl-pds">"</span></span> <span class="pl-k">function</span>()
  <span class="pl-c1">println</span>(<span class="pl-s"><span class="pl-pds">"</span>runs at 8:00, 8:30, 9:00, 9:30, 10:00 and 10:30 every day<span class="pl-pds">"</span></span>)
<span class="pl-k">end</span></pre></div>
<h3 dir="auto"><a id="user-content-starting--stopping-cron-jobs" class="anchor" aria-hidden="true" href="#starting--stopping-cron-jobs"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a>Starting &amp; Stopping Cron Jobs</h3>
<p dir="auto">When you run <code>serve()</code> or <code>serveparallel()</code>, all registered cron jobs are automatically started. If the server is stopped or killed, all running jobs will also be terminated. You can stop the server and all repeat tasks and cron jobs by calling the <code>terminate()</code> function or manually killing the server with <code>ctrl+C</code>.</p>
<p dir="auto">In addition, Oxygen provides utility functions to manually start and stop cron jobs: <code>startcronjobs()</code> and <code>stopcronjobs()</code>. These functions can be used outside of a web server as well.</p>
<h2 dir="auto"><a id="user-content-repeat-tasks" class="anchor" aria-hidden="true" href="#repeat-tasks"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a>Repeat Tasks</h2>
<p dir="auto">The <code>router()</code> function has an <code>interval</code> parameter which is used to call
a request handler on a set interval (in seconds).</p>
<p dir="auto"><strong>It's important to note that request handlers that use this property can't define additional function parameters outside of the default <code>HTTP.Request</code> parameter.</strong></p>
<p dir="auto">In the example below, the <code>/repeat/hello</code> endpoint is called every 0.5 seconds and <code>"hello"</code> is printed to the console each time.</p>
<div class="highlight highlight-source-julia notranslate position-relative overflow-auto" dir="auto" data-snippet-clipboard-copy-content="using Oxygen

repeat = router(&quot;/repeat&quot;, interval=0.5, tags=[&quot;repeat&quot;])

@get repeat(&quot;/hello&quot;) function()
    println(&quot;hello&quot;)
end

# you can override properties by setting route specific values 
@get repeat(&quot;/bonjour&quot;, interval=1.5) function()
    println(&quot;bonjour&quot;)
end

serve()"><pre><span class="pl-k">using</span> Oxygen

repeat <span class="pl-k">=</span> <span class="pl-c1">router</span>(<span class="pl-s"><span class="pl-pds">"</span>/repeat<span class="pl-pds">"</span></span>, interval<span class="pl-k">=</span><span class="pl-c1">0.5</span>, tags<span class="pl-k">=</span>[<span class="pl-s"><span class="pl-pds">"</span>repeat<span class="pl-pds">"</span></span>])

<span class="pl-c1">@get</span> <span class="pl-c1">repeat</span>(<span class="pl-s"><span class="pl-pds">"</span>/hello<span class="pl-pds">"</span></span>) <span class="pl-k">function</span>()
    <span class="pl-c1">println</span>(<span class="pl-s"><span class="pl-pds">"</span>hello<span class="pl-pds">"</span></span>)
<span class="pl-k">end</span>

<span class="pl-c"><span class="pl-c">#</span> you can override properties by setting route specific values </span>
<span class="pl-c1">@get</span> <span class="pl-c1">repeat</span>(<span class="pl-s"><span class="pl-pds">"</span>/bonjour<span class="pl-pds">"</span></span>, interval<span class="pl-k">=</span><span class="pl-c1">1.5</span>) <span class="pl-k">function</span>()
    <span class="pl-c1">println</span>(<span class="pl-s"><span class="pl-pds">"</span>bonjour<span class="pl-pds">"</span></span>)
<span class="pl-k">end</span>

<span class="pl-c1">serve</span>()</pre></div>
<h2 dir="auto"><a id="user-content-mounting-static-files" class="anchor" aria-hidden="true" href="#mounting-static-files"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a>Mounting Static Files</h2>
<p dir="auto">You can mount static files using this handy function which recursively searches a folder for files and mounts everything. All files are
loaded into memory on startup.</p>
<div class="highlight highlight-source-julia notranslate position-relative overflow-auto" dir="auto" data-snippet-clipboard-copy-content="using Oxygen

# mount all files inside the &quot;content&quot; folder under the &quot;/static&quot; path
staticfiles(&quot;content&quot;, &quot;static&quot;)

# start the web server
serve()"><pre><span class="pl-k">using</span> Oxygen

<span class="pl-c"><span class="pl-c">#</span> mount all files inside the "content" folder under the "/static" path</span>
<span class="pl-c1">staticfiles</span>(<span class="pl-s"><span class="pl-pds">"</span>content<span class="pl-pds">"</span></span>, <span class="pl-s"><span class="pl-pds">"</span>static<span class="pl-pds">"</span></span>)

<span class="pl-c"><span class="pl-c">#</span> start the web server</span>
<span class="pl-c1">serve</span>()</pre></div>
<h2 dir="auto"><a id="user-content-mounting-dynamic-files" class="anchor" aria-hidden="true" href="#mounting-dynamic-files"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a>Mounting Dynamic Files</h2>
<p dir="auto">Similar to staticfiles, this function mounts each path and re-reads the file for each request. This means that any changes to the files after the server has started will be displayed.</p>
<div class="highlight highlight-source-julia notranslate position-relative overflow-auto" dir="auto" data-snippet-clipboard-copy-content="using Oxygen

# mount all files inside the &quot;content&quot; folder under the &quot;/dynamic&quot; path
dynamicfiles(&quot;content&quot;, &quot;dynamic&quot;)

# start the web server
serve()"><pre><span class="pl-k">using</span> Oxygen

<span class="pl-c"><span class="pl-c">#</span> mount all files inside the "content" folder under the "/dynamic" path</span>
<span class="pl-c1">dynamicfiles</span>(<span class="pl-s"><span class="pl-pds">"</span>content<span class="pl-pds">"</span></span>, <span class="pl-s"><span class="pl-pds">"</span>dynamic<span class="pl-pds">"</span></span>)

<span class="pl-c"><span class="pl-c">#</span> start the web server</span>
<span class="pl-c1">serve</span>()</pre></div>
<h2 dir="auto"><a id="user-content-performance-tips" class="anchor" aria-hidden="true" href="#performance-tips"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a>Performance Tips</h2>
<p dir="auto">Disabling the internal logger can provide some massive performance gains, which can be helpful in some scenarios.
Anecdotally, i've seen a 2-3x speedup in <code>serve()</code> and a 4-5x speedup in <code>serveparallel()</code> performance.</p>
<div class="highlight highlight-source-julia notranslate position-relative overflow-auto" dir="auto" data-snippet-clipboard-copy-content="# This is how you disable internal logging in both modes
serve(access_log=nothing)
serveparallel(access_log=nothing)"><pre><span class="pl-c"><span class="pl-c">#</span> This is how you disable internal logging in both modes</span>
<span class="pl-c1">serve</span>(access_log<span class="pl-k">=</span><span class="pl-c1">nothing</span>)
<span class="pl-c1">serveparallel</span>(access_log<span class="pl-k">=</span><span class="pl-c1">nothing</span>)</pre></div>
<h2 dir="auto"><a id="user-content-logging" class="anchor" aria-hidden="true" href="#logging"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a>Logging</h2>
<p dir="auto">Oxygen provides a default logging format but allows you to customize the format using the <code>access_log</code> parameter. This functionality is available in both the <code>serve()</code> and <code>serveparallel()</code> functions.</p>
<p dir="auto">You can read more about the logging options <a href="https://juliaweb.github.io/HTTP.jl/stable/reference/#HTTP.@logfmt_str" rel="nofollow">here</a></p>
<div class="highlight highlight-source-julia notranslate position-relative overflow-auto" dir="auto" data-snippet-clipboard-copy-content="# Uses the default logging format
serve()

# Customize the logging format 
serve(access_log=logfmt&quot;[$time_iso8601] \&quot;$request\&quot; $status&quot;)

# Disable internal request logging 
serve(access_log=nothing)"><pre><span class="pl-c"><span class="pl-c">#</span> Uses the default logging format</span>
<span class="pl-c1">serve</span>()

<span class="pl-c"><span class="pl-c">#</span> Customize the logging format </span>
<span class="pl-c1">serve</span>(access_log<span class="pl-k">=</span><span class="pl-s"><span class="pl-pds"><span class="pl-c1">logfmt</span>"</span>[$time_iso8601] <span class="pl-cce">\"</span>$request<span class="pl-cce">\"</span> $status<span class="pl-pds">"</span></span>)

<span class="pl-c"><span class="pl-c">#</span> Disable internal request logging </span>
<span class="pl-c1">serve</span>(access_log<span class="pl-k">=</span><span class="pl-c1">nothing</span>)</pre></div>
<h2 dir="auto"><a id="user-content-middleware" class="anchor" aria-hidden="true" href="#middleware"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a>Middleware</h2>
<p dir="auto">Middleware functions make it easy to create custom workflows to intercept all incoming requests and outgoing responses.
They are executed in the same order they are passed in (from left to right).</p>
<p dir="auto">They can be set at the application, router, and route layer with the <code>middleware</code> keyword argument. All middleware is additive and any middleware defined in these layers will be combined and executed.</p>
<p dir="auto">Middleware will always be executed in the following order:</p>
<div class="snippet-clipboard-content notranslate position-relative overflow-auto" data-snippet-clipboard-copy-content="application -&gt; router -&gt; route"><pre class="notranslate"><code>application -&gt; router -&gt; route
</code></pre></div>
<p dir="auto">Now lets see some middleware in action:</p>
<div class="highlight highlight-source-julia notranslate position-relative overflow-auto" dir="auto" data-snippet-clipboard-copy-content="using Oxygen
using HTTP

const CORS_HEADERS = [
    &quot;Access-Control-Allow-Origin&quot; =&gt; &quot;*&quot;,
    &quot;Access-Control-Allow-Headers&quot; =&gt; &quot;*&quot;,
    &quot;Access-Control-Allow-Methods&quot; =&gt; &quot;POST, GET, OPTIONS&quot;
]

# https://juliaweb.github.io/HTTP.jl/stable/examples/#Cors-Server
function CorsMiddleware(handler)
    return function(req::HTTP.Request)
        println(&quot;CORS middleware&quot;)
        # determine if this is a pre-flight request from the browser
        if HTTP.method(req)==&quot;OPTIONS&quot;
            return HTTP.Response(200, CORS_HEADERS)  
        else 
            return handler(req) # passes the request to the AuthMiddleware
        end
    end
end

function AuthMiddleware(handler)
    return function(req::HTTP.Request)
        println(&quot;Auth middleware&quot;)
        # ** NOT an actual security check ** #
        if !HTTP.headercontains(req, &quot;Authorization&quot;, &quot;true&quot;)
            return HTTP.Response(403)
        else 
            return handler(req) # passes the request to your application
        end
    end
end

function middleware1(handle)
    function(req)
        println(&quot;middleware1&quot;)
        handle(req)
    end
end

function middleware2(handle)
    function(req)
        println(&quot;middleware2&quot;)
        handle(req)
    end
end

# set middleware at the router level
math = router(&quot;math&quot;, middleware=[middleware1])

# set middleware at the route level 
@get math(&quot;/divide/{a}/{b}&quot;, middleware=[middleware2]) function(req, a::Float64, b::Float64)
    return a / b
end

# set application level middleware
serve(middleware=[CorsMiddleware, AuthMiddleware])"><pre><span class="pl-k">using</span> Oxygen
<span class="pl-k">using</span> HTTP

<span class="pl-k">const</span> CORS_HEADERS <span class="pl-k">=</span> [
    <span class="pl-s"><span class="pl-pds">"</span>Access-Control-Allow-Origin<span class="pl-pds">"</span></span> <span class="pl-k">=&gt;</span> <span class="pl-s"><span class="pl-pds">"</span>*<span class="pl-pds">"</span></span>,
    <span class="pl-s"><span class="pl-pds">"</span>Access-Control-Allow-Headers<span class="pl-pds">"</span></span> <span class="pl-k">=&gt;</span> <span class="pl-s"><span class="pl-pds">"</span>*<span class="pl-pds">"</span></span>,
    <span class="pl-s"><span class="pl-pds">"</span>Access-Control-Allow-Methods<span class="pl-pds">"</span></span> <span class="pl-k">=&gt;</span> <span class="pl-s"><span class="pl-pds">"</span>POST, GET, OPTIONS<span class="pl-pds">"</span></span>
]

<span class="pl-c"><span class="pl-c">#</span> https://juliaweb.github.io/HTTP.jl/stable/examples/#Cors-Server</span>
<span class="pl-k">function</span> <span class="pl-en">CorsMiddleware</span>(handler)
    <span class="pl-k">return</span> <span class="pl-k">function</span>(req<span class="pl-k">::</span><span class="pl-c1">HTTP.Request</span>)
        <span class="pl-c1">println</span>(<span class="pl-s"><span class="pl-pds">"</span>CORS middleware<span class="pl-pds">"</span></span>)
        <span class="pl-c"><span class="pl-c">#</span> determine if this is a pre-flight request from the browser</span>
        <span class="pl-k">if</span> HTTP<span class="pl-k">.</span><span class="pl-c1">method</span>(req)<span class="pl-k">==</span><span class="pl-s"><span class="pl-pds">"</span>OPTIONS<span class="pl-pds">"</span></span>
            <span class="pl-k">return</span> HTTP<span class="pl-k">.</span><span class="pl-c1">Response</span>(<span class="pl-c1">200</span>, CORS_HEADERS)  
        <span class="pl-k">else</span> 
            <span class="pl-k">return</span> <span class="pl-c1">handler</span>(req) <span class="pl-c"><span class="pl-c">#</span> passes the request to the AuthMiddleware</span>
        <span class="pl-k">end</span>
    <span class="pl-k">end</span>
<span class="pl-k">end</span>

<span class="pl-k">function</span> <span class="pl-en">AuthMiddleware</span>(handler)
    <span class="pl-k">return</span> <span class="pl-k">function</span>(req<span class="pl-k">::</span><span class="pl-c1">HTTP.Request</span>)
        <span class="pl-c1">println</span>(<span class="pl-s"><span class="pl-pds">"</span>Auth middleware<span class="pl-pds">"</span></span>)
        <span class="pl-c"><span class="pl-c">#</span> ** NOT an actual security check ** #</span>
        <span class="pl-k">if</span> <span class="pl-k">!</span>HTTP<span class="pl-k">.</span><span class="pl-c1">headercontains</span>(req, <span class="pl-s"><span class="pl-pds">"</span>Authorization<span class="pl-pds">"</span></span>, <span class="pl-s"><span class="pl-pds">"</span>true<span class="pl-pds">"</span></span>)
            <span class="pl-k">return</span> HTTP<span class="pl-k">.</span><span class="pl-c1">Response</span>(<span class="pl-c1">403</span>)
        <span class="pl-k">else</span> 
            <span class="pl-k">return</span> <span class="pl-c1">handler</span>(req) <span class="pl-c"><span class="pl-c">#</span> passes the request to your application</span>
        <span class="pl-k">end</span>
    <span class="pl-k">end</span>
<span class="pl-k">end</span>

<span class="pl-k">function</span> <span class="pl-en">middleware1</span>(handle)
    <span class="pl-k">function</span>(req)
        <span class="pl-c1">println</span>(<span class="pl-s"><span class="pl-pds">"</span>middleware1<span class="pl-pds">"</span></span>)
        <span class="pl-c1">handle</span>(req)
    <span class="pl-k">end</span>
<span class="pl-k">end</span>

<span class="pl-k">function</span> <span class="pl-en">middleware2</span>(handle)
    <span class="pl-k">function</span>(req)
        <span class="pl-c1">println</span>(<span class="pl-s"><span class="pl-pds">"</span>middleware2<span class="pl-pds">"</span></span>)
        <span class="pl-c1">handle</span>(req)
    <span class="pl-k">end</span>
<span class="pl-k">end</span>

<span class="pl-c"><span class="pl-c">#</span> set middleware at the router level</span>
math <span class="pl-k">=</span> <span class="pl-c1">router</span>(<span class="pl-s"><span class="pl-pds">"</span>math<span class="pl-pds">"</span></span>, middleware<span class="pl-k">=</span>[middleware1])

<span class="pl-c"><span class="pl-c">#</span> set middleware at the route level </span>
<span class="pl-c1">@get</span> <span class="pl-c1">math</span>(<span class="pl-s"><span class="pl-pds">"</span>/divide/{a}/{b}<span class="pl-pds">"</span></span>, middleware<span class="pl-k">=</span>[middleware2]) <span class="pl-k">function</span>(req, a<span class="pl-k">::</span><span class="pl-c1">Float64</span>, b<span class="pl-k">::</span><span class="pl-c1">Float64</span>)
    <span class="pl-k">return</span> a <span class="pl-k">/</span> b
<span class="pl-k">end</span>

<span class="pl-c"><span class="pl-c">#</span> set application level middleware</span>
<span class="pl-c1">serve</span>(middleware<span class="pl-k">=</span>[CorsMiddleware, AuthMiddleware])</pre></div>
<h2 dir="auto"><a id="user-content-custom-response-serializers" class="anchor" aria-hidden="true" href="#custom-response-serializers"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a>Custom Response Serializers</h2>
<p dir="auto">If you don't want to use Oxygen's default response serializer, you can turn it off and add your own! Just create your own special middleware function to serialize the response and add it at the end of your own middleware chain.</p>
<p dir="auto">Both <code>serve()</code> and <code>serveparallel()</code> have a <code>serialize</code> keyword argument which can toggle off the default serializer.</p>
<div class="highlight highlight-source-julia notranslate position-relative overflow-auto" dir="auto" data-snippet-clipboard-copy-content="using Oxygen
using HTTP
using JSON3

@get &quot;/divide/{a}/{b}&quot; function(req::HTTP.Request, a::Float64, b::Float64)
    return a / b
end

# This is just a regular middleware function
function myserializer(handle)
    function(req)
        try
          response = handle(req)
          # convert all responses to JSON
          return HTTP.Response(200, [], body=JSON3.write(response)) 
        catch error 
            @error &quot;ERROR: &quot; exception=(error, catch_backtrace())
            return HTTP.Response(500, &quot;The Server encountered a problem&quot;)
        end 
    end
end

# make sure 'myserializer' is the last middleware function in this list
serve(middleware=[myserializer], serialize=false)"><pre><span class="pl-k">using</span> Oxygen
<span class="pl-k">using</span> HTTP
<span class="pl-k">using</span> JSON3

<span class="pl-c1">@get</span> <span class="pl-s"><span class="pl-pds">"</span>/divide/{a}/{b}<span class="pl-pds">"</span></span> <span class="pl-k">function</span>(req<span class="pl-k">::</span><span class="pl-c1">HTTP.Request</span>, a<span class="pl-k">::</span><span class="pl-c1">Float64</span>, b<span class="pl-k">::</span><span class="pl-c1">Float64</span>)
    <span class="pl-k">return</span> a <span class="pl-k">/</span> b
<span class="pl-k">end</span>

<span class="pl-c"><span class="pl-c">#</span> This is just a regular middleware function</span>
<span class="pl-k">function</span> <span class="pl-en">myserializer</span>(handle)
    <span class="pl-k">function</span>(req)
        <span class="pl-k">try</span>
          response <span class="pl-k">=</span> <span class="pl-c1">handle</span>(req)
          <span class="pl-c"><span class="pl-c">#</span> convert all responses to JSON</span>
          <span class="pl-k">return</span> HTTP<span class="pl-k">.</span><span class="pl-c1">Response</span>(<span class="pl-c1">200</span>, [], body<span class="pl-k">=</span>JSON3<span class="pl-k">.</span><span class="pl-c1">write</span>(response)) 
        <span class="pl-k">catch</span> error 
            <span class="pl-c1">@error</span> <span class="pl-s"><span class="pl-pds">"</span>ERROR: <span class="pl-pds">"</span></span> exception<span class="pl-k">=</span>(error, <span class="pl-c1">catch_backtrace</span>())
            <span class="pl-k">return</span> HTTP<span class="pl-k">.</span><span class="pl-c1">Response</span>(<span class="pl-c1">500</span>, <span class="pl-s"><span class="pl-pds">"</span>The Server encountered a problem<span class="pl-pds">"</span></span>)
        <span class="pl-k">end</span> 
    <span class="pl-k">end</span>
<span class="pl-k">end</span>

<span class="pl-c"><span class="pl-c">#</span> make sure 'myserializer' is the last middleware function in this list</span>
<span class="pl-c1">serve</span>(middleware<span class="pl-k">=</span>[myserializer], serialize<span class="pl-k">=</span><span class="pl-c1">false</span>)</pre></div>
<h2 dir="auto"><a id="user-content-multithreading--parallelism" class="anchor" aria-hidden="true" href="#multithreading--parallelism"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a>Multithreading &amp; Parallelism</h2>
<p dir="auto">For scenarios where you need to handle higher amounts of traffic, you can run Oxygen in a
multithreaded mode. In order to utilize this mode, julia must have more than 1 thread to work with. You can start a julia session with 4 threads using the command below</p>
<div class="highlight highlight-source-shell notranslate position-relative overflow-auto" dir="auto" data-snippet-clipboard-copy-content="julia --threads 4"><pre>julia --threads 4</pre></div>
<p dir="auto"><code>serveparallel(queuesize=1024)</code> Starts the webserver in streaming mode and spawns n - 1 worker
threads. The <code>queuesize</code> parameter sets how many requests can be scheduled within the queue (a julia Channel)
before they start getting dropped. Each worker thread pops requests off the queue and handles them asynchronously within each thread.</p>
<div class="highlight highlight-source-julia notranslate position-relative overflow-auto" dir="auto" data-snippet-clipboard-copy-content="using Oxygen
using StructTypes
using Base.Threads

# Make the Atomic struct serializable
StructTypes.StructType(::Type{Atomic{Int64}}) = StructTypes.Struct()

x = Atomic{Int64}(0);

@get &quot;/show&quot; function()
    return x
end

@get &quot;/increment&quot; function()
    atomic_add!(x, 1)
    return x
end

# start the web server in parallel mode
serveparallel()"><pre><span class="pl-k">using</span> Oxygen
<span class="pl-k">using</span> StructTypes
<span class="pl-k">using</span> Base<span class="pl-k">.</span>Threads

<span class="pl-c"><span class="pl-c">#</span> Make the Atomic struct serializable</span>
StructTypes<span class="pl-k">.</span><span class="pl-en">StructType</span>(<span class="pl-k">::</span><span class="pl-c1">Type{Atomic{Int64}}</span>) <span class="pl-k">=</span> StructTypes<span class="pl-k">.</span><span class="pl-c1">Struct</span>()

x <span class="pl-k">=</span> <span class="pl-c1">Atomic</span><span class="pl-c1">{Int64}</span>(<span class="pl-c1">0</span>);

<span class="pl-c1">@get</span> <span class="pl-s"><span class="pl-pds">"</span>/show<span class="pl-pds">"</span></span> <span class="pl-k">function</span>()
    <span class="pl-k">return</span> x
<span class="pl-k">end</span>

<span class="pl-c1">@get</span> <span class="pl-s"><span class="pl-pds">"</span>/increment<span class="pl-pds">"</span></span> <span class="pl-k">function</span>()
    <span class="pl-c1">atomic_add!</span>(x, <span class="pl-c1">1</span>)
    <span class="pl-k">return</span> x
<span class="pl-k">end</span>

<span class="pl-c"><span class="pl-c">#</span> start the web server in parallel mode</span>
<span class="pl-c1">serveparallel</span>()</pre></div>
<h2 dir="auto"><a id="user-content-autogenerated-docs-with-swagger" class="anchor" aria-hidden="true" href="#autogenerated-docs-with-swagger"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a>Autogenerated Docs with Swagger</h2>
<p dir="auto">Swagger documentation is automatically generated for each route you register in your application. Only the route name, parameter types, and 200 &amp; 500 responses are automatically created for you by default.</p>
<p dir="auto">You can view your generated documentation at <code>/docs</code>, and the schema
can be found under <code>/docs/schema</code>. Both of these values can be changed to whatever you want using the <code>configdocs()</code> function. You can also opt out of autogenerated docs entirely by calling the <code>disabledocs()</code> function
before starting your application.</p>
<p dir="auto">To add additional details you can either use the built-in <code>mergeschema()</code> or <code>setschema()</code>
functions to directly modify the schema yourself or merge the generated schema from the <code>SwaggerMarkdown.jl</code> package (I'd recommend the latter)</p>
<p dir="auto">Below is an example of how to merge the schema generated from the <code>SwaggerMarkdown.jl</code> package.</p>
<div class="highlight highlight-source-julia notranslate position-relative overflow-auto" dir="auto" data-snippet-clipboard-copy-content="using Oxygen
using SwaggerMarkdown

# Here's an example of how you can merge autogenerated docs from SwaggerMarkdown.jl into your api
@swagger &quot;&quot;&quot;
/divide/{a}/{b}:
  get:
    description: Return the result of a / b
    parameters:
      - name: a
        in: path
        required: true
        description: this is the value of the numerator 
        schema:
          type : number
    responses:
      '200':
        description: Successfully returned an number.
&quot;&quot;&quot;
@get &quot;/divide/{a}/{b}&quot; function (req, a::Float64, b::Float64)
    return a / b
end

# title and version are required
info = Dict(&quot;title&quot; =&gt; &quot;My Demo Api&quot;, &quot;version&quot; =&gt; &quot;1.0.0&quot;)
openApi = OpenAPI(&quot;3.0&quot;, info)
swagger_document = build(openApi)
  
# merge the SwaggerMarkdown schema with the internal schema
mergeschema(swagger_document)

# start the web server
serve()"><pre><span class="pl-k">using</span> Oxygen
<span class="pl-k">using</span> SwaggerMarkdown

<span class="pl-c"><span class="pl-c">#</span> Here's an example of how you can merge autogenerated docs from SwaggerMarkdown.jl into your api</span>
<span class="pl-c1">@swagger</span> <span class="pl-s"><span class="pl-pds">"""</span></span>
<span class="pl-s">/divide/{a}/{b}:</span>
<span class="pl-s">  get:</span>
<span class="pl-s">    description: Return the result of a / b</span>
<span class="pl-s">    parameters:</span>
<span class="pl-s">      - name: a</span>
<span class="pl-s">        in: path</span>
<span class="pl-s">        required: true</span>
<span class="pl-s">        description: this is the value of the numerator </span>
<span class="pl-s">        schema:</span>
<span class="pl-s">          type : number</span>
<span class="pl-s">    responses:</span>
<span class="pl-s">      '200':</span>
<span class="pl-s">        description: Successfully returned an number.</span>
<span class="pl-s"><span class="pl-pds">"""</span></span>
<span class="pl-c1">@get</span> <span class="pl-s"><span class="pl-pds">"</span>/divide/{a}/{b}<span class="pl-pds">"</span></span> <span class="pl-k">function</span> (req, a<span class="pl-k">::</span><span class="pl-c1">Float64</span>, b<span class="pl-k">::</span><span class="pl-c1">Float64</span>)
    <span class="pl-k">return</span> a <span class="pl-k">/</span> b
<span class="pl-k">end</span>

<span class="pl-c"><span class="pl-c">#</span> title and version are required</span>
info <span class="pl-k">=</span> <span class="pl-c1">Dict</span>(<span class="pl-s"><span class="pl-pds">"</span>title<span class="pl-pds">"</span></span> <span class="pl-k">=&gt;</span> <span class="pl-s"><span class="pl-pds">"</span>My Demo Api<span class="pl-pds">"</span></span>, <span class="pl-s"><span class="pl-pds">"</span>version<span class="pl-pds">"</span></span> <span class="pl-k">=&gt;</span> <span class="pl-s"><span class="pl-pds">"</span>1.0.0<span class="pl-pds">"</span></span>)
openApi <span class="pl-k">=</span> <span class="pl-c1">OpenAPI</span>(<span class="pl-s"><span class="pl-pds">"</span>3.0<span class="pl-pds">"</span></span>, info)
swagger_document <span class="pl-k">=</span> <span class="pl-c1">build</span>(openApi)
  
<span class="pl-c"><span class="pl-c">#</span> merge the SwaggerMarkdown schema with the internal schema</span>
<span class="pl-c1">mergeschema</span>(swagger_document)

<span class="pl-c"><span class="pl-c">#</span> start the web server</span>
<span class="pl-c1">serve</span>()</pre></div>
<p dir="auto">Below is an example of how to manually modify the schema</p>
<div class="highlight highlight-source-julia notranslate position-relative overflow-auto" dir="auto" data-snippet-clipboard-copy-content="using Oxygen
using SwaggerMarkdown

# Only the basic information is parsed from this route when generating docs
@get &quot;/multiply/{a}/{b}&quot; function (req, a::Float64, b::Float64)
    return a * b
end

# Here's an example of how to update a part of the schema yourself
mergeschema(&quot;/multiply/{a}/{b}&quot;, 
  Dict(
    &quot;get&quot; =&gt; Dict(
      &quot;description&quot; =&gt; &quot;return the result of a * b&quot;
    )
  )
)

# Here's another example of how to update a part of the schema yourself, but this way allows you to modify other properties defined at the root of the schema (title, summary, etc.)
mergeschema(
  Dict(
    &quot;paths&quot; =&gt; Dict(
      &quot;/multiply/{a}/{b}&quot; =&gt; Dict(
        &quot;get&quot; =&gt; Dict(
          &quot;description&quot; =&gt; &quot;return the result of a * b&quot;
        )
      )
    )
  )
)"><pre><span class="pl-k">using</span> Oxygen
<span class="pl-k">using</span> SwaggerMarkdown

<span class="pl-c"><span class="pl-c">#</span> Only the basic information is parsed from this route when generating docs</span>
<span class="pl-c1">@get</span> <span class="pl-s"><span class="pl-pds">"</span>/multiply/{a}/{b}<span class="pl-pds">"</span></span> <span class="pl-k">function</span> (req, a<span class="pl-k">::</span><span class="pl-c1">Float64</span>, b<span class="pl-k">::</span><span class="pl-c1">Float64</span>)
    <span class="pl-k">return</span> a <span class="pl-k">*</span> b
<span class="pl-k">end</span>

<span class="pl-c"><span class="pl-c">#</span> Here's an example of how to update a part of the schema yourself</span>
<span class="pl-c1">mergeschema</span>(<span class="pl-s"><span class="pl-pds">"</span>/multiply/{a}/{b}<span class="pl-pds">"</span></span>, 
  <span class="pl-c1">Dict</span>(
    <span class="pl-s"><span class="pl-pds">"</span>get<span class="pl-pds">"</span></span> <span class="pl-k">=&gt;</span> <span class="pl-c1">Dict</span>(
      <span class="pl-s"><span class="pl-pds">"</span>description<span class="pl-pds">"</span></span> <span class="pl-k">=&gt;</span> <span class="pl-s"><span class="pl-pds">"</span>return the result of a * b<span class="pl-pds">"</span></span>
    )
  )
)

<span class="pl-c"><span class="pl-c">#</span> Here's another example of how to update a part of the schema yourself, but this way allows you to modify other properties defined at the root of the schema (title, summary, etc.)</span>
<span class="pl-c1">mergeschema</span>(
  <span class="pl-c1">Dict</span>(
    <span class="pl-s"><span class="pl-pds">"</span>paths<span class="pl-pds">"</span></span> <span class="pl-k">=&gt;</span> <span class="pl-c1">Dict</span>(
      <span class="pl-s"><span class="pl-pds">"</span>/multiply/{a}/{b}<span class="pl-pds">"</span></span> <span class="pl-k">=&gt;</span> <span class="pl-c1">Dict</span>(
        <span class="pl-s"><span class="pl-pds">"</span>get<span class="pl-pds">"</span></span> <span class="pl-k">=&gt;</span> <span class="pl-c1">Dict</span>(
          <span class="pl-s"><span class="pl-pds">"</span>description<span class="pl-pds">"</span></span> <span class="pl-k">=&gt;</span> <span class="pl-s"><span class="pl-pds">"</span>return the result of a * b<span class="pl-pds">"</span></span>
        )
      )
    )
  )
)</pre></div>
<h1 dir="auto"><a id="user-content-common-issues--tips" class="anchor" aria-hidden="true" href="#common-issues--tips"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a>Common Issues &amp; Tips</h1>
<h2 dir="auto"><a id="user-content-problems-working-with-julias-repl" class="anchor" aria-hidden="true" href="#problems-working-with-julias-repl"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a>Problems working with Julia's REPL</h2>
<p dir="auto">This is a recurring issue that occurs when writing and testing code in the REPL. Often, people find that their changes are not reflected when they rerun the server. The reason for this is that all the routing utilities are defined as macros, and they are only executed during the precompilation stage. To have your changes take effect, you need to move your route declarations to the <code>__init__()</code> function in your module.</p>
<div class="highlight highlight-source-julia notranslate position-relative overflow-auto" dir="auto" data-snippet-clipboard-copy-content="module OxygenExample
using Oxygen
using HTTP

# is called whenever you load this module
function __init__()
    @get &quot;/greet&quot; function(req::HTTP.Request)
        return &quot;hello world!&quot;
    end
end

# you can call this function from the REPL to start the server
function runserver()
    serve()
end

end "><pre><span class="pl-k">module</span> OxygenExample
<span class="pl-k">using</span> Oxygen
<span class="pl-k">using</span> HTTP

<span class="pl-c"><span class="pl-c">#</span> is called whenever you load this module</span>
<span class="pl-k">function</span> <span class="pl-en">__init__</span>()
    <span class="pl-c1">@get</span> <span class="pl-s"><span class="pl-pds">"</span>/greet<span class="pl-pds">"</span></span> <span class="pl-k">function</span>(req<span class="pl-k">::</span><span class="pl-c1">HTTP.Request</span>)
        <span class="pl-k">return</span> <span class="pl-s"><span class="pl-pds">"</span>hello world!<span class="pl-pds">"</span></span>
    <span class="pl-k">end</span>
<span class="pl-k">end</span>

<span class="pl-c"><span class="pl-c">#</span> you can call this function from the REPL to start the server</span>
<span class="pl-k">function</span> <span class="pl-en">runserver</span>()
    <span class="pl-c1">serve</span>()
<span class="pl-k">end</span>

<span class="pl-k">end</span> </pre></div>
<h1 dir="auto"><a id="user-content-api-reference-macros" class="anchor" aria-hidden="true" href="#api-reference-macros"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a>API Reference (macros)</h1>
<h4 dir="auto"><a id="user-content-get-post-put-patch-delete" class="anchor" aria-hidden="true" href="#get-post-put-patch-delete"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a>@get, @post, @put, @patch, @delete</h4>
<div class="highlight highlight-source-julia notranslate position-relative overflow-auto" dir="auto" data-snippet-clipboard-copy-content="  @get(path, func)"><pre>  <span class="pl-c1">@get</span>(path, func)</pre></div>
<table>
<thead>
<tr>
<th align="left">Parameter</th>
<th align="left">Type</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left"><code>path</code></td>
<td align="left"><code>string</code> or <code>router()</code></td>
<td align="left"><strong>Required</strong>. The route to register</td>
</tr>
<tr>
<td align="left"><code>func</code></td>
<td align="left"><code>function</code></td>
<td align="left"><strong>Required</strong>. The request handler for this route</td>
</tr>
</tbody>
</table>
<p dir="auto">Used to register a function to a specific endpoint to handle that corresponding type of request</p>
<h4 dir="auto"><a id="user-content-route" class="anchor" aria-hidden="true" href="#route"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a>@route</h4>
<div class="highlight highlight-source-julia notranslate position-relative overflow-auto" dir="auto" data-snippet-clipboard-copy-content="  @route(methods, path, func)"><pre>  <span class="pl-c1">@route</span>(methods, path, func)</pre></div>
<table>
<thead>
<tr>
<th align="left">Parameter</th>
<th align="left">Type</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left"><code>methods</code></td>
<td align="left"><code>array</code></td>
<td align="left"><strong>Required</strong>. The types of HTTP requests to register to this route</td>
</tr>
<tr>
<td align="left"><code>path</code></td>
<td align="left"><code>string</code> or <code>router()</code></td>
<td align="left"><strong>Required</strong>. The route to register</td>
</tr>
<tr>
<td align="left"><code>func</code></td>
<td align="left"><code>function</code></td>
<td align="left"><strong>Required</strong>. The request handler for this route</td>
</tr>
</tbody>
</table>
<p dir="auto">Low-level macro that allows a route to be handle multiple request types</p>
<h4 dir="auto"><a id="user-content-staticfiles" class="anchor" aria-hidden="true" href="#staticfiles"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a>staticfiles</h4>
<div class="highlight highlight-source-julia notranslate position-relative overflow-auto" dir="auto" data-snippet-clipboard-copy-content="  staticfiles(folder, mount)"><pre>  <span class="pl-c1">staticfiles</span>(folder, mount)</pre></div>
<table>
<thead>
<tr>
<th align="left">Parameter</th>
<th align="left">Type</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left"><code>folder</code></td>
<td align="left"><code>string</code></td>
<td align="left"><strong>Required</strong>. The folder to serve files from</td>
</tr>
<tr>
<td align="left"><code>mountdir</code></td>
<td align="left"><code>string</code></td>
<td align="left">The root endpoint to mount files under (default is "static")</td>
</tr>
</tbody>
</table>
<p dir="auto">Serve all static files within a folder. This function recursively searches a directory
and mounts all files under the mount directory using their relative paths.</p>
<h3 dir="auto"><a id="user-content-request-helper-functions" class="anchor" aria-hidden="true" href="#request-helper-functions"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a>Request helper functions</h3>
<h4 dir="auto"><a id="user-content-html" class="anchor" aria-hidden="true" href="#html"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a>html()</h4>
<div class="highlight highlight-source-julia notranslate position-relative overflow-auto" dir="auto" data-snippet-clipboard-copy-content="  html(content, status, headers)"><pre>  <span class="pl-c1">html</span>(content, status, headers)</pre></div>
<table>
<thead>
<tr>
<th align="left">Parameter</th>
<th align="left">Type</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left"><code>content</code></td>
<td align="left"><code>string</code></td>
<td align="left"><strong>Required</strong>. The string to be returned as HTML</td>
</tr>
<tr>
<td align="left"><code>status</code></td>
<td align="left"><code>integer</code></td>
<td align="left">The HTTP response code (default is 200)</td>
</tr>
<tr>
<td align="left"><code>headers</code></td>
<td align="left"><code>dict</code></td>
<td align="left">The headers for the HTTP response (default has content-type header set to "text/html; charset=utf-8")</td>
</tr>
</tbody>
</table>
<p dir="auto">Helper function to designate when content should be returned as HTML</p>
<h4 dir="auto"><a id="user-content-queryparams" class="anchor" aria-hidden="true" href="#queryparams"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a>queryparams()</h4>
<div class="highlight highlight-source-julia notranslate position-relative overflow-auto" dir="auto" data-snippet-clipboard-copy-content="  queryparams(request)"><pre>  <span class="pl-c1">queryparams</span>(request)</pre></div>
<table>
<thead>
<tr>
<th align="left">Parameter</th>
<th align="left">Type</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left"><code>req</code></td>
<td align="left"><code>HTTP.Request</code></td>
<td align="left"><strong>Required</strong>. The HTTP request object</td>
</tr>
</tbody>
</table>
<p dir="auto">Returns the query parameters from a request as a Dict()</p>
<h3 dir="auto"><a id="user-content-body-functions" class="anchor" aria-hidden="true" href="#body-functions"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a>Body Functions</h3>
<h4 dir="auto"><a id="user-content-text" class="anchor" aria-hidden="true" href="#text"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a>text()</h4>
<div class="highlight highlight-source-julia notranslate position-relative overflow-auto" dir="auto" data-snippet-clipboard-copy-content="  text(request)"><pre>  <span class="pl-c1">text</span>(request)</pre></div>
<table>
<thead>
<tr>
<th align="left">Parameter</th>
<th align="left">Type</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left"><code>req</code></td>
<td align="left"><code>HTTP.Request</code></td>
<td align="left"><strong>Required</strong>. The HTTP request object</td>
</tr>
</tbody>
</table>
<p dir="auto">Returns the body of a request as a string</p>
<h4 dir="auto"><a id="user-content-binary" class="anchor" aria-hidden="true" href="#binary"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a>binary()</h4>
<div class="highlight highlight-source-julia notranslate position-relative overflow-auto" dir="auto" data-snippet-clipboard-copy-content="  binary(request)"><pre>  <span class="pl-c1">binary</span>(request)</pre></div>
<table>
<thead>
<tr>
<th align="left">Parameter</th>
<th align="left">Type</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left"><code>req</code></td>
<td align="left"><code>HTTP.Request</code></td>
<td align="left"><strong>Required</strong>. The HTTP request object</td>
</tr>
</tbody>
</table>
<p dir="auto">Returns the body of a request as a binary file (returns a vector of <code>UInt8</code>s)</p>
<h4 dir="auto"><a id="user-content-json" class="anchor" aria-hidden="true" href="#json"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a>json()</h4>
<div class="highlight highlight-source-julia notranslate position-relative overflow-auto" dir="auto" data-snippet-clipboard-copy-content="  json(request, classtype)"><pre>  <span class="pl-c1">json</span>(request, classtype)</pre></div>
<table>
<thead>
<tr>
<th align="left">Parameter</th>
<th align="left">Type</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left"><code>req</code></td>
<td align="left"><code>HTTP.Request</code></td>
<td align="left"><strong>Required</strong>. The HTTP request object</td>
</tr>
<tr>
<td align="left"><code>classtype</code></td>
<td align="left"><code>struct</code></td>
<td align="left">A struct to deserialize a JSON object into</td>
</tr>
</tbody>
</table>
<p dir="auto">Deserialize the body of a request into a julia struct</p>
</article></div>