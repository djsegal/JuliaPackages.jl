<div id="readme" class="md" data-path="README.md"><article class="markdown-body entry-content container-lg" itemprop="text"><h1><a id="user-content-bonsai" class="anchor" aria-hidden="true" href="#bonsai"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>Bonsai</h1>
<p><a href="https://travis-ci.com/onetonfoot/Bonsai.jl" rel="nofollow"><img src="https://camo.githubusercontent.com/65fc38d9bf5549320dd38f892dd35a2de1d25fbb/68747470733a2f2f7472617669732d63692e636f6d2f6f6e65746f6e666f6f742f426f6e7361692e6a6c2e7376673f6272616e63683d6d6173746572" alt="Build Status" data-canonical-src="https://travis-ci.com/onetonfoot/Bonsai.jl.svg?branch=master" style="max-width:100%;"></a>
<a href="https://coveralls.io/github/onetonfoot/Bonsai.jl?branch=master" rel="nofollow"><img src="https://camo.githubusercontent.com/6909cd2073d2e845f624244045ee3d8b6b1af95f/68747470733a2f2f636f766572616c6c732e696f2f7265706f732f6769746875622f6f6e65746f6e666f6f742f426f6e7361692e6a6c2f62616467652e7376673f6272616e63683d6d6173746572" alt="Coverage Status" data-canonical-src="https://coveralls.io/repos/github/onetonfoot/Bonsai.jl/badge.svg?branch=master" style="max-width:100%;"></a></p>
<h2><a id="user-content-getting-started" class="anchor" aria-hidden="true" href="#getting-started"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>Getting started</h2>
<p>Create a instance of the app, add a route then starting the server</p>
<div class="highlight highlight-source-julia"><pre>app <span class="pl-k">=</span> <span class="pl-c1">App</span>()

<span class="pl-c1">app</span>(<span class="pl-s"><span class="pl-pds">"</span>/path<span class="pl-pds">"</span></span>; method <span class="pl-k">=</span> GET) <span class="pl-k">do</span> request
    reponse <span class="pl-k">=</span> <span class="pl-s"><span class="pl-pds">"</span>hello<span class="pl-pds">"</span></span>
    <span class="pl-k">return</span> response
<span class="pl-k">end</span>

<span class="pl-c1">start</span>(app)</pre></div>
<p>Now vist <code>localhost:8081</code>.</p>
<p>The handler function should take a <code>HTTP.Request</code> and return a <code>HTTP.Response</code>.
If the return type isn't a <code>Response</code> then it will be made into one by <code>create_response</code>, you can
overload this function for any type from more control.</p>
<h2><a id="user-content-routing-and-query-parameters" class="anchor" aria-hidden="true" href="#routing-and-query-parameters"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>Routing and Query Parameters</h2>
<p>Routes can be defined for multiple methods by passing an array</p>
<div class="highlight highlight-source-julia"><pre><span class="pl-c1">app</span>(handler, <span class="pl-s"><span class="pl-pds">"</span>/path<span class="pl-pds">"</span></span>; method <span class="pl-k">=</span> [GET, POST])</pre></div>
<p>Routes can be parametrized by using the syntax <code>/:x</code>. You can then access
the parameters in the handler with.</p>
<div class="highlight highlight-source-julia"><pre><span class="pl-c1">app</span>(<span class="pl-s"><span class="pl-pds">"</span>/route/:id<span class="pl-pds">"</span></span>, method <span class="pl-k">=</span> [GET, POST]) <span class="pl-k">do</span> request
    params <span class="pl-k">=</span> <span class="pl-c1">path_params</span>(request)
    <span class="pl-c"><span class="pl-c">#</span> Dict(:id =&gt; value)</span>
<span class="pl-k">end</span></pre></div>
<p>Specific routes will be matched first, in other words <code>"/route/1"</code> will be matched before <code>"/route/:id"</code>.
Query parameters can be accessed in a similar way.</p>
<div class="highlight highlight-source-julia"><pre>query <span class="pl-k">=</span> <span class="pl-c1">query_params</span>(request)</pre></div>
<p>Specific routes like <code>/path</code> take priority over variable routes such as <code>/:path</code>.</p>
<h1><a id="user-content-serving-files" class="anchor" aria-hidden="true" href="#serving-files"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>Serving Files</h1>
<h2><a id="user-content-files" class="anchor" aria-hidden="true" href="#files"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>Files</h2>
<p>To serve a single file from <code>"/index.html"</code>.</p>
<div class="highlight highlight-source-julia"><pre><span class="pl-c1">app</span>(<span class="pl-s"><span class="pl-pds"><span class="pl-c1">p</span>"</span>index.html<span class="pl-pds">"</span></span>)</pre></div>
<p>By default the file will be served from the index, but you can specify a route with.</p>
<div class="highlight highlight-source-julia"><pre><span class="pl-c1">app</span>(<span class="pl-s"><span class="pl-pds">"</span>/page<span class="pl-pds">"</span></span>, <span class="pl-s"><span class="pl-pds"><span class="pl-c1">p</span>"</span>page.html<span class="pl-pds">"</span></span>)</pre></div>
<p>The MIME type will be infered from the extension, the supported MIME types can be found <a href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Basics_of_HTTP/MIME_types/Common_types" rel="nofollow">here</a>. If the MIME type is unsuported it can be added to the global <code>MIME_TYPES</code>.</p>
<h2><a id="user-content-folders" class="anchor" aria-hidden="true" href="#folders"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>Folders</h2>
<div class="highlight highlight-source-julia"><pre><span class="pl-c1">app</span>(<span class="pl-s"><span class="pl-pds">"</span>/img<span class="pl-pds">"</span></span>, <span class="pl-s"><span class="pl-pds"><span class="pl-c1">f</span>"</span>images<span class="pl-pds">"</span></span>)</pre></div>
<h2><a id="user-content-create-response" class="anchor" aria-hidden="true" href="#create-response"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>Create Response</h2>
<p>After your handler is called if it's return type isn't a <code>Response</code> it will be made into one by
calling <code>create_response</code>. You can overload <code>create_reponse</code> for your specific type to have more control.</p>
<div class="highlight highlight-source-julia"><pre><span class="pl-c1">create_response</span>(t<span class="pl-k">::</span><span class="pl-c1">Mytype</span>)<span class="pl-k">::</span><span class="pl-c1">HTTP.Response</span></pre></div>
<p>This is already defined for <code>AbstractString</code> and <code>AbstractDict</code>, were the Content-Type header is set as <code>text/plain</code> and <code>application/json</code> respectively.</p>
<h2><a id="user-content-sessions" class="anchor" aria-hidden="true" href="#sessions"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>Sessions</h2>
<p>When instantiating the app you can pass any data structure you want to use for the session, by default this will be a <code>Dict</code>. The session can then be accessed in the handler.</p>
<div class="highlight highlight-source-julia"><pre><span class="pl-c1">app</span>(<span class="pl-s"><span class="pl-pds">"</span>/path<span class="pl-pds">"</span></span>) <span class="pl-k">do</span> req
    session <span class="pl-k">=</span> app<span class="pl-k">.</span>session
<span class="pl-k">end</span></pre></div>
<p>Note <code>Dict</code> isn't thread safe so this will likey change in the future to a differnt data structure.</p>
<h1><a id="user-content-examples" class="anchor" aria-hidden="true" href="#examples"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>Examples</h1>
<p>For more examples see the <code>examples</code> folder.</p>
<h1><a id="user-content-todo" class="anchor" aria-hidden="true" href="#todo"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>TODO</h1>
<h2><a id="user-content-docker" class="anchor" aria-hidden="true" href="#docker"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>Docker</h2>
<h2><a id="user-content-middleware" class="anchor" aria-hidden="true" href="#middleware"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>Middleware</h2>
<h2><a id="user-content-websockets" class="anchor" aria-hidden="true" href="#websockets"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>WebSockets</h2>
<h1><a id="user-content-useful-packages" class="anchor" aria-hidden="true" href="#useful-packages"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>Useful Packages</h1>
<p>Some packages that you may find useful to pair wtih <code>Bonsai</code>.</p>
<ul>
<li><a href="https://github.com/wookay/Octo.jl">Octo.jl</a> - a SQL Query DSL</li>
</ul>
</article></div>