<div id="readme" class="md" data-path="README.md"><article class="markdown-body entry-content container-lg" itemprop="text"><h1 dir="auto"><a id="user-content-chatapicall" class="anchor" aria-hidden="true" href="#chatapicall"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a>ChatAPICall</h1>
<p dir="auto"><a href="https://RexWzh.github.io/ChatAPICall.jl/stable/" rel="nofollow"><img src="https://camo.githubusercontent.com/c97f0a5f2ae95755f64a27f1aa8d9a17462941fd3d6c907c7630abd5d3e60acf/68747470733a2f2f696d672e736869656c64732e696f2f62616467652f646f63732d737461626c652d626c75652e737667" alt="Stable" data-canonical-src="https://img.shields.io/badge/docs-stable-blue.svg" style="max-width: 100%;"></a>
<a href="https://RexWzh.github.io/ChatAPICall.jl/dev/" rel="nofollow"><img src="https://camo.githubusercontent.com/7fcec4b2d3ab291529fce8ef6a4fcd4129a0683b2f5d5fe2f5c648f02db8b616/68747470733a2f2f696d672e736869656c64732e696f2f62616467652f646f63732d6465762d626c75652e737667" alt="Dev" data-canonical-src="https://img.shields.io/badge/docs-dev-blue.svg" style="max-width: 100%;"></a>
<a href="https://github.com/RexWzh/ChatAPICall.jl/actions/workflows/CI.yml?query=branch%3Amain"><img src="https://github.com/RexWzh/ChatAPICall.jl/actions/workflows/CI.yml/badge.svg?branch=main" alt="Build Status" style="max-width: 100%;"></a>
<a href="https://codecov.io/gh/RexWzh/ChatAPICall.jl" rel="nofollow"><img src="https://camo.githubusercontent.com/c270af6e4c295295ab25d7d80ba18e202285597220dd9a1d02d078996240c772/68747470733a2f2f636f6465636f762e696f2f67682f526578577a682f4368617441504943616c6c2e6a6c2f6272616e63682f6d61696e2f67726170682f62616467652e737667" alt="Coverage" data-canonical-src="https://codecov.io/gh/RexWzh/ChatAPICall.jl/branch/main/graph/badge.svg" style="max-width: 100%;"></a></p>
<p dir="auto">A simple wrapper for OpenAI's <a href="https://platform.openai.com/docs/api-reference/introduction" rel="nofollow">API</a>.</p>
<blockquote>
<p dir="auto">中文文档移步这里：<a href="README_zh-CN.md">README_zh-CN.md</a></p>
</blockquote>
<h2 dir="auto"><a id="user-content-usage" class="anchor" aria-hidden="true" href="#usage"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a>Usage</h2>
<h3 dir="auto"><a id="user-content-set-api-key" class="anchor" aria-hidden="true" href="#set-api-key"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a>Set API Key</h3>
<div class="highlight highlight-source-julia notranslate position-relative overflow-auto" dir="auto" data-snippet-clipboard-copy-content="using ChatAPICall
setapikey(&quot;sk-xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx&quot;)"><pre><span class="pl-k">using</span> ChatAPICall
<span class="pl-c1">setapikey</span>(<span class="pl-s"><span class="pl-pds">"</span>sk-xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx<span class="pl-pds">"</span></span>)</pre></div>
<p dir="auto">Or set <code>OPENAI_API_KEY</code> in <code>~/.bashrc</code> to automatically load the API key when using the package:</p>
<div class="highlight highlight-source-shell notranslate position-relative overflow-auto" dir="auto" data-snippet-clipboard-copy-content="# Add the following code to ~/.bashrc
export OPENAI_API_KEY=&quot;sk-xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx&quot;"><pre><span class="pl-c"><span class="pl-c">#</span> Add the following code to ~/.bashrc</span>
<span class="pl-k">export</span> OPENAI_API_KEY=<span class="pl-s"><span class="pl-pds">"</span>sk-xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx<span class="pl-pds">"</span></span></pre></div>
<h3 dir="auto"><a id="user-content-set-proxy-optional" class="anchor" aria-hidden="true" href="#set-proxy-optional"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a>Set Proxy (Optional)</h3>
<div class="highlight highlight-source-julia notranslate position-relative overflow-auto" dir="auto" data-snippet-clipboard-copy-content="using ChatAPICall

# Set proxy(example)
proxy_on(http=&quot;127.0.0.1:7890&quot;, https=&quot;socks://127.0.0.1:7891&quot;)

# Check the current proxy
proxy_status()

# Turn off proxy
proxy_off() "><pre><span class="pl-k">using</span> ChatAPICall

<span class="pl-c"><span class="pl-c">#</span> Set proxy(example)</span>
<span class="pl-c1">proxy_on</span>(http<span class="pl-k">=</span><span class="pl-s"><span class="pl-pds">"</span>127.0.0.1:7890<span class="pl-pds">"</span></span>, https<span class="pl-k">=</span><span class="pl-s"><span class="pl-pds">"</span>socks://127.0.0.1:7891<span class="pl-pds">"</span></span>)

<span class="pl-c"><span class="pl-c">#</span> Check the current proxy</span>
<span class="pl-c1">proxy_status</span>()

<span class="pl-c"><span class="pl-c">#</span> Turn off proxy</span>
<span class="pl-c1">proxy_off</span>() </pre></div>
<p dir="auto">Or you might want to use a proxy url (It is <code>https://api.openai.com</code> by default):</p>
<div class="highlight highlight-source-julia notranslate position-relative overflow-auto" dir="auto" data-snippet-clipboard-copy-content="using ChatAPICall
setbaseurl(&quot;https://api.example.com&quot;)"><pre><span class="pl-k">using</span> ChatAPICall
<span class="pl-c1">setbaseurl</span>(<span class="pl-s"><span class="pl-pds">"</span>https://api.example.com<span class="pl-pds">"</span></span>)</pre></div>
<h3 dir="auto"><a id="user-content-basic-usage" class="anchor" aria-hidden="true" href="#basic-usage"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a>Basic Usage</h3>
<p dir="auto">Example 1, send prompt and return information:</p>
<div class="highlight highlight-source-julia notranslate position-relative overflow-auto" dir="auto" data-snippet-clipboard-copy-content="using ChatAPICall

# Check if API key is set
showapikey()

# Check if proxy is enabled
proxy_status()

# Send prompt and return response
chat = Chat(&quot;Hello, GPT-3.5!&quot;)
resp = getresponse(chat)"><pre><span class="pl-k">using</span> ChatAPICall

<span class="pl-c"><span class="pl-c">#</span> Check if API key is set</span>
<span class="pl-c1">showapikey</span>()

<span class="pl-c"><span class="pl-c">#</span> Check if proxy is enabled</span>
<span class="pl-c1">proxy_status</span>()

<span class="pl-c"><span class="pl-c">#</span> Send prompt and return response</span>
chat <span class="pl-k">=</span> <span class="pl-c1">Chat</span>(<span class="pl-s"><span class="pl-pds">"</span>Hello, GPT-3.5!<span class="pl-pds">"</span></span>)
resp <span class="pl-k">=</span> <span class="pl-c1">getresponse</span>(chat)</pre></div>
<p dir="auto">Example 2, customize the message template and return the information and the number of consumed tokens:</p>
<div class="highlight highlight-source-julia notranslate position-relative overflow-auto" dir="auto" data-snippet-clipboard-copy-content="using ChatAPICall

# Customize the sending template
function ChatAPICall.defaultprompt(msg)
    [
        Dict(&quot;role&quot;=&gt;&quot;system&quot;, &quot;content&quot;=&gt;&quot;Please help me translate the following text.&quot;),
        Dict(&quot;role&quot;=&gt;&quot;user&quot;, &quot;content&quot;=&gt;msg)
    ]
end

chat = Chat(&quot;Hello!&quot;)
# Set the number of retries to Inf
response = getresponse(chat; temperature=0.5, maxrequests=-1)
println(&quot;Number of consumed tokens: &quot;, response.total_tokens)
println(&quot;Returned content: &quot;, response.content)"><pre><span class="pl-k">using</span> ChatAPICall

<span class="pl-c"><span class="pl-c">#</span> Customize the sending template</span>
<span class="pl-k">function</span> ChatAPICall<span class="pl-k">.</span><span class="pl-en">defaultprompt</span>(msg)
    [
        <span class="pl-c1">Dict</span>(<span class="pl-s"><span class="pl-pds">"</span>role<span class="pl-pds">"</span></span><span class="pl-k">=&gt;</span><span class="pl-s"><span class="pl-pds">"</span>system<span class="pl-pds">"</span></span>, <span class="pl-s"><span class="pl-pds">"</span>content<span class="pl-pds">"</span></span><span class="pl-k">=&gt;</span><span class="pl-s"><span class="pl-pds">"</span>Please help me translate the following text.<span class="pl-pds">"</span></span>),
        <span class="pl-c1">Dict</span>(<span class="pl-s"><span class="pl-pds">"</span>role<span class="pl-pds">"</span></span><span class="pl-k">=&gt;</span><span class="pl-s"><span class="pl-pds">"</span>user<span class="pl-pds">"</span></span>, <span class="pl-s"><span class="pl-pds">"</span>content<span class="pl-pds">"</span></span><span class="pl-k">=&gt;</span>msg)
    ]
<span class="pl-k">end</span>

chat <span class="pl-k">=</span> <span class="pl-c1">Chat</span>(<span class="pl-s"><span class="pl-pds">"</span>Hello!<span class="pl-pds">"</span></span>)
<span class="pl-c"><span class="pl-c">#</span> Set the number of retries to Inf</span>
response <span class="pl-k">=</span> <span class="pl-c1">getresponse</span>(chat; temperature<span class="pl-k">=</span><span class="pl-c1">0.5</span>, maxrequests<span class="pl-k">=</span><span class="pl-k">-</span><span class="pl-c1">1</span>)
<span class="pl-c1">println</span>(<span class="pl-s"><span class="pl-pds">"</span>Number of consumed tokens: <span class="pl-pds">"</span></span>, response<span class="pl-k">.</span>total_tokens)
<span class="pl-c1">println</span>(<span class="pl-s"><span class="pl-pds">"</span>Returned content: <span class="pl-pds">"</span></span>, response<span class="pl-k">.</span>content)</pre></div>
<h3 dir="auto"><a id="user-content-advanced-usage" class="anchor" aria-hidden="true" href="#advanced-usage"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a>Advanced Usage</h3>
<p dir="auto">Continue chatting based on the last response:</p>
<div class="highlight highlight-source-julia notranslate position-relative overflow-auto" dir="auto" data-snippet-clipboard-copy-content="# first call
chat = Chat(&quot;Hello, GPT-3.5!&quot;)
resp = getresponse!(chat) # update chat history
println(resp.content)

# continue chatting
adduser!(chat, &quot;How are you?&quot;)
next_resp = getresponse!(chat)
println(next_resp.content)

# fake response
adduser!(chat, &quot;What's your name?&quot;)
addassistant!(chat, &quot;My name is GPT-3.5.&quot;)

# print chat history
print(chat)"><pre><span class="pl-c"><span class="pl-c">#</span> first call</span>
chat <span class="pl-k">=</span> <span class="pl-c1">Chat</span>(<span class="pl-s"><span class="pl-pds">"</span>Hello, GPT-3.5!<span class="pl-pds">"</span></span>)
resp <span class="pl-k">=</span> <span class="pl-c1">getresponse!</span>(chat) <span class="pl-c"><span class="pl-c">#</span> update chat history</span>
<span class="pl-c1">println</span>(resp<span class="pl-k">.</span>content)

<span class="pl-c"><span class="pl-c">#</span> continue chatting</span>
<span class="pl-c1">adduser!</span>(chat, <span class="pl-s"><span class="pl-pds">"</span>How are you?<span class="pl-pds">"</span></span>)
next_resp <span class="pl-k">=</span> <span class="pl-c1">getresponse!</span>(chat)
<span class="pl-c1">println</span>(next_resp<span class="pl-k">.</span>content)

<span class="pl-c"><span class="pl-c">#</span> fake response</span>
<span class="pl-c1">adduser!</span>(chat, <span class="pl-s"><span class="pl-pds">"</span>What's your name?<span class="pl-pds">"</span></span>)
<span class="pl-c1">addassistant!</span>(chat, <span class="pl-s"><span class="pl-pds">"</span>My name is GPT-3.5.<span class="pl-pds">"</span></span>)

<span class="pl-c"><span class="pl-c">#</span> print chat history</span>
<span class="pl-c1">print</span>(chat)</pre></div>
<h2 dir="auto"><a id="user-content-license" class="anchor" aria-hidden="true" href="#license"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a>License</h2>
<p dir="auto">This package is licensed under the MIT license. See the LICENSE file for more details.</p>
<h2 dir="auto"><a id="user-content-features" class="anchor" aria-hidden="true" href="#features"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a>Features</h2>
<ul dir="auto">
<li>TODO</li>
</ul>
</article></div>