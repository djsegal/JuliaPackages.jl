<div id="readme" class="md" data-path="README.md"><article class="markdown-body entry-content container-lg" itemprop="text"><div align="center">
<a target="_blank" rel="noopener noreferrer" href="logo.png"><img src="logo.png" alt="Peacock logo" style="max-width:100%;"></a>
</div>
<h2><a id="user-content-introduction" class="anchor" aria-hidden="true" href="#introduction"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>Introduction</h2>
<p><code>Peacock.jl</code> - or the <strong>P</strong>lane-wave <strong>E</strong>xpansion <strong>A</strong>pproach to <strong>C</strong>haracterising <strong>O</strong>ptical <strong>C</strong>rystals in <strong>k</strong>-space - is a Julia package for studying photonic crystals using the Plane Wave Expansion Method.</p>
<p>Photonic crystals are materials whose optical properties arise from the structuring of the material when the size of the structures are comparable to the wavelengths of light. <code>Peacock.jl</code> is named for the irridescent colours of peacock feathers which arise not from pigmentation but from their photonic crystal structure, as shown below.</p>
<p><a target="_blank" rel="noopener noreferrer" href="zoom.png"><img src="zoom.png" alt="Different zooms of a Peacock" style="max-width:100%;"></a>
<sub>Credits: Peacock by allanlau2000 from pixabay. Feather by suju from pixabay. Electron microscope image of photonic crystal structure from Zi, Jian, et al. "Coloration strategies in peacock feathers.",  <em>Proceedings of the National Academy of Sciences</em> 100.22 (2003): 12576-12578. Copyright (2003) National Academy of Sciences.</sub></p>
<p>As well as occuring naturally as in animals such as peacocks, advances in nanofabrication mean that 'designer' photonic crystals can now be manufactured for unprecedented control over the flow of light, with applications ranging from optical fibers to photonic circuitry. Photonic crystals are also a promising platform for more exotic materials like topological insulators.</p>
<ul>
<li>
<p>Solve for...</p>
<ul>
<li>Transverse electric (TE) and transverse magnetic (TM) modes of 2D photonic crystals</li>
<li>Non-orthogonal unit cells</li>
<li>Inhomogeneous permittivity and/or permeability</li>
<li>Chern numbers of topological photonic crystals using built-in Wilson loop methods</li>
</ul>
</li>
<li>
<p>Focused on ease of use</p>
<ul>
<li>Install with one line in Julia's package manager</li>
<li>Simple visualisation of geometry, fields, and fully labelled band diagrams</li>
</ul>
</li>
</ul>
<h2><a id="user-content-example-usage" class="anchor" aria-hidden="true" href="#example-usage"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>Example usage</h2>
<h3><a id="user-content-installation" class="anchor" aria-hidden="true" href="#installation"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>Installation</h3>
<p>The package can be installed using the built-in Julia package manager</p>
<div class="highlight highlight-source-julia"><pre><span class="pl-k">using</span> Pkg
Pkg<span class="pl-k">.</span><span class="pl-c1">add</span>(<span class="pl-s"><span class="pl-pds">"</span>Peacock<span class="pl-pds">"</span></span>)</pre></div>
<p>After installation, the package can be loaded in Julia</p>
<div class="highlight highlight-source-julia"><pre><span class="pl-k">using</span> Peacock</pre></div>
<p>This example will also use <code>PyPlot</code> to control our figures, and the <code>Parameters</code> package to unpack some tuples.</p>
<div class="highlight highlight-source-julia"><pre><span class="pl-k">using</span> Pkg
Pkg<span class="pl-k">.</span><span class="pl-c1">add</span>(<span class="pl-s"><span class="pl-pds">"</span>PyPlot<span class="pl-pds">"</span></span>)
Pkg<span class="pl-k">.</span><span class="pl-c1">add</span>(<span class="pl-s"><span class="pl-pds">"</span>Parameters<span class="pl-pds">"</span></span>)
<span class="pl-k">using</span> PyPlot
<span class="pl-k">using</span> Parameters</pre></div>
<h3><a id="user-content-defining-a-photonic-crystal-in-real-space" class="anchor" aria-hidden="true" href="#defining-a-photonic-crystal-in-real-space"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>Defining a photonic crystal in real space</h3>
<p>A photonic crystal is defined using the <code>Geometry</code> constructor, which requires the optical properties of the crystal, lattice vectors, and resolution. Here we demonstrate how to define the photonic crystal used in figures 2 and 3 of chapter 5 of <em>Photonic crystals: molding the flow of light</em> by Joannopoulos (see further reading).</p>
<div class="highlight highlight-source-julia"><pre><span class="pl-c"><span class="pl-c">#</span> Permittivity</span>
<span class="pl-k">function</span> <span class="pl-en">epf</span>(x,y)
    <span class="pl-k">if</span> x<span class="pl-k">^</span><span class="pl-c1">2</span><span class="pl-k">+</span>y<span class="pl-k">^</span><span class="pl-c1">2</span> <span class="pl-k">&lt;</span> <span class="pl-c1">0.2</span><span class="pl-k">^</span><span class="pl-c1">2</span>
        <span class="pl-k">return</span> <span class="pl-c1">8.9</span>
    <span class="pl-k">else</span>
        <span class="pl-k">return</span> <span class="pl-c1">1</span>
    <span class="pl-k">end</span>
<span class="pl-k">end</span>

<span class="pl-c"><span class="pl-c">#</span> Permeability</span>
<span class="pl-k">function</span> <span class="pl-en">muf</span>(x,y)
    <span class="pl-k">return</span> <span class="pl-c1">1</span>
<span class="pl-k">end</span>
    
<span class="pl-c"><span class="pl-c">#</span> Lattice vectors</span>
a1 <span class="pl-k">=</span> [<span class="pl-c1">1</span>, <span class="pl-c1">0</span>]
a2 <span class="pl-k">=</span> [<span class="pl-c1">0</span>, <span class="pl-c1">1</span>]

<span class="pl-c"><span class="pl-c">#</span> Real-space resolution</span>
d1 <span class="pl-k">=</span> d2 <span class="pl-k">=</span> <span class="pl-c1">0.01</span>

geometry <span class="pl-k">=</span> <span class="pl-c1">Geometry</span>(epf, muf, a1, a2, d1, d2)
<span class="pl-c1">plot</span>(geometry)</pre></div>
<blockquote>
<p><a target="_blank" rel="noopener noreferrer" href="figures/example_plot_geometry.png"><img src="figures/example_plot_geometry.png" alt="Plot of the example geometry" style="max-width:100%;"></a></p>
</blockquote>
<h3><a id="user-content-defining-the-solver" class="anchor" aria-hidden="true" href="#defining-the-solver"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>Defining the solver</h3>
<p>The <code>Solver</code> approximates the geometry using a truncated Plane Wave Expansion (see further reading). The number of plane waves is determined by the cutoff. Increasing the cutoff will increase the accuracy of the solution, but low-contrast photonic crystals can be well approximated with a relatively low number of plane waves.</p>
<div class="highlight highlight-source-julia"><pre>fourier_space_cutoff <span class="pl-k">=</span> <span class="pl-c1">7</span>
solver <span class="pl-k">=</span> <span class="pl-c1">Solver</span>(geometry, fourier_space_cutoff)
<span class="pl-c1">plot</span>(solver)</pre></div>
<blockquote>
<p><a target="_blank" rel="noopener noreferrer" href="figures/example_plot_solver_cutoff=7.png"><img src="figures/example_plot_solver_cutoff=7.png" alt="Plot of the example solver" style="max-width:100%;"></a></p>
</blockquote>
<h3><a id="user-content-plotting-the-band-structure-of-a-photonic-crystal" class="anchor" aria-hidden="true" href="#plotting-the-band-structure-of-a-photonic-crystal"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>Plotting the band structure of a photonic crystal</h3>
<p>Band structures can be generated using <code>plot_band_diagram(solver, ks, polarisation)</code>. If the elements of <code>ks</code> are instances of <code>BrillouinZoneCoordinate</code> then the band diagram will be fully labelled.</p>
<div class="highlight highlight-source-julia"><pre>G <span class="pl-k">=</span> <span class="pl-c1">BrillouinZoneCoordinate</span>(  <span class="pl-c1">0</span>,   <span class="pl-c1">0</span>, <span class="pl-s"><span class="pl-pds">"</span>Γ<span class="pl-pds">"</span></span>)
X <span class="pl-k">=</span> <span class="pl-c1">BrillouinZoneCoordinate</span>(<span class="pl-c1">1</span><span class="pl-k">/</span><span class="pl-c1">2</span>,   <span class="pl-c1">0</span>, <span class="pl-s"><span class="pl-pds">"</span>X<span class="pl-pds">"</span></span>)
M <span class="pl-k">=</span> <span class="pl-c1">BrillouinZoneCoordinate</span>(<span class="pl-c1">1</span><span class="pl-k">/</span><span class="pl-c1">2</span>, <span class="pl-c1">1</span><span class="pl-k">/</span><span class="pl-c1">2</span>, <span class="pl-s"><span class="pl-pds">"</span>M<span class="pl-pds">"</span></span>)
ks <span class="pl-k">=</span> [G,X,M,G]

<span class="pl-c1">figure</span>(figsize<span class="pl-k">=</span>(<span class="pl-c1">4</span>,<span class="pl-c1">3</span>))
<span class="pl-c1">plot_band_diagram</span>(solver, ks, TE, color<span class="pl-k">=</span><span class="pl-s"><span class="pl-pds">"</span>red<span class="pl-pds">"</span></span>,
            bands<span class="pl-k">=</span><span class="pl-c1">1</span><span class="pl-k">:</span><span class="pl-c1">4</span>, dk<span class="pl-k">=</span><span class="pl-c1">0.1</span>, frequency_scale<span class="pl-k">=</span><span class="pl-c1">1</span><span class="pl-k">/</span><span class="pl-c1">2</span>pi)
<span class="pl-c1">plot_band_diagram</span>(solver, ks, TM, color<span class="pl-k">=</span><span class="pl-s"><span class="pl-pds">"</span>blue<span class="pl-pds">"</span></span>,
            bands<span class="pl-k">=</span><span class="pl-c1">1</span><span class="pl-k">:</span><span class="pl-c1">4</span>, dk<span class="pl-k">=</span><span class="pl-c1">0.1</span>, frequency_scale<span class="pl-k">=</span><span class="pl-c1">1</span><span class="pl-k">/</span><span class="pl-c1">2</span>pi)
<span class="pl-c1">ylim</span>(<span class="pl-c1">0</span>,<span class="pl-c1">0.8</span>)</pre></div>
<blockquote>
<p><a target="_blank" rel="noopener noreferrer" href="figures/example_plot_band_diagram.png"><img src="figures/example_plot_band_diagram.png" alt="Plot of a band structure" style="max-width:100%;"></a></p>
</blockquote>
<p>This reproduces figure 2 of chapter 5 of Joannopoulos <em>et al</em> 2008.</p>
<h3><a id="user-content-plotting-the-modes" class="anchor" aria-hidden="true" href="#plotting-the-modes"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>Plotting the modes</h3>
<p>A <code>Mode</code> can be visualised using <code>plot(mode)</code>. By default the full Bloch wave is plotted - set <code>bloch_phase=false</code> to plot the cell-periodic part of Bloch mode.</p>
<p>The out of plane field component is plotted - for TE and TM polarisations this will be the magnetic and electric fields, respectively. The titles of the figures are set automatically using the <code>label</code> of the <code>Mode</code> object.</p>
<div class="highlight highlight-source-julia"><pre>modes <span class="pl-k">=</span> <span class="pl-c1">solve</span>(solver, X, TM)
<span class="pl-c1">plot</span>(modes[<span class="pl-c1">2</span>], bloch_phase<span class="pl-k">=</span><span class="pl-c1">true</span>)
<span class="pl-c1">plot</span>(modes[<span class="pl-c1">2</span>], bloch_phase<span class="pl-k">=</span><span class="pl-c1">false</span>)</pre></div>
<blockquote>
<p><a target="_blank" rel="noopener noreferrer" href="figures/example_plot_modes.png"><img src="figures/example_plot_modes.png" alt="Plot of some modes" style="max-width:100%;"></a></p>
</blockquote>
<p>This reproduces figure 3 of chapter 5 of Joannopoulos <em>et al</em> 2008. Note that <code>Peacock.jl</code> doesn't fix the phase of the solutions and your results may differ by a random phase.</p>
<h3><a id="user-content-the-peacockzoo-submodule" class="anchor" aria-hidden="true" href="#the-peacockzoo-submodule"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>The <code>Peacock.Zoo</code> submodule</h3>
<p>The <code>Peacock.Zoo</code> module contains some of the photonic crystals that I have studied. Each <code>make_*</code> function returns a <code>NamedTuple</code> containing the geometry, solver, polarisation, and high symmetry points of the crystal. For example, the topological photonic crystal first introduced by Wu <em>et al</em> 2015 can be reproduced using <code>make_wu_topo</code>.</p>
<div class="highlight highlight-source-julia"><pre><span class="pl-k">using</span> Peacock<span class="pl-k">.</span>Zoo

<span class="pl-c"><span class="pl-c">#</span> Load photonic topological insulator from Wu et al 2015</span>
<span class="pl-c1">@unpack</span> geometry, solver, polarisation, G, K, M <span class="pl-k">=</span> <span class="pl-c1">make_wu_topo</span>(fourier_space_cutoff)

<span class="pl-c"><span class="pl-c">#</span> Preview the crystal</span>
<span class="pl-c1">plot</span>(geometry)</pre></div>
<blockquote>
<p><a target="_blank" rel="noopener noreferrer" href="figures/example_zoo_geometry.png"><img src="figures/example_zoo_geometry.png" alt="Plot of a crystal from the Zoo" style="max-width:100%;"></a></p>
</blockquote>
<p>Here I used the <code>@unpack</code> macro from the <code>Parameters</code> package to unpack the named tuple.</p>
<div class="highlight highlight-source-julia"><pre><span class="pl-c"><span class="pl-c">#</span> Plot the first six bands</span>
<span class="pl-c1">figure</span>(figsize<span class="pl-k">=</span>(<span class="pl-c1">3</span>,<span class="pl-c1">4</span>))
<span class="pl-c1">plot_band_diagram</span>(solver, [K,G,M], polarisation,
        bands<span class="pl-k">=</span><span class="pl-c1">1</span><span class="pl-k">:</span><span class="pl-c1">6</span>, frequency_scale<span class="pl-k">=</span><span class="pl-c1">1</span><span class="pl-k">/</span><span class="pl-c1">2</span>pi, dk<span class="pl-k">=</span><span class="pl-c1">0.1</span>)</pre></div>
<blockquote>
<p><a target="_blank" rel="noopener noreferrer" href="figures/example_zoo_bands.png"><img src="figures/example_zoo_bands.png" alt="Plot of some bands from the Zoo" style="max-width:100%;"></a></p>
</blockquote>
<h3><a id="user-content-topology-of-photonic-bands" class="anchor" aria-hidden="true" href="#topology-of-photonic-bands"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>Topology of photonic bands</h3>
<p>Recently there has been a spike of interest in photonic crystals as a platform for topological photonics (Blanco de Paz 2020). We provide methods to identify the topological phase of a photonic crystal using Wilson loops. A winding in the Wilson loop spectrum can indicate a non-trivial topological phase, with the Chern number given by the winding. In this example we reproduce results that demonstrate the photonic crystal with 'fragile' band topology that was introduced by Blanco de Paz et al (Blanco de Paz 2019).</p>
<div class="highlight highlight-source-julia"><pre><span class="pl-k">using</span> Peacock<span class="pl-k">.</span>Zoo

<span class="pl-c"><span class="pl-c">#</span> Load the fragile photonic topological insulator from Blanco de Paz et al 2018</span>
<span class="pl-c1">@unpack</span> solver, polarisation <span class="pl-k">=</span> <span class="pl-c1">make_dePaz_frag</span>(fourier_space_cutoff)

<span class="pl-c"><span class="pl-c">#</span> The Wilson loops are (by default) along b2, so we define a straight</span>
<span class="pl-c"><span class="pl-c">#</span> path from Γ to Γ+b1 - we will scan along this path</span>
ks <span class="pl-k">=</span> [
    <span class="pl-c1">BrillouinZoneCoordinate</span>(<span class="pl-c1">0.0</span>, <span class="pl-c1">0.0</span>, <span class="pl-s"><span class="pl-pds">"</span>Γ<span class="pl-pds">"</span></span>),
    <span class="pl-c1">BrillouinZoneCoordinate</span>(<span class="pl-c1">0.5</span>, <span class="pl-c1">0.0</span>, <span class="pl-s"><span class="pl-pds">"</span>M<span class="pl-pds">"</span></span>),
    <span class="pl-c1">BrillouinZoneCoordinate</span>(<span class="pl-c1">1.0</span>, <span class="pl-c1">0.0</span>, <span class="pl-s"><span class="pl-pds">"</span>Γ<span class="pl-pds">"</span></span>)
]

<span class="pl-c"><span class="pl-c">#</span> Wilson loop of all three valence bands</span>
<span class="pl-c1">figure</span>(figsize<span class="pl-k">=</span>(<span class="pl-c1">3</span>,<span class="pl-c1">2</span>))
<span class="pl-c1">plot_wilson_loop_winding</span>(solver, ks, polarisation, <span class="pl-c1">1</span><span class="pl-k">:</span><span class="pl-c1">3</span>, dk<span class="pl-k">=</span><span class="pl-c1">0.25</span>)
<span class="pl-c1">title</span>(<span class="pl-s"><span class="pl-pds">"</span>Bands 1-3<span class="pl-pds">"</span></span>)

<span class="pl-c"><span class="pl-c">#</span> Wilson loop of just the second and third bands</span>
<span class="pl-c1">figure</span>(figsize<span class="pl-k">=</span>(<span class="pl-c1">3</span>,<span class="pl-c1">2</span>))
<span class="pl-c1">plot_wilson_loop_winding</span>(solver, ks, polarisation, <span class="pl-c1">2</span><span class="pl-k">:</span><span class="pl-c1">3</span>, dk<span class="pl-k">=</span><span class="pl-c1">0.25</span>)
<span class="pl-c1">title</span>(<span class="pl-s"><span class="pl-pds">"</span>Bands 2&amp;3<span class="pl-pds">"</span></span>)</pre></div>
<blockquote>
<p><a target="_blank" rel="noopener noreferrer" href="figures/example_wilson_loops.png"><img src="figures/example_wilson_loops.png" alt="Plot some Wilson loop examples" style="max-width:100%;"></a></p>
</blockquote>
<p>In the first figure, the Wilson loops through the Hilbert spaces of bands 2&amp;3 are seen to wind with Chern numbers ±1. The second figure shows that including the (trivial) acoustic band in the Wilson loop calculation removes the topological winding, and consequently bands 2&amp;3 are said to be 'fragilely topological'.</p>
<h2><a id="user-content-further-reading" class="anchor" aria-hidden="true" href="#further-reading"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>Further reading</h2>
<p>Plane Wave Expansion Method</p>
<ul>
<li>Rumpf, Raymond. "Design and optimization of nano-optical elements by coupling fabrication to optical behavior." (2006)</li>
<li><a href="http://emlab.utep.edu/academics.htm" rel="nofollow">http://emlab.utep.edu/academics.htm</a></li>
</ul>
<p>Photonic crystals</p>
<ul>
<li>Joannopoulos, John D., et al. "Photonic crystals: molding the flow of light. 2008." <em>Princeton Univ Pr</em> (freely available online at <a href="http://ab-initio.mit.edu/book/" rel="nofollow">http://ab-initio.mit.edu/book/</a>)</li>
</ul>
<p>Topological photonics</p>
<ul>
<li>Wu, Long-Hua, and Xiao Hu. "Scheme for achieving a topological photonic crystal by using dielectric material." Physical review letters 114.22 (2015): 223901.</li>
<li>Blanco de Paz, María, et al. "Engineering fragile topology in photonic crystals: Topological quantum chemistry of light." <em>Physical Review Research</em> 1.3 (2019): 032005.</li>
<li>Blanco de Paz, María, et al. "Tutorial: computing topological invariants in 2D photonic crystals." <em>Advanced Quantum Technologies</em> 3.2 (2020): 1900117.</li>
</ul>
</article></div>