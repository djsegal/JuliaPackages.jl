<div id="readme" class="md" data-path="README.md"><article class="markdown-body entry-content container-lg" itemprop="text"><h1><a id="user-content-scoba" class="anchor" aria-hidden="true" href="#scoba"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>SCoBA</h1>
<p>Accompanying code repository for the paper:</p>
<blockquote>
<p>S. Choudhury, J. K. Gupta, M. J. Kochenderfer, D. Sadigh, and J. Bohg. "Dynamic Multi-Robot Task Allocation under Uncertainty and Temporal Constraints" <em>Robotics: Science and Systems 2020</em></p>
</blockquote>
<p>In this paper, we present a hierarchical multi-robot allocation algorithm that plans under task completion uncertainty and time window constraints. We call our algorithm SCoBA (Stochastic Conflict-Based Allocation). The lower layer generates single-robot allocation policies with dynamic programming and tree search, while the upper layer uses optimal conflict resolution logic to obtain a valid multi-agent allocation. Please see the <a href="https://arxiv.org/abs/2005.13109" rel="nofollow">extended version</a> on Arxiv for the details or the <a href="https://youtu.be/nGEDn3x41ZI" rel="nofollow">YouTube Video</a> for an overview.</p>
<h2><a id="user-content-illustrations" class="anchor" aria-hidden="true" href="#illustrations"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>Illustrations</h2>
<p>The GIF below visualizes SCoBA on one of the scenarios from the Multi-Drone Delivery domain, in North San Francisco. The scenario has 5 depots and 30 drones, and the drones allocated to a stream of incoming delivery requests with probability 0.5; details in Section V (Evaluation) of the paper. <em>Delivery locations (gray squares) are randomly generated within a bounding
box, and some of them may be slightly offshore</em>.</p>
<p><a target="_blank" rel="noopener noreferrer" href="img/routing_5dep30dr_oneprob.gif"><img src="img/routing_5dep30dr_oneprob.gif" alt="SF Example" style="max-width:100%;"></a></p>
<h2><a id="user-content-setup-and-usage" class="anchor" aria-hidden="true" href="#setup-and-usage"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>Setup and Usage</h2>
<p>Ensure that you have installed Julia from <a href="https://julialang.org/downloads/" rel="nofollow">their website</a>.</p>
<p>To the reproduce the experiments in the <code>scripts/</code> folder, first clone this
repository:</p>
<div class="highlight highlight-source-shell position-relative" data-snippet-clipboard-copy-content="git clone https://github.com/sisl/SCoBA.jl SCoBA
cd SCoBA
"><pre>git clone https://github.com/sisl/SCoBA.jl SCoBA
<span class="pl-c1">cd</span> SCoBA</pre></div>
<p>First instantiate the subproject in <code>scripts/</code> folder:</p>
<div class="highlight highlight-source-shell position-relative" data-snippet-clipboard-copy-content="julia --project=scripts -e 'using Pkg; Pkg.instantiate()'
"><pre>julia --project=scripts -e <span class="pl-s"><span class="pl-pds">'</span>using Pkg; Pkg.instantiate()<span class="pl-pds">'</span></span></pre></div>
<p>Now you can run any scripts in <code>scripts/</code> folder. For example:</p>
<div class="highlight highlight-source-shell position-relative" data-snippet-clipboard-copy-content="julia --project=scripts scripts/benchmark_routing.jl -n 10 -t 100 -d 15 -e 5 -p 0.5 -w 30 scoba
r_dr15_dep5_probpt5_win30_scoba.json
"><pre>julia --project=scripts scripts/benchmark_routing.jl -n 10 -t 100 -d 15 -e 5 -p 0.5 -w 30 scoba
r_dr15_dep5_probpt5_win30_scoba.json</pre></div>
<p>If you just wish to use the algorithm or domains, from the Julia Pkg mode REPL:</p>
<div class="highlight highlight-source-julia position-relative" data-snippet-clipboard-copy-content="pkg&gt; add https://github.com/JuliaLang/TOML.jl 
pkg&gt; add https://github.com/sisl/SCoBA.jl
"><pre>pkg<span class="pl-k">&gt;</span> add https<span class="pl-k">:</span><span class="pl-k">//</span>github<span class="pl-k">.</span>com<span class="pl-k">/</span>JuliaLang<span class="pl-k">/</span>TOML<span class="pl-k">.</span>jl 
pkg<span class="pl-k">&gt;</span> add https<span class="pl-k">:</span><span class="pl-k">//</span>github<span class="pl-k">.</span>com<span class="pl-k">/</span>sisl<span class="pl-k">/</span>SCoBA<span class="pl-k">.</span>jl</pre></div>
<p>There are 4 scripts in the <code>scripts/</code> folder, for the two kinds of evaluations on each of the two domains in the paper. The <code>scripts/benchmark_*</code> scripts are for the unsuccessful task penalty (for all baselines) and the <code>scripts/scaling_*</code> scripts are for the computation time results for the subset of baselines we show in the paper. <strong>Each script has an example comment at the end for how it should be called.</strong> The scripts should approximately reproduce the corresponding results in the paper, with possible variations in computation time due to versions and hardware. Please open an issue if you have any issues re-running anything.</p>
<p><strong>N.B</strong> Running <code>benchmark_conveyor_belt</code> with QLearning (for the saved policy) requires the precomputed policy files. We did not upload them to Github; please open an issue if you need them.</p>
<h2><a id="user-content-code-overview" class="anchor" aria-hidden="true" href="#code-overview"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>Code Overview</h2>
<p>The two sub-folders in <code>src/</code>, i.e., <code>solver/</code> and <code>domains/</code> contain the domain-agnostic SCoBA algorithm and the domain-dependent implementations respectively. If you want to implement SCoBA on your own domain, you can just import the solver through <code>using SCoBA.SCoBASolver</code> and refer to the <code>domains/</code> sub-folders for examples of how to use it.</p>
<p>Within <code>src/solver/</code>, the following are the summaries of the relevant files:</p>
<ul>
<li><code>solver/types.jl</code> Defines the various domain-agnostic datastructures required by SCoBA (to represent the policy tree, time windows, and so on). The key thing to look at if you want to use SCoBA on another domain is the templated <code>GenericAllocation</code> structure, which it uses to track the assignment of agents to tasks.</li>
<li><code>solver/scoba_tree_search.jl</code> Implements the lower layer of SCoBA, i.e., the per-agent policy tree search. If you want to use just the tree search in a custom manner (as in the conveyor belt domain; check <code>domains/conveyor_belt_scoba.jl</code>), then look at the <code>generate_search_tree!</code> and <code>get_next_attempt_idx</code> methods.</li>
<li><code>solver/scoba_conflict_resolution.jl</code> Implements the higher layer of SCoBA, i.e. the multi-agent conflict resolution. The structure of the <code>coordinate_allocation.jl</code> is very similar to <a href="https://github.com/Shushman/MultiAgentPathFinding.jl/blob/master/src/cbs.jl">the implementation</a> of the Conflict-Based Search Algorithm in <code>MultiAgentPathFinding</code>.</li>
</ul>
</article></div>