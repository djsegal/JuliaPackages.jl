<div id="readme" class="md" data-path="README.md"><article class="markdown-body entry-content container-lg" itemprop="text"><h1 dir="auto"><a id="user-content-ferritegmshjl" class="anchor" aria-hidden="true" href="#ferritegmshjl"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a>FerriteGmsh.jl</h1>

<p dir="auto">FerriteGmsh tries to simplify the conversion from a gmsh mesh to a Ferrite mesh.</p>
<h2 dir="auto"><a id="user-content-installation" class="anchor" aria-hidden="true" href="#installation"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a>Installation</h2>
<div class="snippet-clipboard-content notranslate position-relative overflow-auto" data-snippet-clipboard-copy-content="]add FerriteGmsh"><pre class="notranslate"><code>]add FerriteGmsh
</code></pre></div>
<h2 dir="auto"><a id="user-content-example" class="anchor" aria-hidden="true" href="#example"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a>Example</h2>
<p dir="auto"><a target="_blank" rel="noopener noreferrer nofollow" href="https://camo.githubusercontent.com/9059a4fa4754eabd8552c31e16a0d75752e5c0859a4acdc9d3b0ef841bc2ebc1/68747470733a2f2f692e696d6775722e636f6d2f717a514b7834782e706e67"><img src="https://camo.githubusercontent.com/9059a4fa4754eabd8552c31e16a0d75752e5c0859a4acdc9d3b0ef841bc2ebc1/68747470733a2f2f692e696d6775722e636f6d2f717a514b7834782e706e67" alt="Imgur" data-canonical-src="https://i.imgur.com/qzQKx4x.png" style="max-width: 100%;"></a></p>
<p dir="auto">The above example is taken from the <code>test_mixed_grid.jl</code> file which can be found in the <code>test</code> folder.</p>
<p dir="auto">This package offers two workflows. The user can either load an already defined geometry by a <code>.msh,.geo</code> file or use it in an interactive way.
The first approach can be achieved by</p>
<div class="highlight highlight-source-julia notranslate position-relative overflow-auto" dir="auto" data-snippet-clipboard-copy-content="using FerriteGmsh

togrid(&quot;meshfile.msh&quot;)
togrid(&quot;meshfile.geo&quot;) #gets meshed automatically"><pre><span class="pl-k">using</span> FerriteGmsh

<span class="pl-c1">togrid</span>(<span class="pl-s"><span class="pl-pds">"</span>meshfile.msh<span class="pl-pds">"</span></span>)
<span class="pl-c1">togrid</span>(<span class="pl-s"><span class="pl-pds">"</span>meshfile.geo<span class="pl-pds">"</span></span>) <span class="pl-c"><span class="pl-c">#</span>gets meshed automatically</span></pre></div>
<p dir="auto">while the latter is done by</p>
<div class="highlight highlight-source-julia notranslate position-relative overflow-auto" dir="auto" data-snippet-clipboard-copy-content="using FerriteGmsh

gmsh.initialize()
dim = Int64(gmsh.model.getDimension())
facedim = dim - 1

# do stuff to describe your gmsh model

# renumber the gmsh entities, such that the final used entities start by index 1
# this step is crucial, because Ferrite.jl uses the implicit entity index based on an array index
# and thus, need to start at 1
gmsh.model.mesh.renumberNodes()
gmsh.model.mesh.renumberElements()

# transfer the gmsh information
nodes = tonodes()
elements, gmsh_elementidx = toelements(dim)
cellsets = tocellsets(dim, gmsh_elementidx)

# &quot;Domain&quot; is the name of a PhysicalGroup and saves all cells that define the computational domain
domaincellset = cellsets[&quot;Domain&quot;]
elements = elements[collect(domaincellset)]

boundarydict = toboundary(facedim)
facesets = tofacesets(boundarydict, elements)
gmsh.finalize()

Grid(elements, nodes, facesets=facesets, cellsets=cellsets)"><pre><span class="pl-k">using</span> FerriteGmsh

gmsh<span class="pl-k">.</span><span class="pl-c1">initialize</span>()
dim <span class="pl-k">=</span> <span class="pl-c1">Int64</span>(gmsh<span class="pl-k">.</span>model<span class="pl-k">.</span><span class="pl-c1">getDimension</span>())
facedim <span class="pl-k">=</span> dim <span class="pl-k">-</span> <span class="pl-c1">1</span>

<span class="pl-c"><span class="pl-c">#</span> do stuff to describe your gmsh model</span>

<span class="pl-c"><span class="pl-c">#</span> renumber the gmsh entities, such that the final used entities start by index 1</span>
<span class="pl-c"><span class="pl-c">#</span> this step is crucial, because Ferrite.jl uses the implicit entity index based on an array index</span>
<span class="pl-c"><span class="pl-c">#</span> and thus, need to start at 1</span>
gmsh<span class="pl-k">.</span>model<span class="pl-k">.</span>mesh<span class="pl-k">.</span><span class="pl-c1">renumberNodes</span>()
gmsh<span class="pl-k">.</span>model<span class="pl-k">.</span>mesh<span class="pl-k">.</span><span class="pl-c1">renumberElements</span>()

<span class="pl-c"><span class="pl-c">#</span> transfer the gmsh information</span>
nodes <span class="pl-k">=</span> <span class="pl-c1">tonodes</span>()
elements, gmsh_elementidx <span class="pl-k">=</span> <span class="pl-c1">toelements</span>(dim)
cellsets <span class="pl-k">=</span> <span class="pl-c1">tocellsets</span>(dim, gmsh_elementidx)

<span class="pl-c"><span class="pl-c">#</span> "Domain" is the name of a PhysicalGroup and saves all cells that define the computational domain</span>
domaincellset <span class="pl-k">=</span> cellsets[<span class="pl-s"><span class="pl-pds">"</span>Domain<span class="pl-pds">"</span></span>]
elements <span class="pl-k">=</span> elements[<span class="pl-c1">collect</span>(domaincellset)]

boundarydict <span class="pl-k">=</span> <span class="pl-c1">toboundary</span>(facedim)
facesets <span class="pl-k">=</span> <span class="pl-c1">tofacesets</span>(boundarydict, elements)
gmsh<span class="pl-k">.</span><span class="pl-c1">finalize</span>()

<span class="pl-c1">Grid</span>(elements, nodes, facesets<span class="pl-k">=</span>facesets, cellsets<span class="pl-k">=</span>cellsets)</pre></div>
<h2 dir="auto"><a id="user-content-elements-numbering--supported-elements" class="anchor" aria-hidden="true" href="#elements-numbering--supported-elements"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a>Elements numbering &amp; Supported elements</h2>
<p dir="auto">Ferrite might have a different element node-numbering scheme if compared to Gmsh. For correct portability of a mesh from Gmsh, it is important to transform Gmsh numbering in the one that Ferrite is expecting. Having the same numbering is important because the numbering provides information about which basis function is placed at each position, as well as the orientation of the elements.</p>
<p dir="auto">By default <code>FerriteGmsh</code> supports all Ferrite elements in which the numbering is the same to the one used in Gmsh.</p>
<p dir="auto">To check the numbering used in Ferrite, we could for example generate a grid with a single element, for a QuadraticQuadrilateral that would be:</p>
<div class="highlight highlight-source-julia notranslate position-relative overflow-auto" dir="auto" data-snippet-clipboard-copy-content="using Ferrite
grid = generate_grid(QuadraticQuadrilateral,(1,1))"><pre><span class="pl-k">using</span> Ferrite
grid <span class="pl-k">=</span> <span class="pl-c1">generate_grid</span>(QuadraticQuadrilateral,(<span class="pl-c1">1</span>,<span class="pl-c1">1</span>))</pre></div>
<p dir="auto">Accessing the cells of that element:</p>
<div class="highlight highlight-source-julia notranslate position-relative overflow-auto" dir="auto" data-snippet-clipboard-copy-content="julia&gt; grid.cells
1-element Vector{QuadraticQuadrilateral}: 
QuadraticQuadrilateral((1, 3, 9, 7, 2, 6, 8, 4, 5))"><pre>julia<span class="pl-k">&gt;</span> grid<span class="pl-k">.</span>cells
<span class="pl-c1">1</span><span class="pl-k">-</span>element Vector{QuadraticQuadrilateral}<span class="pl-k">:</span> 
<span class="pl-c1">QuadraticQuadrilateral</span>((<span class="pl-c1">1</span>, <span class="pl-c1">3</span>, <span class="pl-c1">9</span>, <span class="pl-c1">7</span>, <span class="pl-c1">2</span>, <span class="pl-c1">6</span>, <span class="pl-c1">8</span>, <span class="pl-c1">4</span>, <span class="pl-c1">5</span>))</pre></div>
<p dir="auto">where the numbers refers to the global nodes ids, which can be easily visualized in the following manner using the package <a href="https://github.com/koehlerson/FerriteVis.jl">FerriteVis</a>.</p>
<div class="highlight highlight-source-julia notranslate position-relative overflow-auto" dir="auto" data-snippet-clipboard-copy-content="using Ferrite
using FerriteVis

grid =  generate_grid(QuadraticQuadrilateral,(1,1))

FerriteVis.wireframe(grid,markersize=14,strokewidth=20,textsize = 25, nodelabels=true,celllabels=true)"><pre><span class="pl-k">using</span> Ferrite
<span class="pl-k">using</span> FerriteVis

grid <span class="pl-k">=</span>  <span class="pl-c1">generate_grid</span>(QuadraticQuadrilateral,(<span class="pl-c1">1</span>,<span class="pl-c1">1</span>))

FerriteVis<span class="pl-k">.</span><span class="pl-c1">wireframe</span>(grid,markersize<span class="pl-k">=</span><span class="pl-c1">14</span>,strokewidth<span class="pl-k">=</span><span class="pl-c1">20</span>,textsize <span class="pl-k">=</span> <span class="pl-c1">25</span>, nodelabels<span class="pl-k">=</span><span class="pl-c1">true</span>,celllabels<span class="pl-k">=</span><span class="pl-c1">true</span>)</pre></div>
<p dir="auto"><a target="_blank" rel="noopener noreferrer nofollow" href="https://camo.githubusercontent.com/23c6439c09152aeb725776e8d4d6d6cfee4338a6276782429ad5c5588a553bd5/68747470733a2f2f692e696d6775722e636f6d2f35384f4346676f2e706e67"><img src="https://camo.githubusercontent.com/23c6439c09152aeb725776e8d4d6d6cfee4338a6276782429ad5c5588a553bd5/68747470733a2f2f692e696d6775722e636f6d2f35384f4346676f2e706e67" alt="Imgur" data-canonical-src="https://i.imgur.com/58OCFgo.png" style="max-width: 100%;"></a></p>
<p dir="auto">The Ferrite numbering <code>(1, 3, 9, 7, 2, 6, 8, 4, 5)</code> would have to match the numbering of Gmsh (see <a href="https://gmsh.info/doc/texinfo/gmsh.html#Node-ordering" rel="nofollow">gmsh docs</a>).</p>
<p dir="auto">In the particular case of the QuadraticQuadrilateral, the numbering used in <code>Ferrite</code> and the numbering used in Gmsh matches, then as it was anticipated this type of element would be supported through the default method for <a href="https://github.com/koehlerson/FerriteGmsh.jl/blob/6682d9d4d95189f4799da19690b8ff0f18a9e177/src/FerriteGmsh.jl#L17-L19">translate_elements</a>.</p>
<p dir="auto">If the numbering does not match like for example in the <code>QuadraticTetrahedron</code> an specific method for the function <a href="https://github.com/koehlerson/FerriteGmsh.jl/blob/6682d9d4d95189f4799da19690b8ff0f18a9e177/src/FerriteGmsh.jl#L21-L36">translate_elements</a> has to be created. In this method, the correct numbering is specified.</p>
<h3 dir="auto"><a id="user-content-elements-supported-summary" class="anchor" aria-hidden="true" href="#elements-supported-summary"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a>Elements supported (summary):</h3>
<p dir="auto">With the elements supported by default and specific <code>translate_elements</code> methods (for QuadraticTetrahedron and 3D Serendipity), all the linear and quadratic elements available in <code>Ferrite</code> are already supported by <code>FerriteGmsh</code>.</p>
</article></div>