<div id="readme" class="md" data-path="README.md"><article class="markdown-body entry-content container-lg" itemprop="text"><h1><a id="user-content-cancerseqsim" class="anchor" aria-hidden="true" href="#cancerseqsim"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>CancerSeqSim</h1>
<p><a href="https://travis-ci.org/marcjwilliams1/CancerSeqSim.jl" rel="nofollow"><img src="https://camo.githubusercontent.com/8c58912d472e4acfff511e3713c5dd68ffb544c701f3d96128c92d606cc8710d/68747470733a2f2f7472617669732d63692e6f72672f6d6172636a77696c6c69616d73312f43616e63657253657153696d2e6a6c2e7376673f6272616e63683d6d6173746572" alt="Build Status" data-canonical-src="https://travis-ci.org/marcjwilliams1/CancerSeqSim.jl.svg?branch=master" style="max-width:100%;"></a>
<a href="https://ci.appveyor.com/project/marcjwilliams1/cancerseqsim-jl/branch/master" rel="nofollow"><img src="https://camo.githubusercontent.com/919d1e04e71f70155871b3fb1f8935c79edfa147f0c1162b890ce72078e981ee/68747470733a2f2f63692e6170707665796f722e636f6d2f6170692f70726f6a656374732f7374617475732f6769746875622f6d6172636a77696c6c69616d73312f43616e63657253657153696d2e6a6c3f6272616e63683d6d6173746572267376673d74727565" alt="Build Status" data-canonical-src="https://ci.appveyor.com/api/projects/status/github/marcjwilliams1/CancerSeqSim.jl?branch=master&amp;svg=true" style="max-width:100%;"></a>
<a href="https://coveralls.io/github/marcjwilliams1/CancerSeqSim.jl?branch=master" rel="nofollow"><img src="https://camo.githubusercontent.com/2393fb71d7546a8adacee1fe46f9af57f2695ea74ea1b05e53f8c08a4075f207/68747470733a2f2f636f766572616c6c732e696f2f7265706f732f6769746875622f6d6172636a77696c6c69616d73312f43616e63657253657153696d2e6a6c2f62616467652e7376673f6272616e63683d6d6173746572" alt="Coverage Status" data-canonical-src="https://coveralls.io/repos/github/marcjwilliams1/CancerSeqSim.jl/badge.svg?branch=master" style="max-width:100%;"></a>
<a href="http://codecov.io/github/marcjwilliams1/CancerSeqSim.jl?branch=master" rel="nofollow"><img src="https://camo.githubusercontent.com/06844aa687d1b684480fa652957a95dd7058ea97b7070b128802d68871960014/687474703a2f2f636f6465636f762e696f2f6769746875622f6d6172636a77696c6c69616d73312f43616e63657253657153696d2e6a6c2f636f7665726167652e7376673f6272616e63683d6d6173746572" alt="codecov.io" data-canonical-src="http://codecov.io/github/marcjwilliams1/CancerSeqSim.jl/coverage.svg?branch=master" style="max-width:100%;"></a></p>
<p>Simulate tumour VAFs with different clonal structures. Package is written in the <a href="https://julialang.org/" rel="nofollow">Julia</a> programming language.</p>
<p>Package hosts code related to the simulation framework used in the following publications:</p>
<ol>
<li><a href="https://www.nature.com/articles/s41588-018-0128-6" rel="nofollow">Quantification of subclonal selection in cancer from bulk sequencing data</a></li>
<li><a href="https://www.nature.com/articles/ng.3489" rel="nofollow">Identification of neutral tumor evolution across cancer types</a></li>
</ol>
<h2><a id="user-content-getting-started" class="anchor" aria-hidden="true" href="#getting-started"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>Getting Started</h2>
<p>To download the package, once you're in a Julia session type the following command:</p>
<div class="highlight highlight-source-julia position-relative" data-snippet-clipboard-copy-content="using Pkg
Pkg.add(&quot;CancerSeqSim&quot;)
"><pre><span class="pl-k">using</span> Pkg
Pkg<span class="pl-k">.</span><span class="pl-c1">add</span>(<span class="pl-s"><span class="pl-pds">"</span>CancerSeqSim<span class="pl-pds">"</span></span>)</pre></div>
<h2><a id="user-content-example" class="anchor" aria-hidden="true" href="#example"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>Example</h2>
<p>To simulate a tumour and generate synthetic sequencing data simply invoke the <code>simulate</code> command. There are many arguments that can be changed, for example it is possible to change the mutation rate or the number of subclones introduced into the population. To see all the optional arguments you can type <code>?simulate</code> in a julia session. The command below will simulate a tumour with a single subclone with frequency between 0.4 and 0.6, mutation rate = 10 and 200 clonalmutations.</p>
<div class="highlight highlight-source-julia position-relative" data-snippet-clipboard-copy-content="simdata = simulate(0.4, 0.6, μ = 10.0, clonalmutations = 200)
"><pre>simdata <span class="pl-k">=</span> <span class="pl-c1">simulate</span>(<span class="pl-c1">0.4</span>, <span class="pl-c1">0.6</span>, μ <span class="pl-k">=</span> <span class="pl-c1">10.0</span>, clonalmutations <span class="pl-k">=</span> <span class="pl-c1">200</span>)</pre></div>
<p>A summary of the simulation will automatically be printed out.</p>
<p>A VAF histogram can be generated which uses the <a href="https://github.com/JuliaPlots/Plots.jl">Plots.jl</a> package, so you'll need to install and load the package first:</p>
<div class="highlight highlight-source-julia position-relative" data-snippet-clipboard-copy-content="Pkg.add(&quot;Plots.jl&quot;)
using Plots
"><pre>Pkg<span class="pl-k">.</span><span class="pl-c1">add</span>(<span class="pl-s"><span class="pl-pds">"</span>Plots.jl<span class="pl-pds">"</span></span>)
<span class="pl-k">using</span> Plots</pre></div>
<p>Then using the <code>plot</code> function on a simulation object will generate the histogram, the red line shows the frequency of the subclone.</p>
<div class="highlight highlight-source-julia position-relative" data-snippet-clipboard-copy-content="plot(simdata)
"><pre><span class="pl-c1">plot</span>(simdata)</pre></div>
<p><a target="_blank" rel="noopener noreferrer" href="/example/exampleoneclone.png"><img src="/example/exampleoneclone.png" alt="plot" style="max-width:100%;"></a></p>
</article></div>