<div id="readme" class="md" data-path="README.md"><article class="markdown-body entry-content container-lg" itemprop="text"><h1 dir="auto"><a id="user-content-permanova" class="anchor" aria-hidden="true" href="#permanova"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a>PERMANOVA</h1>
<p dir="auto"><a href="https://github.com/EvoArt/Hydra.jl/actions"><img src="https://github.com/EvoArt/Hydra.jl/workflows/CI/badge.svg" alt="Build Status" style="max-width: 100%;"></a>
<a href="https://ci.appveyor.com/project/EvoArt/Hydra-jl" rel="nofollow"><img src="https://camo.githubusercontent.com/d771a5f0f9a80df48377aab5534877f0dcb995ea6f93dd8dcb28b7e8c7bac699/68747470733a2f2f63692e6170707665796f722e636f6d2f6170692f70726f6a656374732f7374617475732f6769746875622f45766f4172742f48796472612e6a6c3f7376673d74727565" alt="Build Status" data-canonical-src="https://ci.appveyor.com/api/projects/status/github/EvoArt/Hydra.jl?svg=true" style="max-width: 100%;"></a>
<a href="https://codecov.io/gh/EvoArt/Hydra.jl" rel="nofollow"><img src="https://camo.githubusercontent.com/548ee74591ce462e33c8762e11dd1d98eae4aee3ec053cae33f00b4b62b5161b/68747470733a2f2f636f6465636f762e696f2f67682f45766f4172742f48796472612e6a6c2f6272616e63682f6d61737465722f67726170682f62616467652e737667" alt="Coverage" data-canonical-src="https://codecov.io/gh/EvoArt/Hydra.jl/branch/master/graph/badge.svg" style="max-width: 100%;"></a></p>
<p dir="auto">PERMANOVA implementation based on the work of <a href="https://esajournals.onlinelibrary.wiley.com/doi/10.1890/0012-9658%282001%29082%5B0290%3AFMMTCD%5D2.0.CO%3B2" rel="nofollow">McArdle and Anderson</a>. This package aims to provide similar functionality to the <code>adonis2</code> in the R package <a href="https://cran.r-project.org/web/packages/vegan/index.html" rel="nofollow"><code>vegan</code></a>. Thus, implementation details are more similar to <code>adonis2</code> than to the original work by McArdle and Anderson. P-values are calculated via permuting of data (not residuals) and calculating sequential sums of squares. In keeping with names from mythology, we provide an alias to the <code>permanova</code> function :<code>hydra</code> the many headed Lernaean Hydra represents the multivariate response data we aim to tackle here. Though perhaps Heracles or Iolis (the eventual slayers of the Hydra) would be more apt.</p>
<p dir="auto"><a target="_blank" rel="noopener noreferrer" href="https://github.com/EvoArt/Hydra/blob/master/docs/Sargent_Hercules.jpg"><img src="https://github.com/EvoArt/Hydra/raw/master/docs/Sargent_Hercules.jpg" alt="drawing" width="400" style="max-width: 100%;"></a></p>
<p dir="auto">The function <code>permanova</code>/<code>hydra2</code> expects:</p>
<ul dir="auto">
<li>data: a table/dataframe with a column containing the independent variables.</li>
<li>y: the dependent variables, where each row is an observation</li>
<li>metric: distance metric to be used.</li>
<li>formula: a <a href="https://juliastats.org/StatsModels.jl/stable/formula/" rel="nofollow">StatsModels.jl</a> formula</li>
</ul>
<p dir="auto">Alternatively, instead of y and metric, pass in a distance matrix D.
The function retruns a <code>PSummary</code> struct containing <code>table</code> - a <a href="https://jacobadenbaum.github.io/TexTables.jl/stable/" rel="nofollow">TexTables.jl</a> formatted ANOVA table for display purposes and <code>results</code> - a NamedArray for easier access to specific results.</p>
<h2 dir="auto"><a id="user-content-example" class="anchor" aria-hidden="true" href="#example"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a>Example</h2>
<div class="highlight highlight-source-julia notranslate position-relative overflow-auto" dir="auto" data-snippet-clipboard-copy-content="using PERMANOVA, DataFrames,Distances
x = rand(1:4,100)
y = rand(100,5)

preds = [[rand([&quot;a&quot;,&quot;b&quot;,&quot;c&quot;,&quot;d&quot;]) for i in 1:100] for j in 1:3]
df = DataFrame(preds,[:X,:Y,:Z])
permanova(df,y,BrayCurtis,@formula(1~X+Y))"><pre><span class="pl-k">using</span> PERMANOVA, DataFrames,Distances
x <span class="pl-k">=</span> <span class="pl-c1">rand</span>(<span class="pl-c1">1</span><span class="pl-k">:</span><span class="pl-c1">4</span>,<span class="pl-c1">100</span>)
y <span class="pl-k">=</span> <span class="pl-c1">rand</span>(<span class="pl-c1">100</span>,<span class="pl-c1">5</span>)

preds <span class="pl-k">=</span> [[<span class="pl-c1">rand</span>([<span class="pl-s"><span class="pl-pds">"</span>a<span class="pl-pds">"</span></span>,<span class="pl-s"><span class="pl-pds">"</span>b<span class="pl-pds">"</span></span>,<span class="pl-s"><span class="pl-pds">"</span>c<span class="pl-pds">"</span></span>,<span class="pl-s"><span class="pl-pds">"</span>d<span class="pl-pds">"</span></span>]) <span class="pl-k">for</span> i <span class="pl-k">in</span> <span class="pl-c1">1</span><span class="pl-k">:</span><span class="pl-c1">100</span>] <span class="pl-k">for</span> j <span class="pl-k">in</span> <span class="pl-c1">1</span><span class="pl-k">:</span><span class="pl-c1">3</span>]
df <span class="pl-k">=</span> <span class="pl-c1">DataFrame</span>(preds,[<span class="pl-c1">:X</span>,<span class="pl-c1">:Y</span>,<span class="pl-c1">:Z</span>])
<span class="pl-c1">permanova</span>(df,y,BrayCurtis,<span class="pl-c1">@formula</span>(<span class="pl-c1">1</span><span class="pl-k">~</span>X<span class="pl-k">+</span>Y))</pre></div>
<h2 dir="auto"><a id="user-content-todo" class="anchor" aria-hidden="true" href="#todo"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a>TODO</h2>
<ul dir="auto">
<li>Pairwise PerMANOVA</li>
</ul>
<h2 dir="auto"><a id="user-content-experimental" class="anchor" aria-hidden="true" href="#experimental"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a>Experimental</h2>
<ul dir="auto">
<li><code>blocks</code> (strata) e.g. <code>permanova(df,y,BrayCurtis,@formula(1~X+Y), blocks = @formula(block ~ Z))</code></li>
</ul>
</article></div>