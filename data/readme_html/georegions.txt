<div id="readme" class="md" data-path="README.md"><article class="markdown-body entry-content" itemprop="text"><h1><a id="user-content-georegionsjl" class="anchor" aria-hidden="true" href="#georegionsjl"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a><strong><div align="center">GeoRegions.jl</div></strong></h1>
<p><strong>Created By:</strong> Nathanael Wong (<a href="mailto:nathanaelwong@fas.harvard.edu">nathanaelwong@fas.harvard.edu</a>)</p>
<h2><a id="user-content-introduction" class="anchor" aria-hidden="true" href="#introduction"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a><strong>Introduction</strong></h2>
<p><code>GeoRegions.jl</code> is a Julia package that aims to streamline the following processes:</p>
<ul>
<li>query if a point / grid is within a specified boundary</li>
<li>extract point data (given coordinates) from a given region</li>
<li>extract gridded data (given grid boundaries) from a larger (parent) region (grid must be entirely within the parent region)</li>
</ul>
<p>In general, these boundaries can be specified either using <code>[N,S,E,W]</code> coordinates, or by <code>longitude</code> and <code>latitude</code> vectors.</p>
<p><code>GeoRegions.jl</code> can be installed via</p>
<pre><code>] add GeoRegions
</code></pre>
<h2><a id="user-content-workflow" class="anchor" aria-hidden="true" href="#workflow"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a><strong>Workflow</strong></h2>
<h3><a id="user-content-is-pointgrid-in-region" class="anchor" aria-hidden="true" href="#is-pointgrid-in-region"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a><strong>Is Point/Grid in (Region)?</strong></h3>
<p><strong>Relevant Functions:</strong> <code>ispointinregion</code>, <code>isgridinregion</code></p>
<p>Let us define a <code>(Region)</code> domain specified by <code>[rN,rS,rE,rW]</code>, with <code>rlon</code> and <code>rlat</code> being the longitude and latitude vectors of the region.<br>
Given that we have a point coordinate <code>(plon,plat)</code>, and grid boundaries defined by <code>[N,S,E,W]</code>,</p>
<p>We can check if the point is within the region via:</p>
<pre><code>ispointinregion(plon,plat,rlon,rlat)
ispointinregion([plon,plat],rlon,rlat)
ispointinregion(plon,plat,[rN,rS,rE,rW])
ispointinregion([plon,plat],[rN,rS,rE,rW])
</code></pre>
<p>And we can check if the grid is within the region via:</p>
<pre><code>isgridinregion([N,S,E,W],rlon,rlat)
isgridinregion([N,S,E,W],[rN,rS,rE,rW])
</code></pre>
<h3><a id="user-content-extract-pointgrid-data-from-parent-region" class="anchor" aria-hidden="true" href="#extract-pointgrid-data-from-parent-region"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a><strong>Extract Point/Grid Data from Parent (Region)</strong></h3>
<p><strong>Relevant Functions:</strong> <code>regionextractpoint</code>, <code>regionextractgrid</code>, <code>regionextractgrid!</code></p>
<p>If we have a set of <strong>gridded</strong> data <code>rdata</code> in a <code>(Region)</code> domain with <code>rlon</code> and <code>rlat</code> being the longitude and latitude vectors defining the region, then given that we have a point coordinate <code>(plon,plat)</code>, and grid boundaries defined by <code>[N,S,E,W]</code>,</p>
<p>We can extract the data nearest the coordinate <code>(plon,plat)</code> via:</p>
<pre><code>regionextractpoint(rdata,plon,plat,rlon,rlat)
</code></pre>
<p>We can extract gridded data for a region bounded by <code>[N,S,E,W]</code> via:</p>
<pre><code>regionextractgrid(rdata,[N,S,E,W],rlon,rlat)
</code></pre>
<h2><a id="user-content-georegions" class="anchor" aria-hidden="true" href="#georegions"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a><strong>GeoRegions</strong></h2>
<p><code>GeoRegions.jl</code> also utilizes the concept of a <code>GeoRegion</code> (short for Geographical Region), which is simply a set of predefined rectilinear regions specified by <code>[N,S,E,W]</code> coordinates.  This is similar to the Python module <code>regionmasks</code> (see <a href="https://github.com/mathause/regionmask">https://github.com/mathause/regionmask</a>), which has also inspired many of the functionalities found in <code>GeoRegions.jl</code>.</p>
<p>In <code>GeoRegions.jl</code>, a set of GeoRegions have already been specified in <code>gregiontemplate.txt</code> in the <code>src</code> folder.  These include:</p>
<ul>
<li>A global region <code>GLB</code> encompassing the entire globe</li>
<li>Giorgi Regions (from <em>Giorgi and Franciso [2000]</em>), specified by <code>GF_xxx</code>, where <code>xxx</code> is a region in <em>Giorgi and Franciso [2000]</em></li>
</ul>
<p>Currently, all GeoRegions are rectilinear in the <code>(lon,lat)</code> domain.  However, future releases of <code>GeoRegions.jl</code> aim to be more flexible in their specification of region boundaries, allowing for arbitrary <code>polygons</code> as defined in <code>GeometryTypes.jl</code> and <code>PolygonOps.jl</code></p>
<h4><a id="user-content-setup--gregioncopy" class="anchor" aria-hidden="true" href="#setup--gregioncopy"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a><strong>Setup / <code>gregioncopy()</code></strong></h4>
<p>Upon running any function from <code>GeoRegions.jl</code> involving the usage of <strong>GeoRegions</strong>, unless an array containing GeoRegion information is included as input, the function <code>gregioncopy()</code> is called.  <code>gregioncopy()</code> does several things:</p>
<ul>
<li><code>gregioncopy()</code> checks for a file named <code>gregions.txt</code> in <code>jfol = $(DEPOT_PATH[1])/files/GeoRegions/</code></li>
<li>if <code>$(jfol)/gregions.txt</code> does not exist, <code>gregioncopy()</code> will
<ul>
<li>create the directory <code>jfol</code> (if it does not already exist)</li>
<li>copy the information from <code>src/gregionstemplate.txt</code> into <code>$(jfol)/gregions.txt</code></li>
</ul>
</li>
<li><strong>NB:</strong> If you want to reset <code>gregions.txt</code> to the default GeoRegions template, <code>gregioncopy(overwrite=true)</code> will overwrite <code>gregions.txt</code> if it already exists</li>
</ul>
<h4><a id="user-content-query-for-georegion-information" class="anchor" aria-hidden="true" href="#query-for-georegion-information"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a><strong>Query for GeoRegion Information</strong></h4>
<ul>
<li><code>gregioninfoall()</code> displays all the available GeoRegions in <code>gregions.txt</code> and their properties in a table format</li>
<li><code>isgeoregion(ID)</code> checks if <code>$(ID)</code> is a valid GeoRegion identifier in <code>gregions.txt</code></li>
</ul>
<h4><a id="user-content-adding-custom-georegions" class="anchor" aria-hidden="true" href="#adding-custom-georegions"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a><strong>Adding Custom GeoRegions</strong></h4>
<p>You can add your own custom GeoRegions to <code>gregions.txt</code> using the function <code>gregioninfoadd()</code>.  There are two methods to accomplish this:</p>
<ul>
<li>You can create a textfile in the same format as <code>gregions.txt</code> (e.g. <code>$(path)/addgreg.txt</code>), and point <code>gregioninfoadd()</code> to this textfile, so for example
<ul>
<li><code>gregioninfoadd("$(path)/addgreg.txt")</code></li>
</ul>
</li>
<li>Or if you want to add in individual GeoRegions manually, you can do it as follows, for example:
<ul>
<li><code>gregioninfoadd(ID="TST",parent="GLB",N=30,S=25,W=5,E=8,name="Test",throw=false,note="Test")</code></li>
<li>will add the line <code>TST,GLB,30,5,25,8,Test,Test</code> to <code>gregions.txt</code></li>
</ul>
</li>
</ul>
<h4><a id="user-content-extracting-data-for-georegion" class="anchor" aria-hidden="true" href="#extracting-data-for-georegion"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Extracting data for GeoRegion</h4>
<p>Suppose we are given gridded data <code>rdata</code> spanning longitude <code>rlon</code> and latitude <code>rlat</code>, we extract data for a GeoRegion <code>greg</code> via the following steps:</p>
<ol>
<li><code>gregiongridvec(greg,rlon,rlat)</code> returns a <code>Dict</code> (let's call it <code>rinfo</code>) containing necessary information required for extraction of data from <code>rdata</code></li>
<li><code>regionextractgrid(rdata,rinfo)</code> will return the data <code>gdata</code> for the GeoRegion <code>greg</code></li>
</ol>
<p>Therefore we can call <code>regionextractgrid()</code> multiple times in loops for the same region <code>greg</code> without needing to reextract region information, thus saving time.  This is particularly useful when dealing with data over many timesteps.</p>

</article></div>