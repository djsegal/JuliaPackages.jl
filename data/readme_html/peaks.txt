<div id="readme" class="md" data-path="README.md"><article class="markdown-body entry-content container-lg" itemprop="text"><h1 dir="auto"><a id="user-content-peaksjl" class="anchor" aria-hidden="true" href="#peaksjl"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a>Peaks.jl</h1>
<p dir="auto"><a href="https://juliahub.com/ui/Packages/Peaks/3TWUM" rel="nofollow"><img src="https://camo.githubusercontent.com/0e5c02a9839c5ae5730e15e75612394cfc6906febe4bd3963bedd63e005a2e4a/68747470733a2f2f6a756c69616875622e636f6d2f646f63732f5065616b732f76657273696f6e2e737667" alt="version" data-canonical-src="https://juliahub.com/docs/Peaks/version.svg" style="max-width: 100%;"></a>
<a href="https://juliahub.com/ui/Packages/Peaks/3TWUM" rel="nofollow"><img src="https://camo.githubusercontent.com/95fbdc14539c8de744b8b7b5956a4c9ca0951312c8427261146354d7a5979ecb/68747470733a2f2f6a756c69616875622e636f6d2f646f63732f5065616b732f706b676576616c2e737667" alt="pkgeval" data-canonical-src="https://juliahub.com/docs/Peaks/pkgeval.svg" style="max-width: 100%;"></a>
<a href="https://halleysfifthinc.github.io/Peaks.jl/stable" rel="nofollow"><img src="https://camo.githubusercontent.com/c97f0a5f2ae95755f64a27f1aa8d9a17462941fd3d6c907c7630abd5d3e60acf/68747470733a2f2f696d672e736869656c64732e696f2f62616467652f646f63732d737461626c652d626c75652e737667" alt="stable-docs" data-canonical-src="https://img.shields.io/badge/docs-stable-blue.svg" style="max-width: 100%;"></a>
<a href="https://halleysfifthinc.github.io/Peaks.jl/dev" rel="nofollow"><img src="https://camo.githubusercontent.com/7fcec4b2d3ab291529fce8ef6a4fcd4129a0683b2f5d5fe2f5c648f02db8b616/68747470733a2f2f696d672e736869656c64732e696f2f62616467652f646f63732d6465762d626c75652e737667" alt="dev-docs" data-canonical-src="https://img.shields.io/badge/docs-dev-blue.svg" style="max-width: 100%;"></a>
<a href="https://github.com/halleysfifthinc/Peaks.jl/actions/workflows/CI.yml"><img src="https://github.com/halleysfifthinc/Peaks.jl/actions/workflows/CI.yml/badge.svg" alt="CI" style="max-width: 100%;"></a>
<a href="https://codecov.io/gh/halleysfifthinc/Peaks.jl" rel="nofollow"><img src="https://camo.githubusercontent.com/07abe38db4cb85ddc6bbd2f7d2a2c1475dc456f74f6140d264fd1c7476fd380d/68747470733a2f2f636f6465636f762e696f2f67682f68616c6c6579736669667468696e632f5065616b732e6a6c2f6272616e63682f6d61737465722f67726170682f62616467652e737667" alt="codecov" data-canonical-src="https://codecov.io/gh/halleysfifthinc/Peaks.jl/branch/master/graph/badge.svg" style="max-width: 100%;"></a>
<a href="#"><img src="https://camo.githubusercontent.com/60b41d35ff39e0942ee0c145946f1469bcc43e45b02fe23f77804ea76b22fa64/68747470733a2f2f696d672e736869656c64732e696f2f6d61696e74656e616e63652f7965732f32303232" alt="Maintenance" data-canonical-src="https://img.shields.io/maintenance/yes/2022" style="max-width: 100%;"></a></p>
<p dir="auto">Peaks.jl contains peak (local extrema) finding functions for vector data. Contributions welcome.</p>
<p dir="auto"><a href="#"><img src="docs/src/assets/images/maxima_prom_width.png" alt="signal-with-peaks-prominences-and-widths" style="max-width: 100%;"></a></p>
<div class="highlight highlight-source-julia notranslate position-relative overflow-auto" dir="auto" data-snippet-clipboard-copy-content="julia&gt; using Peaks

julia&gt; t = 0:1/100:1;

julia&gt; y = 2*sin.(5*t)+3*sin.(10*t)+2*sin.(30*t);

julia&gt; pks, vals = findmaxima(y)
([8, 26, 48, 70, 88], [4.344867409921723, 5.5693856245725195, 0.42179571038522123, 3.050541716751975,
1.765468536605815])

julia&gt; pks, proms = peakproms(pks, y)
([8, 26, 48, 70, 88], [1.9441651653930858, 5.5693856245725195, 2.203426259167901, 6.0957723300230855,
2.195991801053836])

julia&gt; pks, widths, leftedge, rightedge = peakwidths(pks, y, proms)
([8, 26, 48, 70, 88], [7.168551512183585, 13.02544712081329, 8.262715646139178, 13.80559202119737,
7.663187146933097], [4.916043956211862, 18.50125024651451, 43.35170982447645, 63.83409366134414, 84.28425741824285],
[12.084595468395447, 31.5266973673278, 51.61442547061563, 77.63968568254151, 91.94744456517594])

julia&gt; _, proms = peakproms!(pks, y; minprom=1)
([8, 26, 48, 70, 88], [1.9441651653930858, 5.5693856245725195, 2.203426259167901, 6.0957723300230855, 2.195991801053836])

julia&gt; using Plots
julia&gt; plotpeaks(t, y, peaks=pks, prominences=true, widths=true)  # see above plot for result"><pre>julia<span class="pl-k">&gt;</span> <span class="pl-k">using</span> Peaks

julia<span class="pl-k">&gt;</span> t <span class="pl-k">=</span> <span class="pl-c1">0</span><span class="pl-k">:</span><span class="pl-c1">1</span><span class="pl-k">/</span><span class="pl-c1">100</span><span class="pl-k">:</span><span class="pl-c1">1</span>;

julia<span class="pl-k">&gt;</span> y <span class="pl-k">=</span> <span class="pl-c1">2</span><span class="pl-k">*</span><span class="pl-c1">sin</span>.(<span class="pl-c1">5</span><span class="pl-k">*</span>t)<span class="pl-k">+</span><span class="pl-c1">3</span><span class="pl-k">*</span><span class="pl-c1">sin</span>.(<span class="pl-c1">10</span><span class="pl-k">*</span>t)<span class="pl-k">+</span><span class="pl-c1">2</span><span class="pl-k">*</span><span class="pl-c1">sin</span>.(<span class="pl-c1">30</span><span class="pl-k">*</span>t);

julia<span class="pl-k">&gt;</span> pks, vals <span class="pl-k">=</span> <span class="pl-c1">findmaxima</span>(y)
([<span class="pl-c1">8</span>, <span class="pl-c1">26</span>, <span class="pl-c1">48</span>, <span class="pl-c1">70</span>, <span class="pl-c1">88</span>], [<span class="pl-c1">4.344867409921723</span>, <span class="pl-c1">5.5693856245725195</span>, <span class="pl-c1">0.42179571038522123</span>, <span class="pl-c1">3.050541716751975</span>,
<span class="pl-c1">1.765468536605815</span>])

julia<span class="pl-k">&gt;</span> pks, proms <span class="pl-k">=</span> <span class="pl-c1">peakproms</span>(pks, y)
([<span class="pl-c1">8</span>, <span class="pl-c1">26</span>, <span class="pl-c1">48</span>, <span class="pl-c1">70</span>, <span class="pl-c1">88</span>], [<span class="pl-c1">1.9441651653930858</span>, <span class="pl-c1">5.5693856245725195</span>, <span class="pl-c1">2.203426259167901</span>, <span class="pl-c1">6.0957723300230855</span>,
<span class="pl-c1">2.195991801053836</span>])

julia<span class="pl-k">&gt;</span> pks, widths, leftedge, rightedge <span class="pl-k">=</span> <span class="pl-c1">peakwidths</span>(pks, y, proms)
([<span class="pl-c1">8</span>, <span class="pl-c1">26</span>, <span class="pl-c1">48</span>, <span class="pl-c1">70</span>, <span class="pl-c1">88</span>], [<span class="pl-c1">7.168551512183585</span>, <span class="pl-c1">13.02544712081329</span>, <span class="pl-c1">8.262715646139178</span>, <span class="pl-c1">13.80559202119737</span>,
<span class="pl-c1">7.663187146933097</span>], [<span class="pl-c1">4.916043956211862</span>, <span class="pl-c1">18.50125024651451</span>, <span class="pl-c1">43.35170982447645</span>, <span class="pl-c1">63.83409366134414</span>, <span class="pl-c1">84.28425741824285</span>],
[<span class="pl-c1">12.084595468395447</span>, <span class="pl-c1">31.5266973673278</span>, <span class="pl-c1">51.61442547061563</span>, <span class="pl-c1">77.63968568254151</span>, <span class="pl-c1">91.94744456517594</span>])

julia<span class="pl-k">&gt;</span> _, proms <span class="pl-k">=</span> <span class="pl-c1">peakproms!</span>(pks, y; minprom<span class="pl-k">=</span><span class="pl-c1">1</span>)
([<span class="pl-c1">8</span>, <span class="pl-c1">26</span>, <span class="pl-c1">48</span>, <span class="pl-c1">70</span>, <span class="pl-c1">88</span>], [<span class="pl-c1">1.9441651653930858</span>, <span class="pl-c1">5.5693856245725195</span>, <span class="pl-c1">2.203426259167901</span>, <span class="pl-c1">6.0957723300230855</span>, <span class="pl-c1">2.195991801053836</span>])

julia<span class="pl-k">&gt;</span> <span class="pl-k">using</span> Plots
julia<span class="pl-k">&gt;</span> <span class="pl-c1">plotpeaks</span>(t, y, peaks<span class="pl-k">=</span>pks, prominences<span class="pl-k">=</span><span class="pl-c1">true</span>, widths<span class="pl-k">=</span><span class="pl-c1">true</span>)  <span class="pl-c"><span class="pl-c">#</span> see above plot for result</span></pre></div>
<h2 dir="auto"><a id="user-content-features" class="anchor" aria-hidden="true" href="#features"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a>Features</h2>
<ul dir="auto">
<li>Find peaks (maxima or minima), peak prominence, and peak width
<ul dir="auto">
<li>Filter peaks by peak spacing (window size), prominence, and width</li>
</ul>
</li>
<li>Fully supports <code>NaN</code>/<code>missing</code> with optional tolerance using keyword arg <code>strict</code>:
<ul dir="auto">
<li>Conventional handling/propagation of <code>NaN</code>/<code>missing</code> when <code>strict = true</code> (the default)
<div class="highlight highlight-source-julia notranslate position-relative overflow-auto" dir="auto" data-snippet-clipboard-copy-content="julia&gt; argmaxima([missing,2,0,1,1,0]) # equivalent to [2,0,1,1,0]
1-element Vector{Int64}:
 4

julia&gt; peakproms([2,4], [NaN,2,0,1,1,0])
([2, 4], [NaN, 1.0])

julia&gt; peakwidths([2,4], [NaN,2,0,1,1,0], [2,1])
([2, 4], [NaN, 2.0], [NaN, 3.5], [2.5, 5.5])"><pre>julia<span class="pl-k">&gt;</span> <span class="pl-c1">argmaxima</span>([<span class="pl-c1">missing</span>,<span class="pl-c1">2</span>,<span class="pl-c1">0</span>,<span class="pl-c1">1</span>,<span class="pl-c1">1</span>,<span class="pl-c1">0</span>]) <span class="pl-c"><span class="pl-c">#</span> equivalent to [2,0,1,1,0]</span>
<span class="pl-c1">1</span><span class="pl-k">-</span>element Vector{Int64}<span class="pl-k">:</span>
 <span class="pl-c1">4</span>

julia<span class="pl-k">&gt;</span> <span class="pl-c1">peakproms</span>([<span class="pl-c1">2</span>,<span class="pl-c1">4</span>], [<span class="pl-c1">NaN</span>,<span class="pl-c1">2</span>,<span class="pl-c1">0</span>,<span class="pl-c1">1</span>,<span class="pl-c1">1</span>,<span class="pl-c1">0</span>])
([<span class="pl-c1">2</span>, <span class="pl-c1">4</span>], [<span class="pl-c1">NaN</span>, <span class="pl-c1">1.0</span>])

julia<span class="pl-k">&gt;</span> <span class="pl-c1">peakwidths</span>([<span class="pl-c1">2</span>,<span class="pl-c1">4</span>], [<span class="pl-c1">NaN</span>,<span class="pl-c1">2</span>,<span class="pl-c1">0</span>,<span class="pl-c1">1</span>,<span class="pl-c1">1</span>,<span class="pl-c1">0</span>], [<span class="pl-c1">2</span>,<span class="pl-c1">1</span>])
([<span class="pl-c1">2</span>, <span class="pl-c1">4</span>], [<span class="pl-c1">NaN</span>, <span class="pl-c1">2.0</span>], [<span class="pl-c1">NaN</span>, <span class="pl-c1">3.5</span>], [<span class="pl-c1">2.5</span>, <span class="pl-c1">5.5</span>])</pre></div>
</li>
<li>Reasonable alternatives when <code>strict = false</code>
<div class="highlight highlight-source-julia notranslate position-relative overflow-auto" dir="auto" data-snippet-clipboard-copy-content="julia&gt; argmaxima([missing,2,0,1,1,0]; strict=false)
2-element Vector{Int64}:
 2
 4

julia&gt; peakproms([2,4], [NaN,2,0,1,1,0]; strict=false)
([2, 4], [2.0, 1.0])

julia&gt; peakwidths([2,4], [NaN,2,0,1,1,0], [2,1]; strict=false)
([2, 4], [1.5, 2.0], [1.0, 3.5], [2.5, 5.5])"><pre>julia<span class="pl-k">&gt;</span> <span class="pl-c1">argmaxima</span>([<span class="pl-c1">missing</span>,<span class="pl-c1">2</span>,<span class="pl-c1">0</span>,<span class="pl-c1">1</span>,<span class="pl-c1">1</span>,<span class="pl-c1">0</span>]; strict<span class="pl-k">=</span><span class="pl-c1">false</span>)
<span class="pl-c1">2</span><span class="pl-k">-</span>element Vector{Int64}<span class="pl-k">:</span>
 <span class="pl-c1">2</span>
 <span class="pl-c1">4</span>

julia<span class="pl-k">&gt;</span> <span class="pl-c1">peakproms</span>([<span class="pl-c1">2</span>,<span class="pl-c1">4</span>], [<span class="pl-c1">NaN</span>,<span class="pl-c1">2</span>,<span class="pl-c1">0</span>,<span class="pl-c1">1</span>,<span class="pl-c1">1</span>,<span class="pl-c1">0</span>]; strict<span class="pl-k">=</span><span class="pl-c1">false</span>)
([<span class="pl-c1">2</span>, <span class="pl-c1">4</span>], [<span class="pl-c1">2.0</span>, <span class="pl-c1">1.0</span>])

julia<span class="pl-k">&gt;</span> <span class="pl-c1">peakwidths</span>([<span class="pl-c1">2</span>,<span class="pl-c1">4</span>], [<span class="pl-c1">NaN</span>,<span class="pl-c1">2</span>,<span class="pl-c1">0</span>,<span class="pl-c1">1</span>,<span class="pl-c1">1</span>,<span class="pl-c1">0</span>], [<span class="pl-c1">2</span>,<span class="pl-c1">1</span>]; strict<span class="pl-k">=</span><span class="pl-c1">false</span>)
([<span class="pl-c1">2</span>, <span class="pl-c1">4</span>], [<span class="pl-c1">1.5</span>, <span class="pl-c1">2.0</span>], [<span class="pl-c1">1.0</span>, <span class="pl-c1">3.5</span>], [<span class="pl-c1">2.5</span>, <span class="pl-c1">5.5</span>])</pre></div>
</li>
</ul>
</li>
</ul>
<h2 dir="auto"><a id="user-content-related" class="anchor" aria-hidden="true" href="#related"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a>Related</h2>
<ul dir="auto">
<li><a href="https://github.com/JuliaImages/Images.jl"><strong>Images.jl</strong></a>
<ul dir="auto">
<li><a href="https://juliaimages.org/stable/function_reference/#Images.findlocalmaxima" rel="nofollow"><code>findlocalmaxima</code></a>/<a href="https://juliaimages.org/stable/function_reference/#Images.findlocalminima" rel="nofollow"><code>findlocalminima</code></a>
<ul dir="auto">
<li>Supports more than 1 dimension</li>
<li>Doesn't support <code>missing</code>, different window sizes</li>
</ul>
</li>
</ul>
</li>
</ul>
</article></div>