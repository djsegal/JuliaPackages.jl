<div id="readme" class="md" data-path="README.md"><article class="markdown-body entry-content container-lg" itemprop="text"><h1 dir="auto"><a id="user-content-kerrquasinormalmodes" class="anchor" aria-hidden="true" href="#kerrquasinormalmodes"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a>KerrQuasinormalModes</h1>
<p dir="auto">This is a package that not only computes Quasinormal Modes for Kerr Black holes, but focuses on an easy to use (yet performant) interface for working with the Quasinormal Mode Functions. These functions are basically solutions to the Tuekolsky Equations for different s,l,m,n and a values. We implement the <a href="https://arxiv.org/abs/1410.7698" rel="nofollow">Cook-Zalutskiy solver</a> to compute the quasinormal mode frequency and also the radial expansion coefficients, as well as the spectral coefficients in the angular sector.</p>
<h1 dir="auto"><a id="user-content-usage" class="anchor" aria-hidden="true" href="#usage"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a>Usage</h1>
<p dir="auto">Start off by defining a <code>ModeSequence</code>: this defines a particular mode without reference to a particular <math-renderer class="js-inline-math" style="display: inline" data-static-url="https://github.githubassets.com/static" data-run-id="c35b1bc766c4e92733db2085ea4aa5f0">$a$</math-renderer> value. Then you can get the QNM wavefunction corresponding to any particular <math-renderer class="js-inline-math" style="display: inline" data-static-url="https://github.githubassets.com/static" data-run-id="c35b1bc766c4e92733db2085ea4aa5f0">$a$</math-renderer> value. (In this case <math-renderer class="js-inline-math" style="display: inline" data-static-url="https://github.githubassets.com/static" data-run-id="c35b1bc766c4e92733db2085ea4aa5f0">$a=0.8$</math-renderer>)</p>
<div class="highlight highlight-source-julia notranslate position-relative overflow-auto" dir="auto" data-snippet-clipboard-copy-content="Ω = ModeSequence(s=-2,l=2,m=2,n=0) # Pick a mode
ψ = Ω(0.8) # Get the QNM mode function at a = 0.8"><pre>Ω <span class="pl-k">=</span> <span class="pl-c1">ModeSequence</span>(s<span class="pl-k">=</span><span class="pl-k">-</span><span class="pl-c1">2</span>,l<span class="pl-k">=</span><span class="pl-c1">2</span>,m<span class="pl-k">=</span><span class="pl-c1">2</span>,n<span class="pl-k">=</span><span class="pl-c1">0</span>) <span class="pl-c"><span class="pl-c">#</span> Pick a mode</span>
ψ <span class="pl-k">=</span> <span class="pl-c1">Ω</span>(<span class="pl-c1">0.8</span>) <span class="pl-c"><span class="pl-c">#</span> Get the QNM mode function at a = 0.8</span></pre></div>
<h2 dir="auto">
<a id="user-content-mode-values" class="anchor" aria-hidden="true" href="#mode-values"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a>Mode Values</h2>
<p dir="auto"><strong>Values for the Quasinormal Mode Quantities</strong></p>
<div class="highlight highlight-source-julia notranslate position-relative overflow-auto" dir="auto" data-snippet-clipboard-copy-content="ψ.ω # = 0.5860169749084593 - 0.0756295523345646im
ψ.Alm # = 2.5852939720024275 + 0.20529748567633602im"><pre>ψ<span class="pl-k">.</span>ω <span class="pl-c"><span class="pl-c">#</span> = 0.5860169749084593 - 0.0756295523345646im</span>
ψ<span class="pl-k">.</span>Alm <span class="pl-c"><span class="pl-c">#</span> = 2.5852939720024275 + 0.20529748567633602im</span></pre></div>
<h2 dir="auto">
<a id="user-content-wavefunction-evaluation" class="anchor" aria-hidden="true" href="#wavefunction-evaluation"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a>Wavefunction Evaluation</h2>
<p dir="auto"><strong>QNM Wavefunction values in Boyer Lingquist Coordinates</strong></p>
<div class="highlight highlight-source-julia notranslate position-relative overflow-auto" dir="auto" data-snippet-clipboard-copy-content="ψ(r) # Returns the value of the radial wavefuntion at r
ψ(r,cos(θ)) # Returns the value of the full wavefunction at r=r, cos(θ)=cos(θ), ϕ=0 and t=0
ψ(r,cos(θ),ϕ) # Returns the value of the full wavefunction at r=r, cos(θ)=cos(θ), ϕ=ϕ and t=0
ψ(r,cos(θ),ϕ,t) # Returns the value of the full wavefunction at r=r, cos(θ)=cos(θ), ϕ=ϕ and t=t"><pre><span class="pl-c1">ψ</span>(r) <span class="pl-c"><span class="pl-c">#</span> Returns the value of the radial wavefuntion at r</span>
<span class="pl-c1">ψ</span>(r,<span class="pl-c1">cos</span>(θ)) <span class="pl-c"><span class="pl-c">#</span> Returns the value of the full wavefunction at r=r, cos(θ)=cos(θ), ϕ=0 and t=0</span>
<span class="pl-c1">ψ</span>(r,<span class="pl-c1">cos</span>(θ),ϕ) <span class="pl-c"><span class="pl-c">#</span> Returns the value of the full wavefunction at r=r, cos(θ)=cos(θ), ϕ=ϕ and t=0</span>
<span class="pl-c1">ψ</span>(r,<span class="pl-c1">cos</span>(θ),ϕ,t) <span class="pl-c"><span class="pl-c">#</span> Returns the value of the full wavefunction at r=r, cos(θ)=cos(θ), ϕ=ϕ and t=t</span></pre></div>
<p dir="auto"><strong>Radial &amp; Spin Weighted Harmonic Wavefunctions</strong></p>
<div class="highlight highlight-source-julia notranslate position-relative overflow-auto" dir="auto" data-snippet-clipboard-copy-content="ψ.R # Returns the Radial Wavefunction
ψ.R(2.2) # Value of the Radial Wavefunction @ r = 2.2
ψ.R.r₊, ψ.R.r₋  # Radial coordinate of Outer and Inner Horizons
ψ.S # Returns the Spin-Weighted Spheroidal Harmonic Wavefunction
ψ.S(0.7) # Value of the Spin-Weighted Spheroidal Harmonic @ cos(θ) = 0.7
ψ.S(0.7, π/2) # Value of the Spin-Weighted Spheroidal Harmonic @ cos(θ) = 0.7 &amp; ϕ = π/2
ψ.S.Cllʼ # Returns the vector of Spherical-Spheroidal mixing coefficients"><pre>ψ<span class="pl-k">.</span>R <span class="pl-c"><span class="pl-c">#</span> Returns the Radial Wavefunction</span>
ψ<span class="pl-k">.</span><span class="pl-c1">R</span>(<span class="pl-c1">2.2</span>) <span class="pl-c"><span class="pl-c">#</span> Value of the Radial Wavefunction @ r = 2.2</span>
ψ<span class="pl-k">.</span>R<span class="pl-k">.</span>r₊, ψ<span class="pl-k">.</span>R<span class="pl-k">.</span>r₋  <span class="pl-c"><span class="pl-c">#</span> Radial coordinate of Outer and Inner Horizons</span>
ψ<span class="pl-k">.</span>S <span class="pl-c"><span class="pl-c">#</span> Returns the Spin-Weighted Spheroidal Harmonic Wavefunction</span>
ψ<span class="pl-k">.</span><span class="pl-c1">S</span>(<span class="pl-c1">0.7</span>) <span class="pl-c"><span class="pl-c">#</span> Value of the Spin-Weighted Spheroidal Harmonic @ cos(θ) = 0.7</span>
ψ<span class="pl-k">.</span><span class="pl-c1">S</span>(<span class="pl-c1">0.7</span>, π<span class="pl-k">/</span><span class="pl-c1">2</span>) <span class="pl-c"><span class="pl-c">#</span> Value of the Spin-Weighted Spheroidal Harmonic @ cos(θ) = 0.7 &amp; ϕ = π/2</span>
ψ<span class="pl-k">.</span>S<span class="pl-k">.</span>Cllʼ <span class="pl-c"><span class="pl-c">#</span> Returns the vector of Spherical-Spheroidal mixing coefficients</span></pre></div>
<h2 dir="auto">
<a id="user-content-performant-linear-symbolics-of-qnm-wavefunctions" class="anchor" aria-hidden="true" href="#performant-linear-symbolics-of-qnm-wavefunctions"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a>Performant Linear Symbolics of QNM Wavefunctions</h2>
<p dir="auto">One can also take <em>Derivatives</em> and <em>Linear Combinations</em> of these modes to emulate the action of differential operators on these functions in a simple way that doesn't come with the slow-down of a general symbolic system. It allows:</p>
<ul dir="auto">
<li>
<strong>Derivatives</strong> of any mode with respect to any of the Boyer Lingquist coordinates <code>∂r,∂θ,∂ϕ,∂t </code>
<ul dir="auto">
<li>Use <code>∂r,∂θ,∂ϕ,∂t</code> to create a new Heun-like function. This new function is also very performant during evaluation.</li>
</ul>
</li>
<li>
<strong>Linear Combinations</strong> of any mode or it's derivative: (<code>∂r(Ψ) + m*Ψ  -∂θ(∂θ(Ψ)) </code>)</li>
<li>Doing something like <code>ψnew = ∂r(Ψ) + m*Ψ  -∂θ(∂θ(Ψ))</code> is a completely valid operation, and evaluating it as if it was a mode function, like <code>ψnew(0.6,0.4)</code>, will be performant.</li>
</ul>
<p dir="auto">An example:</p>
<div class="highlight highlight-source-julia notranslate position-relative overflow-auto" dir="auto" data-snippet-clipboard-copy-content="julia&gt; ψnew = ∂r(Ψ) + 3*Ψ  -∂θ(∂θ(Ψ)) # Completely valid expression that is saved as a Linear Combination of Heun-Like functions as shown below
(-1.0 - 0.0im)₋₂Ψ₂₂₀ +
(-1.224744871391589 - 0.0im)₀Ψ₂₂₀ +
(0.2293785997558912 + 1.7983211937744943im)₋₂Ψ₂₂₀ +
(-1.4014125495728098 + 1.352937910894635im)₋₂Ψ₂₂₀ +
(4.075629552334565 + 0.5860169749084593im)₋₂Ψ₂₂₀

julia&gt; ψnew(2.5,0.7)  # Evaluating this new variable is a completely valid and performant operation
0.5945305105574497 + 0.6407097912091125im"><pre>julia<span class="pl-k">&gt;</span> ψnew <span class="pl-k">=</span> <span class="pl-c1">∂r</span>(Ψ) <span class="pl-k">+</span> <span class="pl-c1">3</span><span class="pl-k">*</span>Ψ  <span class="pl-k">-</span><span class="pl-c1">∂θ</span>(<span class="pl-c1">∂θ</span>(Ψ)) <span class="pl-c"><span class="pl-c">#</span> Completely valid expression that is saved as a Linear Combination of Heun-Like functions as shown below</span>
(<span class="pl-k">-</span><span class="pl-c1">1.0</span> <span class="pl-k">-</span> <span class="pl-c1">0.0im</span>)₋₂Ψ₂₂₀ <span class="pl-k">+</span>
(<span class="pl-k">-</span><span class="pl-c1">1.224744871391589</span> <span class="pl-k">-</span> <span class="pl-c1">0.0im</span>)₀Ψ₂₂₀ <span class="pl-k">+</span>
(<span class="pl-c1">0.2293785997558912</span> <span class="pl-k">+</span> <span class="pl-c1">1.7983211937744943im</span>)₋₂Ψ₂₂₀ <span class="pl-k">+</span>
(<span class="pl-k">-</span><span class="pl-c1">1.4014125495728098</span> <span class="pl-k">+</span> <span class="pl-c1">1.352937910894635im</span>)₋₂Ψ₂₂₀ <span class="pl-k">+</span>
(<span class="pl-c1">4.075629552334565</span> <span class="pl-k">+</span> <span class="pl-c1">0.5860169749084593im</span>)₋₂Ψ₂₂₀

julia<span class="pl-k">&gt;</span> <span class="pl-c1">ψnew</span>(<span class="pl-c1">2.5</span>,<span class="pl-c1">0.7</span>)  <span class="pl-c"><span class="pl-c">#</span> Evaluating this new variable is a completely valid and performant operation</span>
<span class="pl-c1">0.5945305105574497</span> <span class="pl-k">+</span> <span class="pl-c1">0.6407097912091125im</span></pre></div>
<h2 dir="auto">
<a id="user-content-animated-plot-of-radial-modes" class="anchor" aria-hidden="true" href="#animated-plot-of-radial-modes"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a>Animated Plot of Radial Modes</h2>
<p dir="auto"><a target="_blank" rel="noopener noreferrer" href="docs/QnmAnimated.gif"><img src="docs/QnmAnimated.gif" alt="RadialModePlot" style="max-width: 100%;"></a></p>
</article></div>