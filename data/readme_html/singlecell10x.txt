<div id="readme" class="md" data-path="README.md"><article class="markdown-body entry-content container-lg" itemprop="text"><h1 dir="auto"><a id="user-content-singlecell10xjl" class="anchor" aria-hidden="true" href="#singlecell10xjl"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a>SingleCell10x.jl</h1>
<p dir="auto"><a href="https://github.com/rasmushenningsson/SingleCell10x.jl/actions/workflows/CI.yml?query=branch%3Amain"><img src="https://github.com/rasmushenningsson/SingleCell10x.jl/actions/workflows/CI.yml/badge.svg?branch=main" alt="Build Status" style="max-width: 100%;"></a>
<a href="https://codecov.io/gh/rasmushenningsson/SingleCell10x.jl" rel="nofollow"><img src="https://camo.githubusercontent.com/8d0bd14563cc4c20317495def81a9464fb57b83da0c5cd05a9d2ba7c7e562137/68747470733a2f2f636f6465636f762e696f2f67682f7261736d757368656e6e696e6773736f6e2f53696e676c6543656c6c3130782e6a6c2f6272616e63682f6d61696e2f67726170682f62616467652e737667" alt="Coverage" data-canonical-src="https://codecov.io/gh/rasmushenningsson/SingleCell10x.jl/branch/main/graph/badge.svg" style="max-width: 100%;"></a></p>
<p dir="auto">A Julia package for loading 10x Single Cell RNA-seq and antibody count data.</p>
<p dir="auto">It supports loading of 10x ".h5" files as well as text-based ".mtx" and ".tsv/.csv" files.
The count matrix can be transposed at load time and the data types of the matrix and annotations can be chosen conveniently.</p>
<p dir="auto">More information on the file formats can be found in the <a href="https://support.10xgenomics.com/single-cell-gene-expression/software/pipelines/latest/output/overview" rel="nofollow">10x Genomics offical documentation</a>.
Note that this is an independent implementation - any bugs you find should be reported here, not to 10x Genomics.</p>
<p dir="auto">To analyze your Single Cell expression data in Julia, you can use <a href="https://github.com/rasmushenningsson/SingleCellProjections.jl">SingleCellProjections.jl</a>.</p>
<h2 dir="auto"><a id="user-content-documentation" class="anchor" aria-hidden="true" href="#documentation"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a>Documentation</h2>
<p dir="auto">The package should hopefully be straightforward to use.
See below for example usage. More detailed descriptions are in the docstrings of the exported functions:</p>
<ul dir="auto">
<li><code>read10x</code></li>
<li><code>read10x_matrix</code></li>
<li><code>read10x_features</code></li>
<li><code>read10x_barcodes</code></li>
</ul>
<h2 dir="auto"><a id="user-content-example-usage" class="anchor" aria-hidden="true" href="#example-usage"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a>Example usage</h2>
<p dir="auto">Below, we will load files from the <code>test/</code> directory, but you can try with your own files instead.</p>
<div class="highlight highlight-source-julia notranslate position-relative overflow-auto" dir="auto" data-snippet-clipboard-copy-content="basepath = joinpath(pkgdir(SingleCell10x),&quot;test/data/500_PBMC_3p_LT_Chromium_X_50genes/&quot;)"><pre>basepath <span class="pl-k">=</span> <span class="pl-c1">joinpath</span>(<span class="pl-c1">pkgdir</span>(SingleCell10x),<span class="pl-s"><span class="pl-pds">"</span>test/data/500_PBMC_3p_LT_Chromium_X_50genes/<span class="pl-pds">"</span></span>)</pre></div>
<h3 dir="auto"><a id="user-content-basic-loading" class="anchor" aria-hidden="true" href="#basic-loading"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a>Basic loading</h3>
<p dir="auto">Loading a sparse count matrix, feature annotations and barcode annotations from a ".h5" file:</p>
<div class="highlight highlight-source-julia notranslate position-relative overflow-auto" dir="auto" data-snippet-clipboard-copy-content="using SingleCell10x
filepath = joinpath(basepath, &quot;filtered_feature_bc_matrix.h5&quot;)

matrix,features,barcodes = read10x(filepath)"><pre><span class="pl-k">using</span> SingleCell10x
filepath <span class="pl-k">=</span> <span class="pl-c1">joinpath</span>(basepath, <span class="pl-s"><span class="pl-pds">"</span>filtered_feature_bc_matrix.h5<span class="pl-pds">"</span></span>)

matrix,features,barcodes <span class="pl-k">=</span> <span class="pl-c1">read10x</span>(filepath)</pre></div>
<p dir="auto">You can also load the matrix/features/barcodes separately:</p>
<div class="highlight highlight-source-julia notranslate position-relative overflow-auto" dir="auto" data-snippet-clipboard-copy-content="matrix2 = read10x_matrix(filepath)
features2 = read10x_features(filepath)
barcodes2 = read10x_barcodes(filepath)"><pre>matrix2 <span class="pl-k">=</span> <span class="pl-c1">read10x_matrix</span>(filepath)
features2 <span class="pl-k">=</span> <span class="pl-c1">read10x_features</span>(filepath)
barcodes2 <span class="pl-k">=</span> <span class="pl-c1">read10x_barcodes</span>(filepath)</pre></div>
<h3 dir="auto"><a id="user-content-sink-types" class="anchor" aria-hidden="true" href="#sink-types"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a>Sink types</h3>
<p dir="auto">Per default, the matrix will be a <code>SparseMatrixCSC{Int,Int}</code>, features will be a <code>NamedTuple</code> where keys are column names and elements are column vectors, and barcodes a <code>Vector{String}</code>.
But you can also specify sink types to load directly into the desired type:</p>
<div class="highlight highlight-source-julia notranslate position-relative overflow-auto" dir="auto" data-snippet-clipboard-copy-content="using DataFrames
matrix,features,barcodes = read10x(filepath, Matrix{Float64}, DataFrame, DataFrame)"><pre><span class="pl-k">using</span> DataFrames
matrix,features,barcodes <span class="pl-k">=</span> <span class="pl-c1">read10x</span>(filepath, Matrix{Float64}, DataFrame, DataFrame)</pre></div>
<p dir="auto">or similarly</p>
<div class="highlight highlight-source-julia notranslate position-relative overflow-auto" dir="auto" data-snippet-clipboard-copy-content="matrix2 = read10x_matrix(filepath, Matrix{Float64})
features2 = read10x_features(filepath, DataFrame)
barcodes2 = read10x_barcodes(filepath, DataFrame)"><pre>matrix2 <span class="pl-k">=</span> <span class="pl-c1">read10x_matrix</span>(filepath, Matrix{Float64})
features2 <span class="pl-k">=</span> <span class="pl-c1">read10x_features</span>(filepath, DataFrame)
barcodes2 <span class="pl-k">=</span> <span class="pl-c1">read10x_barcodes</span>(filepath, DataFrame)</pre></div>
<h3 dir="auto"><a id="user-content-matrixmarket-mtx-files" class="anchor" aria-hidden="true" href="#matrixmarket-mtx-files"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a>MatrixMarket .mtx files</h3>
<p dir="auto">Instead of loading a ".h5", <code>SingleCell10x.jl</code> also support the text-based "matrix.mtx(.gz)" with companion files. By default, feature/barcode filenames are searched for in the same folder.</p>
<div class="highlight highlight-source-julia notranslate position-relative overflow-auto" dir="auto" data-snippet-clipboard-copy-content="filepath_mtx = joinpath(basepath,&quot;filtered_feature_bc_matrix/matrix.mtx.gz&quot;)

matrix,features,barcodes = read10x(filepath_mtx)"><pre>filepath_mtx <span class="pl-k">=</span> <span class="pl-c1">joinpath</span>(basepath,<span class="pl-s"><span class="pl-pds">"</span>filtered_feature_bc_matrix/matrix.mtx.gz<span class="pl-pds">"</span></span>)

matrix,features,barcodes <span class="pl-k">=</span> <span class="pl-c1">read10x</span>(filepath_mtx)</pre></div>
<p dir="auto">If you load features/barcodes separately, you can either specify the path to the "matrix.mtx(.gz)" file or the feature/barcode file directly.</p>
<div class="highlight highlight-source-julia notranslate position-relative overflow-auto" dir="auto" data-snippet-clipboard-copy-content="filepath_features = joinpath(basepath,&quot;filtered_feature_bc_matrix/features.tsv.gz&quot;)
filepath_barcodes = joinpath(basepath,&quot;filtered_feature_bc_matrix/barcodes.tsv.gz&quot;)

features2 = read10x_features(filepath_mtx)
features3 = read10x_features(filepath_features)

barcodes2 = read10x_barcodes(filepath_mtx)
barcodes3 = read10x_barcodes(filepath_barcodes)"><pre>filepath_features <span class="pl-k">=</span> <span class="pl-c1">joinpath</span>(basepath,<span class="pl-s"><span class="pl-pds">"</span>filtered_feature_bc_matrix/features.tsv.gz<span class="pl-pds">"</span></span>)
filepath_barcodes <span class="pl-k">=</span> <span class="pl-c1">joinpath</span>(basepath,<span class="pl-s"><span class="pl-pds">"</span>filtered_feature_bc_matrix/barcodes.tsv.gz<span class="pl-pds">"</span></span>)

features2 <span class="pl-k">=</span> <span class="pl-c1">read10x_features</span>(filepath_mtx)
features3 <span class="pl-k">=</span> <span class="pl-c1">read10x_features</span>(filepath_features)

barcodes2 <span class="pl-k">=</span> <span class="pl-c1">read10x_barcodes</span>(filepath_mtx)
barcodes3 <span class="pl-k">=</span> <span class="pl-c1">read10x_barcodes</span>(filepath_barcodes)</pre></div>
</article></div>