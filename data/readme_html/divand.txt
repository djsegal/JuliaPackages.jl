<div id="readme" class="md" data-path="README.md"><article class="markdown-body entry-content container-lg" itemprop="text"><h1 dir="auto"><a id="user-content-divand" class="anchor" aria-hidden="true" href="#divand"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a>DIVAnd</h1>
<div align="center" dir="auto"> <a target="_blank" rel="noopener noreferrer" href="docs/src/assets/logo.png"><img src="docs/src/assets/logo.png" style="max-width: 100%;"></a></div>
<hr>
<p dir="auto"><a href="https://www.repostatus.org/#active" rel="nofollow"><img src="https://camo.githubusercontent.com/2261082c77808ea734741b12e535d02d23c4101f6b8dfec807f4ddc5ef2eeec0/68747470733a2f2f7777772e7265706f7374617475732e6f72672f6261646765732f6c61746573742f6163746976652e737667" alt="Project Status: Active – The project has reached a stable, usable state and is being actively developed." data-canonical-src="https://www.repostatus.org/badges/latest/active.svg" style="max-width: 100%;"></a>
<a href="https://github.com/gher-uliege/DIVAnd.jl/actions"><img src="https://github.com/gher-uliege/DIVAnd.jl/workflows/CI/badge.svg" alt="Build Status" style="max-width: 100%;"></a>
<a href="https://app.codecov.io/github/gher-uliege/DIVAnd.jl/tree/JMB" rel="nofollow"><img src="https://camo.githubusercontent.com/387d716f6a7c227ae91f4bb09708f2efe496103aa88f5c02fa42304906be8b02/687474703a2f2f636f6465636f762e696f2f6769746875622f676865722d756c696567652f444956416e642e6a6c2f636f7665726167652e7376673f6272616e63683d4a4d42" alt="codecov.io" data-canonical-src="http://codecov.io/github/gher-uliege/DIVAnd.jl/coverage.svg?branch=JMB" style="max-width: 100%;"></a>
<a href="https://gher-uliege.github.io/DIVAnd.jl/stable/" rel="nofollow"><img src="https://camo.githubusercontent.com/c97f0a5f2ae95755f64a27f1aa8d9a17462941fd3d6c907c7630abd5d3e60acf/68747470733a2f2f696d672e736869656c64732e696f2f62616467652f646f63732d737461626c652d626c75652e737667" alt="documentation stable" data-canonical-src="https://img.shields.io/badge/docs-stable-blue.svg" style="max-width: 100%;"></a>
<a href="https://gher-uliege.github.io/DIVAnd.jl/latest/" rel="nofollow"><img src="https://camo.githubusercontent.com/56f8252ba8e9d3f0b810769543f77823d2fe031ce560d4c2d69fb1fcad800383/68747470733a2f2f696d672e736869656c64732e696f2f62616467652f646f63732d6c61746573742d626c75652e737667" alt="documentation latest" data-canonical-src="https://img.shields.io/badge/docs-latest-blue.svg" style="max-width: 100%;"></a>
<a href="https://zenodo.org/badge/latestdoi/79277337" rel="nofollow"><img src="https://camo.githubusercontent.com/1c07f29592041ebd0d7a2a46e68c9a710aef0dc44a956dfc04c1b3c5a1740daf/68747470733a2f2f7a656e6f646f2e6f72672f62616467652f37393237373333372e737667" alt="DOI" data-canonical-src="https://zenodo.org/badge/79277337.svg" style="max-width: 100%;"></a>
<a target="_blank" rel="noopener noreferrer nofollow" href="https://camo.githubusercontent.com/8b9dbda9fb500ac20987b4564af54682b841d194747f979d34c9d989f18dd3d6/68747470733a2f2f696d672e736869656c64732e696f2f6769746875622f6c616e6775616765732f746f702f676865722d756c696567652f444956416e642e6a6c"><img src="https://camo.githubusercontent.com/8b9dbda9fb500ac20987b4564af54682b841d194747f979d34c9d989f18dd3d6/68747470733a2f2f696d672e736869656c64732e696f2f6769746875622f6c616e6775616765732f746f702f676865722d756c696567652f444956416e642e6a6c" alt="GitHub top language" data-canonical-src="https://img.shields.io/github/languages/top/gher-uliege/DIVAnd.jl" style="max-width: 100%;"></a></p>
<p dir="auto"><code>DIVAnd</code> (Data-Interpolating Variational Analysis in n dimensions) performs an n-dimensional variational analysis/gridding of arbitrarily located observations. Observations will be interpolated/analyzed on a curvilinear grid in 1, 2, 3 or more dimensions. In this sense it is a generalization of the original two-dimensional DIVA version (still available here <a href="https://github.com/gher-uliege/DIVA">https://github.com/gher-uliege/DIVA</a> but not further developed anymore).</p>
<p dir="auto">The method bears some similarities and equivalences with Optimal Interpolation or Krigging in that it allows to create a smooth and continous field from a collection of observations, observations which can be affected by errors. The analysis method is however different in practise, allowing to take into account topological features, physical constraints etc in a natural way. The method was initially developped with ocean data in mind, but it can be applied to any field where localized observations have to be used to produce gridded fields which are "smooth".</p>
<p dir="auto">See also <a href="https://gher-uliege.github.io/DIVAnd-presentation/#1" rel="nofollow">https://gher-uliege.github.io/DIVAnd-presentation/#1</a></p>
<p dir="auto">Please cite this paper as follows if you use <code>DIVAnd</code> in a publication:</p>
<p dir="auto">Barth, A., Beckers, J.-M., Troupin, C., Alvera-Azcárate, A., and Vandenbulcke, L.: DIVAnd-1.0: n-dimensional variational data analysis for ocean observations, Geosci. Model Dev., 7, 225-241, doi:<a href="https://doi.org/10.5194/gmd-7-225-2014" rel="nofollow">10.5194/gmd-7-225-2014</a>, 2014.</p>
<p dir="auto">(click <a href="./data/DIVAnd.bib">here</a> for the BibTeX entry).</p>
<h1 dir="auto"><a id="user-content-summary-of-features" class="anchor" aria-hidden="true" href="#summary-of-features"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a>Summary of features</h1>
<ul dir="auto">
<li>N-Dimensional analysis/interpolation</li>
<li>Scattered data</li>
<li>Noise allowed</li>
<li>Physical constraints can be added</li>
<li>Inequality constraints can be added</li>
<li>Topological constraints are handled naturally (barriers, holes)</li>
<li>Analysis error maps can be estimated</li>
<li>Periodicity in selected directions can be enforced</li>
<li>Multivariate data can be used (experimental)</li>
<li>The output grid can be curvilinear</li>
<li>Instead of interpolating scattered data you can also peform Kernel Density Estimations with the points.</li>
</ul>
<h1 dir="auto"><a id="user-content-installing" class="anchor" aria-hidden="true" href="#installing"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a>Installing</h1>
<p dir="auto">You need <a href="http://julialang.org" rel="nofollow">Julia</a> (version 1.6 or later) to run <code>DIVAnd</code>. The command line version is sufficient for <code>DIVAnd</code>.
Inside a Julia terminal, you can download and install the package by issuing:</p>
<div class="highlight highlight-source-julia notranslate position-relative overflow-auto" dir="auto" data-snippet-clipboard-copy-content="using Pkg
Pkg.add(&quot;DIVAnd&quot;)"><pre><span class="pl-k">using</span> Pkg
Pkg<span class="pl-k">.</span><span class="pl-c1">add</span>(<span class="pl-s"><span class="pl-pds">"</span>DIVAnd<span class="pl-pds">"</span></span>)</pre></div>
<p dir="auto">It is not recommended to download the source of <code>DIVAnd.jl</code> directly (using the green <em>Clone or Download</em> button above) because this by-passes Julia's package manager and you would need to install the dependencies of <code>DIVAnd.jl</code> manually.</p>
<h1 dir="auto"><a id="user-content-updating-divand" class="anchor" aria-hidden="true" href="#updating-divand"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a>Updating DIVAnd</h1>
<p dir="auto">To update DIVAnd, run the following command and restart Julia (or restart the jupyter notebook kernel using <code>Kernel</code> -&gt; <code>Restart</code>):</p>
<div class="highlight highlight-source-julia notranslate position-relative overflow-auto" dir="auto" data-snippet-clipboard-copy-content="using Pkg
Pkg.update(&quot;DIVAnd&quot;)"><pre><span class="pl-k">using</span> Pkg
Pkg<span class="pl-k">.</span><span class="pl-c1">update</span>(<span class="pl-s"><span class="pl-pds">"</span>DIVAnd<span class="pl-pds">"</span></span>)</pre></div>
<p dir="auto">Note that Julia does not directly delete the previous installed version.
To check if you have the latest version run the following command:</p>
<div class="highlight highlight-source-julia notranslate position-relative overflow-auto" dir="auto" data-snippet-clipboard-copy-content="using Pkg
Pkg.status()"><pre><span class="pl-k">using</span> Pkg
Pkg<span class="pl-k">.</span><span class="pl-c1">status</span>()</pre></div>
<p dir="auto">The latest version number is available from <a href="https://github.com/gher-uliege/DIVAnd.jl/releases">here</a>.</p>
<p dir="auto">To explicitly install a given version <code>X.Y.Z</code> you can also use:</p>
<div class="highlight highlight-source-julia notranslate position-relative overflow-auto" dir="auto" data-snippet-clipboard-copy-content="using Pkg
Pkg.add(name=&quot;DIVAnd&quot;, version=&quot;X.Y.Z&quot;)"><pre><span class="pl-k">using</span> Pkg
Pkg<span class="pl-k">.</span><span class="pl-c1">add</span>(name<span class="pl-k">=</span><span class="pl-s"><span class="pl-pds">"</span>DIVAnd<span class="pl-pds">"</span></span>, version<span class="pl-k">=</span><span class="pl-s"><span class="pl-pds">"</span>X.Y.Z<span class="pl-pds">"</span></span>)</pre></div>
<p dir="auto">Or the master version:</p>
<div class="highlight highlight-source-julia notranslate position-relative overflow-auto" dir="auto" data-snippet-clipboard-copy-content="using Pkg
Pkg.add(name=&quot;DIVAnd&quot;, rev=&quot;master&quot;)"><pre><span class="pl-k">using</span> Pkg
Pkg<span class="pl-k">.</span><span class="pl-c1">add</span>(name<span class="pl-k">=</span><span class="pl-s"><span class="pl-pds">"</span>DIVAnd<span class="pl-pds">"</span></span>, rev<span class="pl-k">=</span><span class="pl-s"><span class="pl-pds">"</span>master<span class="pl-pds">"</span></span>)</pre></div>
<h1 dir="auto"><a id="user-content-testing" class="anchor" aria-hidden="true" href="#testing"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a>Testing</h1>
<p dir="auto">A test script is included to verify the correct functioning of the toolbox.
The script should be run in a Julia session.
Make sure to be in a directory with write-access (for example your home directory).
You can change the directory to your home directory with the <code>cd(homedir())</code> command.</p>
<div class="highlight highlight-source-julia notranslate position-relative overflow-auto" dir="auto" data-snippet-clipboard-copy-content="using Pkg
Pkg.test(&quot;DIVAnd&quot;)"><pre><span class="pl-k">using</span> Pkg
Pkg<span class="pl-k">.</span><span class="pl-c1">test</span>(<span class="pl-s"><span class="pl-pds">"</span>DIVAnd<span class="pl-pds">"</span></span>)</pre></div>
<p dir="auto">All tests should pass without error (it can take several minutes).</p>
<div class="snippet-clipboard-content notranslate position-relative overflow-auto" data-snippet-clipboard-copy-content="INFO: Testing DIVAnd
Test Summary: | Pass  Total
  DIVAnd      |  461    461
INFO: DIVAnd tests passed"><pre class="notranslate"><code>INFO: Testing DIVAnd
Test Summary: | Pass  Total
  DIVAnd      |  461    461
INFO: DIVAnd tests passed
</code></pre></div>
<p dir="auto">The test suite will download some sample data.
You need to have Internet access and run the test function from a directory with write access.</p>
<h1 dir="auto"><a id="user-content-documentation" class="anchor" aria-hidden="true" href="#documentation"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a>Documentation</h1>
<p dir="auto">The main routine of this toolbox is called <code>DIVAnd</code> which performs an n-dimensional variational analysis of arbitrarily located observations. Type the following in Julia to view a list of parameters:</p>
<div class="highlight highlight-source-julia notranslate position-relative overflow-auto" dir="auto" data-snippet-clipboard-copy-content="using DIVAnd
?DIVAndrun"><pre><span class="pl-k">using</span> DIVAnd
?DIVAndrun</pre></div>
<p dir="auto">see also <a href="https://gher-uliege.github.io/DIVAnd.jl/latest/index.html" rel="nofollow">https://gher-uliege.github.io/DIVAnd.jl/latest/index.html</a></p>
<h2 dir="auto"><a id="user-content-example" class="anchor" aria-hidden="true" href="#example"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a>Example</h2>
<p dir="auto"><a href="https://github.com/gher-uliege/DIVAnd.jl/blob/master/examples/DIVAnd_simple_example_4D.jl">DIVAnd_simple_example_4D.jl</a> is a basic example in fours dimensions. The call to <code>DIVAndrun</code> looks like this:</p>
<div class="highlight highlight-source-julia notranslate position-relative overflow-auto" dir="auto" data-snippet-clipboard-copy-content="fi,s = DIVAndrun(mask,(pm,pn,po,pq),(xi,yi,zi,ti),(x,y,z,t),f,len,epsilon2);
"><pre>fi,s <span class="pl-k">=</span> <span class="pl-c1">DIVAndrun</span>(mask,(pm,pn,po,pq),(xi,yi,zi,ti),(x,y,z,t),f,len,epsilon2);
</pre></div>
<p dir="auto">where
<code>mask</code> is the land-sea mask, usually obtained from the bathymetry/topography,
<code>(pm,pn,po,pq)</code> is a <em>n</em>-element tuple (4 in this case) containing the scale factors of the grid,
<code>(xi,yi,zi,ti)</code> is a <em>n</em>-element tuple containing the coordinates of the final grid,
<code>(x,y,z,t)</code> is a <em>n</em>-element tuple containing the coordinates of the observations,
<code>f</code> is the data anomalies (with respect to a background field),
<code>len</code> is the correlation length and
<code>epsilon2</code> is the error variance of the observations.</p>
<p dir="auto">The call returns <code>fi</code>, the analyzed field on the grid <code>(xi,yi,zi,ti)</code>.</p>
<p dir="auto">More examples are available in the notebooks from the <a href="https://github.com/gher-uliege/Diva-Workshops">Diva Workshop</a>.</p>
<h2 dir="auto"><a id="user-content-note-on-which-analysis-function-to-use" class="anchor" aria-hidden="true" href="#note-on-which-analysis-function-to-use"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a>Note on which analysis function to use</h2>
<p dir="auto"><code>DIVAndrun</code> is the core analysis function in n dimensions. It does not know anything about the physical parameters or units you work with. Coordinates can also be very general. The only constraint is that the metrics <code>(pm,pn,po,...)</code> when multiplied by the corresponding length scales <code>len</code> lead to non-dimensional parameters. Furthermore the coordinates of the output grid <code>(xi,yi,zi,...)</code> need to have the same units as the observation coordinates <code>(x,y,z,...)</code>.</p>
<p dir="auto"><code>DIVAndfun</code> is a version with a minimal set of parameters (the coordinates and values of observations, i.e.  <code>(x,f)</code>, the remaining parameters being optional) and provides an interpolation <em>function</em> rather than an already gridded field.</p>
<p dir="auto"><code>diva3D</code> is a higher-level function specifically designed for climatological analysis of data on Earth, using longitude/latitude/depth/time coordinates and correlations length in meters. It makes the necessary preparation of metrics, parameter optimizations etc you normally would program yourself before calling the analysis function <code>DIVAndrun</code>.</p>
<p dir="auto"><code>DIVAnd_heatmap</code> can be used for additive data and produces Kernel Density Estimations.</p>
<p dir="auto"><code>DIVAndgo</code> is only needed for very large problems when a call to <code>DIVAndrun</code> leads to memory or CPU time problems. This function tries to decide which solver (direct or iterative) to use and how to make an automatic domain decomposition. Not all options from <code>DIVAndrun</code> are available.</p>
<p dir="auto">If you want to try out multivariate approaches, you can look at <code>DIVAnd_multivarEOF</code> and <code>DIVAnd_multivarJAC</code></p>
<h2 dir="auto"><a id="user-content-note-about-the-background-field" class="anchor" aria-hidden="true" href="#note-about-the-background-field"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a>Note about the background field</h2>
<p dir="auto">If zero is not a valid first guess for your variable (as it is the case for e.g. ocean temperature), you have to subtract the first guess from the observations before calling <code>DIVAnd</code> and then add the first guess back in.</p>
<h2 dir="auto"><a id="user-content-determining-the-analysis-parameters" class="anchor" aria-hidden="true" href="#determining-the-analysis-parameters"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a>Determining the analysis parameters</h2>
<p dir="auto">The parameter <code>epsilon2</code> and parameter <code>len</code> are crucial for the analysis.</p>
<p dir="auto"><code>epsilon2</code> corresponds to the inverse of the <a href="https://en.wikipedia.org/wiki/Signal-to-noise_ratio" rel="nofollow">signal-to-noise ratio</a>. <code>epsilon2</code> is the normalized variance of observation error (i.e. divided by the background error variance). Therefore, its value depends on how accurate and how representative the observations are.
<code>len</code> corresponds to the correlation length and the value of <code>len</code> can sometimes be determined by physical arguments. Note that there should be one correlation length per dimension of the analysis.</p>
<p dir="auto">One statistical way to determine the parameter(s) is to do a <a href="https://en.wikipedia.org/wiki/Cross-validation_%28statistics%29" rel="nofollow">cross-validation</a>.</p>
<ol dir="auto">
<li>choose, at random, a relatively small subset of observations (about 5%). This is the validation data set.</li>
<li>make the analysis without your validation data set</li>
<li>compare the analysis to your validation data set and compute the RMS difference</li>
<li>repeat steps 2 and 3 with different values of the parameters and try to minimize the RMS difference.</li>
</ol>
<p dir="auto">You can repeat all steps with a different validation data set to ensure that the optimal parameter values are robust.
Tools to help you are included in  (<a href="https://github.com/gher-uliege/DIVAnd.jl/blob/master/src/DIVAnd_cv.jl">DIVAnd_cv.jl</a>).</p>
<h2 dir="auto"><a id="user-content-note-about-the-error-fields" class="anchor" aria-hidden="true" href="#note-about-the-error-fields"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a>Note about the error fields</h2>
<p dir="auto"><code>DIVAnd</code> allows the calculation of the analysis error variance, scaled by the background error variance. Though it can be calculated "exactly" using the diagonal of the error covariance matrix s.P, it is generally too costly and approximations are provided. All of them are accessible as options via <code>DIVAnd_errormap</code> or you can let <code>DIVAnd</code> decide which version to use (possibly by specifying if you just need a quick estimate or a version closer the theoretical estimate) (see <a href="https://doi.org/10.1175/JTECH-D-13-00130.1" rel="nofollow">Beckers et al 2014</a> )</p>
<h2 dir="auto"><a id="user-content-advanced-usage" class="anchor" aria-hidden="true" href="#advanced-usage"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a>Advanced usage</h2>
<h3 dir="auto"><a id="user-content-additional-constraint" class="anchor" aria-hidden="true" href="#additional-constraint"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a>Additional constraint</h3>
<p dir="auto">An arbitrary number of additional quadratic constraints can be included to the cost function which should have the following form:</p>
<p dir="auto"><em>J</em>(<strong>x</strong>) = ∑<sub><em>i</em></sub> (<strong>C</strong><sub><em>i</em></sub> <strong>x</strong>  - <strong>z</strong><sub><em>i</em></sub>)ᵀ <strong>Q</strong><sub><em>i</em></sub><sup>-1</sup> (<strong>C</strong><sub><em>i</em></sub> <strong>x</strong> - <strong>z</strong><sub><em>i</em></sub>)</p>
<p dir="auto">For every constrain, a structure with the following fields is passed to <code>DIVAnd</code>:</p>
<ul dir="auto">
<li><code>yo</code>: the vector <strong>z</strong><sub><em>i</em></sub></li>
<li><code>H</code>: the matrix <strong>C</strong><sub><em>i</em></sub></li>
<li><code>R</code>: the matrix <strong>Q</strong><sub><em>i</em></sub> (symmetric and positive defined)</li>
</ul>
<p dir="auto">Internally the observations are also implemented as constraint defined in this way.</p>
<h3 dir="auto"><a id="user-content-additional-inequality-constraint" class="anchor" aria-hidden="true" href="#additional-inequality-constraint"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a>Additional inequality constraint</h3>
<p dir="auto">An arbitrary number of additional inequality constraints can be included and which should have the following form:</p>
<p dir="auto">(<strong>H</strong><sub><em>i</em></sub> <strong>x</strong>  &gt; <strong>yo</strong><sub><em>i</em></sub>)</p>
<p dir="auto">For every constraint, a structure with the following fields is passed to <code>DIVAnd</code>:</p>
<ul dir="auto">
<li><code>yo</code>: a vector</li>
<li><code>H</code>: a matrix</li>
</ul>
<h2 dir="auto"><a id="user-content-run-notebooks-on-a-server-which-has-no-graphical-interface" class="anchor" aria-hidden="true" href="#run-notebooks-on-a-server-which-has-no-graphical-interface"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a>Run notebooks on a server which has no graphical interface</h2>
<p dir="auto">On the server, launch the notebook with:</p>
<div class="highlight highlight-source-shell notranslate position-relative overflow-auto" dir="auto" data-snippet-clipboard-copy-content="jupyter-notebook --no-browser --ip='0.0.0.0' --port=8888"><pre>jupyter-notebook --no-browser --ip=<span class="pl-s"><span class="pl-pds">'</span>0.0.0.0<span class="pl-pds">'</span></span> --port=8888</pre></div>
<p dir="auto">where the path to <code>jupyter-notebook</code> might have to be adapted, depending on your installation. The <code>ip</code> and <code>port</code> parameters can also be modified.</p>
<p dir="auto">Then from the local machine it is possible to connect to the server through the browser.</p>
<p dir="auto">Thanks to Lennert and Bart (VLIZ) for this trick.</p>
<h1 dir="auto"><a id="user-content-example-data" class="anchor" aria-hidden="true" href="#example-data"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a>Example data</h1>
<p dir="auto">Some examples in <code>DIVAnd.jl</code> use a quite large data set which cannot be efficiently distributed through <code>git</code>. This data can be downloaded from the URL <a href="https://dox.ulg.ac.be/index.php/s/Bo01EicxnMgP9E3/download" rel="nofollow">https://dox.ulg.ac.be/index.php/s/Bo01EicxnMgP9E3/download</a>. The zip file should be decompressed and the directory <code>DIVAnd-example-data</code> should be placed on the same level than the directory <code>DIVAnd.jl</code>.</p>
<h1 dir="auto"><a id="user-content-reporting-issues" class="anchor" aria-hidden="true" href="#reporting-issues"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a>Reporting issues</h1>
<p dir="auto">Please include the following information when reporting an issue:</p>
<ul dir="auto">
<li>Version of Julia</li>
<li>Version of DIVAnd</li>
<li>Operating system</li>
<li>Full screen output preferably obtained by setting <code>ENV["JULIA_DEBUG"] = "DIVAnd"</code>.</li>
<li>Full stack strace with error message</li>
<li>A short description of the problem</li>
<li>The command and their arguments which produced the error</li>
</ul>
<p dir="auto">Note that only <a href="https://julialang.org/downloads/" rel="nofollow">official julia builds</a> are supported.</p>
<p dir="auto">In all cases, if we provide a tentative solution, please provide a feedback in all cases (whether it solved your issue or not).</p>
<h1 dir="auto"><a id="user-content-fun" class="anchor" aria-hidden="true" href="#fun"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a>Fun</h1>
<p dir="auto">An <a href="http://data-assimilation.net/Tools/divand_demo/html/" rel="nofollow">educational web application</a> has been developed to reconstruct a field based on point "observations". The user must choose in an optimal way the location of 10 observations such that the analysed field obtained by <code>DIVAnd</code> based on these observations is as close as possible to the original field.</p>
<h1 dir="auto"><a id="user-content-you-do-not-want-to-use-julia" class="anchor" aria-hidden="true" href="#you-do-not-want-to-use-julia"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a>You do not want to use Julia</h1>
<p dir="auto">You should really reconsider and try out Julia. It is easy to use and provides the native interface to <code>DIVAnd</code>.</p>
<p dir="auto">If you have a stable workflow using python, into which you want to integrate <code>DIVAnd</code>, you might try</p>
<p dir="auto"><a href="https://github.com/gher-uliege/DIVAnd.py">https://github.com/gher-uliege/DIVAnd.py</a></p>
</article></div>