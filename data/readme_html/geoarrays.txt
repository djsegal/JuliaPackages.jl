<div id="readme" class="md" data-path="README.md"><article class="markdown-body entry-content" itemprop="text"><p><a href="https://evetion.github.io/GeoArrays.jl/" rel="nofollow"><img src="https://camo.githubusercontent.com/f7b92a177c912c1cc007fc9b40f17ff3ee3bb414/68747470733a2f2f696d672e736869656c64732e696f2f62616467652f646f63732d737461626c652d626c75652e737667" alt="" data-canonical-src="https://img.shields.io/badge/docs-stable-blue.svg" style="max-width:100%;"></a> <a href="https://travis-ci.org/evetion/GeoArrays.jl" rel="nofollow"><img src="https://camo.githubusercontent.com/18b5c5d482bc23f9d83a412fa4321c570a222b11/68747470733a2f2f7472617669732d63692e6f72672f65766574696f6e2f47656f4172726179732e6a6c2e7376673f6272616e63683d6d6173746572" alt="Build Status" data-canonical-src="https://travis-ci.org/evetion/GeoArrays.jl.svg?branch=master" style="max-width:100%;"></a> <a href="https://ci.appveyor.com/project/evetion/GeoArrays-jl" rel="nofollow"><img src="https://camo.githubusercontent.com/461abec63bf514e7172be19152c7f3c24f1c93e5/68747470733a2f2f63692e6170707665796f722e636f6d2f6170692f70726f6a656374732f7374617475732f73686b36616f636b346838306364376a3f7376673d74727565" alt="Build status" data-canonical-src="https://ci.appveyor.com/api/projects/status/shk6aock4h80cd7j?svg=true" style="max-width:100%;"></a> <a href="https://codecov.io/gh/evetion/GeoArrays.jl" rel="nofollow"><img src="https://camo.githubusercontent.com/66c85638923ae2f8171e012bd50156b32ef16d0f/68747470733a2f2f636f6465636f762e696f2f67682f65766574696f6e2f47656f4172726179732e6a6c2f6272616e63682f6d61737465722f67726170682f62616467652e737667" alt="codecov" data-canonical-src="https://codecov.io/gh/evetion/GeoArrays.jl/branch/master/graph/badge.svg" style="max-width:100%;"></a></p>
<h1><a id="user-content-geoarrays" class="anchor" aria-hidden="true" href="#geoarrays"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>GeoArrays</h1>
<p>Simple geographical raster interaction built on top of <a href="https://github.com/yeesian/ArchGDAL.jl/">ArchGDAL</a>, <a href="https://github.com/JuliaGeo/GDAL.jl">GDAL</a> and <a href="https://github.com/FugroRoames/CoordinateTransformations.jl">CoordinateTransformations</a>.</p>
<p>A GeoArray is an AbstractArray, an AffineMap for calculating coordinates based on the axes and a CRS definition to interpret these coordinates into in the real world. It's three dimensional and can be seen as a stack (3d) of 2d geospatial rasters (bands), the dimensions are :x, :y, and :bands. The AffineMap and CRS (coordinates) only operate on the :x and :y dimensions.</p>
<p>This packages takes its inspiration from Python's <a href="https://github.com/mapbox/rasterio">rasterio</a>.</p>
<h2><a id="user-content-installation" class="anchor" aria-hidden="true" href="#installation"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Installation</h2>
<div class="highlight highlight-source-julia"><pre>(v1<span class="pl-c1">.4</span>) pkg<span class="pl-k">&gt;</span> add GeoArrays</pre></div>
<h2><a id="user-content-examples" class="anchor" aria-hidden="true" href="#examples"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Examples</h2>
<h4><a id="user-content-basic-usage" class="anchor" aria-hidden="true" href="#basic-usage"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Basic Usage</h4>
<div class="highlight highlight-source-julia"><pre>julia<span class="pl-k">&gt;</span> <span class="pl-k">using</span> GeoArrays

<span class="pl-c"><span class="pl-c">#</span> Read TIF file</span>
julia<span class="pl-k">&gt;</span> fn <span class="pl-k">=</span> <span class="pl-c1">download</span>(<span class="pl-s"><span class="pl-pds">"</span>https://github.com/yeesian/ArchGDALDatasets/blob/master/data/utmsmall.tif?raw=true<span class="pl-pds">"</span></span>)
julia<span class="pl-k">&gt;</span> geoarray <span class="pl-k">=</span> GeoArrays<span class="pl-k">.</span><span class="pl-c1">read</span>(fn)
<span class="pl-c1">100</span>x100x1 Array{UInt8,<span class="pl-c1">3</span>} with <span class="pl-c1">AffineMap</span>([<span class="pl-c1">60.0</span> <span class="pl-c1">0.0</span>; <span class="pl-c1">0.0</span> <span class="pl-k">-</span><span class="pl-c1">60.0</span>], [<span class="pl-c1">440720.0</span>, <span class="pl-c1">3.75132e6</span>]) and CRS PROJCS[<span class="pl-s"><span class="pl-pds">"</span>NAD27 / UTM zone 11N<span class="pl-pds">"</span></span><span class="pl-k">...</span>

<span class="pl-c"><span class="pl-c">#</span> Affinemap containing offset and scaling</span>
julia<span class="pl-k">&gt;</span> geoarray<span class="pl-k">.</span>f
<span class="pl-c1">AffineMap</span>([<span class="pl-c1">60.0</span> <span class="pl-c1">0.0</span>; <span class="pl-c1">0.0</span> <span class="pl-k">-</span><span class="pl-c1">60.0</span>], [<span class="pl-c1">440720.0</span>, <span class="pl-c1">3.75132e6</span>])

<span class="pl-c"><span class="pl-c">#</span> WKT projection string</span>
julia<span class="pl-k">&gt;</span> geoarray<span class="pl-k">.</span>crs
GeoFormatTypes<span class="pl-k">.</span><span class="pl-c1">WellKnownText</span><span class="pl-c1">{GeoFormatTypes.CRS,String}</span>(GeoFormatTypes<span class="pl-k">.</span><span class="pl-c1">CRS</span>(), <span class="pl-s"><span class="pl-pds">"</span>PROJCS[<span class="pl-cce">\"</span>NAD27 / UTM zone 11N<span class="pl-cce">\"</span>,GEOGCS[<span class="pl-cce">\"</span>NAD27<span class="pl-cce">\"</span>,DATUM[<span class="pl-cce">\"</span>North_American_Datum_1927<span class="pl-cce">\"</span>,SPHEROID[<span class="pl-cce">\"</span>Clarke 1866<span class="pl-cce">\"</span>,6378206.4,294.978698213898,AUTHORITY[<span class="pl-cce">\"</span>EPSG<span class="pl-cce">\"</span>,<span class="pl-cce">\"</span>7008<span class="pl-cce">\"</span>]],AUTHORITY[<span class="pl-cce">\"</span>EPSG<span class="pl-cce">\"</span>,<span class="pl-cce">\"</span>6267<span class="pl-cce">\"</span>]],PRIMEM[<span class="pl-cce">\"</span>Greenwich<span class="pl-cce">\"</span>,0],UNIT[<span class="pl-cce">\"</span>degree<span class="pl-cce">\"</span>,0.0174532925199433,AUTHORITY[<span class="pl-cce">\"</span>EPSG<span class="pl-cce">\"</span>,<span class="pl-cce">\"</span>9122<span class="pl-cce">\"</span>]],AUTHORITY[<span class="pl-cce">\"</span>EPSG<span class="pl-cce">\"</span>,<span class="pl-cce">\"</span>4267<span class="pl-cce">\"</span>]],PROJECTION[<span class="pl-cce">\"</span>Transverse_Mercator<span class="pl-cce">\"</span>],PARAMETER[<span class="pl-cce">\"</span>latitude_of_origin<span class="pl-cce">\"</span>,0],PARAMETER[<span class="pl-cce">\"</span>central_meridian<span class="pl-cce">\"</span>,-117],PARAMETER[<span class="pl-cce">\"</span>scale_factor<span class="pl-cce">\"</span>,0.9996],PARAMETER[<span class="pl-cce">\"</span>false_easting<span class="pl-cce">\"</span>,500000],PARAMETER[<span class="pl-cce">\"</span>false_northing<span class="pl-cce">\"</span>,0],UNIT[<span class="pl-cce">\"</span>metre<span class="pl-cce">\"</span>,1,AUTHORITY[<span class="pl-cce">\"</span>EPSG<span class="pl-cce">\"</span>,<span class="pl-cce">\"</span>9001<span class="pl-cce">\"</span>]],AXIS[<span class="pl-cce">\"</span>Easting<span class="pl-cce">\"</span>,EAST],AXIS[<span class="pl-cce">\"</span>Northing<span class="pl-cce">\"</span>,NORTH],AUTHORITY[<span class="pl-cce">\"</span>EPSG<span class="pl-cce">\"</span>,<span class="pl-cce">\"</span>26711<span class="pl-cce">\"</span>]]<span class="pl-pds">"</span></span>)

<span class="pl-c"><span class="pl-c">#</span> Create, reference and write a TIFF</span>
julia<span class="pl-k">&gt;</span> ga <span class="pl-k">=</span> <span class="pl-c1">GeoArray</span>(<span class="pl-c1">rand</span>(<span class="pl-c1">100</span>,<span class="pl-c1">200</span>))
julia<span class="pl-k">&gt;</span> <span class="pl-c1">bbox!</span>(ga, (min_x<span class="pl-k">=</span><span class="pl-c1">2.</span>, min_y<span class="pl-k">=</span><span class="pl-c1">51.</span>, max_x<span class="pl-k">=</span><span class="pl-c1">5.</span>, max_y<span class="pl-k">=</span><span class="pl-c1">54.</span>))  <span class="pl-c"><span class="pl-c">#</span> roughly the Netherlands</span>
julia<span class="pl-k">&gt;</span> <span class="pl-c1">epsg!</span>(ga, <span class="pl-c1">4326</span>)  <span class="pl-c"><span class="pl-c">#</span> in WGS84</span>
julia<span class="pl-k">&gt;</span> GeoArrays<span class="pl-k">.</span><span class="pl-c1">write!</span>(<span class="pl-s"><span class="pl-pds">"</span>test.tif<span class="pl-pds">"</span></span>, ga)</pre></div>
<h4><a id="user-content-using-coordinates" class="anchor" aria-hidden="true" href="#using-coordinates"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Using coordinates</h4>
<div class="highlight highlight-source-julia"><pre><span class="pl-c"><span class="pl-c">#</span> Find coordinates by index</span>
julia<span class="pl-k">&gt;</span> <span class="pl-c1">coords</span>(geoarray, [<span class="pl-c1">1</span>,<span class="pl-c1">1</span>])
<span class="pl-c1">2</span><span class="pl-k">-</span>element StaticArrays<span class="pl-k">.</span>SArray{Tuple{<span class="pl-c1">2</span>},Float64,<span class="pl-c1">1</span>,<span class="pl-c1">2</span>}<span class="pl-k">:</span>
 <span class="pl-c1">440720.0</span>
      <span class="pl-c1">3.75132e6</span>

<span class="pl-c"><span class="pl-c">#</span> Find index by coordinates</span>
julia<span class="pl-k">&gt;</span> <span class="pl-c1">indices</span>(geoarray, [<span class="pl-c1">440720.0</span>, <span class="pl-c1">3.75132e6</span>])
<span class="pl-c1">2</span><span class="pl-k">-</span>element StaticArrays<span class="pl-k">.</span>SArray{Tuple{<span class="pl-c1">2</span>},Int64,<span class="pl-c1">1</span>,<span class="pl-c1">2</span>}<span class="pl-k">:</span>
 <span class="pl-c1">1</span>
 <span class="pl-c1">1</span>

<span class="pl-c"><span class="pl-c">#</span> Find all coordinates</span>
julia<span class="pl-k">&gt;</span> <span class="pl-c1">coords</span>(geoarray)
<span class="pl-c1">101</span><span class="pl-k">Ã—</span><span class="pl-c1">101</span> Array{StaticArrays<span class="pl-k">.</span>SArray{Tuple{<span class="pl-c1">2</span>},Float64,<span class="pl-c1">1</span>,<span class="pl-c1">2</span>},<span class="pl-c1">2</span>}<span class="pl-k">:</span>
 [<span class="pl-c1">440720.0</span>, <span class="pl-c1">3.75132e6</span>]  [<span class="pl-c1">440720.0</span>, <span class="pl-c1">3.75126e6</span>]  [<span class="pl-c1">440720.0</span>, <span class="pl-c1">3.7512e6</span>] <span class="pl-k">...</span>
 <span class="pl-k">...</span></pre></div>
<h4><a id="user-content-manipulation" class="anchor" aria-hidden="true" href="#manipulation"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Manipulation</h4>
<div class="highlight highlight-source-julia"><pre><span class="pl-c"><span class="pl-c">#</span> Translate complete raster by x + 100</span>
julia<span class="pl-k">&gt;</span> trans <span class="pl-k">=</span> <span class="pl-c1">Translation</span>(<span class="pl-c1">100</span>, <span class="pl-c1">0</span>)
julia<span class="pl-k">&gt;</span> <span class="pl-c1">compose!</span>(ga, trans)


<span class="pl-c"><span class="pl-c">#</span> Math with GeoArrays (- + * /)</span>
julia<span class="pl-k">&gt;</span> <span class="pl-c1">GeoArray</span>(<span class="pl-c1">rand</span>(<span class="pl-c1">5</span>,<span class="pl-c1">5</span>,<span class="pl-c1">1</span>)) <span class="pl-k">-</span> <span class="pl-c1">GeoArray</span>(<span class="pl-c1">rand</span>(<span class="pl-c1">5</span>,<span class="pl-c1">5</span>,<span class="pl-c1">1</span>))
<span class="pl-c1">5</span>x5x1 Array{Float64,<span class="pl-c1">3</span>} with <span class="pl-c1">AffineMap</span>([<span class="pl-c1">1.0</span> <span class="pl-c1">0.0</span>; <span class="pl-c1">0.0</span> <span class="pl-c1">1.0</span>], [<span class="pl-c1">0.0</span>, <span class="pl-c1">0.0</span>]) and undefined CRS</pre></div>
<h4><a id="user-content-interpolation" class="anchor" aria-hidden="true" href="#interpolation"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Interpolation</h4>
<div class="highlight highlight-source-julia"><pre>julia<span class="pl-k">&gt;</span> <span class="pl-k">using</span> InverseDistanceWeighting  <span class="pl-c"><span class="pl-c">#</span> or any solver from the GeoStats ecosystem</span>
julia<span class="pl-k">&gt;</span> ga <span class="pl-k">=</span> <span class="pl-c1">GeoArray</span>(<span class="pl-c1">Array</span><span class="pl-c1">{Union{Missing, Float64}}</span>(<span class="pl-c1">rand</span>(<span class="pl-c1">5</span>, <span class="pl-c1">1</span>)))
julia<span class="pl-k">&gt;</span> ga<span class="pl-k">.</span>A[<span class="pl-c1">2</span>,<span class="pl-c1">1</span>] <span class="pl-k">=</span> <span class="pl-c1">missing</span>
[:, :, <span class="pl-c1">1</span>] <span class="pl-k">=</span>
 <span class="pl-c1">0.6760718768442127</span>
  <span class="pl-c1">missing</span>
 <span class="pl-c1">0.852882193026649</span>
 <span class="pl-c1">0.7137410453351622</span>
 <span class="pl-c1">0.5949409082233854</span>
julia<span class="pl-k">&gt;</span> GeoArrays<span class="pl-k">.</span><span class="pl-c1">interpolate!</span>(ga, <span class="pl-c1">InvDistWeight</span>(<span class="pl-c1">:z</span> <span class="pl-k">=&gt;</span> (neighbors<span class="pl-k">=</span><span class="pl-c1">3</span>,)))
[:, :, <span class="pl-c1">1</span>] <span class="pl-k">=</span>
 <span class="pl-c1">0.6760718768442127</span>
 <span class="pl-c1">0.7543298370153771</span>
 <span class="pl-c1">0.852882193026649</span>
 <span class="pl-c1">0.7137410453351622</span>
 <span class="pl-c1">0.5949409082233854</span></pre></div>
<h4><a id="user-content-plotting" class="anchor" aria-hidden="true" href="#plotting"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Plotting</h4>
<div class="highlight highlight-source-julia"><pre><span class="pl-c"><span class="pl-c">#</span> Plot a GeoArray</span>
julia<span class="pl-k">&gt;</span> <span class="pl-k">using</span> Plots
julia<span class="pl-k">&gt;</span> fn <span class="pl-k">=</span> <span class="pl-c1">download</span>(<span class="pl-s"><span class="pl-pds">"</span>https://github.com/yeesian/ArchGDALDatasets/blob/master/pyrasterio/RGB.byte.tif?raw=true<span class="pl-pds">"</span></span>)
julia<span class="pl-k">&gt;</span> ga <span class="pl-k">=</span> GeoArrays<span class="pl-k">.</span><span class="pl-c1">read</span>(fn)
julia<span class="pl-k">&gt;</span> <span class="pl-c1">plot</span>(ga)

<span class="pl-c"><span class="pl-c">#</span> or plot a band other than the first one</span>
julia<span class="pl-k">&gt;</span> <span class="pl-c1">plot</span>(ga, band<span class="pl-k">=</span><span class="pl-c1">2</span>)</pre></div>
<p><a target="_blank" rel="noopener noreferrer" href="docs/img/RGB.byte.png"><img src="docs/img/RGB.byte.png" alt="example plot" style="max-width:100%;"></a></p>
</article></div>