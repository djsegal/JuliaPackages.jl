<div id="readme" class="md" data-path="README.md"><article class="markdown-body entry-content container-lg" itemprop="text"><h1><a id="user-content-pkgserverloganalysisjl" class="anchor" aria-hidden="true" href="#pkgserverloganalysisjl"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>PkgServerLogAnalysis.jl</h1>
<p>First off, to use these processing routines, you'll need access to the logs.  If you've already gotten the requisite SSH access to the PkgServers correctly, then <code>sync_logs.jl</code> will connect to them just fine.  If not, you can test new analysis passes on the test data contained within the test suite, stored within an artifact in this repository.  See <code>bin/load_test_data.jl</code> for an example oof how to load that test data.  The test data is generated through applying <code>bin/anonymize_log.jl</code> to a real logfile.</p>
<p>The logs are stored in separate log files per day, per server, <a href="https://github.com/JuliaPackaging/PkgServerS3Mirror/blob/master/logrotate.conf">collated by <code>logrotate</code></a> on each individual server.  <code>sync_logs.jl</code> transfers the compressed gzip archives of each day's logs, and <code>parse_logfiles()</code> reads them in with a giant regex to parse out relevant pieces of information.  Because parsing is fairly expensive, we cache the parse results in compressed <code>.csvz</code> files, stored in a scratch space.</p>
<p>Right now, there is a single main analysis script stored in <code>bin</code>, <code>package_hits_by_day.jl</code>.  It's a <a href="https://github.com/fonsp/Pluto.jl"><code>Pluto.jl</code></a> notebook, I suggest running it inside of a <code>Pluto</code> session with multiple threads, to improve parsing efficiency via <code>Pluto.run(;threads="8")</code> or so.  Future decisions will solidify the contract of analysis passes, and determine the best way to present it to the world.</p>
</article></div>