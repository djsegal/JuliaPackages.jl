<div id="readme" class="md" data-path="README.md"><article class="markdown-body entry-content" itemprop="text"><h1><a id="user-content-sqlquery" class="anchor" aria-hidden="true" href="#sqlquery"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>SQLQuery</h1>
<p>A package for representing sql queries, and converting them to valid SQL
statements. The generated SQL statements follow the specification in
<a href="https://www.sqlite.org/lang_select.html" rel="nofollow">https://www.sqlite.org/lang_select.html</a>, and should conform to
<a href="http://www.sqlstyle.guide/" rel="nofollow">http://www.sqlstyle.guide/</a> as far as possible.</p>
<p>This package is currently under development and is not registered.</p>
<p>It allows for user-defined verbs (e.g. to capture common SQL idioms) that composes well with the rest of the verbs provided here. It is the intention of this package to allow for further customizations (e.g. different string or identifier quotes, or to recognize <a href="http://www.gaia-gis.it/gaia-sins/spatialite-sql-4.3.0.html" rel="nofollow">additional functions</a> for different backends).</p>
<div class="highlight highlight-source-julia"><pre>  <span class="pl-k">|</span> <span class="pl-k">|</span> <span class="pl-k">|</span>_<span class="pl-k">|</span> <span class="pl-k">|</span> <span class="pl-k">|</span> <span class="pl-k">|</span> (_<span class="pl-k">|</span> <span class="pl-k">|</span>  <span class="pl-k">|</span>  Version <span class="pl-c1">0.5.0</span><span class="pl-k">-</span>rc1<span class="pl-k">+</span><span class="pl-c1">1</span> (<span class="pl-c1">2016</span><span class="pl-k">-</span><span class="pl-c1">08</span><span class="pl-k">-</span><span class="pl-c1">05</span> <span class="pl-c1">15</span><span class="pl-k">:</span><span class="pl-c1">23</span> UTC)
 _<span class="pl-k">/</span> <span class="pl-k">|</span><span class="pl-k">\</span>__<span class="pl-k">'</span>_<span class="pl-k">|</span>_<span class="pl-k">|</span>_<span class="pl-k">|</span><span class="pl-k">\</span>__<span class="pl-k">'</span>_<span class="pl-k">|</span>  <span class="pl-k">|</span>  Commit acfd04c (<span class="pl-c1">9</span> days old release<span class="pl-k">-</span><span class="pl-c1">0.5</span>)
<span class="pl-k">|</span>__<span class="pl-k">/</span>                   <span class="pl-k">|</span>  x86_64<span class="pl-k">-</span>apple<span class="pl-k">-</span>darwin13<span class="pl-c1">.4.0</span>

julia<span class="pl-k">&gt;</span> <span class="pl-k">using</span> SQLQuery

julia<span class="pl-k">&gt;</span> type NewNode{T} <span class="pl-k">&lt;:</span> <span class="pl-c1">SQLQuery.QueryNode</span>
           input<span class="pl-k">::</span><span class="pl-c1">T</span>
           args
       <span class="pl-k">end</span>

julia<span class="pl-k">&gt;</span> SQLQuery<span class="pl-k">.</span>QUERYNODE[<span class="pl-c1">:newnode</span>] <span class="pl-k">=</span> NewNode
NewNode{T}

julia<span class="pl-k">&gt;</span> SQLQuery<span class="pl-k">.</span><span class="pl-en">translatesql</span>(nn<span class="pl-k">::</span><span class="pl-c1">NewNode</span>, offset<span class="pl-k">::</span><span class="pl-c1">Int</span>) <span class="pl-k">=</span> <span class="pl-s"><span class="pl-pds">"</span>newnode, offset=<span class="pl-v">$offset</span><span class="pl-pds">"</span></span>

julia<span class="pl-k">&gt;</span> <span class="pl-c1">@sqlquery</span> source <span class="pl-k">|&gt;</span> <span class="pl-c1">newnode</span>(are, you<span class="pl-k">.</span>serious) <span class="pl-k">|&gt;</span> <span class="pl-c1">select</span>(<span class="pl-k">*</span>, some, columns)
SELECT <span class="pl-k">*</span>,
       some,
       columns
  FROM (newnode, offset<span class="pl-k">=</span><span class="pl-c1">8</span>)</pre></div>
<p>Some other examples:</p>
<div class="highlight highlight-source-julia"><pre>  <span class="pl-k">|</span> <span class="pl-k">|</span> <span class="pl-k">|</span>_<span class="pl-k">|</span> <span class="pl-k">|</span> <span class="pl-k">|</span> <span class="pl-k">|</span> (_<span class="pl-k">|</span> <span class="pl-k">|</span>  <span class="pl-k">|</span>  Version <span class="pl-c1">0.5.0</span><span class="pl-k">-</span>rc1<span class="pl-k">+</span><span class="pl-c1">1</span> (<span class="pl-c1">2016</span><span class="pl-k">-</span><span class="pl-c1">08</span><span class="pl-k">-</span><span class="pl-c1">05</span> <span class="pl-c1">15</span><span class="pl-k">:</span><span class="pl-c1">23</span> UTC)
 _<span class="pl-k">/</span> <span class="pl-k">|</span><span class="pl-k">\</span>__<span class="pl-k">'</span>_<span class="pl-k">|</span>_<span class="pl-k">|</span>_<span class="pl-k">|</span><span class="pl-k">\</span>__<span class="pl-k">'</span>_<span class="pl-k">|</span>  <span class="pl-k">|</span>  Commit acfd04c (<span class="pl-c1">10</span> days old release<span class="pl-k">-</span><span class="pl-c1">0.5</span>)
<span class="pl-k">|</span>__<span class="pl-k">/</span>                   <span class="pl-k">|</span>  x86_64<span class="pl-k">-</span>apple<span class="pl-k">-</span>darwin13<span class="pl-c1">.4.0</span>

julia<span class="pl-k">&gt;</span> <span class="pl-k">using</span> SQLQuery

julia<span class="pl-k">&gt;</span> <span class="pl-c1">@sqlquery</span> source <span class="pl-k">|&gt;</span>
       <span class="pl-c1">filter</span>(name <span class="pl-k">==</span> <span class="pl-c1">3</span>, bar <span class="pl-k">==</span> <span class="pl-s"><span class="pl-pds">"</span>whee<span class="pl-pds">"</span></span>)
SELECT <span class="pl-k">*</span>
  FROM source
 WHERE name <span class="pl-k">==</span> <span class="pl-c1">3</span>
   AND bar <span class="pl-k">==</span> <span class="pl-s"><span class="pl-pds">"</span>whee<span class="pl-pds">"</span></span>

julia<span class="pl-k">&gt;</span> <span class="pl-c1">@sqlquery</span> source <span class="pl-k">|&gt;</span>
       <span class="pl-c1">filter</span>(name <span class="pl-k">==</span> <span class="pl-c1">3</span>, bar <span class="pl-k">==</span> <span class="pl-s"><span class="pl-pds">"</span>whee<span class="pl-pds">"</span></span>) <span class="pl-k">|&gt;</span>
       <span class="pl-c1">select</span>(name <span class="pl-k">=</span> foo <span class="pl-k">*</span> <span class="pl-c1">3</span>, col)
SELECT foo <span class="pl-k">*</span> <span class="pl-c1">3</span> AS name,
       col
  FROM (SELECT <span class="pl-k">*</span>
          FROM source
         WHERE name <span class="pl-k">==</span> <span class="pl-c1">3</span>
           AND bar <span class="pl-k">==</span> <span class="pl-s"><span class="pl-pds">"</span>whee<span class="pl-pds">"</span></span>)

julia<span class="pl-k">&gt;</span> <span class="pl-c1">@sqlquery</span> source <span class="pl-k">|&gt;</span>
       <span class="pl-c1">filter</span>(name <span class="pl-k">==</span> <span class="pl-c1">3</span>, bar <span class="pl-k">==</span> <span class="pl-s"><span class="pl-pds">"</span>whee<span class="pl-pds">"</span></span>) <span class="pl-k">|&gt;</span>
       <span class="pl-c1">distinct</span>(name <span class="pl-k">=</span> foo <span class="pl-k">*</span> <span class="pl-c1">3</span>, col)
SELECT DISTINCT foo <span class="pl-k">*</span> <span class="pl-c1">3</span> AS name,
                col
  FROM (SELECT <span class="pl-k">*</span>
          FROM source
         WHERE name <span class="pl-k">==</span> <span class="pl-c1">3</span>
           AND bar <span class="pl-k">==</span> <span class="pl-s"><span class="pl-pds">"</span>whee<span class="pl-pds">"</span></span>)

julia<span class="pl-k">&gt;</span> <span class="pl-c1">@sqlquery</span> source <span class="pl-k">|&gt;</span>
       <span class="pl-c1">filter</span>(name <span class="pl-k">==</span> <span class="pl-c1">3</span>, bar <span class="pl-k">==</span> <span class="pl-s"><span class="pl-pds">"</span>whee<span class="pl-pds">"</span></span>) <span class="pl-k">|&gt;</span>
       <span class="pl-c1">select</span>(name <span class="pl-k">=</span> foo <span class="pl-k">*</span> <span class="pl-c1">3</span>, col)
SELECT foo <span class="pl-k">*</span> <span class="pl-c1">3</span> AS name,
       col
  FROM (SELECT <span class="pl-k">*</span>
          FROM source
         WHERE name <span class="pl-k">==</span> <span class="pl-c1">3</span>
           AND bar <span class="pl-k">==</span> <span class="pl-s"><span class="pl-pds">"</span>whee<span class="pl-pds">"</span></span>)

julia<span class="pl-k">&gt;</span> <span class="pl-c1">@sqlquery</span> source <span class="pl-k">|&gt;</span>
       <span class="pl-c1">filter</span>(name <span class="pl-k">==</span> <span class="pl-c1">3</span>, bar <span class="pl-k">==</span> <span class="pl-s"><span class="pl-pds">"</span>whee<span class="pl-pds">"</span></span>) <span class="pl-k">|&gt;</span>
       <span class="pl-c1">select</span>(<span class="pl-k">*</span>)
SELECT <span class="pl-k">*</span>
  FROM (SELECT <span class="pl-k">*</span>
          FROM source
         WHERE name <span class="pl-k">==</span> <span class="pl-c1">3</span>
           AND bar <span class="pl-k">==</span> <span class="pl-s"><span class="pl-pds">"</span>whee<span class="pl-pds">"</span></span>)

julia<span class="pl-k">&gt;</span> <span class="pl-c1">@sqlquery</span> source <span class="pl-k">|&gt;</span>
       <span class="pl-c1">filter</span>(name <span class="pl-k">==</span> <span class="pl-c1">3</span>, bar <span class="pl-k">==</span> <span class="pl-s"><span class="pl-pds">"</span>whee<span class="pl-pds">"</span></span>) <span class="pl-k">|&gt;</span>
       <span class="pl-c1">distinct</span>(<span class="pl-k">*</span>)
SELECT DISTINCT <span class="pl-k">*</span>
  FROM (SELECT <span class="pl-k">*</span>
          FROM source
         WHERE name <span class="pl-k">==</span> <span class="pl-c1">3</span>
           AND bar <span class="pl-k">==</span> <span class="pl-s"><span class="pl-pds">"</span>whee<span class="pl-pds">"</span></span>)

julia<span class="pl-k">&gt;</span> <span class="pl-c1">@sqlquery</span> source <span class="pl-k">|&gt;</span>
       <span class="pl-c1">filter</span>(name <span class="pl-k">==</span> <span class="pl-c1">3</span>, bar <span class="pl-k">==</span> <span class="pl-s"><span class="pl-pds">"</span>whee<span class="pl-pds">"</span></span>) <span class="pl-k">|&gt;</span>
       <span class="pl-c1">distinct</span>(col)
SELECT DISTINCT col
  FROM (SELECT <span class="pl-k">*</span>
          FROM source
         WHERE name <span class="pl-k">==</span> <span class="pl-c1">3</span>
           AND bar <span class="pl-k">==</span> <span class="pl-s"><span class="pl-pds">"</span>whee<span class="pl-pds">"</span></span>)

julia<span class="pl-k">&gt;</span> <span class="pl-c1">@sqlquery</span> source <span class="pl-k">|&gt;</span>
       <span class="pl-c1">filter</span>(name <span class="pl-k">==</span> <span class="pl-c1">3</span>, bar <span class="pl-k">==</span> <span class="pl-s"><span class="pl-pds">"</span>whee<span class="pl-pds">"</span></span>) <span class="pl-k">|&gt;</span>
       <span class="pl-c1">select</span>(name <span class="pl-k">=</span> foo <span class="pl-k">*</span> <span class="pl-c1">3</span>, col) <span class="pl-k">|&gt;</span>
       <span class="pl-c1">orderby</span>(name)
  SELECT <span class="pl-k">*</span>
    FROM (SELECT foo <span class="pl-k">*</span> <span class="pl-c1">3</span> AS name,
                 col
            FROM (SELECT <span class="pl-k">*</span>
                    FROM source
                   WHERE name <span class="pl-k">==</span> <span class="pl-c1">3</span>
                     AND bar <span class="pl-k">==</span> <span class="pl-s"><span class="pl-pds">"</span>whee<span class="pl-pds">"</span></span>))
ORDER BY name

julia<span class="pl-k">&gt;</span> <span class="pl-c1">@sqlquery</span> source <span class="pl-k">|&gt;</span>
       <span class="pl-c1">filter</span>(name <span class="pl-k">==</span> <span class="pl-c1">3</span>, bar <span class="pl-k">==</span> <span class="pl-s"><span class="pl-pds">"</span>whee<span class="pl-pds">"</span></span>) <span class="pl-k">|&gt;</span>
       <span class="pl-c1">select</span>(name <span class="pl-k">=</span> foo <span class="pl-k">*</span> <span class="pl-c1">3</span>, col) <span class="pl-k">|&gt;</span>
       <span class="pl-c1">orderby</span>(name, col)
  SELECT <span class="pl-k">*</span>
    FROM (SELECT foo <span class="pl-k">*</span> <span class="pl-c1">3</span> AS name,
                 col
            FROM (SELECT <span class="pl-k">*</span>
                    FROM source
                   WHERE name <span class="pl-k">==</span> <span class="pl-c1">3</span>
                     AND bar <span class="pl-k">==</span> <span class="pl-s"><span class="pl-pds">"</span>whee<span class="pl-pds">"</span></span>))
ORDER BY name,
         col

julia<span class="pl-k">&gt;</span> <span class="pl-c1">@sqlquery</span> source <span class="pl-k">|&gt;</span>
       <span class="pl-c1">filter</span>(name <span class="pl-k">==</span> <span class="pl-c1">3</span>, bar <span class="pl-k">==</span> <span class="pl-s"><span class="pl-pds">"</span>whee<span class="pl-pds">"</span></span>) <span class="pl-k">|&gt;</span>
       <span class="pl-c1">select</span>(name <span class="pl-k">=</span> foo <span class="pl-k">*</span> <span class="pl-c1">3</span>, col) <span class="pl-k">|&gt;</span>
       <span class="pl-c1">orderby</span>(<span class="pl-c1">desc</span>(name))
  SELECT <span class="pl-k">*</span>
    FROM (SELECT foo <span class="pl-k">*</span> <span class="pl-c1">3</span> AS name,
                 col
            FROM (SELECT <span class="pl-k">*</span>
                    FROM source
                   WHERE name <span class="pl-k">==</span> <span class="pl-c1">3</span>
                     AND bar <span class="pl-k">==</span> <span class="pl-s"><span class="pl-pds">"</span>whee<span class="pl-pds">"</span></span>))
ORDER BY name DESC

julia<span class="pl-k">&gt;</span> <span class="pl-c1">@sqlquery</span> source <span class="pl-k">|&gt;</span>
       <span class="pl-c1">filter</span>(name <span class="pl-k">==</span> <span class="pl-c1">3</span>, bar <span class="pl-k">==</span> <span class="pl-s"><span class="pl-pds">"</span>whee<span class="pl-pds">"</span></span>) <span class="pl-k">|&gt;</span>
       <span class="pl-c1">select</span>(name <span class="pl-k">=</span> foo <span class="pl-k">*</span> <span class="pl-c1">3</span>, col) <span class="pl-k">|&gt;</span>
       <span class="pl-c1">orderby</span>(name, <span class="pl-c1">desc</span>(col))
  SELECT <span class="pl-k">*</span>
    FROM (SELECT foo <span class="pl-k">*</span> <span class="pl-c1">3</span> AS name,
                 col
            FROM (SELECT <span class="pl-k">*</span>
                    FROM source
                   WHERE name <span class="pl-k">==</span> <span class="pl-c1">3</span>
                     AND bar <span class="pl-k">==</span> <span class="pl-s"><span class="pl-pds">"</span>whee<span class="pl-pds">"</span></span>))
ORDER BY name,
         col DESC

julia<span class="pl-k">&gt;</span> <span class="pl-c1">@sqlquery</span> source <span class="pl-k">|&gt;</span>
       <span class="pl-c1">filter</span>(name <span class="pl-k">==</span> <span class="pl-c1">3</span>, bar <span class="pl-k">==</span> <span class="pl-s"><span class="pl-pds">"</span>whee<span class="pl-pds">"</span></span>) <span class="pl-k">|&gt;</span>
       <span class="pl-c1">select</span>(name <span class="pl-k">=</span> foo <span class="pl-k">*</span> <span class="pl-c1">3</span>, col) <span class="pl-k">|&gt;</span>
       <span class="pl-c1">orderby</span>(<span class="pl-c1">desc</span>(name), <span class="pl-c1">desc</span>(col))
  SELECT <span class="pl-k">*</span>
    FROM (SELECT foo <span class="pl-k">*</span> <span class="pl-c1">3</span> AS name,
                 col
            FROM (SELECT <span class="pl-k">*</span>
                    FROM source
                   WHERE name <span class="pl-k">==</span> <span class="pl-c1">3</span>
                     AND bar <span class="pl-k">==</span> <span class="pl-s"><span class="pl-pds">"</span>whee<span class="pl-pds">"</span></span>))
ORDER BY name DESC,
         col DESC

julia<span class="pl-k">&gt;</span> <span class="pl-c1">@sqlquery</span> source <span class="pl-k">|&gt;</span>
       <span class="pl-c1">filter</span>(name <span class="pl-k">==</span> <span class="pl-c1">3</span>, bar <span class="pl-k">==</span> <span class="pl-s"><span class="pl-pds">"</span>whee<span class="pl-pds">"</span></span>) <span class="pl-k">|&gt;</span>
       <span class="pl-c1">select</span>(name <span class="pl-k">=</span> foo <span class="pl-k">*</span> <span class="pl-c1">3</span>, col) <span class="pl-k">|&gt;</span>
       <span class="pl-c1">orderby</span>(<span class="pl-c1">desc</span>(name), <span class="pl-c1">asc</span>(col))
  SELECT <span class="pl-k">*</span>
    FROM (SELECT foo <span class="pl-k">*</span> <span class="pl-c1">3</span> AS name,
                 col
            FROM (SELECT <span class="pl-k">*</span>
                    FROM source
                   WHERE name <span class="pl-k">==</span> <span class="pl-c1">3</span>
                     AND bar <span class="pl-k">==</span> <span class="pl-s"><span class="pl-pds">"</span>whee<span class="pl-pds">"</span></span>))
ORDER BY name DESC,
         col ASC

julia<span class="pl-k">&gt;</span> <span class="pl-c1">@sqlquery</span> source <span class="pl-k">|&gt;</span>
       <span class="pl-c1">filter</span>(name <span class="pl-k">==</span> <span class="pl-c1">3</span>, bar <span class="pl-k">==</span> <span class="pl-s"><span class="pl-pds">"</span>whee<span class="pl-pds">"</span></span>) <span class="pl-k">|&gt;</span>
       <span class="pl-c1">select</span>(name <span class="pl-k">=</span> foo <span class="pl-k">*</span> <span class="pl-c1">3</span>, col) <span class="pl-k">|&gt;</span>
       <span class="pl-c1">orderby</span>(<span class="pl-c1">asc</span>(name), <span class="pl-c1">asc</span>(col))
  SELECT <span class="pl-k">*</span>
    FROM (SELECT foo <span class="pl-k">*</span> <span class="pl-c1">3</span> AS name,
                 col
            FROM (SELECT <span class="pl-k">*</span>
                    FROM source
                   WHERE name <span class="pl-k">==</span> <span class="pl-c1">3</span>
                     AND bar <span class="pl-k">==</span> <span class="pl-s"><span class="pl-pds">"</span>whee<span class="pl-pds">"</span></span>))
ORDER BY name ASC,
         col ASC

julia<span class="pl-k">&gt;</span> <span class="pl-c1">@sqlquery</span> source <span class="pl-k">|&gt;</span>
       <span class="pl-c1">filter</span>(name <span class="pl-k">==</span> <span class="pl-c1">3</span>, bar <span class="pl-k">==</span> <span class="pl-s"><span class="pl-pds">"</span>whee<span class="pl-pds">"</span></span>) <span class="pl-k">|&gt;</span>
       <span class="pl-c1">select</span>(name <span class="pl-k">=</span> foo <span class="pl-k">*</span> <span class="pl-c1">3</span>, col) <span class="pl-k">|&gt;</span>
       <span class="pl-c1">orderby</span>(<span class="pl-c1">desc</span>(name))
  SELECT <span class="pl-k">*</span>
    FROM (SELECT foo <span class="pl-k">*</span> <span class="pl-c1">3</span> AS name,
                 col
            FROM (SELECT <span class="pl-k">*</span>
                    FROM source
                   WHERE name <span class="pl-k">==</span> <span class="pl-c1">3</span>
                     AND bar <span class="pl-k">==</span> <span class="pl-s"><span class="pl-pds">"</span>whee<span class="pl-pds">"</span></span>))
ORDER BY name DESC

julia<span class="pl-k">&gt;</span> <span class="pl-c1">@sqlquery</span> source <span class="pl-k">|&gt;</span>
       <span class="pl-c1">filter</span>(name <span class="pl-k">==</span> <span class="pl-c1">3</span>, bar <span class="pl-k">==</span> <span class="pl-s"><span class="pl-pds">"</span>whee<span class="pl-pds">"</span></span>) <span class="pl-k">|&gt;</span>
       <span class="pl-c1">select</span>(name <span class="pl-k">=</span> foo <span class="pl-k">*</span> <span class="pl-c1">3</span>, col) <span class="pl-k">|&gt;</span>
       <span class="pl-c1">orderby</span>(<span class="pl-c1">desc</span>(name)) <span class="pl-k">|&gt;</span>
       <span class="pl-c1">limit</span>(<span class="pl-c1">10</span>)
SELECT <span class="pl-k">*</span>
  FROM (  SELECT <span class="pl-k">*</span>
            FROM (SELECT foo <span class="pl-k">*</span> <span class="pl-c1">3</span> AS name,
                         col
                    FROM (SELECT <span class="pl-k">*</span>
                            FROM source
                           WHERE name <span class="pl-k">==</span> <span class="pl-c1">3</span>
                             AND bar <span class="pl-k">==</span> <span class="pl-s"><span class="pl-pds">"</span>whee<span class="pl-pds">"</span></span>))
        ORDER BY name DESC)
 LIMIT <span class="pl-c1">10</span>

julia<span class="pl-k">&gt;</span> <span class="pl-c1">@sqlquery</span> source <span class="pl-k">|&gt;</span>
       <span class="pl-c1">filter</span>(name <span class="pl-k">==</span> <span class="pl-c1">3</span>, bar <span class="pl-k">==</span> <span class="pl-s"><span class="pl-pds">"</span>whee<span class="pl-pds">"</span></span>) <span class="pl-k">|&gt;</span>
       <span class="pl-c1">select</span>(name <span class="pl-k">=</span> foo <span class="pl-k">*</span> <span class="pl-c1">3</span>, col) <span class="pl-k">|&gt;</span>
       <span class="pl-c1">orderby</span>(<span class="pl-c1">desc</span>(name)) <span class="pl-k">|&gt;</span>
       <span class="pl-c1">offset</span>(<span class="pl-c1">7</span>)
SELECT <span class="pl-k">*</span>
  FROM (  SELECT <span class="pl-k">*</span>
            FROM (SELECT foo <span class="pl-k">*</span> <span class="pl-c1">3</span> AS name,
                         col
                    FROM (SELECT <span class="pl-k">*</span>
                            FROM source
                           WHERE name <span class="pl-k">==</span> <span class="pl-c1">3</span>
                             AND bar <span class="pl-k">==</span> <span class="pl-s"><span class="pl-pds">"</span>whee<span class="pl-pds">"</span></span>))
        ORDER BY name DESC)
 LIMIT <span class="pl-k">-</span><span class="pl-c1">1</span> OFFSET <span class="pl-c1">7</span>


julia<span class="pl-k">&gt;</span> <span class="pl-c1">@sqlquery</span> Artists <span class="pl-k">|&gt;</span>
       <span class="pl-c1">leftjoin</span>(Songs) <span class="pl-k">|&gt;</span>
       <span class="pl-c1">leftjoin</span>(Albums) <span class="pl-k">|&gt;</span>
       <span class="pl-c1">select</span>( song_id <span class="pl-k">=</span> Songs<span class="pl-k">.</span>_id,
       song_name <span class="pl-k">=</span> Songs<span class="pl-k">.</span>name,
       Songs<span class="pl-k">.</span>length,
       artist_id <span class="pl-k">=</span> Songs<span class="pl-k">.</span>artist_id,
       artist_name <span class="pl-k">=</span> Artists<span class="pl-k">.</span>name,
       album_id <span class="pl-k">=</span> Songs<span class="pl-k">.</span>album_id,
       album_name <span class="pl-k">=</span> Albums<span class="pl-k">.</span>name)
SELECT Songs<span class="pl-k">.</span>_id AS song_id,
       Songs<span class="pl-k">.</span>name AS song_name,
       Songs<span class="pl-k">.</span>length,
       Songs<span class="pl-k">.</span>artist_id AS artist_id,
       Artists<span class="pl-k">.</span>name AS artist_name,
       Songs<span class="pl-k">.</span>album_id AS album_id,
       Albums<span class="pl-k">.</span>name AS album_name
  FROM (SELECT <span class="pl-k">*</span>
          FROM (SELECT <span class="pl-k">*</span>
                  FROM Artists
                       LEFT JOIN Songs)
               LEFT JOIN Albums)

julia<span class="pl-k">&gt;</span> <span class="pl-c1">@sqlquery</span> Artists <span class="pl-k">|&gt;</span>
       <span class="pl-c1">leftjoin</span>(Songs) <span class="pl-k">|&gt;</span>
       <span class="pl-c1">leftjoin</span>(Albums) <span class="pl-k">|&gt;</span>
       <span class="pl-c1">select</span>( song_id <span class="pl-k">=</span> Songs<span class="pl-k">.</span>_id,
       song_name <span class="pl-k">=</span> Songs<span class="pl-k">.</span>name,
       Songs<span class="pl-k">.</span>length,
       artist_id <span class="pl-k">=</span> Songs<span class="pl-k">.</span>artist_id,
       artist_name <span class="pl-k">=</span> Artists<span class="pl-k">.</span>name,
       album_id <span class="pl-k">=</span> Songs<span class="pl-k">.</span>album_id,
       album_name <span class="pl-k">=</span> Albums<span class="pl-k">.</span>name) <span class="pl-k">|&gt;</span>
       <span class="pl-c1">groupby</span>(Songs<span class="pl-k">.</span>length, artist_id)
  SELECT <span class="pl-k">*</span>
    FROM (SELECT Songs<span class="pl-k">.</span>_id AS song_id,
                 Songs<span class="pl-k">.</span>name AS song_name,
                 Songs<span class="pl-k">.</span>length,
                 Songs<span class="pl-k">.</span>artist_id AS artist_id,
                 Artists<span class="pl-k">.</span>name AS artist_name,
                 Songs<span class="pl-k">.</span>album_id AS album_id,
                 Albums<span class="pl-k">.</span>name AS album_name
            FROM (SELECT <span class="pl-k">*</span>
                    FROM (SELECT <span class="pl-k">*</span>
                            FROM Artists
                                 LEFT JOIN Songs)
                         LEFT JOIN Albums))
GROUP BY Songs<span class="pl-k">.</span>length, artist_id

julia<span class="pl-k">&gt;</span> <span class="pl-c1">@sqlquery</span> Artists <span class="pl-k">|&gt;</span>
       <span class="pl-c1">leftjoin</span>(Songs) <span class="pl-k">|&gt;</span>
       <span class="pl-c1">leftjoin</span>(Albums) <span class="pl-k">|&gt;</span>
       <span class="pl-c1">select</span>( song_id <span class="pl-k">=</span> Songs<span class="pl-k">.</span>_id,
       song_name <span class="pl-k">=</span> Songs<span class="pl-k">.</span>name,
       Songs<span class="pl-k">.</span>length,
       artist_id <span class="pl-k">=</span> Songs<span class="pl-k">.</span>artist_id,
       artist_name <span class="pl-k">=</span> Artists<span class="pl-k">.</span>name,
       album_id <span class="pl-k">=</span> Songs<span class="pl-k">.</span>album_id,
       album_name <span class="pl-k">=</span> Albums<span class="pl-k">.</span>name) <span class="pl-k">|&gt;</span>
       <span class="pl-c1">groupby</span>(Songs<span class="pl-k">.</span>length, artist_id) <span class="pl-k">|&gt;</span>
       <span class="pl-c1">orderby</span>(<span class="pl-c1">asc</span>(song_id), <span class="pl-c1">desc</span>(Songs<span class="pl-k">.</span>length), <span class="pl-c1">desc</span>(artist_id))
  SELECT <span class="pl-k">*</span>
    FROM (  SELECT <span class="pl-k">*</span>
              FROM (SELECT Songs<span class="pl-k">.</span>_id AS song_id,
                           Songs<span class="pl-k">.</span>name AS song_name,
                           Songs<span class="pl-k">.</span>length,
                           Songs<span class="pl-k">.</span>artist_id AS artist_id,
                           Artists<span class="pl-k">.</span>name AS artist_name,
                           Songs<span class="pl-k">.</span>album_id AS album_id,
                           Albums<span class="pl-k">.</span>name AS album_name
                      FROM (SELECT <span class="pl-k">*</span>
                              FROM (SELECT <span class="pl-k">*</span>
                                      FROM Artists
                                           LEFT JOIN Songs)
                                   LEFT JOIN Albums))
          GROUP BY Songs<span class="pl-k">.</span>length, artist_id)
ORDER BY song_id ASC,
         Songs<span class="pl-k">.</span>length DESC,
         artist_id DESC</pre></div>
</article></div>