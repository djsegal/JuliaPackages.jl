<div id="readme" class="md" data-path="README.md"><article class="markdown-body entry-content container-lg" itemprop="text"><h1 dir="auto"><a id="user-content-twostageoptimalcontroljl" class="anchor" aria-hidden="true" href="#twostageoptimalcontroljl"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a>TwoStageOptimalControl.jl</h1>
<p dir="auto"><a href="https://github.com/michaelfreiberger/TwoStageOptimalControl.jl/actions/workflows/ci.yml?query=branch%3Amaster"><img src="https://github.com/michaelfreiberger/TwoStageOptimalControl.jl/actions/workflows/ci.yml/badge.svg?branch=master" alt="Build Status" style="max-width: 100%;"></a>
<a href="https://zenodo.org/badge/latestdoi/590158468" rel="nofollow"><img src="https://camo.githubusercontent.com/b57d505b2846dc04b288fafe0fb8567c3a8b9cf3ff71a43c52c7fc70347ebf1c/68747470733a2f2f7a656e6f646f2e6f72672f62616467652f3539303135383436382e737667" alt="DOI" data-canonical-src="https://zenodo.org/badge/590158468.svg" style="max-width: 100%;"></a></p>
<p dir="auto">This is a Julia-package which allows for the solution of two-stage optimal control problems and vintage-structured optimal control problems.</p>
<h1 dir="auto"><a id="user-content-installation" class="anchor" aria-hidden="true" href="#installation"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a>Installation</h1>
<p dir="auto">The package is available in the Julia repository. The package can be installed by simply using the following two commands:</p>
<div class="snippet-clipboard-content notranslate position-relative overflow-auto" data-snippet-clipboard-copy-content="julia&gt; using Pkg
julia&gt; Pkg.add(&quot;TwoStageOptimalControl&quot;)"><pre lang="julia-repl" class="notranslate"><code>julia&gt; using Pkg
julia&gt; Pkg.add("TwoStageOptimalControl")
</code></pre></div>
<h1 dir="auto"><a id="user-content-documentation" class="anchor" aria-hidden="true" href="#documentation"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a>Documentation</h1>
<p dir="auto">For information on how to use the toolbox and some examples, please take a look into the <a href="https://michaelfreiberger.github.io/TwoStageOptimalControl.jl/dev/" rel="nofollow">documentation</a>.</p>
<h1 dir="auto"><a id="user-content-problem-class" class="anchor" aria-hidden="true" href="#problem-class"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a>Problem class</h1>
<p dir="auto">This package is designed to solve problems of the form</p>
<p dir="auto"><math-renderer class="js-display-math" style="display: block" data-static-url="https://github.githubassets.com/static" data-run-id="c2580cc6710953061e8d8e77097fdb60">$$
\max_{C_1: [0,T]\to\mathbb{R}^{n_1},\quad C_2:[0,T]^2\to\mathbb{R}^{n_2}}\int_{0}^{T} \exp(-\rho t)\Big[F_1(t,C_1(t),S_1(t)) + Q(t) \Big]dt +
$$</math-renderer></p>
<p dir="auto"><math-renderer class="js-display-math" style="display: block" data-static-url="https://github.githubassets.com/static" data-run-id="c2580cc6710953061e8d8e77097fdb60">$$
\hspace{4cm} + D_1(S(T)) + \int_0^T D_2(S_2(T,s))ds
$$</math-renderer></p>
<p dir="auto"><math-renderer class="js-display-math" style="display: block" data-static-url="https://github.githubassets.com/static" data-run-id="c2580cc6710953061e8d8e77097fdb60">$$
s.t. \qquad\dot{S_1}(t) = g_1(t,C_1(t),S_1(t)) ,\hspace{2cm} S_1(0) = S_1^0
$$</math-renderer></p>
<p dir="auto"><math-renderer class="js-display-math" style="display: block" data-static-url="https://github.githubassets.com/static" data-run-id="c2580cc6710953061e8d8e77097fdb60">$$
\hspace{3cm} \frac{d}{dt} S_2(t,s) = g_2(t,s,C_2(t,s),S_2(t,s)) ,\qquad S_2(s,s) = h(s,C_1(s),S_1(s))
$$</math-renderer></p>
<p dir="auto"><math-renderer class="js-display-math" style="display: block" data-static-url="https://github.githubassets.com/static" data-run-id="c2580cc6710953061e8d8e77097fdb60">$$
\qquad \qquad Q(t) = \int_0^t F_2(t,s,C_2(t,s),S_2(t,s)) ds
$$</math-renderer></p>
<p dir="auto"><math-renderer class="js-display-math" style="display: block" data-static-url="https://github.githubassets.com/static" data-run-id="c2580cc6710953061e8d8e77097fdb60">$$
\underline{C_1}(i) \leq C_{1,i}(t) \leq \overline{C_1}(i) \qquad\forall i = 1,\ldots,n_1 \quad,\quad\forall t\in [0,T]
$$</math-renderer></p>
<p dir="auto"><math-renderer class="js-display-math" style="display: block" data-static-url="https://github.githubassets.com/static" data-run-id="c2580cc6710953061e8d8e77097fdb60">$$
\underline{C_2}(i) \leq C_{2,i}(t,s) \leq \overline{C_2}(i) \qquad\forall i = 1,\ldots,n_2 \quad,\quad\forall s\in [0,T]\quad,\quad\forall t\in [s,T]
$$</math-renderer></p>
<h2 dir="auto">
<a id="user-content-variable-and-function-explanations" class="anchor" aria-hidden="true" href="#variable-and-function-explanations"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a><strong>Variable and function explanations</strong>
</h2>
<p dir="auto">The model consist of three different types of variables:</p>
<ul dir="auto">
<li>concentrated state and control variables (depending on time <math-renderer class="js-inline-math" style="display: inline" data-static-url="https://github.githubassets.com/static" data-run-id="c2580cc6710953061e8d8e77097fdb60">$t$</math-renderer>)</li>
<li>distributed state and control variables (depending on time <math-renderer class="js-inline-math" style="display: inline" data-static-url="https://github.githubassets.com/static" data-run-id="c2580cc6710953061e8d8e77097fdb60">$t$</math-renderer> and vintage <math-renderer class="js-inline-math" style="display: inline" data-static-url="https://github.githubassets.com/static" data-run-id="c2580cc6710953061e8d8e77097fdb60">$s$</math-renderer>)</li>
<li>aggregated state variables (depending on time <math-renderer class="js-inline-math" style="display: inline" data-static-url="https://github.githubassets.com/static" data-run-id="c2580cc6710953061e8d8e77097fdb60">$t$</math-renderer>)</li>
</ul>
<h3 dir="auto">
<a id="user-content-concentrated-variables" class="anchor" aria-hidden="true" href="#concentrated-variables"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a>Concentrated variables</h3>
<p dir="auto">The concentrated variables consist of the <math-renderer class="js-inline-math" style="display: inline" data-static-url="https://github.githubassets.com/static" data-run-id="c2580cc6710953061e8d8e77097fdb60">$n_1$</math-renderer>-dimensional control variable <math-renderer class="js-inline-math" style="display: inline" data-static-url="https://github.githubassets.com/static" data-run-id="c2580cc6710953061e8d8e77097fdb60">$C_1$</math-renderer> and the <math-renderer class="js-inline-math" style="display: inline" data-static-url="https://github.githubassets.com/static" data-run-id="c2580cc6710953061e8d8e77097fdb60">$m_1$</math-renderer>-dimensional state variable <math-renderer class="js-inline-math" style="display: inline" data-static-url="https://github.githubassets.com/static" data-run-id="c2580cc6710953061e8d8e77097fdb60">$S_1$</math-renderer>. The initial value of <math-renderer class="js-inline-math" style="display: inline" data-static-url="https://github.githubassets.com/static" data-run-id="c2580cc6710953061e8d8e77097fdb60">$S_1$</math-renderer> is given by <math-renderer class="js-inline-math" style="display: inline" data-static-url="https://github.githubassets.com/static" data-run-id="c2580cc6710953061e8d8e77097fdb60">$S_1^0$</math-renderer> and its dynamics are affected by <math-renderer class="js-inline-math" style="display: inline" data-static-url="https://github.githubassets.com/static" data-run-id="c2580cc6710953061e8d8e77097fdb60">$C_1$</math-renderer>. Furthermore <math-renderer class="js-inline-math" style="display: inline" data-static-url="https://github.githubassets.com/static" data-run-id="c2580cc6710953061e8d8e77097fdb60">$C_1$</math-renderer> also affects the initial values of the distributed variables (see below).</p>
<h3 dir="auto">
<a id="user-content-distributed-variables" class="anchor" aria-hidden="true" href="#distributed-variables"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a>Distributed variables</h3>
<p dir="auto">Analogous to the concentrated variables, the distributed variables consist of the <math-renderer class="js-inline-math" style="display: inline" data-static-url="https://github.githubassets.com/static" data-run-id="c2580cc6710953061e8d8e77097fdb60">$n_2$</math-renderer>-dimensional control variable <math-renderer class="js-inline-math" style="display: inline" data-static-url="https://github.githubassets.com/static" data-run-id="c2580cc6710953061e8d8e77097fdb60">$C_2$</math-renderer> and the <math-renderer class="js-inline-math" style="display: inline" data-static-url="https://github.githubassets.com/static" data-run-id="c2580cc6710953061e8d8e77097fdb60">$m_2$</math-renderer>-dimensional state variable <math-renderer class="js-inline-math" style="display: inline" data-static-url="https://github.githubassets.com/static" data-run-id="c2580cc6710953061e8d8e77097fdb60">$S_2$</math-renderer>. The strictly speaking partial differential equation can be solved along the characteristic lines with fixed vintage <math-renderer class="js-inline-math" style="display: inline" data-static-url="https://github.githubassets.com/static" data-run-id="c2580cc6710953061e8d8e77097fdb60">$s=\overline{s}$</math-renderer>. While the dynamics of <math-renderer class="js-inline-math" style="display: inline" data-static-url="https://github.githubassets.com/static" data-run-id="c2580cc6710953061e8d8e77097fdb60">$S_2$</math-renderer> are again affected by the distributed controls <math-renderer class="js-inline-math" style="display: inline" data-static-url="https://github.githubassets.com/static" data-run-id="c2580cc6710953061e8d8e77097fdb60">$C_2$</math-renderer>, the initial values of <math-renderer class="js-inline-math" style="display: inline" data-static-url="https://github.githubassets.com/static" data-run-id="c2580cc6710953061e8d8e77097fdb60">$S_2$</math-renderer> at the beginning of each vintage <math-renderer class="js-inline-math" style="display: inline" data-static-url="https://github.githubassets.com/static" data-run-id="c2580cc6710953061e8d8e77097fdb60">$s$</math-renderer> are determined by the value of the concentrated state <math-renderer class="js-inline-math" style="display: inline" data-static-url="https://github.githubassets.com/static" data-run-id="c2580cc6710953061e8d8e77097fdb60">$S_1$</math-renderer> at time <math-renderer class="js-inline-math" style="display: inline" data-static-url="https://github.githubassets.com/static" data-run-id="c2580cc6710953061e8d8e77097fdb60">$s$</math-renderer> and the concentrated control <math-renderer class="js-inline-math" style="display: inline" data-static-url="https://github.githubassets.com/static" data-run-id="c2580cc6710953061e8d8e77097fdb60">$C_1$</math-renderer>.</p>
<h3 dir="auto">
<a id="user-content-aggregated-variables" class="anchor" aria-hidden="true" href="#aggregated-variables"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a>Aggregated variables</h3>
<p dir="auto">Finally we also have an aggregated variable <math-renderer class="js-inline-math" style="display: inline" data-static-url="https://github.githubassets.com/static" data-run-id="c2580cc6710953061e8d8e77097fdb60">$Q$</math-renderer> which aggregates at each point in time <math-renderer class="js-inline-math" style="display: inline" data-static-url="https://github.githubassets.com/static" data-run-id="c2580cc6710953061e8d8e77097fdb60">$t$</math-renderer> a functional form <math-renderer class="js-inline-math" style="display: inline" data-static-url="https://github.githubassets.com/static" data-run-id="c2580cc6710953061e8d8e77097fdb60">$F_2$</math-renderer> over all vintages which startet before <math-renderer class="js-inline-math" style="display: inline" data-static-url="https://github.githubassets.com/static" data-run-id="c2580cc6710953061e8d8e77097fdb60">$t$</math-renderer>.</p>
<h2 dir="auto">
<a id="user-content-algorithm-principles" class="anchor" aria-hidden="true" href="#algorithm-principles"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a><strong>Algorithm principles</strong>
</h2>
<p dir="auto">The algorithm uses a gradient based approach following a sequence of steps:</p>
<ol dir="auto">
<li>Start with a given guess for the optimal solution of the control variables.</li>
<li>Calculate the corresponding profiles of the state variables and co-state variables (based on the maximum principle)</li>
<li>Calculate the gradient based on the Hamiltonian.</li>
<li>Adjust the guess for the control in the direction of the gradient.</li>
<li>Find the optimal adjustment step in the direction of the gradient.</li>
<li>Define new currently best solution.</li>
<li>Iterate from step 2 until no improvement can be found anymore.</li>
</ol>
<h2 dir="auto">
<a id="user-content-two-stage-optimal-control-problems-with-random-switching-time" class="anchor" aria-hidden="true" href="#two-stage-optimal-control-problems-with-random-switching-time"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a><strong>Two-stage optimal control problems with random switching time</strong>
</h2>
<p dir="auto">This package is based on a project about the solution of two-stage optimal control problems with random switching time. This problem class takes the following form:</p>
<p dir="auto">$$
\max_{C_1: [0,T]\to\mathbb{R}^{n_1}}\mathbb{E}<em>{\tau}\int</em>{0}^{\tau} \exp(-\rho t) F_1(t,C_1(t),S_1(t)) dt + \exp(-\rho\tau)V^*(\tau,C_1(\tau),S_1(\tau))
$$</p>
<p dir="auto"><math-renderer class="js-display-math" style="display: block" data-static-url="https://github.githubassets.com/static" data-run-id="c2580cc6710953061e8d8e77097fdb60">$$
s.t. \qquad\dot{S_1}(t) = g_1(t,C_1(t),S_1(t)) ,\hspace{2cm} S_1(0) = S_1^0
$$</math-renderer></p>
<p dir="auto"><math-renderer class="js-display-math" style="display: block" data-static-url="https://github.githubassets.com/static" data-run-id="c2580cc6710953061e8d8e77097fdb60">$$
\underline{C_1}(i) \leq C_{1,i}(t) \leq \overline{C_1}(i) \qquad\forall i = 1,\ldots,n_1
$$</math-renderer></p>
<p dir="auto">with <math-renderer class="js-inline-math" style="display: inline" data-static-url="https://github.githubassets.com/static" data-run-id="c2580cc6710953061e8d8e77097fdb60">$V^*(\tau,S_1(\tau))$</math-renderer> being the value-function of the second stage problem</p>
<p dir="auto"><math-renderer class="js-display-math" style="display: block" data-static-url="https://github.githubassets.com/static" data-run-id="c2580cc6710953061e8d8e77097fdb60">$$
V^*(\tau,S_1(\tau)) = \max_{C_2:[\tau,T]\to\mathbb{R}^{n_2}}\int_{\tau}^T \exp(-\rho(t-\tau))F_2(t,\tau,C_2(t),S_2(t)) dt
$$</math-renderer></p>
<p dir="auto"><math-renderer class="js-display-math" style="display: block" data-static-url="https://github.githubassets.com/static" data-run-id="c2580cc6710953061e8d8e77097fdb60">$$
\hspace{3cm} \dot{S_2}(t) = g_2(t,\tau,C_2(t),S_2(t)) ,\qquad S_2(\tau) = h(\tau,C_1(\tau),S_1(\tau))
$$</math-renderer></p>
<p dir="auto"><math-renderer class="js-display-math" style="display: block" data-static-url="https://github.githubassets.com/static" data-run-id="c2580cc6710953061e8d8e77097fdb60">$$
\underline{C_2}(i) \leq C_{2,i}(t) \leq \overline{C_2}(i) \qquad\forall i = 1,\ldots,n_2 \quad,\quad\forall t\in [\tau,T]
$$</math-renderer></p>
<p dir="auto">and <math-renderer class="js-inline-math" style="display: inline" data-static-url="https://github.githubassets.com/static" data-run-id="c2580cc6710953061e8d8e77097fdb60">$\tau$</math-renderer> being the random switching time between the two stages with the stochastic properties being best described by the <math-renderer class="js-inline-math" style="display: inline" data-static-url="https://github.githubassets.com/static" data-run-id="c2580cc6710953061e8d8e77097fdb60">$Z(t):= \mathbb{P}\left[\tau &amp;gt; t\right]$</math-renderer>, the probability of surviving in the first stage. The hazard rate <math-renderer class="js-inline-math" style="display: inline" data-static-url="https://github.githubassets.com/static" data-run-id="c2580cc6710953061e8d8e77097fdb60">$\eta$</math-renderer> of <math-renderer class="js-inline-math" style="display: inline" data-static-url="https://github.githubassets.com/static" data-run-id="c2580cc6710953061e8d8e77097fdb60">$Z$</math-renderer> thereby can depend on time <math-renderer class="js-inline-math" style="display: inline" data-static-url="https://github.githubassets.com/static" data-run-id="c2580cc6710953061e8d8e77097fdb60">$t$</math-renderer> the state variables <math-renderer class="js-inline-math" style="display: inline" data-static-url="https://github.githubassets.com/static" data-run-id="c2580cc6710953061e8d8e77097fdb60">$S_1$</math-renderer> and the control variablee <math-renderer class="js-inline-math" style="display: inline" data-static-url="https://github.githubassets.com/static" data-run-id="c2580cc6710953061e8d8e77097fdb60">$C_1$</math-renderer>.</p>
<p dir="auto"><math-renderer class="js-display-math" style="display: block" data-static-url="https://github.githubassets.com/static" data-run-id="c2580cc6710953061e8d8e77097fdb60">$$
\dot{Z}(t) = -\eta(t,C_1,S_1)\cdot Z(t)
$$</math-renderer></p>
<p dir="auto">Overall this problem type can be transformed into a vintage-structed optimal control problem presented above. For details see the work of <a href="https://link.springer.com/article/10.1007/s10957-019-01598-5" rel="nofollow">Wrzaczek, Kuhn and Frankovic (2020)</a>.</p>
<h1 dir="auto">
<a id="user-content-planned-extensions-of-the-toolbox" class="anchor" aria-hidden="true" href="#planned-extensions-of-the-toolbox"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a>Planned extensions of the toolbox</h1>
<h3 dir="auto">
<a id="user-content-1-generalise-to-the-age-structured-optimal-control-problems-with-initial-distribution-of-state-variables-intial-and-boundary-controls-and-more-generalised-version-of-aggregated-variables" class="anchor" aria-hidden="true" href="#1-generalise-to-the-age-structured-optimal-control-problems-with-initial-distribution-of-state-variables-intial-and-boundary-controls-and-more-generalised-version-of-aggregated-variables"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a>1. Generalise to the age-structured optimal control problems with initial distribution of state variables, intial and boundary controls, and more generalised version of aggregated variables.</h3>
<h3 dir="auto">
<a id="user-content-2-allow-for-more-generalcomplicated-feasible-regions-for-the-control-variables" class="anchor" aria-hidden="true" href="#2-allow-for-more-generalcomplicated-feasible-regions-for-the-control-variables"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a>2. Allow for more general/complicated feasible regions for the control variables.</h3>
<h3 dir="auto">
<a id="user-content-3-include-the-option-to-define-equilibrium-conditions-which-the-solution-has-to-fulfill" class="anchor" aria-hidden="true" href="#3-include-the-option-to-define-equilibrium-conditions-which-the-solution-has-to-fulfill"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a>3. Include the option to define equilibrium conditions, which the solution has to fulfill.</h3>
</article></div>