<div id="readme" class="md" data-path="README.md"><article class="markdown-body entry-content container-lg" itemprop="text"><h1 dir="auto"><a id="user-content-phylo" class="anchor" aria-hidden="true" href="#phylo"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a>Phylo</h1>
<h2 dir="auto"><a id="user-content-a-package-for-creating-and-manipulating-phylogenies" class="anchor" aria-hidden="true" href="#a-package-for-creating-and-manipulating-phylogenies"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a>A package for creating and manipulating phylogenies</h2>
<table>
<thead>
<tr>
<th align="center"><strong>Documentation</strong></th>
<th align="center"><strong>Build Status</strong></th>
<th align="center"><strong>DOI</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td align="center"><a href="https://docs.ecojulia.org/Phylo.jl/stable" rel="nofollow"><img src="https://camo.githubusercontent.com/c97f0a5f2ae95755f64a27f1aa8d9a17462941fd3d6c907c7630abd5d3e60acf/68747470733a2f2f696d672e736869656c64732e696f2f62616467652f646f63732d737461626c652d626c75652e737667" alt="stable docs" data-canonical-src="https://img.shields.io/badge/docs-stable-blue.svg" style="max-width: 100%;"></a></td>
<td align="center"><a href="https://github.com/EcoJulia/Phylo.jl/actions/workflows/testing.yaml"><img src="https://github.com/EcoJulia/Phylo.jl/actions/workflows/testing.yaml/badge.svg" alt="build tests" style="max-width: 100%;"></a> <a href="https://github.com/EcoJulia/Phylo.jl/actions/workflows/nightly.yaml"><img src="https://github.com/EcoJulia/Phylo.jl/actions/workflows/nightly.yaml/badge.svg" alt="JuliaNightly" style="max-width: 100%;"></a></td>
<td align="center"><a href="https://zenodo.org/badge/latestdoi/93447241" rel="nofollow"><img src="https://camo.githubusercontent.com/ffa5f94e446163186e27cace8a4c969cdd1b5ffefee66cc0fea519a432a9351a/68747470733a2f2f7a656e6f646f2e6f72672f62616467652f39333434373234312e737667" alt="Zenodo" data-canonical-src="https://zenodo.org/badge/93447241.svg" style="max-width: 100%;"></a></td>
</tr>
<tr>
<td align="center"><a href="http://docs.ecojulia.org/Phylo.jl/dev" rel="nofollow"><img src="https://camo.githubusercontent.com/7fcec4b2d3ab291529fce8ef6a4fcd4129a0683b2f5d5fe2f5c648f02db8b616/68747470733a2f2f696d672e736869656c64732e696f2f62616467652f646f63732d6465762d626c75652e737667" alt="dev docs" data-canonical-src="https://img.shields.io/badge/docs-dev-blue.svg" style="max-width: 100%;"></a></td>
<td align="center"><a href="https://codecov.io/gh/EcoJulia/Phylo.jl" rel="nofollow"><img src="https://camo.githubusercontent.com/3bbfaee9b43bb1f0757537e1e47442fd537c12390457e68bc04c9571b8e3c28a/68747470733a2f2f636f6465636f762e696f2f67682f45636f4a756c69612f5068796c6f2e6a6c2f6272616e63682f6465762f67726170682f62616467652e737667" alt="codecov" data-canonical-src="https://codecov.io/gh/EcoJulia/Phylo.jl/branch/dev/graph/badge.svg" style="max-width: 100%;"></a> <a href="https://coveralls.io/r/EcoJulia/Phylo.jl?branch=dev" rel="nofollow"><img src="https://camo.githubusercontent.com/38ba165b95936d99531a4c88aaa7bc66bef977b4e359224dd369aa111fb60245/68747470733a2f2f696d672e736869656c64732e696f2f636f766572616c6c732f45636f4a756c69612f5068796c6f2e6a6c2e737667" alt="coveralls" data-canonical-src="https://img.shields.io/coveralls/EcoJulia/Phylo.jl.svg" style="max-width: 100%;"></a></td>
<td align="center"></td>
</tr>
</tbody>
</table>
<h2 dir="auto"><a id="user-content-installation" class="anchor" aria-hidden="true" href="#installation"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a>Installation</h2>
<p dir="auto">The package is registered in the <code>General</code> registry so can be
installed with <code>add</code>. For example:</p>
<div class="highlight highlight-source-julia notranslate position-relative overflow-auto" dir="auto" data-snippet-clipboard-copy-content="(@v1.6) pkg&gt; add Phylo
    Updating registry at `~/.julia/registries/General`
    Updating git-repo `https://github.com/JuliaRegistries/General.git`
   Resolving package versions...
    Updating `~/.julia/environments/v1.6/Project.toml`
  [aea672f4] + Phylo v0.4.18
    Updating `~/.julia/environments/v1.6/Manifest.toml`

(@v1.6) pkg&gt;"><pre>(<span class="pl-c1">@v1</span>.<span class="pl-c1">6</span>) pkg<span class="pl-k">&gt;</span> add Phylo
    Updating registry at <span class="pl-s"><span class="pl-pds">`</span>~/.julia/registries/General<span class="pl-pds">`</span></span>
    Updating git<span class="pl-k">-</span>repo <span class="pl-s"><span class="pl-pds">`</span>https://github.com/JuliaRegistries/General.git<span class="pl-pds">`</span></span>
   Resolving package versions<span class="pl-k">...</span>
    Updating <span class="pl-s"><span class="pl-pds">`</span>~/.julia/environments/v1.6/Project.toml<span class="pl-pds">`</span></span>
  [aea672f4] <span class="pl-k">+</span> Phylo v0.<span class="pl-c1">4.18</span>
    Updating <span class="pl-s"><span class="pl-pds">`</span>~/.julia/environments/v1.6/Manifest.toml<span class="pl-pds">`</span></span>

(<span class="pl-c1">@v1</span>.<span class="pl-c1">6</span>) pkg<span class="pl-k">&gt;</span></pre></div>
<h2 dir="auto"><a id="user-content-project-status" class="anchor" aria-hidden="true" href="#project-status"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a>Project Status</h2>
<p dir="auto">The package is confirmed to work against Julia v1.6, the current LTS Julia
v1.4 release and the latest release on Linux, macOS, and Windows. It is also
tested against nightly.</p>
<h2 dir="auto"><a id="user-content-contributing-and-questions" class="anchor" aria-hidden="true" href="#contributing-and-questions"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a>Contributing and Questions</h2>
<p dir="auto">Contributions are very welcome, as are feature requests and suggestions.
Please open an <a href="https://github.com/EcoJuli/Phylo.jl/issues">issue</a> if you encounter any problems or would
just like to ask a question.</p>
<h2 dir="auto"><a id="user-content-summary" class="anchor" aria-hidden="true" href="#summary"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a>Summary</h2>
<p dir="auto"><strong>Phylo</strong> is a <a href="http://www.julialang.org" rel="nofollow">Julia</a> package that provides
functionality for generating phylogenetic trees to feed into our
<a href="https://github.com/EcoJulia/Diversity.jl/">Diversity</a> package to calculate phylogenetic
diversity. <code>Phylo</code> is currently in <em>beta</em>, but is probably still
missing much of the functionality that people may desire, so please
<a href="https://github.com/EcoJuli/Phylo.jl/issues">raise an issue</a> if/when you find problems or missing
functionality - don't assume that I know!</p>
<p dir="auto">Currently the package can be used to make trees manually, to generate
random trees using the framework from <code>Distributions</code>, and to read
newick and nexus format trees from files. It can also be used to
evolve continuous and discrete traits on the resultant phylogenies,
and plot all of this using <code>Plots</code> recipes. Finally, the trees and
traits are capable of handling <code>Unitful</code> units, so the branch lengths
can be time based, and traits that relate directly to physical units
(e.g. size) can be directly evolved.</p>
<h3 dir="auto"><a id="user-content-random-tree-generation" class="anchor" aria-hidden="true" href="#random-tree-generation"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a>Random tree generation</h3>
<p dir="auto">For instance, to construct a sampler for 5 tip non-ultrametric trees,
and then generate one or two random tree of that type (the examples
below are from the dev branch, but work similarly on the current
release):</p>
<div class="highlight highlight-source-julia notranslate position-relative overflow-auto" dir="auto" data-snippet-clipboard-copy-content="julia&gt; using Phylo

julia&gt; nu = Nonultrametric(5);

julia&gt; tree = rand(nu)
RootedTree with 5 tips, 9 nodes and 8 branches.
Leaf names are tip 2, tip 3, tip 1, tip 4 and tip 5

julia&gt; trees = rand(nu, [&quot;Tree 1&quot;, &quot;Tree 2&quot;])
TreeSet with 2 trees, each with 5 tips.
Tree names are Tree 2 and Tree 1

Tree 1: RootedTree with 5 tips, 9 nodes and 8 branches.
Leaf names are tip 5, tip 4, tip 2, tip 1 and tip 3

Tree 2: RootedTree with 5 tips, 9 nodes and 8 branches.
Leaf names are tip 3, tip 1, tip 2, tip 4 and tip 5"><pre>julia<span class="pl-k">&gt;</span> <span class="pl-k">using</span> Phylo

julia<span class="pl-k">&gt;</span> nu <span class="pl-k">=</span> <span class="pl-c1">Nonultrametric</span>(<span class="pl-c1">5</span>);

julia<span class="pl-k">&gt;</span> tree <span class="pl-k">=</span> <span class="pl-c1">rand</span>(nu)
RootedTree with <span class="pl-c1">5</span> tips, <span class="pl-c1">9</span> nodes and <span class="pl-c1">8</span> branches.
Leaf names are tip <span class="pl-c1">2</span>, tip <span class="pl-c1">3</span>, tip <span class="pl-c1">1</span>, tip <span class="pl-c1">4</span> and tip <span class="pl-c1">5</span>

julia<span class="pl-k">&gt;</span> trees <span class="pl-k">=</span> <span class="pl-c1">rand</span>(nu, [<span class="pl-s"><span class="pl-pds">"</span>Tree 1<span class="pl-pds">"</span></span>, <span class="pl-s"><span class="pl-pds">"</span>Tree 2<span class="pl-pds">"</span></span>])
TreeSet with <span class="pl-c1">2</span> trees, each with <span class="pl-c1">5</span> tips.
Tree names are Tree <span class="pl-c1">2</span> and Tree <span class="pl-c1">1</span>

Tree <span class="pl-c1">1</span><span class="pl-k">:</span> RootedTree with <span class="pl-c1">5</span> tips, <span class="pl-c1">9</span> nodes and <span class="pl-c1">8</span> branches.
Leaf names are tip <span class="pl-c1">5</span>, tip <span class="pl-c1">4</span>, tip <span class="pl-c1">2</span>, tip <span class="pl-c1">1</span> and tip <span class="pl-c1">3</span>

Tree <span class="pl-c1">2</span><span class="pl-k">:</span> RootedTree with <span class="pl-c1">5</span> tips, <span class="pl-c1">9</span> nodes and <span class="pl-c1">8</span> branches.
Leaf names are tip <span class="pl-c1">3</span>, tip <span class="pl-c1">1</span>, tip <span class="pl-c1">2</span>, tip <span class="pl-c1">4</span> and tip <span class="pl-c1">5</span></pre></div>
<h3 dir="auto"><a id="user-content-tree-traversal" class="anchor" aria-hidden="true" href="#tree-traversal"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a>Tree traversal</h3>
<p dir="auto">The code also provides iterators, and filtered iterators over the branches,
nodes, branchnames and nodenames of a tree, though this may soon be superseded
by a simpler strategy.</p>
<div class="highlight highlight-source-julia notranslate position-relative overflow-auto" dir="auto" data-snippet-clipboard-copy-content="julia&gt; traversal(tree, inorder)
9-element Vector{LinkNode{OneRoot, String, Dict{String, Any}, LinkBranch{OneRoot, String, Dict{String, Any}, Float64}}}:
 LinkNode tip 2, a tip of the tree with an incoming connection (branch 11).

 LinkNode Node 7, an internal node with 1 inbound and 2 outbound connections (branches 13 and 11, 12)

 LinkNode tip 3, a tip of the tree with an incoming connection (branch 12).

 LinkNode Node 8, an internal node with 1 inbound and 2 outbound connections (branches 15 and 13, 14)

 LinkNode tip 1, a tip of the tree with an incoming connection (branch 9).

 LinkNode Node 6, an internal node with 1 inbound and 2 outbound connections (branches 14 and 9, 10)

 LinkNode tip 4, a tip of the tree with an incoming connection (branch 10).

 LinkNode Node 9, a root node with 2 outbound connections (branches 15, 16)

 LinkNode tip 5, a tip of the tree with an incoming connection (branch 16).


julia&gt; getnodename.(tree, traversal(tree, preorder))
9-element Vector{String}:
 &quot;Node 9&quot;
 &quot;Node 8&quot;
 &quot;Node 7&quot;
 &quot;tip 2&quot;
 &quot;tip 3&quot;
 &quot;Node 6&quot;
 &quot;tip 1&quot;
 &quot;tip 4&quot;
 &quot;tip 5&quot;

julia&gt; collect(nodenamefilter(isleaf, tree))
5-element Vector{String}:
 &quot;tip 1&quot;
 &quot;tip 2&quot;
 &quot;tip 3&quot;
 &quot;tip 4&quot;
 &quot;tip 5&quot;"><pre>julia<span class="pl-k">&gt;</span> <span class="pl-c1">traversal</span>(tree, inorder)
<span class="pl-c1">9</span><span class="pl-k">-</span>element Vector{LinkNode{OneRoot, String, Dict{String, Any}, LinkBranch{OneRoot, String, Dict{String, Any}, Float64}}}<span class="pl-k">:</span>
 LinkNode tip <span class="pl-c1">2</span>, a tip of the tree with an incoming connection (branch <span class="pl-c1">11</span>)<span class="pl-k">.</span>

 LinkNode Node <span class="pl-c1">7</span>, an internal node with <span class="pl-c1">1</span> inbound and <span class="pl-c1">2</span> outbound connections (branches <span class="pl-c1">13</span> and <span class="pl-c1">11</span>, <span class="pl-c1">12</span>)

 LinkNode tip <span class="pl-c1">3</span>, a tip of the tree with an incoming connection (branch <span class="pl-c1">12</span>)<span class="pl-k">.</span>

 LinkNode Node <span class="pl-c1">8</span>, an internal node with <span class="pl-c1">1</span> inbound and <span class="pl-c1">2</span> outbound connections (branches <span class="pl-c1">15</span> and <span class="pl-c1">13</span>, <span class="pl-c1">14</span>)

 LinkNode tip <span class="pl-c1">1</span>, a tip of the tree with an incoming connection (branch <span class="pl-c1">9</span>)<span class="pl-k">.</span>

 LinkNode Node <span class="pl-c1">6</span>, an internal node with <span class="pl-c1">1</span> inbound and <span class="pl-c1">2</span> outbound connections (branches <span class="pl-c1">14</span> and <span class="pl-c1">9</span>, <span class="pl-c1">10</span>)

 LinkNode tip <span class="pl-c1">4</span>, a tip of the tree with an incoming connection (branch <span class="pl-c1">10</span>)<span class="pl-k">.</span>

 LinkNode Node <span class="pl-c1">9</span>, a root node with <span class="pl-c1">2</span> outbound connections (branches <span class="pl-c1">15</span>, <span class="pl-c1">16</span>)

 LinkNode tip <span class="pl-c1">5</span>, a tip of the tree with an incoming connection (branch <span class="pl-c1">16</span>)<span class="pl-k">.</span>


julia<span class="pl-k">&gt;</span> <span class="pl-c1">getnodename</span>.(tree, <span class="pl-c1">traversal</span>(tree, preorder))
<span class="pl-c1">9</span><span class="pl-k">-</span>element Vector{String}<span class="pl-k">:</span>
 <span class="pl-s"><span class="pl-pds">"</span>Node 9<span class="pl-pds">"</span></span>
 <span class="pl-s"><span class="pl-pds">"</span>Node 8<span class="pl-pds">"</span></span>
 <span class="pl-s"><span class="pl-pds">"</span>Node 7<span class="pl-pds">"</span></span>
 <span class="pl-s"><span class="pl-pds">"</span>tip 2<span class="pl-pds">"</span></span>
 <span class="pl-s"><span class="pl-pds">"</span>tip 3<span class="pl-pds">"</span></span>
 <span class="pl-s"><span class="pl-pds">"</span>Node 6<span class="pl-pds">"</span></span>
 <span class="pl-s"><span class="pl-pds">"</span>tip 1<span class="pl-pds">"</span></span>
 <span class="pl-s"><span class="pl-pds">"</span>tip 4<span class="pl-pds">"</span></span>
 <span class="pl-s"><span class="pl-pds">"</span>tip 5<span class="pl-pds">"</span></span>

julia<span class="pl-k">&gt;</span> <span class="pl-c1">collect</span>(<span class="pl-c1">nodenamefilter</span>(isleaf, tree))
<span class="pl-c1">5</span><span class="pl-k">-</span>element Vector{String}<span class="pl-k">:</span>
 <span class="pl-s"><span class="pl-pds">"</span>tip 1<span class="pl-pds">"</span></span>
 <span class="pl-s"><span class="pl-pds">"</span>tip 2<span class="pl-pds">"</span></span>
 <span class="pl-s"><span class="pl-pds">"</span>tip 3<span class="pl-pds">"</span></span>
 <span class="pl-s"><span class="pl-pds">"</span>tip 4<span class="pl-pds">"</span></span>
 <span class="pl-s"><span class="pl-pds">"</span>tip 5<span class="pl-pds">"</span></span></pre></div>
<p dir="auto">The current main purpose of this package is to provide a framework for
phylogenetics to use in our <a href="https://github.com/EcoJulia/Diversity.jl/">Diversity</a> package, and
they will both be adapted as appropriate until both are functioning as
required (though they are currently working together reasonably successfully).</p>
<h3 dir="auto"><a id="user-content-reading-from-a-file" class="anchor" aria-hidden="true" href="#reading-from-a-file"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a>Reading from a file</h3>
<p dir="auto">It can also read newick trees either from strings or files:</p>
<div class="highlight highlight-source-julia notranslate position-relative overflow-auto" dir="auto" data-snippet-clipboard-copy-content="julia&gt; using Phylo

julia&gt; simpletree = parsenewick(&quot;((,Tip:1.0)Internal,)Root;&quot;)
RootedTree with 3 tips, 5 nodes and 4 branches.
Leaf names are Tip, Node 1 and Node 4


julia&gt; getbranchname.(simpletree, getbranches(simpletree))
4-element Vector{Int64}:
 1
 2
 3
 4

julia&gt; tree = open(parsenewick, Phylo.path(&quot;H1N1.newick&quot;))
RootedTree with 507 tips, 1013 nodes and 1012 branches.
Leaf names are 227, 294, 295, 110, 390, ... [501 omitted] ... and 418"><pre>julia<span class="pl-k">&gt;</span> <span class="pl-k">using</span> Phylo

julia<span class="pl-k">&gt;</span> simpletree <span class="pl-k">=</span> <span class="pl-c1">parsenewick</span>(<span class="pl-s"><span class="pl-pds">"</span>((,Tip:1.0)Internal,)Root;<span class="pl-pds">"</span></span>)
RootedTree with <span class="pl-c1">3</span> tips, <span class="pl-c1">5</span> nodes and <span class="pl-c1">4</span> branches.
Leaf names are Tip, Node <span class="pl-c1">1</span> and Node <span class="pl-c1">4</span>


julia<span class="pl-k">&gt;</span> <span class="pl-c1">getbranchname</span>.(simpletree, <span class="pl-c1">getbranches</span>(simpletree))
<span class="pl-c1">4</span><span class="pl-k">-</span>element Vector{Int64}<span class="pl-k">:</span>
 <span class="pl-c1">1</span>
 <span class="pl-c1">2</span>
 <span class="pl-c1">3</span>
 <span class="pl-c1">4</span>

julia<span class="pl-k">&gt;</span> tree <span class="pl-k">=</span> <span class="pl-c1">open</span>(parsenewick, Phylo<span class="pl-k">.</span><span class="pl-c1">path</span>(<span class="pl-s"><span class="pl-pds">"</span>H1N1.newick<span class="pl-pds">"</span></span>))
RootedTree with <span class="pl-c1">507</span> tips, <span class="pl-c1">1013</span> nodes and <span class="pl-c1">1012</span> branches.
Leaf names are <span class="pl-c1">227</span>, <span class="pl-c1">294</span>, <span class="pl-c1">295</span>, <span class="pl-c1">110</span>, <span class="pl-c1">390</span>, <span class="pl-k">...</span> [<span class="pl-c1">501</span> omitted] <span class="pl-k">...</span> and <span class="pl-c1">418</span></pre></div>
<p dir="auto">And it can read nexus trees from files too:</p>
<div class="highlight highlight-source-julia notranslate position-relative overflow-auto" dir="auto" data-snippet-clipboard-copy-content="julia&gt; tree = open(parsenewick, Phylo.path(&quot;H1N1.newick&quot;))
RootedTree with 507 tips, 1013 nodes and 1012 branches.
Leaf names are 227, 294, 295, 110, 390, ... [501 omitted] ... and 418

julia&gt; ts = open(parsenexus, Phylo.path(&quot;H1N1.trees&quot;))
[ Info: Created a tree called &quot;TREE1&quot;
[ Info: Created a tree called &quot;TREE2&quot;
TreeSet with 2 trees, each with 507 tips.
Tree names are TREE2 and TREE1

TREE1: RootedTree with 507 tips, 1013 nodes and 1012 branches.
Leaf names are H1N1_A_BRAZIL_11_1978, H1N1_A_TAHITI_8_1998, H1N1_A_TAIWAN_1_1986, H1N1_A_BAYERN_7_1995, H1N1_A_ENGLAND_45_1998, ... [501 omitted] ... and H1N1_A_PUERTORICO_8_1934

TREE2: RootedTree with 507 tips, 1013 nodes and 1012 branches.
Leaf names are H1N1_A_BRAZIL_11_1978, H1N1_A_TAHITI_8_1998, H1N1_A_TAIWAN_1_1986, H1N1_A_BAYERN_7_1995, H1N1_A_ENGLAND_45_1998, ... [501 omitted] ... and H1N1_A_PUERTORICO_8_1934


julia&gt; ts[&quot;TREE1&quot;]
RootedTree with 507 tips, 1013 nodes and 1012 branches.
Leaf names are H1N1_A_BRAZIL_11_1978, H1N1_A_TAHITI_8_1998, H1N1_A_TAIWAN_1_1986, H1N1_A_BAYERN_7_1995, H1N1_A_ENGLAND_45_1998, ... [501 omitted] ... and H1N1_A_PUERTORICO_8_1934


julia&gt; gettreeinfo(ts)
Dict{String, Dict{String, Any}} with 2 entries:
  &quot;TREE2&quot; =&gt; Dict(&quot;lnP&quot;=&gt;-1.0)
  &quot;TREE1&quot; =&gt; Dict(&quot;lnP&quot;=&gt;1.0)

julia&gt; gettreeinfo(ts, &quot;TREE1&quot;)
Dict{String, Any} with 1 entry:
  &quot;lnP&quot; =&gt; 1.0"><pre>julia<span class="pl-k">&gt;</span> tree <span class="pl-k">=</span> <span class="pl-c1">open</span>(parsenewick, Phylo<span class="pl-k">.</span><span class="pl-c1">path</span>(<span class="pl-s"><span class="pl-pds">"</span>H1N1.newick<span class="pl-pds">"</span></span>))
RootedTree with <span class="pl-c1">507</span> tips, <span class="pl-c1">1013</span> nodes and <span class="pl-c1">1012</span> branches.
Leaf names are <span class="pl-c1">227</span>, <span class="pl-c1">294</span>, <span class="pl-c1">295</span>, <span class="pl-c1">110</span>, <span class="pl-c1">390</span>, <span class="pl-k">...</span> [<span class="pl-c1">501</span> omitted] <span class="pl-k">...</span> and <span class="pl-c1">418</span>

julia<span class="pl-k">&gt;</span> ts <span class="pl-k">=</span> <span class="pl-c1">open</span>(parsenexus, Phylo<span class="pl-k">.</span><span class="pl-c1">path</span>(<span class="pl-s"><span class="pl-pds">"</span>H1N1.trees<span class="pl-pds">"</span></span>))
[ Info<span class="pl-k">:</span> Created a tree called <span class="pl-s"><span class="pl-pds">"</span>TREE1<span class="pl-pds">"</span></span>
[ Info<span class="pl-k">:</span> Created a tree called <span class="pl-s"><span class="pl-pds">"</span>TREE2<span class="pl-pds">"</span></span>
TreeSet with <span class="pl-c1">2</span> trees, each with <span class="pl-c1">507</span> tips.
Tree names are TREE2 and TREE1

TREE1<span class="pl-k">:</span> RootedTree with <span class="pl-c1">507</span> tips, <span class="pl-c1">1013</span> nodes and <span class="pl-c1">1012</span> branches.
Leaf names are H1N1_A_BRAZIL_11_1978, H1N1_A_TAHITI_8_1998, H1N1_A_TAIWAN_1_1986, H1N1_A_BAYERN_7_1995, H1N1_A_ENGLAND_45_1998, <span class="pl-k">...</span> [<span class="pl-c1">501</span> omitted] <span class="pl-k">...</span> and H1N1_A_PUERTORICO_8_1934

TREE2<span class="pl-k">:</span> RootedTree with <span class="pl-c1">507</span> tips, <span class="pl-c1">1013</span> nodes and <span class="pl-c1">1012</span> branches.
Leaf names are H1N1_A_BRAZIL_11_1978, H1N1_A_TAHITI_8_1998, H1N1_A_TAIWAN_1_1986, H1N1_A_BAYERN_7_1995, H1N1_A_ENGLAND_45_1998, <span class="pl-k">...</span> [<span class="pl-c1">501</span> omitted] <span class="pl-k">...</span> and H1N1_A_PUERTORICO_8_1934


julia<span class="pl-k">&gt;</span> ts[<span class="pl-s"><span class="pl-pds">"</span>TREE1<span class="pl-pds">"</span></span>]
RootedTree with <span class="pl-c1">507</span> tips, <span class="pl-c1">1013</span> nodes and <span class="pl-c1">1012</span> branches.
Leaf names are H1N1_A_BRAZIL_11_1978, H1N1_A_TAHITI_8_1998, H1N1_A_TAIWAN_1_1986, H1N1_A_BAYERN_7_1995, H1N1_A_ENGLAND_45_1998, <span class="pl-k">...</span> [<span class="pl-c1">501</span> omitted] <span class="pl-k">...</span> and H1N1_A_PUERTORICO_8_1934


julia<span class="pl-k">&gt;</span> <span class="pl-c1">gettreeinfo</span>(ts)
Dict{String, Dict{String, Any}} with <span class="pl-c1">2</span> entries<span class="pl-k">:</span>
  <span class="pl-s"><span class="pl-pds">"</span>TREE2<span class="pl-pds">"</span></span> <span class="pl-k">=&gt;</span> <span class="pl-c1">Dict</span>(<span class="pl-s"><span class="pl-pds">"</span>lnP<span class="pl-pds">"</span></span><span class="pl-k">=&gt;</span><span class="pl-k">-</span><span class="pl-c1">1.0</span>)
  <span class="pl-s"><span class="pl-pds">"</span>TREE1<span class="pl-pds">"</span></span> <span class="pl-k">=&gt;</span> <span class="pl-c1">Dict</span>(<span class="pl-s"><span class="pl-pds">"</span>lnP<span class="pl-pds">"</span></span><span class="pl-k">=&gt;</span><span class="pl-c1">1.0</span>)

julia<span class="pl-k">&gt;</span> <span class="pl-c1">gettreeinfo</span>(ts, <span class="pl-s"><span class="pl-pds">"</span>TREE1<span class="pl-pds">"</span></span>)
Dict{String, Any} with <span class="pl-c1">1</span> entry<span class="pl-k">:</span>
  <span class="pl-s"><span class="pl-pds">"</span>lnP<span class="pl-pds">"</span></span> <span class="pl-k">=&gt;</span> <span class="pl-c1">1.0</span></pre></div>
<h3 dir="auto"><a id="user-content-calculating-metrics" class="anchor" aria-hidden="true" href="#calculating-metrics"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a>Calculating metrics</h3>
<p dir="auto">We so far only support calculating a few metrics on trees, but will gradually be added. Open an issue with a request!</p>
<div class="highlight highlight-source-julia notranslate position-relative overflow-auto" dir="auto" data-snippet-clipboard-copy-content="julia&gt; species = getleaves(tree)[[2, 5, 8, 12, 22]];  # take 5 tips from the phylogeny (or use names)

julia&gt; mrca(tree, species)                 # Identify the MRCA (Most Recent Common Ancestor)
LinkNode Node 65, an internal node with 1 inbound and 2 outbound connections (branches 999 and 61, 62)"><pre>julia<span class="pl-k">&gt;</span> species <span class="pl-k">=</span> <span class="pl-c1">getleaves</span>(tree)[[<span class="pl-c1">2</span>, <span class="pl-c1">5</span>, <span class="pl-c1">8</span>, <span class="pl-c1">12</span>, <span class="pl-c1">22</span>]];  <span class="pl-c"><span class="pl-c">#</span> take 5 tips from the phylogeny (or use names)</span>

julia<span class="pl-k">&gt;</span> <span class="pl-c1">mrca</span>(tree, species)                 <span class="pl-c"><span class="pl-c">#</span> Identify the MRCA (Most Recent Common Ancestor)</span>
LinkNode Node <span class="pl-c1">65</span>, an internal node with <span class="pl-c1">1</span> inbound and <span class="pl-c1">2</span> outbound connections (branches <span class="pl-c1">999</span> and <span class="pl-c1">61</span>, <span class="pl-c1">62</span>)</pre></div>
<h3 dir="auto"><a id="user-content-r-interface" class="anchor" aria-hidden="true" href="#r-interface"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a>R interface</h3>
<p dir="auto">And while we wait for me (or kind <a href="https://github.com/EcoJulia/Phylo.jl/pulls">contributors</a>!) to fill out
the other extensive functionality that many phylogenetics packages
have in other languages, the other important feature that it offers is
a fully(?)-functional interface to R, allowing any existing R library
functions to be carried out on julia trees, and trees to be read from
disk and written using R helper functions. Naturally the medium-term
plan is to fill in as many of these gaps as possible in Julia, so the R interface does not make RCall a dependency of the package (we use the
<code>Requires</code> package to avoid dependencies). Instead, if you want to use
the R interface you just need to use both packages:</p>
<div class="highlight highlight-source-julia notranslate position-relative overflow-auto" dir="auto" data-snippet-clipboard-copy-content="julia&gt; using Phylo

julia&gt; using RCall
Creating Phylo RCall interface...

R&gt; library(ape)"><pre>julia<span class="pl-k">&gt;</span> <span class="pl-k">using</span> Phylo

julia<span class="pl-k">&gt;</span> <span class="pl-k">using</span> RCall
Creating Phylo RCall interface<span class="pl-k">...</span>

R<span class="pl-k">&gt;</span> <span class="pl-c1">library</span>(ape)</pre></div>
<p dir="auto">You can then translate back and forth using <code>rcopy</code> on
R <code>phylo</code> objects, and <code>RObject</code> constructors on julia <code>NamedTree</code>
types to keep them in Julia or <code>@rput</code> to move the object into R:</p>
<div class="highlight highlight-source-julia notranslate position-relative overflow-auto" dir="auto" data-snippet-clipboard-copy-content="julia&gt; rt = rcall(:rtree, 10)
RCall.RObject{RCall.VecSxp}

Phylogenetic tree with 10 tips and 9 internal nodes.

Tip labels:
  t10, t8, t1, t2, t6, t5, ...

Rooted; includes branch lengths.

julia&gt; jt = rcopy(NamedTree, rt)
NamedTree with 10 tips, 19 nodes and 18 branches.
Leaf names are t8, t3, t7, t9, t6, ... [4 omitted] ... and t1

julia&gt; rjt = RObject(jt); # manually translate it back to R

R&gt; if (all.equal($rjt, $rt)) &quot;no damage in translation&quot;
[1] &quot;no damage in translation&quot;

julia&gt; @rput rt; # Or use macros to pass R object back to R

julia&gt; @rput jt; # And automatically translate jt back to R

R&gt; jt

Phylogenetic tree with 10 tips and 9 internal nodes.

Tip labels:
  t10, t8, t1, t2, t6, t5, ...

Rooted; includes branch lengths.

R&gt; if (all.equal(rt, jt)) &quot;no damage in translation&quot;
[1] &quot;no damage in translation&quot;"><pre>julia<span class="pl-k">&gt;</span> rt <span class="pl-k">=</span> <span class="pl-c1">rcall</span>(<span class="pl-c1">:rtree</span>, <span class="pl-c1">10</span>)
RCall<span class="pl-k">.</span>RObject{RCall<span class="pl-k">.</span>VecSxp}

Phylogenetic tree with <span class="pl-c1">10</span> tips and <span class="pl-c1">9</span> internal nodes.

Tip labels<span class="pl-k">:</span>
  t10, t8, t1, t2, t6, t5, <span class="pl-k">...</span>

Rooted; includes branch lengths.

julia<span class="pl-k">&gt;</span> jt <span class="pl-k">=</span> <span class="pl-c1">rcopy</span>(NamedTree, rt)
NamedTree with <span class="pl-c1">10</span> tips, <span class="pl-c1">19</span> nodes and <span class="pl-c1">18</span> branches.
Leaf names are t8, t3, t7, t9, t6, <span class="pl-k">...</span> [<span class="pl-c1">4</span> omitted] <span class="pl-k">...</span> and t1

julia<span class="pl-k">&gt;</span> rjt <span class="pl-k">=</span> <span class="pl-c1">RObject</span>(jt); <span class="pl-c"><span class="pl-c">#</span> manually translate it back to R</span>

R<span class="pl-k">&gt;</span> <span class="pl-k">if</span> (all<span class="pl-k">.</span><span class="pl-c1">equal</span>(<span class="pl-k">$</span>rjt, <span class="pl-k">$</span>rt)) <span class="pl-s"><span class="pl-pds">"</span>no damage in translation<span class="pl-pds">"</span></span>
[<span class="pl-c1">1</span>] <span class="pl-s"><span class="pl-pds">"</span>no damage in translation<span class="pl-pds">"</span></span>

julia<span class="pl-k">&gt;</span> <span class="pl-c1">@rput</span> rt; <span class="pl-c"><span class="pl-c">#</span> Or use macros to pass R object back to R</span>

julia<span class="pl-k">&gt;</span> <span class="pl-c1">@rput</span> jt; <span class="pl-c"><span class="pl-c">#</span> And automatically translate jt back to R</span>

R<span class="pl-k">&gt;</span> jt

Phylogenetic tree with <span class="pl-c1">10</span> tips and <span class="pl-c1">9</span> internal nodes.

Tip labels<span class="pl-k">:</span>
  t10, t8, t1, t2, t6, t5, <span class="pl-k">...</span>

Rooted; includes branch lengths.

R<span class="pl-k">&gt;</span> <span class="pl-k">if</span> (all<span class="pl-k">.</span><span class="pl-c1">equal</span>(rt, jt)) <span class="pl-s"><span class="pl-pds">"</span>no damage in translation<span class="pl-pds">"</span></span>
[<span class="pl-c1">1</span>] <span class="pl-s"><span class="pl-pds">"</span>no damage in translation<span class="pl-pds">"</span></span></pre></div>
<p dir="auto">For the time being the code will only work with rooted trees
with named tips and branch lengths. If there's <a href="https://github.com/EcoJuli/Phylo.jl/issues">demand</a>
for other types of trees, I'll look into it.</p>
<h3 dir="auto"><a id="user-content-trait-evolution" class="anchor" aria-hidden="true" href="#trait-evolution"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a>Trait evolution</h3>
<p dir="auto">As far as traits are concerned, these can be continuous pr
discrete. First a continuous trait:</p>
<div class="highlight highlight-source-julia notranslate position-relative overflow-auto" dir="auto" data-snippet-clipboard-copy-content="julia&gt; using Phylo, Plots, DataFrames, Random

julia&gt; tree = rand(Nonultrametric(100)) # Defaults to mean tree depth of 1.0
RootedTree with 100 tips, 199 nodes and 198 branches.
Leaf names are tip 41, tip 7, tip 37, tip 81, tip 88, ... [94 omitted] ... and tip 89

julia&gt; rand!(BrownianTrait(tree, &quot;Trait&quot;), tree)  # Defaults to starting at 0.0, variance 1.0
RootedTree with 100 tips, 199 nodes and 198 branches.
Leaf names are tip 41, tip 7, tip 37, tip 81, tip 88, ... [94 omitted] ... and tip 89

julia&gt; plot(tree, line_z = &quot;Trait&quot;, lw = 2)

julia&gt; d = DataFrame(nodename=getnodename.(tree, traversal(tree, preorder)), trait=getnodedata.(tree, traversal(tree, preorder), &quot;Trait&quot;))
199×2 DataFrame
│ Row │ nodename │ trait      │
│     │ String   │ Float64    │
├─────┼──────────┼────────────┤
│ 1   │ Node 199 │ 0.0        │
│ 2   │ Node 198 │ 0.334372   │
│ 3   │ Node 163 │ 0.734348   │
│ 4   │ Node 138 │ 0.588014   │
│ 5   │ tip 41   │ 0.749697   │
⋮
│ 195 │ tip 64   │ -0.791095  │
│ 196 │ tip 75   │ -0.4173    │
│ 197 │ tip 82   │ -0.305623  │
│ 198 │ tip 71   │ -0.868774  │
│ 199 │ tip 89   │ -0.30126   │"><pre>julia<span class="pl-k">&gt;</span> <span class="pl-k">using</span> Phylo, Plots, DataFrames, Random

julia<span class="pl-k">&gt;</span> tree <span class="pl-k">=</span> <span class="pl-c1">rand</span>(<span class="pl-c1">Nonultrametric</span>(<span class="pl-c1">100</span>)) <span class="pl-c"><span class="pl-c">#</span> Defaults to mean tree depth of 1.0</span>
RootedTree with <span class="pl-c1">100</span> tips, <span class="pl-c1">199</span> nodes and <span class="pl-c1">198</span> branches.
Leaf names are tip <span class="pl-c1">41</span>, tip <span class="pl-c1">7</span>, tip <span class="pl-c1">37</span>, tip <span class="pl-c1">81</span>, tip <span class="pl-c1">88</span>, <span class="pl-k">...</span> [<span class="pl-c1">94</span> omitted] <span class="pl-k">...</span> and tip <span class="pl-c1">89</span>

julia<span class="pl-k">&gt;</span> <span class="pl-c1">rand!</span>(<span class="pl-c1">BrownianTrait</span>(tree, <span class="pl-s"><span class="pl-pds">"</span>Trait<span class="pl-pds">"</span></span>), tree)  <span class="pl-c"><span class="pl-c">#</span> Defaults to starting at 0.0, variance 1.0</span>
RootedTree with <span class="pl-c1">100</span> tips, <span class="pl-c1">199</span> nodes and <span class="pl-c1">198</span> branches.
Leaf names are tip <span class="pl-c1">41</span>, tip <span class="pl-c1">7</span>, tip <span class="pl-c1">37</span>, tip <span class="pl-c1">81</span>, tip <span class="pl-c1">88</span>, <span class="pl-k">...</span> [<span class="pl-c1">94</span> omitted] <span class="pl-k">...</span> and tip <span class="pl-c1">89</span>

julia<span class="pl-k">&gt;</span> <span class="pl-c1">plot</span>(tree, line_z <span class="pl-k">=</span> <span class="pl-s"><span class="pl-pds">"</span>Trait<span class="pl-pds">"</span></span>, lw <span class="pl-k">=</span> <span class="pl-c1">2</span>)

julia<span class="pl-k">&gt;</span> d <span class="pl-k">=</span> <span class="pl-c1">DataFrame</span>(nodename<span class="pl-k">=</span><span class="pl-c1">getnodename</span>.(tree, <span class="pl-c1">traversal</span>(tree, preorder)), trait<span class="pl-k">=</span><span class="pl-c1">getnodedata</span>.(tree, <span class="pl-c1">traversal</span>(tree, preorder), <span class="pl-s"><span class="pl-pds">"</span>Trait<span class="pl-pds">"</span></span>))
<span class="pl-c1">199</span><span class="pl-k">×</span><span class="pl-c1">2</span> DataFrame
│ Row │ nodename │ trait      │
│     │ String   │ Float64    │
├─────┼──────────┼────────────┤
│ <span class="pl-c1">1</span>   │ Node <span class="pl-c1">199</span> │ <span class="pl-c1">0.0</span>        │
│ <span class="pl-c1">2</span>   │ Node <span class="pl-c1">198</span> │ <span class="pl-c1">0.334372</span>   │
│ <span class="pl-c1">3</span>   │ Node <span class="pl-c1">163</span> │ <span class="pl-c1">0.734348</span>   │
│ <span class="pl-c1">4</span>   │ Node <span class="pl-c1">138</span> │ <span class="pl-c1">0.588014</span>   │
│ <span class="pl-c1">5</span>   │ tip <span class="pl-c1">41</span>   │ <span class="pl-c1">0.749697</span>   │
⋮
│ <span class="pl-c1">195</span> │ tip <span class="pl-c1">64</span>   │ <span class="pl-k">-</span><span class="pl-c1">0.791095</span>  │
│ <span class="pl-c1">196</span> │ tip <span class="pl-c1">75</span>   │ <span class="pl-k">-</span><span class="pl-c1">0.4173</span>    │
│ <span class="pl-c1">197</span> │ tip <span class="pl-c1">82</span>   │ <span class="pl-k">-</span><span class="pl-c1">0.305623</span>  │
│ <span class="pl-c1">198</span> │ tip <span class="pl-c1">71</span>   │ <span class="pl-k">-</span><span class="pl-c1">0.868774</span>  │
│ <span class="pl-c1">199</span> │ tip <span class="pl-c1">89</span>   │ <span class="pl-k">-</span><span class="pl-c1">0.30126</span>   │</pre></div>
<p dir="auto"><a target="_blank" rel="noopener noreferrer" href="docs/img/browniantree.png"><img src="docs/img/browniantree.png" alt="Continuous trait tree plot" style="max-width: 100%;"></a></p>
<p dir="auto">Then a discrete trait:</p>
<div class="highlight highlight-source-julia notranslate position-relative overflow-auto" dir="auto" data-snippet-clipboard-copy-content="julia&gt; @enum TemperatureTrait lowTempPref midTempPref highTempPref

julia&gt; rand!(SymmetricDiscreteTrait(tree, TemperatureTrait, 0.4), tree);

julia&gt; plot(tree, marker_group = &quot;TemperatureTrait&quot;, legend = :topleft,
            msc = :white, treetype = :fan, c = [:red :blue :green])

julia&gt; d = DataFrame(nodename=getnodename.(tree, traversal(tree, preorder)), trait=getnodedata.(tree, traversal(tree, preorder), &quot;TemperatureTrait&quot;))
199×2 DataFrame
│ Row │ nodename │ trait                              │
│     │ String   │ TemperatureTrait                   │
├─────┼──────────┼────────────────────────────────────┤
│ 1   │ Node 199 │ highTempPref::TemperatureTrait = 2 │
│ 2   │ Node 198 │ lowTempPref::TemperatureTrait = 0  │
│ 3   │ Node 163 │ lowTempPref::TemperatureTrait = 0  │
│ 4   │ Node 138 │ lowTempPref::TemperatureTrait = 0  │
│ 5   │ tip 41   │ lowTempPref::TemperatureTrait = 0  │
⋮
│ 195 │ tip 64   │ midTempPref::TemperatureTrait = 1  │
│ 196 │ tip 75   │ highTempPref::TemperatureTrait = 2 │
│ 197 │ tip 82   │ highTempPref::TemperatureTrait = 2 │
│ 198 │ tip 71   │ highTempPref::TemperatureTrait = 2 │
│ 199 │ tip 89   │ highTempPref::TemperatureTrait = 2 │"><pre>julia<span class="pl-k">&gt;</span> <span class="pl-c1">@enum</span> TemperatureTrait lowTempPref midTempPref highTempPref

julia<span class="pl-k">&gt;</span> <span class="pl-c1">rand!</span>(<span class="pl-c1">SymmetricDiscreteTrait</span>(tree, TemperatureTrait, <span class="pl-c1">0.4</span>), tree);

julia<span class="pl-k">&gt;</span> <span class="pl-c1">plot</span>(tree, marker_group <span class="pl-k">=</span> <span class="pl-s"><span class="pl-pds">"</span>TemperatureTrait<span class="pl-pds">"</span></span>, legend <span class="pl-k">=</span> <span class="pl-c1">:topleft</span>,
            msc <span class="pl-k">=</span> <span class="pl-c1">:white</span>, treetype <span class="pl-k">=</span> <span class="pl-c1">:fan</span>, c <span class="pl-k">=</span> [<span class="pl-c1">:red</span> <span class="pl-c1">:blue</span> <span class="pl-c1">:green</span>])

julia<span class="pl-k">&gt;</span> d <span class="pl-k">=</span> <span class="pl-c1">DataFrame</span>(nodename<span class="pl-k">=</span><span class="pl-c1">getnodename</span>.(tree, <span class="pl-c1">traversal</span>(tree, preorder)), trait<span class="pl-k">=</span><span class="pl-c1">getnodedata</span>.(tree, <span class="pl-c1">traversal</span>(tree, preorder), <span class="pl-s"><span class="pl-pds">"</span>TemperatureTrait<span class="pl-pds">"</span></span>))
<span class="pl-c1">199</span><span class="pl-k">×</span><span class="pl-c1">2</span> DataFrame
│ Row │ nodename │ trait                              │
│     │ String   │ TemperatureTrait                   │
├─────┼──────────┼────────────────────────────────────┤
│ <span class="pl-c1">1</span>   │ Node <span class="pl-c1">199</span> │ highTempPref<span class="pl-k">::</span><span class="pl-c1">TemperatureTrait</span> <span class="pl-k">=</span> <span class="pl-c1">2</span> │
│ <span class="pl-c1">2</span>   │ Node <span class="pl-c1">198</span> │ lowTempPref<span class="pl-k">::</span><span class="pl-c1">TemperatureTrait</span> <span class="pl-k">=</span> <span class="pl-c1">0</span>  │
│ <span class="pl-c1">3</span>   │ Node <span class="pl-c1">163</span> │ lowTempPref<span class="pl-k">::</span><span class="pl-c1">TemperatureTrait</span> <span class="pl-k">=</span> <span class="pl-c1">0</span>  │
│ <span class="pl-c1">4</span>   │ Node <span class="pl-c1">138</span> │ lowTempPref<span class="pl-k">::</span><span class="pl-c1">TemperatureTrait</span> <span class="pl-k">=</span> <span class="pl-c1">0</span>  │
│ <span class="pl-c1">5</span>   │ tip <span class="pl-c1">41</span>   │ lowTempPref<span class="pl-k">::</span><span class="pl-c1">TemperatureTrait</span> <span class="pl-k">=</span> <span class="pl-c1">0</span>  │
⋮
│ <span class="pl-c1">195</span> │ tip <span class="pl-c1">64</span>   │ midTempPref<span class="pl-k">::</span><span class="pl-c1">TemperatureTrait</span> <span class="pl-k">=</span> <span class="pl-c1">1</span>  │
│ <span class="pl-c1">196</span> │ tip <span class="pl-c1">75</span>   │ highTempPref<span class="pl-k">::</span><span class="pl-c1">TemperatureTrait</span> <span class="pl-k">=</span> <span class="pl-c1">2</span> │
│ <span class="pl-c1">197</span> │ tip <span class="pl-c1">82</span>   │ highTempPref<span class="pl-k">::</span><span class="pl-c1">TemperatureTrait</span> <span class="pl-k">=</span> <span class="pl-c1">2</span> │
│ <span class="pl-c1">198</span> │ tip <span class="pl-c1">71</span>   │ highTempPref<span class="pl-k">::</span><span class="pl-c1">TemperatureTrait</span> <span class="pl-k">=</span> <span class="pl-c1">2</span> │
│ <span class="pl-c1">199</span> │ tip <span class="pl-c1">89</span>   │ highTempPref<span class="pl-k">::</span><span class="pl-c1">TemperatureTrait</span> <span class="pl-k">=</span> <span class="pl-c1">2</span> │</pre></div>
<p dir="auto"><a target="_blank" rel="noopener noreferrer" href="docs/img/discretefan.png"><img src="docs/img/discretefan.png" alt="Discrete trait fan plot" style="max-width: 100%;"></a></p>
</article></div>