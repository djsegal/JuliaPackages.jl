<div id="readme" class="md" data-path="README.md"><article class="markdown-body entry-content container-lg" itemprop="text"><h1><a id="user-content-sentinelarraysjl" class="anchor" aria-hidden="true" href="#sentinelarraysjl"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>SentinelArrays.jl</h1>
<p><a href="https://github.com/JuliaData/SentinelArrays.jl/actions?query=workflow%3ACI"><img src="https://github.com/JuliaData/SentinelArrays.jl/workflows/CI/badge.svg" alt="CI" style="max-width:100%;"></a>
<a href="https://codecov.io/gh/JuliaData/SentinelArrays.jl" rel="nofollow"><img src="https://camo.githubusercontent.com/0319388e228a4fc7442973d33cf50a17db4f3c367024c2c9f93ec3de71a2a6f4/68747470733a2f2f636f6465636f762e696f2f67682f4a756c6961446174612f53656e74696e656c4172726179732e6a6c2f6272616e63682f6d61737465722f67726170682f62616467652e737667" alt="codecov" data-canonical-src="https://codecov.io/gh/JuliaData/SentinelArrays.jl/branch/master/graph/badge.svg" style="max-width:100%;"></a>
<a href="https://juliahub.com/ui/Packages/SentinelArrays/uMYVe?t=2" rel="nofollow"><img src="https://camo.githubusercontent.com/5170ede4c7cb8b769fc6e6dee89f055d915919a39ceb1b4add3317fa09843943/68747470733a2f2f6a756c69616875622e636f6d2f646f63732f53656e74696e656c4172726179732f646570732e737667" alt="deps" data-canonical-src="https://juliahub.com/docs/SentinelArrays/deps.svg" style="max-width:100%;"></a>
<a href="https://juliahub.com/ui/Packages/SentinelArrays/uMYVe" rel="nofollow"><img src="https://camo.githubusercontent.com/fb1d785793af43d12370554c2bfc59e437a783fbe37dfa420460034edfccf406/68747470733a2f2f6a756c69616875622e636f6d2f646f63732f53656e74696e656c4172726179732f76657273696f6e2e737667" alt="version" data-canonical-src="https://juliahub.com/docs/SentinelArrays/version.svg" style="max-width:100%;"></a>
<a href="https://juliahub.com/ui/Packages/SentinelArrays/uMYVe" rel="nofollow"><img src="https://camo.githubusercontent.com/af52c03c4d3f0dfcb4557529abc7888a5699681a98585171df9259407de72b3c/68747470733a2f2f6a756c69616875622e636f6d2f646f63732f53656e74696e656c4172726179732f706b676576616c2e737667" alt="pkgeval" data-canonical-src="https://juliahub.com/docs/SentinelArrays/pkgeval.svg" style="max-width:100%;"></a></p>
<p><em>Array types that can use sentinel values of the element type for special values</em></p>
<h2><a id="user-content-installation" class="anchor" aria-hidden="true" href="#installation"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>Installation</h2>
<p>The package is registered in the <a href="https://github.com/JuliaRegistries/General"><code>General</code></a> registry and so can be installed at the REPL with <code>] add SentinelArrays</code>.</p>
<h2><a id="user-content-usage" class="anchor" aria-hidden="true" href="#usage"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>Usage</h2>
<div class="snippet-clipboard-content position-relative" data-snippet-clipboard-copy-content="SentinelArray(A::AbstractArray, sentinel, value)
SentinelVector{T}(undef, len, sentinel, value)
SentinelArray{T, N}(undef, dims, sentinel, value)
"><pre><code>SentinelArray(A::AbstractArray, sentinel, value)
SentinelVector{T}(undef, len, sentinel, value)
SentinelArray{T, N}(undef, dims, sentinel, value)
</code></pre></div>
<p>Construct a <code>SentinelArray</code> by either wrapping an existing <code>AbstractArray</code> or using the standard <code>undef</code> pattern, which first constructs an <code>Array</code> to be wrapped by <code>SentinelArray</code>.</p>
<p>A <code>SentinelArray{T}</code> wraps an <code>AbstractArray</code> of type <code>T</code>, and accepts a <code>sentinel</code> and <code>value</code> argument. If the wrapped array has an element equal to <code>sentinel</code>, <code>value</code> is returned instead.
This allows, for example, simulating a <code>Vector{Union{Float64, Missing}}</code> by doing something like <code>SentinelVector{Float64}(undef, len, NaN, missing)</code>. The resulting <code>SentinelArray</code> will have
<code>eltype</code> equal to <code>Union{T, typeof(value)}</code>.</p>
<p>For isbits types, a random/reasonable sentinel will be attempted if none provided. For non-isbits, <code>#undef</code> is used as sentinel. The default value, if not provided, is <code>missing</code>.</p>
<p>A <code>SentinelArray</code> allows setting an element to <code>value</code>, which will result in the <code>sentinel</code> being stored in the wrapped array.</p>
<p>For isbits element types, if a <code>setindex!</code> operation is attempted with the <code>SentinelArray</code>'s current sentinel value, another sentinel will be attempted to be chosen that doesn't already exist in the wrapped array.
If another sentinel can't be found (i.e. the values already exist in the wrapped array), an error will be thrown.</p>
<h3><a id="user-content-caveats" class="anchor" aria-hidden="true" href="#caveats"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>Caveats</h3>
<ul>
<li>For float and date/time types, reasonable sentinels exist that don't have meaningful <em>real</em> values, so it's recommended to use the default sentinels</li>
<li>For <code>Integer</code> types, all bit patterns are valid, so a random value is chosen; if usage will involve extremely high cardinality relative to the type range, consider using <code>Vector{Union{T, Missing}}</code> instead</li>
<li><code>SentinelArray</code>s are not allowed to have plain <code>Bool</code> elements since there isn't a possible sentinel</li>
<li>A <code>SentinelArray</code> <em>IS NOT</em> thread-safe when usage relies on <code>setindex!</code> and potential sentinel collision (due to the check to automatically cycle the sentinel to another value); this will normally only affect small <code>Integer</code> element types where the potential for sentinel collision is highest</li>
<li>Access to a <code>SentinelArray</code>'s raw data is possible via <code>parent(A)</code> or <code>pointer(A)</code>, but note that the raw data will <em>NOT</em> respect the sentinel=&gt;value semantics; i.e. the raw data may have entries of the sentinel value.</li>
</ul>
<h3><a id="user-content-use-cases" class="anchor" aria-hidden="true" href="#use-cases"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>Use-cases</h3>
<ul>
<li>It is generally recommended to use <code>Vector{Union{T, typeof(value}}</code> instead of <code>SentinelArray</code> if possible</li>
<li>Currently, a non-copying operation like <code>convert(Vector{T}, A::Vector{Union{T, Missing}})</code> isn't possible, even though you may know there aren't <code>missing</code> values; a <code>SentinelArray</code> allows this operation by just "unwrapping" the storage array, like <code>parent(A)</code></li>
<li>It's also currently not possible to use <code>Vector{Union{T, Missing}}</code> with <code>Mmap.mmap</code>; with <code>SentinelArray</code>, you can write the parent array to disk and then do <code>SentinelArray(Mmap.mmap(array_type, file))</code> (assuming usage of default sentinel/value)</li>
</ul>
<h3><a id="user-content-examples" class="anchor" aria-hidden="true" href="#examples"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>Examples</h3>
<div class="highlight highlight-source-julia position-relative" data-snippet-clipboard-copy-content="# initialize a new SentinelArray with default sentinel/value
A = SentinelVector{Float64}(undef, 10)

# wrap an existing array, manually providing sentinel/value
parent = zeros(UInt8, 10)
B = SentinelArray(parent, typemax(UInt8), nothing)
"><pre><span class="pl-c"><span class="pl-c">#</span> initialize a new SentinelArray with default sentinel/value</span>
A <span class="pl-k">=</span> <span class="pl-c1">SentinelVector</span><span class="pl-c1">{Float64}</span>(undef, <span class="pl-c1">10</span>)

<span class="pl-c"><span class="pl-c">#</span> wrap an existing array, manually providing sentinel/value</span>
parent <span class="pl-k">=</span> <span class="pl-c1">zeros</span>(UInt8, <span class="pl-c1">10</span>)
B <span class="pl-k">=</span> <span class="pl-c1">SentinelArray</span>(parent, <span class="pl-c1">typemax</span>(UInt8), <span class="pl-c1">nothing</span>)</pre></div>
<h2><a id="user-content-project-status" class="anchor" aria-hidden="true" href="#project-status"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>Project Status</h2>
<p>The package is tested against Julia <code>1.0</code>, current stable release, and nightly on Linux, OS X, and Windows.</p>
<h2><a id="user-content-contributing-and-questions" class="anchor" aria-hidden="true" href="#contributing-and-questions"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>Contributing and Questions</h2>
<p>Contributions are very welcome, as are feature requests and suggestions. Please open an
<a href="https://github.com/JuliaData/SentinelArrays.jl/issues">issue</a> if you encounter any problems or would just like to ask a question.</p>
</article></div>