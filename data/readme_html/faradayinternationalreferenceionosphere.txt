<div id="readme" class="md" data-path="README.md"><article class="markdown-body entry-content container-lg" itemprop="text"><h1 dir="auto"><a id="user-content-faradayinternationalreferenceionospherejl" class="anchor" aria-hidden="true" href="#faradayinternationalreferenceionospherejl"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a>FaradayInternationalReferenceIonosphere.jl</h1>
<p dir="auto"><a href="https://zenodo.org/badge/latestdoi/332354802" rel="nofollow"><img src="https://camo.githubusercontent.com/a23b68996a7aa72d49c35391d1c6eb869b498741f7ac988c4ea108d42e21932f/68747470733a2f2f7a656e6f646f2e6f72672f62616467652f3333323335343830322e737667" alt="DOI" data-canonical-src="https://zenodo.org/badge/332354802.svg" style="max-width: 100%;"></a></p>
<p dir="auto"><strong>Julia tools for working with FIRI ionosphere profiles.</strong></p>
<p dir="auto">The Faraday-International Reference Ionosphere (FIRI) is a semiempirical model of the nonauroral ionosphere that enhances and extends the IRI model down to 60 km and densities above 10⁶ e-/m³. FIRI blends results from a simple ion-chemical model with sounding rocket profiles made by Langmuir probe and HF Faraday rotation measurements. FIRI-2018 is the most recent version of the model by M. Friedrich, C. Pock, and K. Torkar, but it was originally published in 2001 by Friedrich and Torkar. See the <a href="#citations">Citations</a> section below.</p>
<p dir="auto"><a target="_blank" rel="noopener noreferrer" href="sza_extrap.png"><img src="sza_extrap.png" alt="sza_extrap" style="max-width: 100%;"></a></p>
<h2 dir="auto"><a id="user-content-usage" class="anchor" aria-hidden="true" href="#usage"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a>Usage</h2>
<p dir="auto">Only one function is exported from FaradayInternationalReferenceIonosphere: <code>firi</code>. <code>firi</code> returns the average profile after filtering the model by the keyword arguments to the function.</p>
<div class="highlight highlight-source-julia notranslate position-relative overflow-auto" dir="auto" data-snippet-clipboard-copy-content="profile = firi(; chi=(0, 130), lat=(0, 60), f10_7=(75, 200), month=(1, 12))"><pre>profile <span class="pl-k">=</span> <span class="pl-c1">firi</span>(; chi<span class="pl-k">=</span>(<span class="pl-c1">0</span>, <span class="pl-c1">130</span>), lat<span class="pl-k">=</span>(<span class="pl-c1">0</span>, <span class="pl-c1">60</span>), f10_7<span class="pl-k">=</span>(<span class="pl-c1">75</span>, <span class="pl-c1">200</span>), month<span class="pl-k">=</span>(<span class="pl-c1">1</span>, <span class="pl-c1">12</span>))</pre></div>
<p dir="auto">Each of the keyword arguments can either be a <code>Tuple</code> that inclusively brackets the range of values to be included in the average profile or can be a single value. Note that no interpolation occurs! If the value specified for <code>f10_7</code> is <code>100</code> (which is not one of the values in the model output) then a warning will be printed and an empty profile will be
returned.</p>
<blockquote>
<p dir="auto"><g-emoji class="g-emoji" alias="star" fallback-src="https://github.githubassets.com/images/icons/emoji/unicode/2b50.png">⭐</g-emoji> <strong>Tip:</strong></p>
<p dir="auto">For convenience, load the package into your environment like</p>
<div class="highlight highlight-source-julia notranslate position-relative overflow-auto" dir="auto" data-snippet-clipboard-copy-content="using FaradayInternationalReferenceIonosphere
import FaradayInternationalReferenceIonosphere as FIRI"><pre><span class="pl-k">using</span> FaradayInternationalReferenceIonosphere
<span class="pl-k">import</span> FaradayInternationalReferenceIonosphere <span class="pl-k">as</span> FIRI</pre></div>
<p dir="auto">The first line brings <code>firi</code> into scope. If that's all you need, then you can stop there. However, the second line lets you reference the package using the shorthand <code>FIRI</code>. I assume the package has been loaded this way in the examples below.</p>
</blockquote>
<p dir="auto">The raw model data can be accessed as <code>FIRI.ALTITUDE</code> for a <code>Vector</code> of the altitude in meters, <code>FIRI.DATA</code> for a <code>Matrix</code> of each electron density profile in electrons per cubic meter, and <code>FIRI.HEADER</code> for a <code>Table</code> with each combination of FIRI model parameters. To find the acceptable values of the <code>f10_7</code> field, for example, you can use</p>
<div class="highlight highlight-source-julia notranslate position-relative overflow-auto" dir="auto" data-snippet-clipboard-copy-content="unique(FIRI.HEADER.f10_7)"><pre><span class="pl-c1">unique</span>(FIRI<span class="pl-k">.</span>HEADER<span class="pl-k">.</span>f10_7)</pre></div>
<p dir="auto">Although day of year ("DOY") appears as an independent field in the original published FIRI model file, this is entirely redundant with the month number. Each day of year simply corresponds to the day number in the middle of each month. Therefore, we use only the month field.</p>
<p dir="auto">The keyword defaults bracket the full range of each field so that no filtering occurs.</p>
<h3 dir="auto"><a id="user-content-interpolation-across-latitude-and-solar-zenith-angle" class="anchor" aria-hidden="true" href="#interpolation-across-latitude-and-solar-zenith-angle"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a>Interpolation across latitude and solar zenith angle</h3>
<p dir="auto">The latitude and solar zenith angle (<code>chi</code>) fields can be interpolated with the function form</p>
<div class="highlight highlight-source-julia notranslate position-relative overflow-auto" dir="auto" data-snippet-clipboard-copy-content="profile = firi(chi, lat; f10_7=(75, 200), month=(1, 12))"><pre>profile <span class="pl-k">=</span> <span class="pl-c1">firi</span>(chi, lat; f10_7<span class="pl-k">=</span>(<span class="pl-c1">75</span>, <span class="pl-c1">200</span>), month<span class="pl-k">=</span>(<span class="pl-c1">1</span>, <span class="pl-c1">12</span>))</pre></div>
<p dir="auto">This performs a simple linear interpolation at each altitude of the profile for the specified <code>chi</code> and <code>lat</code>. The latitude can also be linearly extrapolated beyond 60°. If a <code>chi</code> or <code>lat</code> less than 0° is provided, a warning is thrown. According to Friedrich et al., 2018, although FIRI is only valid for the Northern Hemisphere, it can be used to predict values for the Southern Hemisphere by adding 6 months. Any <code>chi</code> greater than 130° (night) returns the profiles for exactly 130°.</p>
<h3 dir="auto"><a id="user-content-quantiles" class="anchor" aria-hidden="true" href="#quantiles"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a>Quantiles</h3>
<p dir="auto">The average profile returned by <code>firi</code> is skewed towards higher electron densities. If preferred, profile quantiles can be returned with the function <code>FIRI.quantile</code>. The quantile function is not exported to avoid collisions with <code>Statistics.quantile</code>. The usage of <code>FIRI.quantile</code> is similar to <code>firi</code>, except the quantile(s) are specified by <code>p</code> on the interval [0, 1].</p>
<div class="highlight highlight-source-julia notranslate position-relative overflow-auto" dir="auto" data-snippet-clipboard-copy-content="profile = FIRI.quantile(p; chi=(0, 130), lat=(0, 60), f10_7=(75, 200), month=(1, 12))"><pre>profile <span class="pl-k">=</span> FIRI<span class="pl-k">.</span><span class="pl-c1">quantile</span>(p; chi<span class="pl-k">=</span>(<span class="pl-c1">0</span>, <span class="pl-c1">130</span>), lat<span class="pl-k">=</span>(<span class="pl-c1">0</span>, <span class="pl-c1">60</span>), f10_7<span class="pl-k">=</span>(<span class="pl-c1">75</span>, <span class="pl-c1">200</span>), month<span class="pl-k">=</span>(<span class="pl-c1">1</span>, <span class="pl-c1">12</span>))</pre></div>
<p dir="auto">There is also an interpolating form</p>
<div class="highlight highlight-source-julia notranslate position-relative overflow-auto" dir="auto" data-snippet-clipboard-copy-content="profile = FIRI.quantile(chi, lat, p; f10_7=(75, 200), month=(1, 12))"><pre>profile <span class="pl-k">=</span> FIRI<span class="pl-k">.</span><span class="pl-c1">quantile</span>(chi, lat, p; f10_7<span class="pl-k">=</span>(<span class="pl-c1">75</span>, <span class="pl-c1">200</span>), month<span class="pl-k">=</span>(<span class="pl-c1">1</span>, <span class="pl-c1">12</span>))</pre></div>
<h3 dir="auto"><a id="user-content-extrapolation-by-altitude" class="anchor" aria-hidden="true" href="#extrapolation-by-altitude"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a>Extrapolation by altitude</h3>
<p dir="auto">To extrapolate the bottom of a profile to lower altitudes, use <code>FIRI.extrapolate</code>. This function will also interpolate to new (finer or coarser) altitudes in <code>newz</code>.</p>
<p dir="auto">The function call is</p>
<div class="highlight highlight-source-julia notranslate position-relative overflow-auto" dir="auto" data-snippet-clipboard-copy-content="newprofile = FIRI.extrapolate([z,] profile, newz)"><pre>newprofile <span class="pl-k">=</span> FIRI<span class="pl-k">.</span><span class="pl-c1">extrapolate</span>([z,] profile, newz)</pre></div>
<h2 dir="auto"><a id="user-content-citations" class="anchor" aria-hidden="true" href="#citations"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a>Citations</h2>
<p dir="auto">Friedrich, M., and Torkar, K. M. (2001). FIRI: A semiempirical model of the lower ionosphere. Journal of Geophysical Research: Space Physics, 106, 21409-21418. <a href="https://doi.org/10.1029/2001JA900070" rel="nofollow">doi: 10.1029/2001JA900070</a></p>
<p dir="auto">Friedrich, M., Pock, C., &amp; Torkar, K. (2018). FIRI-2018, an updated empirical model of the lower ionosphere. Journal of Geophysical Research: Space Physics, 123, 6737-6751. <a href="https://doi.org/10.1029/2018JA025437" rel="nofollow">doi: 10.1029/2018JA025437</a></p>
</article></div>