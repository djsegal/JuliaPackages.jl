<div id="readme" class="md" data-path="README.md"><article class="markdown-body entry-content container-lg" itemprop="text"><h1 dir="auto"><a id="user-content-independenthypothesisweighting" class="anchor" aria-hidden="true" href="#independenthypothesisweighting"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a>IndependentHypothesisWeighting</h1>
<p dir="auto"><a href="https://github.com/nignatiadis/IndependentHypothesisWeighting.jl/actions/workflows/CI.yml?query=branch%3Amain"><img src="https://github.com/nignatiadis/IndependentHypothesisWeighting.jl/actions/workflows/CI.yml/badge.svg?branch=main" alt="Build Status" style="max-width: 100%;"></a>
<a href="https://codecov.io/gh/nignatiadis/IndependentHypothesisWeighting.jl" rel="nofollow"><img src="https://camo.githubusercontent.com/fb2d80c30bd02306a730a455c06fcdaf20357cf046515cfd1fda21659559832c/68747470733a2f2f636f6465636f762e696f2f67682f6e69676e617469616469732f496e646570656e64656e744879706f746865736973576569676874696e672e6a6c2f6272616e63682f6d61696e2f67726170682f62616467652e737667" alt="Coverage" data-canonical-src="https://codecov.io/gh/nignatiadis/IndependentHypothesisWeighting.jl/branch/main/graph/badge.svg" style="max-width: 100%;"></a></p>
<p dir="auto">This package provides a preliminary implementation of the Independent Hypothesis Weighting method for multiple testing with side-information, as described in:</p>
<blockquote>
<p dir="auto">Ignatiadis N, Huber W (2021). “<a href="https://rss.onlinelibrary.wiley.com/doi/10.1111/rssb.12411" rel="nofollow">Covariate powered cross-weighted multiple testing.</a>” Journal of the Royal Statistical Society: Series B (Statistical Methodology), 83: 720-751.</p>
</blockquote>
<blockquote>
<p dir="auto">Ignatiadis N, Klaus B, Zaugg J, Huber W (2016). “<a href="https://www.nature.com/articles/nmeth.3885" rel="nofollow">Data-driven hypothesis weighting increases detection power in genome-scale multiple testing.</a>” Nature Methods. doi: 10.1038/nmeth.3885, 13: 577–580.</p>
</blockquote>
<p dir="auto">This package is work in progress, so that we currently recommend using the R package <a href="https://bioconductor.org/packages/release/bioc/html/IHW.html" rel="nofollow">IHW</a>, which is available on Bioconductor. Also please see the <a href="https://github.com/juliangehring/MultipleTesting.jl">MultipleTesting.jl</a> package that provides methods for multiple testing without side-information (here we build upon the interface defined in MultipleTesting.jl).</p>
<h1 dir="auto"><a id="user-content-example-usage" class="anchor" aria-hidden="true" href="#example-usage"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a>Example Usage</h1>
<p dir="auto">Load packages:</p>
<div class="highlight highlight-source-julia notranslate position-relative overflow-auto" dir="auto" data-snippet-clipboard-copy-content="using Distributions
using IndependentHypothesisWeighting
using Random
using StatsBase"><pre><span class="pl-k">using</span> Distributions
<span class="pl-k">using</span> IndependentHypothesisWeighting
<span class="pl-k">using</span> Random
<span class="pl-k">using</span> StatsBase</pre></div>
<p dir="auto">Generate synthetic data: 10,000 p-values that can be partitioned into two groups, as encoded by the side-information <code>Xs</code>.</p>
<div class="highlight highlight-source-julia notranslate position-relative overflow-auto" dir="auto" data-snippet-clipboard-copy-content="Random.seed!(1)
Xs = CategoricalVector(sample(1:2, 10000))
Ps = rand(BetaUniformMixtureModel(0.7, 0.2), 10000) .* (Xs.==1) .+ rand(Uniform(), 10000) .* (Xs.==2) "><pre>Random<span class="pl-k">.</span><span class="pl-c1">seed!</span>(<span class="pl-c1">1</span>)
Xs <span class="pl-k">=</span> <span class="pl-c1">CategoricalVector</span>(<span class="pl-c1">sample</span>(<span class="pl-c1">1</span><span class="pl-k">:</span><span class="pl-c1">2</span>, <span class="pl-c1">10000</span>))
Ps <span class="pl-k">=</span> <span class="pl-c1">rand</span>(<span class="pl-c1">BetaUniformMixtureModel</span>(<span class="pl-c1">0.7</span>, <span class="pl-c1">0.2</span>), <span class="pl-c1">10000</span>) <span class="pl-k">.*</span> (Xs<span class="pl-k">.==</span><span class="pl-c1">1</span>) <span class="pl-k">.+</span> <span class="pl-c1">rand</span>(<span class="pl-c1">Uniform</span>(), <span class="pl-c1">10000</span>) <span class="pl-k">.*</span> (Xs<span class="pl-k">.==</span><span class="pl-c1">2</span>) </pre></div>
<p dir="auto">Suppose we seek to control the false discovery rate at 10%. As a baseline, that does not use the grouping side-information,
we may run the Benjamini-Hochberg procedure:</p>
<div class="highlight highlight-source-julia notranslate position-relative overflow-auto" dir="auto" data-snippet-clipboard-copy-content="α = 0.1
sum(adjust(Ps, BenjaminiHochberg()) .&lt;= α ) # 580 discoveries"><pre>α <span class="pl-k">=</span> <span class="pl-c1">0.1</span>
<span class="pl-c1">sum</span>(<span class="pl-c1">adjust</span>(Ps, <span class="pl-c1">BenjaminiHochberg</span>()) <span class="pl-k">.&lt;=</span> α ) <span class="pl-c"><span class="pl-c">#</span> 580 discoveries</span></pre></div>
<p dir="auto">580 p-values are significant. Let us run Independent Hypothesis Weighting (IHW) with the grouping side-information:</p>
<div class="highlight highlight-source-julia notranslate position-relative overflow-auto" dir="auto" data-snippet-clipboard-copy-content="ihw_grenander = IHW(weight_learner = GrenanderLearner(), α = α)
ihw_grenander_fit = fit(ihw_grenander, Ps, Xs)
sum(adjust(ihw_grenander_fit) .&lt;= α) # 677 discoveries"><pre>ihw_grenander <span class="pl-k">=</span> <span class="pl-c1">IHW</span>(weight_learner <span class="pl-k">=</span> <span class="pl-c1">GrenanderLearner</span>(), α <span class="pl-k">=</span> α)
ihw_grenander_fit <span class="pl-k">=</span> <span class="pl-c1">fit</span>(ihw_grenander, Ps, Xs)
<span class="pl-c1">sum</span>(<span class="pl-c1">adjust</span>(ihw_grenander_fit) <span class="pl-k">.&lt;=</span> α) <span class="pl-c"><span class="pl-c">#</span> 677 discoveries</span></pre></div>
<p dir="auto">IHW increased the significant discoveries to 677.</p>
</article></div>