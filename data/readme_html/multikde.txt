<div id="readme" class="md" data-path="README.md"><article class="markdown-body entry-content container-lg" itemprop="text"><h1 dir="auto"><a id="user-content-multikde" class="anchor" aria-hidden="true" href="#multikde"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a>MultiKDE</h1>
<p dir="auto"><a href="https://github.com/noil-reed/MultiKDE.jl/actions"><img src="https://github.com/noil-reed/MultiKDE.jl/workflows/CI/badge.svg" alt="Actions Status" style="max-width: 100%;"></a>
<a href="https://app.codecov.io/gh/noil-reed/MultiKDE.jl" rel="nofollow"><img src="https://camo.githubusercontent.com/a25fa212a1cbf2ad82013b15de077c2addab5d374f82cf5291fd6ed61086eb2c/68747470733a2f2f636f6465636f762e696f2f67682f6e6f696c2d726565642f4d756c74694b44452e6a6c2f6272616e63682f6d61696e2f67726170682f62616467652e737667" alt="codecov" data-canonical-src="https://codecov.io/gh/noil-reed/MultiKDE.jl/branch/main/graph/badge.svg" style="max-width: 100%;"></a></p>
<p dir="auto">A kernel density estimation library, what make this one different from other Julia KDE libraries are:</p>
<ol dir="auto">
<li>Multidimension: Using <a href="https://csyue.nccu.edu.tw/ch/Kernel%20Estimation(Ref).pdf" rel="nofollow">product kernel</a> to estimate multi-dimensional kernel density.</li>
<li>Lazy evaluation: Doesn't pre-initialize a KDE, only evaluate points when necessary.</li>
<li>Categorical distribution: This library supports categorical KDE using two specific kernel functions <a href="https://academic.oup.com/biomet/article-abstract/68/1/301/237752?redirectedFrom=fulltext" rel="nofollow">Wang-Ryzin</a> and <a href="https://academic.oup.com/biomet/article-abstract/63/3/413/270829?redirectedFrom=fulltext" rel="nofollow">Aitchson-Aitken</a>, in which the former one is for categorical distribution that is ordered (age, amount...), the latter is for categorical distribution that is unordered (sex, the face of the coin...). When using unordered categorical distribution, non-numeric objects are also supported.</li>
</ol>
<h2 dir="auto"><a id="user-content-use" class="anchor" aria-hidden="true" href="#use"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a>Use</h2>
<h3 dir="auto"><a id="user-content-example-notebook" class="anchor" aria-hidden="true" href="#example-notebook"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a>Example <sub><sup><a href="https://github.com/noil-reed/notebooks/blob/main/MultiKDE_demo/demo.ipynb">[notebook]</a></sup></sub></h3>
<h4 dir="auto"><a id="user-content-one-dimension-kde" class="anchor" aria-hidden="true" href="#one-dimension-kde"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a>One-dimension KDE</h4>
<div class="highlight highlight-source-julia notranslate position-relative overflow-auto" dir="auto" data-snippet-clipboard-copy-content="
using MultiKDE
using Distributions, Random, Plots

# Simulation
bws = [0.05 0.1 0.5]
d = Normal(0, 1)
observations = rand(d, 50)
granularity_1d = 100
x = Vector(LinRange(minimum(observations), maximum(observations), granularity_1d))
ys = []
for bw in bws
    kde = KDEUniv(ContinuousDim(), bw, observations, MultiKDE.gaussian)
    y = [MultiKDE.pdf(kde, _x, keep_all=false) for _x in x]
    push!(ys, y)
end

# Plot
highest = maximum([maximum(y) for y in ys])
plot(x, ys, label=bws, fmt=:svg)
plot!(observations, [highest+0.05 for _ in 1:length(ys)], seriestype=:scatter, label=&quot;observations&quot;, size=(900, 450), legend=:outertopright)
"><pre><span class="pl-k">using</span> MultiKDE
<span class="pl-k">using</span> Distributions, Random, Plots

<span class="pl-c"><span class="pl-c">#</span> Simulation</span>
bws <span class="pl-k">=</span> [<span class="pl-c1">0.05</span> <span class="pl-c1">0.1</span> <span class="pl-c1">0.5</span>]
d <span class="pl-k">=</span> <span class="pl-c1">Normal</span>(<span class="pl-c1">0</span>, <span class="pl-c1">1</span>)
observations <span class="pl-k">=</span> <span class="pl-c1">rand</span>(d, <span class="pl-c1">50</span>)
granularity_1d <span class="pl-k">=</span> <span class="pl-c1">100</span>
x <span class="pl-k">=</span> <span class="pl-c1">Vector</span>(<span class="pl-c1">LinRange</span>(<span class="pl-c1">minimum</span>(observations), <span class="pl-c1">maximum</span>(observations), granularity_1d))
ys <span class="pl-k">=</span> []
<span class="pl-k">for</span> bw <span class="pl-k">in</span> bws
    kde <span class="pl-k">=</span> <span class="pl-c1">KDEUniv</span>(<span class="pl-c1">ContinuousDim</span>(), bw, observations, MultiKDE<span class="pl-k">.</span>gaussian)
    y <span class="pl-k">=</span> [MultiKDE<span class="pl-k">.</span><span class="pl-c1">pdf</span>(kde, _x, keep_all<span class="pl-k">=</span><span class="pl-c1">false</span>) <span class="pl-k">for</span> _x <span class="pl-k">in</span> x]
    <span class="pl-c1">push!</span>(ys, y)
<span class="pl-k">end</span>

<span class="pl-c"><span class="pl-c">#</span> Plot</span>
highest <span class="pl-k">=</span> <span class="pl-c1">maximum</span>([<span class="pl-c1">maximum</span>(y) <span class="pl-k">for</span> y <span class="pl-k">in</span> ys])
<span class="pl-c1">plot</span>(x, ys, label<span class="pl-k">=</span>bws, fmt<span class="pl-k">=</span><span class="pl-c1">:svg</span>)
<span class="pl-c1">plot!</span>(observations, [highest<span class="pl-k">+</span><span class="pl-c1">0.05</span> <span class="pl-k">for</span> _ <span class="pl-k">in</span> <span class="pl-c1">1</span><span class="pl-k">:</span><span class="pl-c1">length</span>(ys)], seriestype<span class="pl-k">=</span><span class="pl-c1">:scatter</span>, label<span class="pl-k">=</span><span class="pl-s"><span class="pl-pds">"</span>observations<span class="pl-pds">"</span></span>, size<span class="pl-k">=</span>(<span class="pl-c1">900</span>, <span class="pl-c1">450</span>), legend<span class="pl-k">=</span><span class="pl-c1">:outertopright</span>)
</pre></div>
<p dir="auto"><a target="_blank" rel="noopener noreferrer nofollow" href="https://raw.githubusercontent.com/noil-reed/notebooks/842a60e81bad431dd70c6e04eb93f82ff10c1cda/MultiKDE_demo/dim1.svg"><img src="https://raw.githubusercontent.com/noil-reed/notebooks/842a60e81bad431dd70c6e04eb93f82ff10c1cda/MultiKDE_demo/dim1.svg" alt="1d KDE visualization" style="max-width: 100%;"></a></p>
<h4 dir="auto"><a id="user-content-multi-dimension-kde" class="anchor" aria-hidden="true" href="#multi-dimension-kde"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a>Multi-dimension KDE</h4>
<div class="highlight highlight-source-julia notranslate position-relative overflow-auto" dir="auto" data-snippet-clipboard-copy-content="
using MultiKDE
using Distributions, Random, Plots

# Simulation
dims = [ContinuousDim(), ContinuousDim()]
bws = [[0.3, 0.3], [0.5, 0.5], [1, 1]]
mn = MvNormal([0, 0], [1, 1])
observations = rand(mn, 50)
observations = [observations[:, i] for i in 1:size(observations, 2)]
observations_x1 = [_obs[1] for _obs in observations]
observations_x2 = [_obs[2] for _obs in observations]
granularity_2d = 100
x1_range = LinRange(minimum(observations_x1), maximum(observations_x1), granularity_2d)
x2_range = LinRange(minimum(observations_x2), maximum(observations_x2), granularity_2d)
x_grid = [[_x1, _x2] for _x1 in x1_range for _x2 in x2_range]
y_grid = []
for bw in bws
    kde = KDEMulti(dims, bw, observations)
    y = [MultiKDE.pdf(kde, _x) for _x in x_grid]
    push!(y_grid, y)
end

# Plot
highest = maximum([maximum(y) for y in y_grid])
plot([_x[1] for _x in x_grid], [_x[2] for _x in x_grid], y_grid, label=[bw[1] for bw in bws][:, :]', size=(900, 450), legend=:outertopright)
plot!(observations_x1, observations_x2, [highest for _ in 1:length(observations)], seriestype=:scatter, label=&quot;observations&quot;)
"><pre><span class="pl-k">using</span> MultiKDE
<span class="pl-k">using</span> Distributions, Random, Plots

<span class="pl-c"><span class="pl-c">#</span> Simulation</span>
dims <span class="pl-k">=</span> [<span class="pl-c1">ContinuousDim</span>(), <span class="pl-c1">ContinuousDim</span>()]
bws <span class="pl-k">=</span> [[<span class="pl-c1">0.3</span>, <span class="pl-c1">0.3</span>], [<span class="pl-c1">0.5</span>, <span class="pl-c1">0.5</span>], [<span class="pl-c1">1</span>, <span class="pl-c1">1</span>]]
mn <span class="pl-k">=</span> <span class="pl-c1">MvNormal</span>([<span class="pl-c1">0</span>, <span class="pl-c1">0</span>], [<span class="pl-c1">1</span>, <span class="pl-c1">1</span>])
observations <span class="pl-k">=</span> <span class="pl-c1">rand</span>(mn, <span class="pl-c1">50</span>)
observations <span class="pl-k">=</span> [observations[:, i] <span class="pl-k">for</span> i <span class="pl-k">in</span> <span class="pl-c1">1</span><span class="pl-k">:</span><span class="pl-c1">size</span>(observations, <span class="pl-c1">2</span>)]
observations_x1 <span class="pl-k">=</span> [_obs[<span class="pl-c1">1</span>] <span class="pl-k">for</span> _obs <span class="pl-k">in</span> observations]
observations_x2 <span class="pl-k">=</span> [_obs[<span class="pl-c1">2</span>] <span class="pl-k">for</span> _obs <span class="pl-k">in</span> observations]
granularity_2d <span class="pl-k">=</span> <span class="pl-c1">100</span>
x1_range <span class="pl-k">=</span> <span class="pl-c1">LinRange</span>(<span class="pl-c1">minimum</span>(observations_x1), <span class="pl-c1">maximum</span>(observations_x1), granularity_2d)
x2_range <span class="pl-k">=</span> <span class="pl-c1">LinRange</span>(<span class="pl-c1">minimum</span>(observations_x2), <span class="pl-c1">maximum</span>(observations_x2), granularity_2d)
x_grid <span class="pl-k">=</span> [[_x1, _x2] <span class="pl-k">for</span> _x1 <span class="pl-k">in</span> x1_range <span class="pl-k">for</span> _x2 <span class="pl-k">in</span> x2_range]
y_grid <span class="pl-k">=</span> []
<span class="pl-k">for</span> bw <span class="pl-k">in</span> bws
    kde <span class="pl-k">=</span> <span class="pl-c1">KDEMulti</span>(dims, bw, observations)
    y <span class="pl-k">=</span> [MultiKDE<span class="pl-k">.</span><span class="pl-c1">pdf</span>(kde, _x) <span class="pl-k">for</span> _x <span class="pl-k">in</span> x_grid]
    <span class="pl-c1">push!</span>(y_grid, y)
<span class="pl-k">end</span>

<span class="pl-c"><span class="pl-c">#</span> Plot</span>
highest <span class="pl-k">=</span> <span class="pl-c1">maximum</span>([<span class="pl-c1">maximum</span>(y) <span class="pl-k">for</span> y <span class="pl-k">in</span> y_grid])
<span class="pl-c1">plot</span>([_x[<span class="pl-c1">1</span>] <span class="pl-k">for</span> _x <span class="pl-k">in</span> x_grid], [_x[<span class="pl-c1">2</span>] <span class="pl-k">for</span> _x <span class="pl-k">in</span> x_grid], y_grid, label<span class="pl-k">=</span>[bw[<span class="pl-c1">1</span>] <span class="pl-k">for</span> bw <span class="pl-k">in</span> bws][:, :]<span class="pl-k">'</span>, size<span class="pl-k">=</span>(<span class="pl-c1">900</span>, <span class="pl-c1">450</span>), legend<span class="pl-k">=</span><span class="pl-c1">:outertopright</span>)
<span class="pl-c1">plot!</span>(observations_x1, observations_x2, [highest <span class="pl-k">for</span> _ <span class="pl-k">in</span> <span class="pl-c1">1</span><span class="pl-k">:</span><span class="pl-c1">length</span>(observations)], seriestype<span class="pl-k">=</span><span class="pl-c1">:scatter</span>, label<span class="pl-k">=</span><span class="pl-s"><span class="pl-pds">"</span>observations<span class="pl-pds">"</span></span>)
</pre></div>
<p dir="auto"><a target="_blank" rel="noopener noreferrer nofollow" href="https://raw.githubusercontent.com/noil-reed/notebooks/842a60e81bad431dd70c6e04eb93f82ff10c1cda/MultiKDE_demo/dim2.svg"><img src="https://raw.githubusercontent.com/noil-reed/notebooks/842a60e81bad431dd70c6e04eb93f82ff10c1cda/MultiKDE_demo/dim2.svg" alt="2d KDE visualization" style="max-width: 100%;"></a></p>

<h2 dir="auto"><a id="user-content-post" class="anchor" aria-hidden="true" href="#post"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a>Post</h2>
<p dir="auto"><a href="https://noilreed.github.io/2021/MultiKDE.jl-a-lazy-evaluation-multivariate-kernel-density-estimator/" rel="nofollow">MultiKDE.jl: A Lazy Evaluation Multivariate Kernel Density Estimator</a></p>
<h2 dir="auto"><a id="user-content-liscense" class="anchor" aria-hidden="true" href="#liscense"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a>Liscense</h2>
<p dir="auto">Licensed under <a href="https://github.com/noil-reed/MultiKDE.jl/blob/main/LICENSE">MIT Liscense</a>.</p>
<h2 dir="auto"><a id="user-content-contact" class="anchor" aria-hidden="true" href="#contact"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a>Contact</h2>
<p dir="auto"><a href="mailto:ping69852@gmail.com">ping69852@gmail.com</a></p>
</article></div>