<div id="readme" class="md" data-path="README.md"><article class="markdown-body entry-content container-lg" itemprop="text"><h2 dir="auto"><a id="user-content-rankcompv3" class="anchor" aria-hidden="true" href="#rankcompv3"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a>RankCompV3</h2>
<p dir="auto">RankCompV3 is a differential expression analysis algorithm based on relative expression ordering (REO) of gene pairs. It can be applied to bulk or single-cell RNA-sequencing (scRNA-seq) data, microarray gene expression profiles and proteomics profiles, etc. When applied in scRNA-seq data, it can run in single-cell mode or pseudo-bulk mode. The pseudo-bulk mode is expected to improve the accuracy while decreasing runntime and memory cost.</p>
<h3 dir="auto"><a id="user-content-installation" class="anchor" aria-hidden="true" href="#installation"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a>Installation</h3>
<p dir="auto">The algorithm is implemented in Julia. Version 1.7 or later is recommended. The simpliest way to install is using the <code>Pkg</code> facility in Julia.</p>
<div class="highlight highlight-source-julia notranslate position-relative overflow-auto" dir="auto" data-snippet-clipboard-copy-content="using Pkg
Pkg.add(&quot;RankCompV3&quot;)"><pre><span class="pl-k">using</span> Pkg
Pkg<span class="pl-k">.</span><span class="pl-c1">add</span>(<span class="pl-s"><span class="pl-pds">"</span>RankCompV3<span class="pl-pds">"</span></span>)</pre></div>
<h3 dir="auto"><a id="user-content-examples" class="anchor" aria-hidden="true" href="#examples"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a>Examples</h3>
<h4 dir="auto"><a id="user-content-quick-start" class="anchor" aria-hidden="true" href="#quick-start"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a>Quick Start</h4>
<p dir="auto">Run a test job with the input files distributed with the package.</p>
<div class="highlight highlight-source-julia notranslate position-relative overflow-auto" dir="auto" data-snippet-clipboard-copy-content="julia&gt; using RankCompV3
# Use the default values for the following other parameters. If you need to modify the parameters, add them directly.
julia&gt; result = reoa(use_testdata=&quot;yes&quot;)"><pre>julia<span class="pl-k">&gt;</span> <span class="pl-k">using</span> RankCompV3
<span class="pl-c"><span class="pl-c">#</span> Use the default values for the following other parameters. If you need to modify the parameters, add them directly.</span>
julia<span class="pl-k">&gt;</span> result <span class="pl-k">=</span> <span class="pl-c1">reoa</span>(use_testdata<span class="pl-k">=</span><span class="pl-s"><span class="pl-pds">"</span>yes<span class="pl-pds">"</span></span>)</pre></div>
<p dir="auto">The analysis results and a few plots will be generated and saved in the current work directory. They are also returned by the <code>reoa</code> function and can be captured by assign the returned values to a variable,  e.g., <code>result</code> in the above example.</p>
<p dir="auto">The first return value is a DataFrame, where rows are genes and columns are statistical values for each gene. All the genes passing the basic preprocessing step are retained.</p>
<div class="highlight highlight-source-julia notranslate position-relative overflow-auto" dir="auto" data-snippet-clipboard-copy-content="julia&gt; result
(19999×16 DataFrame
   Row │ Name     pval         padj        n11      n12      n13      n21      n22      n23      n31      n32      n33      Δ1           Δ2          se         z1
       │ String   Float64      Float64     Float64  Float64  Float64  Float64  Float64  Float64  Float64  Float64  Float64  Float64      Float64     Float64    Float64
───────┼────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
     1 │ DE1      0.23566      0.716036     1532.0     75.0      0.0   1220.0  11010.0    602.0     16.0   2933.0   1674.0   1.91208      1.81954    0.0393608    48.5783
     2 │ DE2      0.280118     0.761567     2277.0    288.0      0.0    965.0  11514.0    372.0     20.0   2615.0   1011.0   1.74141      1.70287    0.0405313    42.9647
     3 │ DE3      0.0578546    0.359121     1576.0     37.0      0.0   1376.0   8716.0    293.0    113.0   5211.0   1740.0   3.05828      3.02011    0.0437133    69.9623
   ⋮   │    ⋮          ⋮           ⋮          ⋮        ⋮        ⋮        ⋮        ⋮        ⋮        ⋮        ⋮        ⋮          ⋮           ⋮           ⋮           ⋮
 19998 │ EE19999  0.344847     0.823375     1475.0    307.0      0.0   1756.0  15356.0    128.0      0.0     38.0      2.0   1.52307      1.41599    0.0525798    28.9668
 19999 │ EE20000  0.694484     0.980397     1571.0    315.0      0.0    979.0  15555.0    362.0      1.0    225.0     54.0   0.63329      0.577392   0.0481845    13.143
                                                                                                                                             19965 rows omitted, 19999×16"><pre>julia<span class="pl-k">&gt;</span> result
(<span class="pl-c1">19999</span><span class="pl-k">×</span><span class="pl-c1">16</span> DataFrame
   Row │ Name     pval         padj        n11      n12      n13      n21      n22      n23      n31      n32      n33      Δ1           Δ2          se         z1
       │ String   Float64      Float64     Float64  Float64  Float64  Float64  Float64  Float64  Float64  Float64  Float64  Float64      Float64     Float64    Float64
───────┼────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
     <span class="pl-c1">1</span> │ DE1      <span class="pl-c1">0.23566</span>      <span class="pl-c1">0.716036</span>     <span class="pl-c1">1532.0</span>     <span class="pl-c1">75.0</span>      <span class="pl-c1">0.0</span>   <span class="pl-c1">1220.0</span>  <span class="pl-c1">11010.0</span>    <span class="pl-c1">602.0</span>     <span class="pl-c1">16.0</span>   <span class="pl-c1">2933.0</span>   <span class="pl-c1">1674.0</span>   <span class="pl-c1">1.91208</span>      <span class="pl-c1">1.81954</span>    <span class="pl-c1">0.0393608</span>    <span class="pl-c1">48.5783</span>
     <span class="pl-c1">2</span> │ DE2      <span class="pl-c1">0.280118</span>     <span class="pl-c1">0.761567</span>     <span class="pl-c1">2277.0</span>    <span class="pl-c1">288.0</span>      <span class="pl-c1">0.0</span>    <span class="pl-c1">965.0</span>  <span class="pl-c1">11514.0</span>    <span class="pl-c1">372.0</span>     <span class="pl-c1">20.0</span>   <span class="pl-c1">2615.0</span>   <span class="pl-c1">1011.0</span>   <span class="pl-c1">1.74141</span>      <span class="pl-c1">1.70287</span>    <span class="pl-c1">0.0405313</span>    <span class="pl-c1">42.9647</span>
     <span class="pl-c1">3</span> │ DE3      <span class="pl-c1">0.0578546</span>    <span class="pl-c1">0.359121</span>     <span class="pl-c1">1576.0</span>     <span class="pl-c1">37.0</span>      <span class="pl-c1">0.0</span>   <span class="pl-c1">1376.0</span>   <span class="pl-c1">8716.0</span>    <span class="pl-c1">293.0</span>    <span class="pl-c1">113.0</span>   <span class="pl-c1">5211.0</span>   <span class="pl-c1">1740.0</span>   <span class="pl-c1">3.05828</span>      <span class="pl-c1">3.02011</span>    <span class="pl-c1">0.0437133</span>    <span class="pl-c1">69.9623</span>
   ⋮   │    ⋮          ⋮           ⋮          ⋮        ⋮        ⋮        ⋮        ⋮        ⋮        ⋮        ⋮        ⋮          ⋮           ⋮           ⋮           ⋮
 <span class="pl-c1">19998</span> │ EE19999  <span class="pl-c1">0.344847</span>     <span class="pl-c1">0.823375</span>     <span class="pl-c1">1475.0</span>    <span class="pl-c1">307.0</span>      <span class="pl-c1">0.0</span>   <span class="pl-c1">1756.0</span>  <span class="pl-c1">15356.0</span>    <span class="pl-c1">128.0</span>      <span class="pl-c1">0.0</span>     <span class="pl-c1">38.0</span>      <span class="pl-c1">2.0</span>   <span class="pl-c1">1.52307</span>      <span class="pl-c1">1.41599</span>    <span class="pl-c1">0.0525798</span>    <span class="pl-c1">28.9668</span>
 <span class="pl-c1">19999</span> │ EE20000  <span class="pl-c1">0.694484</span>     <span class="pl-c1">0.980397</span>     <span class="pl-c1">1571.0</span>    <span class="pl-c1">315.0</span>      <span class="pl-c1">0.0</span>    <span class="pl-c1">979.0</span>  <span class="pl-c1">15555.0</span>    <span class="pl-c1">362.0</span>      <span class="pl-c1">1.0</span>    <span class="pl-c1">225.0</span>     <span class="pl-c1">54.0</span>   <span class="pl-c1">0.63329</span>      <span class="pl-c1">0.577392</span>   <span class="pl-c1">0.0481845</span>    <span class="pl-c1">13.143</span>
                                                                                                                                             <span class="pl-c1">19965</span> rows omitted, <span class="pl-c1">19999</span><span class="pl-k">×</span><span class="pl-c1">16</span></pre></div>
<h4 dir="auto"><a id="user-content-run-your-own-deg-analysis" class="anchor" aria-hidden="true" href="#run-your-own-deg-analysis"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a>Run your own DEG analysis</h4>
<p dir="auto">You need to prepare two input files before the analysis: metadata file and expression matrix. Both of them should be saved in the <code>TSV</code> or <code>CSV</code> format and they should be compatible with each other.</p>
<ul dir="auto">
<li><strong>metadata file (required).</strong></li>
</ul>
<p dir="auto">The metadata file contains at least two columns. The first column is the sample names, and the second column is the grouping information. Only two groups are supported at present, therefore, do not include more than two groups.</p>
<p dir="auto">Column names for a metadata should be <code>Name</code> and <code>Group</code>.</p>
<p dir="auto">See an example metadata file, <a href="https://github.com/yanjer/RankCompV3.jl/blob/master/test/fn_metadata.txt">fn_metadata.txt</a>.</p>
<ul dir="auto">
<li><strong>expression matrix file (required).</strong></li>
</ul>
<p dir="auto">The first column is the gene name and the column header should be <code>Name</code> and the rest columns are profiles for each cell or each sample. Each column header should be the sample name which appears in the metadata file.</p>
<p dir="auto">See an example expression matrix file, <a href="https://github.com/yanjer/RankCompV3.jl/blob/master/test/fn_expr.txt">fn_expr.txt</a>.</p>
<p dir="auto">Raw counts or expression values are recommended to use. Other values, e.g, FPKM, RPKM, TPM, log(counts) and log(normalized counts), can also be used, though normalization and batch effect removal are neither necessary nor recommended.</p>
<p dir="auto">Once the files are ready, you can carry out the DEG analysis with the default settings as follows.</p>
<div class="highlight highlight-source-julia notranslate position-relative overflow-auto" dir="auto" data-snippet-clipboard-copy-content="julia&gt; using RankCompV3
# Use the default values for the following other parameters. If you want to modify the parameters, add them directly.
julia&gt; reoa(&quot;/public/yanj/data/fn_expr.txt&quot;,
	&quot;/public/yanj/data/fn_metadata.txt&quot;)"><pre>julia<span class="pl-k">&gt;</span> <span class="pl-k">using</span> RankCompV3
<span class="pl-c"><span class="pl-c">#</span> Use the default values for the following other parameters. If you want to modify the parameters, add them directly.</span>
julia<span class="pl-k">&gt;</span> <span class="pl-c1">reoa</span>(<span class="pl-s"><span class="pl-pds">"</span>/public/yanj/data/fn_expr.txt<span class="pl-pds">"</span></span>,
	<span class="pl-s"><span class="pl-pds">"</span>/public/yanj/data/fn_metadata.txt<span class="pl-pds">"</span></span>)</pre></div>
<p dir="auto">Other parameters can be set by passing the value to the corresponding keyword.</p>
<div class="highlight highlight-source-julia notranslate position-relative overflow-auto" dir="auto" data-snippet-clipboard-copy-content="julia&gt; reoa(&quot;/public/yanj/data/fn_expr.txt&quot;,
    	&quot;/public/yanj/data/fn_meta.txt&quot;,
    	expr_threshold = 0,
    	min_profiles = 0,
    	min_features = 0,
    	pval_reo = 0.01,
     	pval_deg = 0.05,
     	padj_deg = 0.05,
    	use_pseudobulk = 0,
    	use_hk_genes = &quot;yes&quot;
    	hk_file = &quot;HK_genes_info.tsv&quot;,
    	gene_name_type = &quot;ENSEMBL&quot;,
    	ref_gene_max = 3000,
    	ref_gene_min = 100
    	n_iter = 128,
    	n_conv = 5,
    	work_dir = &quot;./&quot;,
    	use_testdata = &quot;no&quot;)"><pre>julia<span class="pl-k">&gt;</span> <span class="pl-c1">reoa</span>(<span class="pl-s"><span class="pl-pds">"</span>/public/yanj/data/fn_expr.txt<span class="pl-pds">"</span></span>,
    	<span class="pl-s"><span class="pl-pds">"</span>/public/yanj/data/fn_meta.txt<span class="pl-pds">"</span></span>,
    	expr_threshold <span class="pl-k">=</span> <span class="pl-c1">0</span>,
    	min_profiles <span class="pl-k">=</span> <span class="pl-c1">0</span>,
    	min_features <span class="pl-k">=</span> <span class="pl-c1">0</span>,
    	pval_reo <span class="pl-k">=</span> <span class="pl-c1">0.01</span>,
     	pval_deg <span class="pl-k">=</span> <span class="pl-c1">0.05</span>,
     	padj_deg <span class="pl-k">=</span> <span class="pl-c1">0.05</span>,
    	use_pseudobulk <span class="pl-k">=</span> <span class="pl-c1">0</span>,
    	use_hk_genes <span class="pl-k">=</span> <span class="pl-s"><span class="pl-pds">"</span>yes<span class="pl-pds">"</span></span>
    	hk_file <span class="pl-k">=</span> <span class="pl-s"><span class="pl-pds">"</span>HK_genes_info.tsv<span class="pl-pds">"</span></span>,
    	gene_name_type <span class="pl-k">=</span> <span class="pl-s"><span class="pl-pds">"</span>ENSEMBL<span class="pl-pds">"</span></span>,
    	ref_gene_max <span class="pl-k">=</span> <span class="pl-c1">3000</span>,
    	ref_gene_min <span class="pl-k">=</span> <span class="pl-c1">100</span>
    	n_iter <span class="pl-k">=</span> <span class="pl-c1">128</span>,
    	n_conv <span class="pl-k">=</span> <span class="pl-c1">5</span>,
    	work_dir <span class="pl-k">=</span> <span class="pl-s"><span class="pl-pds">"</span>./<span class="pl-pds">"</span></span>,
    	use_testdata <span class="pl-k">=</span> <span class="pl-s"><span class="pl-pds">"</span>no<span class="pl-pds">"</span></span>)</pre></div>
<h4 dir="auto"><a id="user-content-pseudobulk-method" class="anchor" aria-hidden="true" href="#pseudobulk-method"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a>Pseudobulk method</h4>
<p dir="auto">For scRNA-seq data, one can carry out a pseudobulk analysis. Rather than using the original single-cell profiles, pseudobulk profiles can be generated and used for DEG analysis. In this method, a random subset of cells from a group is aggregated into a pseudo-bulk profile.</p>
<p dir="auto">The pseudobulk method can be turned on by setting <code>use_pseudobulk = 1</code>.</p>
<div class="highlight highlight-source-julia notranslate position-relative overflow-auto" dir="auto" data-snippet-clipboard-copy-content="julia&gt; reoa(&quot;scRNA_expr.txt&quot;,
    	&quot;scRNA_metadata.txt&quot;,
    	use_pseudobulk = 1)"><pre>julia<span class="pl-k">&gt;</span> <span class="pl-c1">reoa</span>(<span class="pl-s"><span class="pl-pds">"</span>scRNA_expr.txt<span class="pl-pds">"</span></span>,
    	<span class="pl-s"><span class="pl-pds">"</span>scRNA_metadata.txt<span class="pl-pds">"</span></span>,
    	use_pseudobulk <span class="pl-k">=</span> <span class="pl-c1">1</span>)</pre></div>
<p dir="auto">By default, the analysis does not use the pseudobulk method (<code>use_pseudobulk = 0</code>).  If a value between <code>6</code> and <code>100</code> is passed to <code>use_pseudobulk</code>, that number of pseudobulk profiles will be generated and used for analysis. Other values (except <code>0</code> which turns off the pseudobulk method) will generate the default value (<code>10</code>) profiles.</p>
<h3 dir="auto"><a id="user-content-optional-parameters" class="anchor" aria-hidden="true" href="#optional-parameters"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a>Optional Parameters</h3>
<p dir="auto">Below lists the optional keyword parameters and their default values.</p>
<table>
<thead>
<tr>
<th>Parameter</th>
<th>Parameter types</th>
<th>Default value</th>
<th>Parameters to describe</th>
</tr>
</thead>
<tbody>
<tr>
<td>fn_expr</td>
<td>AbstractString</td>
<td>"fn_expr.txt"</td>
<td>Gene expression profile file path. (required)</td>
</tr>
<tr>
<td>fn_metadata</td>
<td>AbstractString</td>
<td>"fn_metadata.txt"</td>
<td>Grouping information file path. (required)</td>
</tr>
<tr>
<td>expr_threshold</td>
<td>Number</td>
<td>0</td>
<td>Gene expression threshold.</td>
</tr>
<tr>
<td>min_profiles</td>
<td>Int</td>
<td>0</td>
<td>Include features (genes) detected in at least this many cells.</td>
</tr>
<tr>
<td>min_features</td>
<td>Int</td>
<td>0</td>
<td>Include profiles (cells) where at least this many features are detected.</td>
</tr>
<tr>
<td>pval_reo</td>
<td>AbstractFloat</td>
<td>0.01</td>
<td>Stable threshold for p-value.</td>
</tr>
<tr>
<td>pval_deg</td>
<td>AbstractFloat</td>
<td>0.05</td>
<td>Significant  reversal threshold for p-value.</td>
</tr>
<tr>
<td>padj_deg</td>
<td>AbstractFloat</td>
<td>0.05</td>
<td>Significant reversal threshold for FDR  value.</td>
</tr>
<tr>
<td>use_pseudobulk</td>
<td>Int</td>
<td>0</td>
<td>0 for not using pseudobulk mode, 1 for automatic, 2<del>5 not used, 6</del>100 for number of pseudobulk profiles in each group.</td>
</tr>
<tr>
<td>use_hk_genes</td>
<td>AbstractString</td>
<td>"yes"</td>
<td>Whether to use the housekeeping gene, yes or no.</td>
</tr>
<tr>
<td>hk_file</td>
<td>AbstractString</td>
<td>"HK_genes_info.tsv"</td>
<td>House-keeping genes  file path.</td>
</tr>
<tr>
<td>gene_name_type</td>
<td>AbstractString</td>
<td>"ENSEMBL"</td>
<td>Available choices: Name, REFSEQ, SYMBOL, ENTREZID, ENSEMBL, UNIGENE and GENENAME.</td>
</tr>
<tr>
<td>ref_gene_max</td>
<td>Int</td>
<td>3000</td>
<td>If the number of available features is higher than this, take a random sample of this size.</td>
</tr>
<tr>
<td>ref_gene_min</td>
<td>Int</td>
<td>100</td>
<td>If the number is lower than this, ignore the house-keeping genes.</td>
</tr>
<tr>
<td>n_iter</td>
<td>Int</td>
<td>128</td>
<td>Max iterations.</td>
</tr>
<tr>
<td>n_conv</td>
<td>Int</td>
<td>5</td>
<td>Convergence condition: max. difference in the number of DEGs between two consective iterations.</td>
</tr>
<tr>
<td>work_dir</td>
<td>AbstractString</td>
<td>"./"</td>
<td>Working Directory.</td>
</tr>
<tr>
<td>use_testdata</td>
<td>AbstractString</td>
<td>"no"</td>
<td>Whether to use the default provided test data for analysis, yes or no.</td>
</tr>
</tbody>
</table>
<h4 dir="auto"><a id="user-content-example-output-file" class="anchor" aria-hidden="true" href="#example-output-file"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a>Example output file:</h4>
<ul dir="auto">
<li>
<p dir="auto">The expression profile of the ctrl group (after preprocessing).  (See <a href="https://github.com/yanjer/RankCompV3.jl/blob/master/test/fn_metadata.txt">fn_metadata.txt</a>)</p>
</li>
<li>
<p dir="auto">The expression profile of the treat group (after preprocessing).  (See <a href="https://github.com/yanjer/RankCompV3-test-data-output/blob/master/RankCompV3-test-data-output/fn_expr_treat.tsv">fn_expr_treat.tsv</a>)</p>
</li>
<li>
<p dir="auto">This file contains Name, pval, padj, n11, n12, n13, n21, n22, n23, n31, n32, n33, Δ1, Δ2, se, z1.  (See <a href="https://github.com/yanjer/RankCompV3-test-data-output/blob/master/RankCompV3-test-data-output/fn_expr_result.tsv">fn_expr_result.tsv</a>)</p>
</li>
<li>
<p dir="auto">Graph of Distribution of Expression Values.  (See <a href="https://github.com/yanjer/RankCompV3-test-data-output/blob/master/RankCompV3-test-data-output/fn_expr_expr_dist.pdf">fn_expr_expr_dist.pdf</a>)</p>
</li>
<li>
<p dir="auto">Heat maps of expression values for the ctrl and treat groups.  (See <a href="https://github.com/yanjer/RankCompV3-test-data-output/blob/master/RankCompV3-test-data-output/fn_expr_expr_heat.pdf">fn_expr_expr_heat.pdf</a>)</p>
</li>
<li>
<p dir="auto">Distribution of parameters in 3 x 3 contingency tables.  (See <a href="https://github.com/yanjer/RankCompV3-test-data-output/blob/master/RankCompV3-test-data-output/fn_expr_contigency_table.pdf">fn_expr_contigency_table.pdf</a>)</p>
</li>
<li>
<p dir="auto">Delta distribution.  (See <a href="https://github.com/yanjer/RankCompV3-test-data-output/blob/master/RankCompV3-test-data-output/fn_expr_delta_value.pdf">fn_expr_delta_value.pdf</a>)</p>
</li>
<li>
<p dir="auto">Distribution of Standard Error (SE).  (See <a href="https://github.com/yanjer/RankCompV3-test-data-output/blob/master/RankCompV3-test-data-output/fn_expr_se.pdf">fn_expr_se.pdf</a>)</p>
</li>
<li>
<p dir="auto">Distribution of z1.  (See <a href="https://github.com/yanjer/RankCompV3-test-data-output/blob/master/RankCompV3-test-data-output/fn_expr_z1.pdf">fn_expr_z1.pdf</a>)</p>
</li>
<li>
<p dir="auto">Distribution of p and FDR values.  (See <a href="https://github.com/yanjer/RankCompV3-test-data-output/blob/master/RankCompV3-test-data-output/fn_expr_p_value.pdf">fn_expr_p_value.pdf</a>)</p>
</li>
<li>
<p dir="auto">Distribution of expression values for DEGs.  (See <a href="https://github.com/yanjer/RankCompV3-test-data-output/blob/master/RankCompV3-test-data-output/fn_expr_degs_expr_dist.pdf">fn_expr_degs_expr_dist.pdf</a>)</p>
</li>
<li>
<p dir="auto">Heat map of the expression values of DEGs in the ctrl and treat groups.  (See <a href="https://github.com/yanjer/RankCompV3-test-data-output/blob/master/RankCompV3-test-data-output/fn_expr_degs_expr_heat.pdf">fn_expr_degs_expr_heat.pdf</a>)</p>
</li>
</ul>
<h5 dir="auto"><a id="user-content-log-file" class="anchor" aria-hidden="true" href="#log-file"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a>log file</h5>
<ul dir="auto">
<li><a href="https://github.com/yanjer/RankCompV3-test-data-output/blob/master/RankCompV3-test-data-output/RankCompV3_test_data_output.log">RankCompV3-test-data-output.log</a></li>
</ul>
<h3 dir="auto"><a id="user-content-used-in-the-r-language" class="anchor" aria-hidden="true" href="#used-in-the-r-language"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a>Used in the R language</h3>
<h3 dir="auto"><a id="user-content-installation-1" class="anchor" aria-hidden="true" href="#installation-1"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a>Installation</h3>
<h5 dir="auto"><a id="user-content-you-can-install-just-like-any-other-r-packages-by-juliacall" class="anchor" aria-hidden="true" href="#you-can-install-just-like-any-other-r-packages-by-juliacall"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a>You can install just like any other R packages by <code>JuliaCall</code></h5>
<div class="highlight highlight-source-r notranslate position-relative overflow-auto" dir="auto" data-snippet-clipboard-copy-content="install.packages(&quot;JuliaCall&quot;)"><pre>install.packages(<span class="pl-s"><span class="pl-pds">"</span>JuliaCall<span class="pl-pds">"</span></span>)</pre></div>
<h5 dir="auto"><a id="user-content-to-use-you-must-have-a-working-installation-of-julia-this-can-be-easily-done-via-juliacall" class="anchor" aria-hidden="true" href="#to-use-you-must-have-a-working-installation-of-julia-this-can-be-easily-done-via-juliacall"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a>To use you must have a working installation of Julia. This can be easily done via: <code>JuliaCall</code></h5>
<div class="highlight highlight-source-r notranslate position-relative overflow-auto" dir="auto" data-snippet-clipboard-copy-content="library(JuliaCall)
install_julia()"><pre>library(<span class="pl-smi">JuliaCall</span>)
install_julia()</pre></div>
<h5 dir="auto"><a id="user-content-which-will-automatically-install-and-setup-a-version-of-julia-specifically-for-use-with-juliacall-or-you-can-do" class="anchor" aria-hidden="true" href="#which-will-automatically-install-and-setup-a-version-of-julia-specifically-for-use-with-juliacall-or-you-can-do"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a>which will automatically install and setup a version of Julia specifically for use with <code>JuliaCall</code>. Or you can do</h5>
<div class="highlight highlight-source-r notranslate position-relative overflow-auto" dir="auto" data-snippet-clipboard-copy-content="library(JuliaCall)
julia &lt;-julia_setup()"><pre>library(<span class="pl-smi">JuliaCall</span>)
<span class="pl-smi">julia</span> <span class="pl-k">&lt;-</span>julia_setup()</pre></div>
<h5 dir="auto"><a id="user-content-download-rankcompv3" class="anchor" aria-hidden="true" href="#download-rankcompv3"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a>Download RankCompV3</h5>
<div class="highlight highlight-source-julia notranslate position-relative overflow-auto" dir="auto" data-snippet-clipboard-copy-content="julia_install_package_if_needed(&quot;RankCompV3&quot;)"><pre><span class="pl-c1">julia_install_package_if_needed</span>(<span class="pl-s"><span class="pl-pds">"</span>RankCompV3<span class="pl-pds">"</span></span>)</pre></div>
<h3 dir="auto"><a id="user-content-examples-1" class="anchor" aria-hidden="true" href="#examples-1"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a>Examples</h3>
<h4 dir="auto"><a id="user-content-quick-start-1" class="anchor" aria-hidden="true" href="#quick-start-1"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a>Quick Start</h4>
<p dir="auto">Run a test job with the input files distributed with the package.</p>
<div class="highlight highlight-source-r notranslate position-relative overflow-auto" dir="auto" data-snippet-clipboard-copy-content="julia_library(&quot;RankCompV3&quot;)
result &lt;- julia_do.call(&quot;reoa&quot;,list(use_testdata=&quot;yes&quot;),need_return=&quot;Julia&quot;,show_value=FALSE)"><pre>julia_library(<span class="pl-s"><span class="pl-pds">"</span>RankCompV3<span class="pl-pds">"</span></span>)
<span class="pl-smi">result</span> <span class="pl-k">&lt;-</span> julia_do.call(<span class="pl-s"><span class="pl-pds">"</span>reoa<span class="pl-pds">"</span></span>,<span class="pl-k">list</span>(<span class="pl-v">use_testdata</span><span class="pl-k">=</span><span class="pl-s"><span class="pl-pds">"</span>yes<span class="pl-pds">"</span></span>),<span class="pl-v">need_return</span><span class="pl-k">=</span><span class="pl-s"><span class="pl-pds">"</span>Julia<span class="pl-pds">"</span></span>,<span class="pl-v">show_value</span><span class="pl-k">=</span><span class="pl-c1">FALSE</span>)</pre></div>
<p dir="auto">The analysis results and a few plots will be generated and saved in the current work directory. They are also returned by the <code>reoa</code> function and can be captured by assign the returned values to a variable,  e.g., <code>result</code> in the above example.</p>
<p dir="auto">The first return value is a DataFrame, where rows are genes and columns are statistical values for each gene. All the genes passing the basic preprocessing step are retained.</p>
<div class="highlight highlight-source-r notranslate position-relative overflow-auto" dir="auto" data-snippet-clipboard-copy-content="&gt; result
Julia Object of type Tuple{DataFrames.DataFrame, DataFrames.DataFrame, DataFrames.DataFrame}.
(19999×16 DataFrame
   Row │ Name     pval        padj        n11      n12      n13      n21       ⋯
       │ String   Float64     Float64     Float64  Float64  Float64  Float64   ⋯
───────┼────────────────────────────────────────────────────────────────────────
     1 │ DE1      0.237557    0.719072     1531.0     75.0      0.0   1213.0   ⋯
     2 │ DE2      0.280253    0.762245     2276.0    285.0      0.0    978.0
     3 │ DE3      0.0578256   0.358368     1574.0     37.0      0.0   1375.0
     4 │ DE4      0.155619    0.595079     1539.0    139.0      0.0    760.0
     5 │ DE5      0.0432114   0.30634      1166.0     12.0      0.0   1582.0   ⋯
     6 │ DE6      0.0572817   0.356322     1583.0     70.0      0.0    909.0
     7 │ DE7      0.00925067  0.123914     2182.0     64.0      0.0   3608.0
     8 │ DE8      0.036411    0.278039     1927.0     69.0      0.0   2155.0
   ⋮   │    ⋮         ⋮           ⋮          ⋮        ⋮        ⋮        ⋮      ⋱
 19993 │ EE19994  0.0833578   0.438012     1719.0    353.0      0.0   1143.0   ⋯
 19994 │ EE19995  0.0457029   0.316136     1840.0    215.0      0.0   1323.0
 19995 │ EE19996  0.843871    0.999171     1103.0    276.0      0.0    440.0
 19996 │ EE19997  6.70797e-5  0.00465755   1248.0     25.0      0.0   2058.0
 19997 │ EE19998  0.909702    1.0          1112.0    136.0      0.0    931.0   ⋯
 19998 │ EE19999  0.348734    0.827127     1475.0    304.0      0.0   1752.0
 19999 │ EE20000  0.699539    0.981932     1576.0    313.0      0.0    970.0
                                                9 columns and 19984 rows omitted, 19999×6 DataFrame
   Row │ Name     Sample1  Sample2  Sample3  Sample4  Sample5
       │ String   Int64    Int64    Int64    Int64    Int64
───────┼──────────────────────────────────────────────────────
     1 │ DE1           10       53       18       84       18
     2 │ DE2            5       22       59       11       33
     3 │ DE3           62       39       18       19        8
     4 │ DE4            6      116      131        3       49
     5 │ DE5           28       31       27       58       16
     6 │ DE6           91       81       26        3       29
     7 │ DE7            8        4       18        4        5
     8 │ DE8            3       31        5       32       11
   ⋮   │    ⋮        ⋮        ⋮        ⋮        ⋮        ⋮
 19993 │ EE19994        6      176       36        0        1
 19994 │ EE19995        3      103        8        0       48
 19995 │ EE19996       60       27      405      132        0
 19996 │ EE19997       23        4        0        0      116
 19997 │ EE19998      172       28       31        2      128
 19998 │ EE19999      102       49        3        0        6
 19999 │ EE20000       96        2        2       27      112
                                            19984 rows omitted, 19999×6 DataFrame
   Row │ Name     Sample76  Sample77  Sample78  Sample79  Sample80
       │ String   Int64     Int64     Int64     Int64     Int64
───────┼───────────────────────────────────────────────────────────
     1 │ DE1           200       180       176        26        24
     2 │ DE2            26        37        36        40        79
     3 │ DE3           157        81        89       220        97
     4 │ DE4            15       205        63        75       228
     5 │ DE5           505        92       119       157       261
     6 │ DE6           191       131        99       147        68
     7 │ DE7           116        38        34        58        64
     8 │ DE8            53        39       183        22        73
   ⋮   │    ⋮        ⋮         ⋮         ⋮         ⋮         ⋮
 19993 │ EE19994        88        15       192         9        35
 19994 │ EE19995       174        73        14        16        97
 19995 │ EE19996       138        61       407       182         0
 19996 │ EE19997       325        94       231       281        41
 19997 │ EE19998        24         0       116        43       656
 19998 │ EE19999         0       144         4       393         0
 19999 │ EE20000       294         0        26        98        18
                                                 19984 rows omitted)"><pre><span class="pl-k">&gt;</span> <span class="pl-smi">result</span>
<span class="pl-smi">Julia</span> <span class="pl-smi">Object</span> <span class="pl-smi">of</span> <span class="pl-smi">type</span> <span class="pl-smi">Tuple</span>{<span class="pl-smi">DataFrames.DataFrame</span>, <span class="pl-smi">DataFrames.DataFrame</span>, <span class="pl-smi">DataFrames.DataFrame</span>}<span class="pl-smi">.</span>
(<span class="pl-c1">19999</span>×<span class="pl-c1">16</span> <span class="pl-smi">DataFrame</span>
   <span class="pl-smi">Row</span> │ <span class="pl-smi">Name</span>     <span class="pl-smi">pval</span>        <span class="pl-smi">padj</span>        <span class="pl-smi">n11</span>      <span class="pl-smi">n12</span>      <span class="pl-smi">n13</span>      <span class="pl-smi">n21</span>       ⋯
       │ <span class="pl-smi">String</span>   <span class="pl-smi">Float64</span>     <span class="pl-smi">Float64</span>     <span class="pl-smi">Float64</span>  <span class="pl-smi">Float64</span>  <span class="pl-smi">Float64</span>  <span class="pl-smi">Float64</span>   ⋯
───────┼────────────────────────────────────────────────────────────────────────
     <span class="pl-c1">1</span> │ <span class="pl-smi">DE1</span>      <span class="pl-c1">0.237557</span>    <span class="pl-c1">0.719072</span>     <span class="pl-c1">1531.0</span>     <span class="pl-c1">75.0</span>      <span class="pl-c1">0.0</span>   <span class="pl-c1">1213.0</span>   ⋯
     <span class="pl-c1">2</span> │ <span class="pl-smi">DE2</span>      <span class="pl-c1">0.280253</span>    <span class="pl-c1">0.762245</span>     <span class="pl-c1">2276.0</span>    <span class="pl-c1">285.0</span>      <span class="pl-c1">0.0</span>    <span class="pl-c1">978.0</span>
     <span class="pl-c1">3</span> │ <span class="pl-smi">DE3</span>      <span class="pl-c1">0.0578256</span>   <span class="pl-c1">0.358368</span>     <span class="pl-c1">1574.0</span>     <span class="pl-c1">37.0</span>      <span class="pl-c1">0.0</span>   <span class="pl-c1">1375.0</span>
     <span class="pl-c1">4</span> │ <span class="pl-smi">DE4</span>      <span class="pl-c1">0.155619</span>    <span class="pl-c1">0.595079</span>     <span class="pl-c1">1539.0</span>    <span class="pl-c1">139.0</span>      <span class="pl-c1">0.0</span>    <span class="pl-c1">760.0</span>
     <span class="pl-c1">5</span> │ <span class="pl-smi">DE5</span>      <span class="pl-c1">0.0432114</span>   <span class="pl-c1">0.30634</span>      <span class="pl-c1">1166.0</span>     <span class="pl-c1">12.0</span>      <span class="pl-c1">0.0</span>   <span class="pl-c1">1582.0</span>   ⋯
     <span class="pl-c1">6</span> │ <span class="pl-smi">DE6</span>      <span class="pl-c1">0.0572817</span>   <span class="pl-c1">0.356322</span>     <span class="pl-c1">1583.0</span>     <span class="pl-c1">70.0</span>      <span class="pl-c1">0.0</span>    <span class="pl-c1">909.0</span>
     <span class="pl-c1">7</span> │ <span class="pl-smi">DE7</span>      <span class="pl-c1">0.00925067</span>  <span class="pl-c1">0.123914</span>     <span class="pl-c1">2182.0</span>     <span class="pl-c1">64.0</span>      <span class="pl-c1">0.0</span>   <span class="pl-c1">3608.0</span>
     <span class="pl-c1">8</span> │ <span class="pl-smi">DE8</span>      <span class="pl-c1">0.036411</span>    <span class="pl-c1">0.278039</span>     <span class="pl-c1">1927.0</span>     <span class="pl-c1">69.0</span>      <span class="pl-c1">0.0</span>   <span class="pl-c1">2155.0</span>
   ⋮   │    ⋮         ⋮           ⋮          ⋮        ⋮        ⋮        ⋮      ⋱
 <span class="pl-c1">19993</span> │ <span class="pl-smi">EE19994</span>  <span class="pl-c1">0.0833578</span>   <span class="pl-c1">0.438012</span>     <span class="pl-c1">1719.0</span>    <span class="pl-c1">353.0</span>      <span class="pl-c1">0.0</span>   <span class="pl-c1">1143.0</span>   ⋯
 <span class="pl-c1">19994</span> │ <span class="pl-smi">EE19995</span>  <span class="pl-c1">0.0457029</span>   <span class="pl-c1">0.316136</span>     <span class="pl-c1">1840.0</span>    <span class="pl-c1">215.0</span>      <span class="pl-c1">0.0</span>   <span class="pl-c1">1323.0</span>
 <span class="pl-c1">19995</span> │ <span class="pl-smi">EE19996</span>  <span class="pl-c1">0.843871</span>    <span class="pl-c1">0.999171</span>     <span class="pl-c1">1103.0</span>    <span class="pl-c1">276.0</span>      <span class="pl-c1">0.0</span>    <span class="pl-c1">440.0</span>
 <span class="pl-c1">19996</span> │ <span class="pl-smi">EE19997</span>  <span class="pl-c1">6.70797e-5</span>  <span class="pl-c1">0.00465755</span>   <span class="pl-c1">1248.0</span>     <span class="pl-c1">25.0</span>      <span class="pl-c1">0.0</span>   <span class="pl-c1">2058.0</span>
 <span class="pl-c1">19997</span> │ <span class="pl-smi">EE19998</span>  <span class="pl-c1">0.909702</span>    <span class="pl-c1">1.0</span>          <span class="pl-c1">1112.0</span>    <span class="pl-c1">136.0</span>      <span class="pl-c1">0.0</span>    <span class="pl-c1">931.0</span>   ⋯
 <span class="pl-c1">19998</span> │ <span class="pl-smi">EE19999</span>  <span class="pl-c1">0.348734</span>    <span class="pl-c1">0.827127</span>     <span class="pl-c1">1475.0</span>    <span class="pl-c1">304.0</span>      <span class="pl-c1">0.0</span>   <span class="pl-c1">1752.0</span>
 <span class="pl-c1">19999</span> │ <span class="pl-smi">EE20000</span>  <span class="pl-c1">0.699539</span>    <span class="pl-c1">0.981932</span>     <span class="pl-c1">1576.0</span>    <span class="pl-c1">313.0</span>      <span class="pl-c1">0.0</span>    <span class="pl-c1">970.0</span>
                                                <span class="pl-c1">9</span> <span class="pl-smi">columns</span> <span class="pl-smi">and</span> <span class="pl-c1">19984</span> <span class="pl-smi">rows</span> <span class="pl-smi">omitted</span>, <span class="pl-c1">19999</span>×<span class="pl-c1">6</span> <span class="pl-smi">DataFrame</span>
   <span class="pl-smi">Row</span> │ <span class="pl-smi">Name</span>     <span class="pl-smi">Sample1</span>  <span class="pl-smi">Sample2</span>  <span class="pl-smi">Sample3</span>  <span class="pl-smi">Sample4</span>  <span class="pl-smi">Sample5</span>
       │ <span class="pl-smi">String</span>   <span class="pl-smi">Int64</span>    <span class="pl-smi">Int64</span>    <span class="pl-smi">Int64</span>    <span class="pl-smi">Int64</span>    <span class="pl-smi">Int64</span>
───────┼──────────────────────────────────────────────────────
     <span class="pl-c1">1</span> │ <span class="pl-smi">DE1</span>           <span class="pl-c1">10</span>       <span class="pl-c1">53</span>       <span class="pl-c1">18</span>       <span class="pl-c1">84</span>       <span class="pl-c1">18</span>
     <span class="pl-c1">2</span> │ <span class="pl-smi">DE2</span>            <span class="pl-c1">5</span>       <span class="pl-c1">22</span>       <span class="pl-c1">59</span>       <span class="pl-c1">11</span>       <span class="pl-c1">33</span>
     <span class="pl-c1">3</span> │ <span class="pl-smi">DE3</span>           <span class="pl-c1">62</span>       <span class="pl-c1">39</span>       <span class="pl-c1">18</span>       <span class="pl-c1">19</span>        <span class="pl-c1">8</span>
     <span class="pl-c1">4</span> │ <span class="pl-smi">DE4</span>            <span class="pl-c1">6</span>      <span class="pl-c1">116</span>      <span class="pl-c1">131</span>        <span class="pl-c1">3</span>       <span class="pl-c1">49</span>
     <span class="pl-c1">5</span> │ <span class="pl-smi">DE5</span>           <span class="pl-c1">28</span>       <span class="pl-c1">31</span>       <span class="pl-c1">27</span>       <span class="pl-c1">58</span>       <span class="pl-c1">16</span>
     <span class="pl-c1">6</span> │ <span class="pl-smi">DE6</span>           <span class="pl-c1">91</span>       <span class="pl-c1">81</span>       <span class="pl-c1">26</span>        <span class="pl-c1">3</span>       <span class="pl-c1">29</span>
     <span class="pl-c1">7</span> │ <span class="pl-smi">DE7</span>            <span class="pl-c1">8</span>        <span class="pl-c1">4</span>       <span class="pl-c1">18</span>        <span class="pl-c1">4</span>        <span class="pl-c1">5</span>
     <span class="pl-c1">8</span> │ <span class="pl-smi">DE8</span>            <span class="pl-c1">3</span>       <span class="pl-c1">31</span>        <span class="pl-c1">5</span>       <span class="pl-c1">32</span>       <span class="pl-c1">11</span>
   ⋮   │    ⋮        ⋮        ⋮        ⋮        ⋮        ⋮
 <span class="pl-c1">19993</span> │ <span class="pl-smi">EE19994</span>        <span class="pl-c1">6</span>      <span class="pl-c1">176</span>       <span class="pl-c1">36</span>        <span class="pl-c1">0</span>        <span class="pl-c1">1</span>
 <span class="pl-c1">19994</span> │ <span class="pl-smi">EE19995</span>        <span class="pl-c1">3</span>      <span class="pl-c1">103</span>        <span class="pl-c1">8</span>        <span class="pl-c1">0</span>       <span class="pl-c1">48</span>
 <span class="pl-c1">19995</span> │ <span class="pl-smi">EE19996</span>       <span class="pl-c1">60</span>       <span class="pl-c1">27</span>      <span class="pl-c1">405</span>      <span class="pl-c1">132</span>        <span class="pl-c1">0</span>
 <span class="pl-c1">19996</span> │ <span class="pl-smi">EE19997</span>       <span class="pl-c1">23</span>        <span class="pl-c1">4</span>        <span class="pl-c1">0</span>        <span class="pl-c1">0</span>      <span class="pl-c1">116</span>
 <span class="pl-c1">19997</span> │ <span class="pl-smi">EE19998</span>      <span class="pl-c1">172</span>       <span class="pl-c1">28</span>       <span class="pl-c1">31</span>        <span class="pl-c1">2</span>      <span class="pl-c1">128</span>
 <span class="pl-c1">19998</span> │ <span class="pl-smi">EE19999</span>      <span class="pl-c1">102</span>       <span class="pl-c1">49</span>        <span class="pl-c1">3</span>        <span class="pl-c1">0</span>        <span class="pl-c1">6</span>
 <span class="pl-c1">19999</span> │ <span class="pl-smi">EE20000</span>       <span class="pl-c1">96</span>        <span class="pl-c1">2</span>        <span class="pl-c1">2</span>       <span class="pl-c1">27</span>      <span class="pl-c1">112</span>
                                            <span class="pl-c1">19984</span> <span class="pl-smi">rows</span> <span class="pl-smi">omitted</span>, <span class="pl-c1">19999</span>×<span class="pl-c1">6</span> <span class="pl-smi">DataFrame</span>
   <span class="pl-smi">Row</span> │ <span class="pl-smi">Name</span>     <span class="pl-smi">Sample76</span>  <span class="pl-smi">Sample77</span>  <span class="pl-smi">Sample78</span>  <span class="pl-smi">Sample79</span>  <span class="pl-smi">Sample80</span>
       │ <span class="pl-smi">String</span>   <span class="pl-smi">Int64</span>     <span class="pl-smi">Int64</span>     <span class="pl-smi">Int64</span>     <span class="pl-smi">Int64</span>     <span class="pl-smi">Int64</span>
───────┼───────────────────────────────────────────────────────────
     <span class="pl-c1">1</span> │ <span class="pl-smi">DE1</span>           <span class="pl-c1">200</span>       <span class="pl-c1">180</span>       <span class="pl-c1">176</span>        <span class="pl-c1">26</span>        <span class="pl-c1">24</span>
     <span class="pl-c1">2</span> │ <span class="pl-smi">DE2</span>            <span class="pl-c1">26</span>        <span class="pl-c1">37</span>        <span class="pl-c1">36</span>        <span class="pl-c1">40</span>        <span class="pl-c1">79</span>
     <span class="pl-c1">3</span> │ <span class="pl-smi">DE3</span>           <span class="pl-c1">157</span>        <span class="pl-c1">81</span>        <span class="pl-c1">89</span>       <span class="pl-c1">220</span>        <span class="pl-c1">97</span>
     <span class="pl-c1">4</span> │ <span class="pl-smi">DE4</span>            <span class="pl-c1">15</span>       <span class="pl-c1">205</span>        <span class="pl-c1">63</span>        <span class="pl-c1">75</span>       <span class="pl-c1">228</span>
     <span class="pl-c1">5</span> │ <span class="pl-smi">DE5</span>           <span class="pl-c1">505</span>        <span class="pl-c1">92</span>       <span class="pl-c1">119</span>       <span class="pl-c1">157</span>       <span class="pl-c1">261</span>
     <span class="pl-c1">6</span> │ <span class="pl-smi">DE6</span>           <span class="pl-c1">191</span>       <span class="pl-c1">131</span>        <span class="pl-c1">99</span>       <span class="pl-c1">147</span>        <span class="pl-c1">68</span>
     <span class="pl-c1">7</span> │ <span class="pl-smi">DE7</span>           <span class="pl-c1">116</span>        <span class="pl-c1">38</span>        <span class="pl-c1">34</span>        <span class="pl-c1">58</span>        <span class="pl-c1">64</span>
     <span class="pl-c1">8</span> │ <span class="pl-smi">DE8</span>            <span class="pl-c1">53</span>        <span class="pl-c1">39</span>       <span class="pl-c1">183</span>        <span class="pl-c1">22</span>        <span class="pl-c1">73</span>
   ⋮   │    ⋮        ⋮         ⋮         ⋮         ⋮         ⋮
 <span class="pl-c1">19993</span> │ <span class="pl-smi">EE19994</span>        <span class="pl-c1">88</span>        <span class="pl-c1">15</span>       <span class="pl-c1">192</span>         <span class="pl-c1">9</span>        <span class="pl-c1">35</span>
 <span class="pl-c1">19994</span> │ <span class="pl-smi">EE19995</span>       <span class="pl-c1">174</span>        <span class="pl-c1">73</span>        <span class="pl-c1">14</span>        <span class="pl-c1">16</span>        <span class="pl-c1">97</span>
 <span class="pl-c1">19995</span> │ <span class="pl-smi">EE19996</span>       <span class="pl-c1">138</span>        <span class="pl-c1">61</span>       <span class="pl-c1">407</span>       <span class="pl-c1">182</span>         <span class="pl-c1">0</span>
 <span class="pl-c1">19996</span> │ <span class="pl-smi">EE19997</span>       <span class="pl-c1">325</span>        <span class="pl-c1">94</span>       <span class="pl-c1">231</span>       <span class="pl-c1">281</span>        <span class="pl-c1">41</span>
 <span class="pl-c1">19997</span> │ <span class="pl-smi">EE19998</span>        <span class="pl-c1">24</span>         <span class="pl-c1">0</span>       <span class="pl-c1">116</span>        <span class="pl-c1">43</span>       <span class="pl-c1">656</span>
 <span class="pl-c1">19998</span> │ <span class="pl-smi">EE19999</span>         <span class="pl-c1">0</span>       <span class="pl-c1">144</span>         <span class="pl-c1">4</span>       <span class="pl-c1">393</span>         <span class="pl-c1">0</span>
 <span class="pl-c1">19999</span> │ <span class="pl-smi">EE20000</span>       <span class="pl-c1">294</span>         <span class="pl-c1">0</span>        <span class="pl-c1">26</span>        <span class="pl-c1">98</span>        <span class="pl-c1">18</span>
                                                 <span class="pl-c1">19984</span> <span class="pl-smi">rows</span> <span class="pl-smi">omitted</span>)</pre></div>
<h4 dir="auto"><a id="user-content-run-your-own-deg-analysis-1" class="anchor" aria-hidden="true" href="#run-your-own-deg-analysis-1"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a>Run your own DEG analysis</h4>
<p dir="auto">You need to prepare two input files before the analysis: metadata file and expression matrix. Both of them should be saved in the <code>TSV</code> or <code>CSV</code> format and they should be compatible with each other.</p>
<ul dir="auto">
<li><strong>metadata file (required).</strong></li>
</ul>
<p dir="auto">The metadata file contains at least two columns. The first column is the sample names, and the second column is the grouping information. Only two groups are supported at present, therefore, do not include more than two groups.</p>
<p dir="auto">Column names for a metadata should be <code>Name</code> and <code>Group</code>.</p>
<p dir="auto">See an example metadata file, <a href="https://github.com/yanjer/RankCompV3.jl/blob/master/test/fn_metadata.txt">fn_metadata.txt</a>.</p>
<ul dir="auto">
<li><strong>expression matrix file (required).</strong></li>
</ul>
<p dir="auto">The first column is the gene name and the column header should be <code>Name</code> and the rest columns are profiles for each cell or each sample. Each column header should be the sample name which appears in the metadata file.</p>
<p dir="auto">See an example expression matrix file, <a href="https://github.com/yanjer/RankCompV3.jl/blob/master/test/fn_expr.txt">fn_expr.txt</a>.</p>
<p dir="auto">Raw counts or expression values are recommended to use. Other values, e.g, FPKM, RPKM, TPM, log(counts) and log(normalized counts), can also be used, though normalization and batch effect removal are neither necessary nor recommended.</p>
<p dir="auto">Once the files are ready, you can carry out the DEG analysis with the default settings as follows.</p>
<div class="highlight highlight-source-r notranslate position-relative overflow-auto" dir="auto" data-snippet-clipboard-copy-content="julia_library(&quot;RankCompV3&quot;)
# Use the default values for the following other parameters. If you want to modify the parameters, add them directly.
julia_do.call(&quot;reoa&quot;,list(&quot;/public/yanj/data/fn_expr.txt&quot;,
						&quot;/public/yanj/data/fn_meta.txt&quot;),need_return=&quot;Julia&quot;,show_value=FALSE)"><pre>julia_library(<span class="pl-s"><span class="pl-pds">"</span>RankCompV3<span class="pl-pds">"</span></span>)
<span class="pl-c"><span class="pl-c">#</span> Use the default values for the following other parameters. If you want to modify the parameters, add them directly.</span>
julia_do.call(<span class="pl-s"><span class="pl-pds">"</span>reoa<span class="pl-pds">"</span></span>,<span class="pl-k">list</span>(<span class="pl-s"><span class="pl-pds">"</span>/public/yanj/data/fn_expr.txt<span class="pl-pds">"</span></span>,
						<span class="pl-s"><span class="pl-pds">"</span>/public/yanj/data/fn_meta.txt<span class="pl-pds">"</span></span>),<span class="pl-v">need_return</span><span class="pl-k">=</span><span class="pl-s"><span class="pl-pds">"</span>Julia<span class="pl-pds">"</span></span>,<span class="pl-v">show_value</span><span class="pl-k">=</span><span class="pl-c1">FALSE</span>)</pre></div>
<p dir="auto">Other parameters can be set by passing the value to the corresponding keyword.</p>
<div class="highlight highlight-source-r notranslate position-relative overflow-auto" dir="auto" data-snippet-clipboard-copy-content="julia_do.call(&quot;reoa&quot;,list(&quot;/public/yanj/data/fn_expr.txt&quot;,
    	&quot;/public/yanj/data/fn_meta.txt&quot;,
    	expr_threshold = 0,
    	min_profiles = 0,
    	min_features = 0,
    	pval_reo = 0.01,
     	pval_deg = 0.05,
     	padj_deg = 0.05,
    	use_pseudobulk = 0,
    	use_hk_genes = &quot;yes&quot;
    	hk_file = &quot;HK_genes_info.tsv&quot;,
    	gene_name_type = &quot;ENSEMBL&quot;,
    	ref_gene_max = 3000,
    	ref_gene_min = 100
    	n_iter = 128,
    	n_conv = 5,
    	work_dir = &quot;./&quot;,
    	use_testdata = &quot;no&quot;),need_return=&quot;Julia&quot;,show_value=FALSE)"><pre>julia_do.call(<span class="pl-s"><span class="pl-pds">"</span>reoa<span class="pl-pds">"</span></span>,<span class="pl-k">list</span>(<span class="pl-s"><span class="pl-pds">"</span>/public/yanj/data/fn_expr.txt<span class="pl-pds">"</span></span>,
    	<span class="pl-s"><span class="pl-pds">"</span>/public/yanj/data/fn_meta.txt<span class="pl-pds">"</span></span>,
    	<span class="pl-v">expr_threshold</span> <span class="pl-k">=</span> <span class="pl-c1">0</span>,
    	<span class="pl-v">min_profiles</span> <span class="pl-k">=</span> <span class="pl-c1">0</span>,
    	<span class="pl-v">min_features</span> <span class="pl-k">=</span> <span class="pl-c1">0</span>,
    	<span class="pl-v">pval_reo</span> <span class="pl-k">=</span> <span class="pl-c1">0.01</span>,
     	<span class="pl-v">pval_deg</span> <span class="pl-k">=</span> <span class="pl-c1">0.05</span>,
     	<span class="pl-v">padj_deg</span> <span class="pl-k">=</span> <span class="pl-c1">0.05</span>,
    	<span class="pl-v">use_pseudobulk</span> <span class="pl-k">=</span> <span class="pl-c1">0</span>,
    	<span class="pl-v">use_hk_genes</span> <span class="pl-k">=</span> <span class="pl-s"><span class="pl-pds">"</span>yes<span class="pl-pds">"</span></span>
    	<span class="pl-v">hk_file</span> <span class="pl-k">=</span> <span class="pl-s"><span class="pl-pds">"</span>HK_genes_info.tsv<span class="pl-pds">"</span></span>,
    	<span class="pl-v">gene_name_type</span> <span class="pl-k">=</span> <span class="pl-s"><span class="pl-pds">"</span>ENSEMBL<span class="pl-pds">"</span></span>,
    	<span class="pl-v">ref_gene_max</span> <span class="pl-k">=</span> <span class="pl-c1">3000</span>,
    	<span class="pl-v">ref_gene_min</span> <span class="pl-k">=</span> <span class="pl-c1">100</span>
    	<span class="pl-v">n_iter</span> <span class="pl-k">=</span> <span class="pl-c1">128</span>,
    	<span class="pl-v">n_conv</span> <span class="pl-k">=</span> <span class="pl-c1">5</span>,
    	<span class="pl-v">work_dir</span> <span class="pl-k">=</span> <span class="pl-s"><span class="pl-pds">"</span>./<span class="pl-pds">"</span></span>,
    	<span class="pl-v">use_testdata</span> <span class="pl-k">=</span> <span class="pl-s"><span class="pl-pds">"</span>no<span class="pl-pds">"</span></span>),<span class="pl-v">need_return</span><span class="pl-k">=</span><span class="pl-s"><span class="pl-pds">"</span>Julia<span class="pl-pds">"</span></span>,<span class="pl-v">show_value</span><span class="pl-k">=</span><span class="pl-c1">FALSE</span>)</pre></div>
<h4 dir="auto"><a id="user-content-pseudobulk-method-1" class="anchor" aria-hidden="true" href="#pseudobulk-method-1"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a>Pseudobulk method</h4>
<p dir="auto">For scRNA-seq data, one can carry out a pseudobulk analysis. Rather than using the original single-cell profiles, pseudobulk profiles can be generated and used for DEG analysis. In this method, a random subset of cells from a group is aggregated into a pseudo-bulk profile.</p>
<p dir="auto">The pseudobulk method can be turned on by setting <code>use_pseudobulk = 1</code>.</p>
<div class="highlight highlight-source-r notranslate position-relative overflow-auto" dir="auto" data-snippet-clipboard-copy-content="julia_do.call(&quot;reoa&quot;,list(&quot;scRNA_expr.txt&quot;,
						&quot;scRNA_metadata.txt&quot;,
        				use_pseudobulk = 1),need_return=&quot;Julia&quot;,show_value=FALSE)"><pre>julia_do.call(<span class="pl-s"><span class="pl-pds">"</span>reoa<span class="pl-pds">"</span></span>,<span class="pl-k">list</span>(<span class="pl-s"><span class="pl-pds">"</span>scRNA_expr.txt<span class="pl-pds">"</span></span>,
						<span class="pl-s"><span class="pl-pds">"</span>scRNA_metadata.txt<span class="pl-pds">"</span></span>,
        				<span class="pl-v">use_pseudobulk</span> <span class="pl-k">=</span> <span class="pl-c1">1</span>),<span class="pl-v">need_return</span><span class="pl-k">=</span><span class="pl-s"><span class="pl-pds">"</span>Julia<span class="pl-pds">"</span></span>,<span class="pl-v">show_value</span><span class="pl-k">=</span><span class="pl-c1">FALSE</span>)</pre></div>
<p dir="auto">By default, the analysis does not use the pseudobulk method (<code>use_pseudobulk = 0</code>).  If a value between <code>6</code> and <code>100</code> is passed to <code>use_pseudobulk</code>, that number of pseudobulk profiles will be generated and used for analysis. Other values (except <code>0</code> which turns off the pseudobulk method) will generate the default value (<code>10</code>) profiles.</p>
<h3 dir="auto"><a id="user-content-optional-parameters-1" class="anchor" aria-hidden="true" href="#optional-parameters-1"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a>Optional Parameters</h3>
<p dir="auto">Below lists the optional keyword parameters and their default values.</p>
<table>
<thead>
<tr>
<th>Parameter</th>
<th>Parameter types</th>
<th>Default value</th>
<th>Parameters to describe</th>
</tr>
</thead>
<tbody>
<tr>
<td>fn_expr</td>
<td>AbstractString</td>
<td>"fn_expr.txt"</td>
<td>Gene expression profile file path. (required)</td>
</tr>
<tr>
<td>fn_metadata</td>
<td>AbstractString</td>
<td>"fn_metadata.txt"</td>
<td>Grouping information file path. (required)</td>
</tr>
<tr>
<td>expr_threshold</td>
<td>Number</td>
<td>0</td>
<td>Gene expression threshold.</td>
</tr>
<tr>
<td>min_profiles</td>
<td>Int</td>
<td>0</td>
<td>Include features (genes) detected in at least this many cells.</td>
</tr>
<tr>
<td>min_features</td>
<td>Int</td>
<td>0</td>
<td>Include profiles (cells) where at least this many features are detected.</td>
</tr>
<tr>
<td>pval_reo</td>
<td>AbstractFloat</td>
<td>0.01</td>
<td>Stable threshold for p-value.</td>
</tr>
<tr>
<td>pval_deg</td>
<td>AbstractFloat</td>
<td>0.05</td>
<td>Significant  reversal threshold for p-value.</td>
</tr>
<tr>
<td>padj_deg</td>
<td>AbstractFloat</td>
<td>0.05</td>
<td>Significant reversal threshold for FDR  value.</td>
</tr>
<tr>
<td>use_pseudobulk</td>
<td>Int</td>
<td>0</td>
<td>0 for not using pseudobulk mode, 1 for automatic, 2<del>5 not used, 6</del>100 for number of pseudobulk profiles in each group.</td>
</tr>
<tr>
<td>use_hk_genes</td>
<td>AbstractString</td>
<td>"yes"</td>
<td>Whether to use the housekeeping gene, yes or no.</td>
</tr>
<tr>
<td>hk_file</td>
<td>AbstractString</td>
<td>"HK_genes_info.tsv"</td>
<td>House-keeping genes  file path.</td>
</tr>
<tr>
<td>gene_name_type</td>
<td>AbstractString</td>
<td>"ENSEMBL"</td>
<td>Available choices: Name, REFSEQ, SYMBOL, ENTREZID, ENSEMBL, UNIGENE and GENENAME.</td>
</tr>
<tr>
<td>ref_gene_max</td>
<td>Int</td>
<td>3000</td>
<td>If the number of available features is higher than this, take a random sample of this size.</td>
</tr>
<tr>
<td>ref_gene_min</td>
<td>Int</td>
<td>100</td>
<td>If the number is lower than this, ignore the house-keeping genes.</td>
</tr>
<tr>
<td>n_iter</td>
<td>Int</td>
<td>128</td>
<td>Max iterations.</td>
</tr>
<tr>
<td>n_conv</td>
<td>Int</td>
<td>5</td>
<td>Convergence condition: max. difference in the number of DEGs between two consective iterations.</td>
</tr>
<tr>
<td>work_dir</td>
<td>AbstractString</td>
<td>"./"</td>
<td>Working Directory.</td>
</tr>
<tr>
<td>use_testdata</td>
<td>AbstractString</td>
<td>"no"</td>
<td>Whether to use the default provided test data for analysis, yes or no.</td>
</tr>
</tbody>
</table>
<h4 dir="auto"><a id="user-content-example-output-file-1" class="anchor" aria-hidden="true" href="#example-output-file-1"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a>Example output file:</h4>
<ul dir="auto">
<li>
<p dir="auto">The expression profile of the ctrl group (after preprocessing).  (See <a href="https://github.com/yanjer/RankCompV3.jl/blob/master/test/fn_metadata.txt">fn_metadata.txt</a>)</p>
</li>
<li>
<p dir="auto">The expression profile of the treat group (after preprocessing).  (See <a href="https://github.com/yanjer/RankCompV3-test-data-output/blob/master/RankCompV3-test-data-output/fn_expr_treat.tsv">fn_expr_treat.tsv</a>)</p>
</li>
<li>
<p dir="auto">This file contains Name, pval, padj, n11, n12, n13, n21, n22, n23, n31, n32, n33, Δ1, Δ2, se, z1.  (See <a href="https://github.com/yanjer/RankCompV3-test-data-output/blob/master/RankCompV3-test-data-output/fn_expr_result.tsv">fn_expr_result.tsv</a>)</p>
</li>
<li>
<p dir="auto">Graph of Distribution of Expression Values.  (See <a href="https://github.com/yanjer/RankCompV3-test-data-output/blob/master/RankCompV3-test-data-output/fn_expr_expr_dist.pdf">fn_expr_expr_dist.pdf</a>)</p>
</li>
<li>
<p dir="auto">Heat maps of expression values for the ctrl and treat groups.  (See <a href="https://github.com/yanjer/RankCompV3-test-data-output/blob/master/RankCompV3-test-data-output/fn_expr_expr_heat.pdf">fn_expr_expr_heat.pdf</a>)</p>
</li>
<li>
<p dir="auto">Distribution of parameters in 3 x 3 contingency tables.  (See <a href="https://github.com/yanjer/RankCompV3-test-data-output/blob/master/RankCompV3-test-data-output/fn_expr_contigency_table.pdf">fn_expr_contigency_table.pdf</a>)</p>
</li>
<li>
<p dir="auto">Delta distribution.  (See <a href="https://github.com/yanjer/RankCompV3-test-data-output/blob/master/RankCompV3-test-data-output/fn_expr_delta_value.pdf">fn_expr_delta_value.pdf</a>)</p>
</li>
<li>
<p dir="auto">Distribution of Standard Error (SE).  (See <a href="https://github.com/yanjer/RankCompV3-test-data-output/blob/master/RankCompV3-test-data-output/fn_expr_se.pdf">fn_expr_se.pdf</a>)</p>
</li>
<li>
<p dir="auto">Distribution of z1.  (See <a href="https://github.com/yanjer/RankCompV3-test-data-output/blob/master/RankCompV3-test-data-output/fn_expr_z1.pdf">fn_expr_z1.pdf</a>)</p>
</li>
<li>
<p dir="auto">Distribution of p and FDR values.  (See <a href="https://github.com/yanjer/RankCompV3-test-data-output/blob/master/RankCompV3-test-data-output/fn_expr_p_value.pdf">fn_expr_p_value.pdf</a>)</p>
</li>
<li>
<p dir="auto">Distribution of expression values for DEGs.  (See <a href="https://github.com/yanjer/RankCompV3-test-data-output/blob/master/RankCompV3-test-data-output/fn_expr_degs_expr_dist.pdf">fn_expr_degs_expr_dist.pdf</a>)</p>
</li>
<li>
<p dir="auto">Heat map of the expression values of DEGs in the ctrl and treat groups.  (See <a href="https://github.com/yanjer/RankCompV3-test-data-output/blob/master/RankCompV3-test-data-output/fn_expr_degs_expr_heat.pdf">fn_expr_degs_expr_heat.pdf</a>)</p>
</li>
</ul>
<h5 dir="auto"><a id="user-content-log-file-1" class="anchor" aria-hidden="true" href="#log-file-1"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a>log file</h5>
<ul dir="auto">
<li><a href="https://github.com/yanjer/RankCompV3-test-data-output/blob/master/RankCompV3-test-data-output/RankCompV3_test_data_output.log">RankCompV3-test-data-output.log</a></li>
</ul>
</article></div>