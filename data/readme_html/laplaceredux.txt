<div id="readme" class="md" data-path="README.md"><article class="markdown-body entry-content container-lg" itemprop="text"><p dir="auto"><a target="_blank" rel="noopener noreferrer" href="docs/src/assets/wide_logo.png"><img src="docs/src/assets/wide_logo.png" alt="" style="max-width: 100%;"></a></p>
<p dir="auto"><a href="https://juliatrustworthyai.github.io/LaplaceRedux.jl/stable" rel="nofollow"><img src="https://camo.githubusercontent.com/c97f0a5f2ae95755f64a27f1aa8d9a17462941fd3d6c907c7630abd5d3e60acf/68747470733a2f2f696d672e736869656c64732e696f2f62616467652f646f63732d737461626c652d626c75652e737667" alt="Stable" data-canonical-src="https://img.shields.io/badge/docs-stable-blue.svg" style="max-width: 100%;"></a> <a href="https://juliatrustworthyai.github.io/LaplaceRedux.jl/dev" rel="nofollow"><img src="https://camo.githubusercontent.com/7fcec4b2d3ab291529fce8ef6a4fcd4129a0683b2f5d5fe2f5c648f02db8b616/68747470733a2f2f696d672e736869656c64732e696f2f62616467652f646f63732d6465762d626c75652e737667" alt="Dev" data-canonical-src="https://img.shields.io/badge/docs-dev-blue.svg" style="max-width: 100%;"></a> <a href="https://github.com/JuliaTrustworthyAI/LaplaceRedux.jl/actions/workflows/CI.yml?query=branch%3Amain"><img src="https://github.com/JuliaTrustworthyAI/LaplaceRedux.jl/actions/workflows/CI.yml/badge.svg?branch=main" alt="Build Status" style="max-width: 100%;"></a> <a href="https://codecov.io/gh/JuliaTrustworthyAI/LaplaceRedux.jl" rel="nofollow"><img src="https://camo.githubusercontent.com/f2748531a117db298b3ad12e968ddbc2abdf07804ac35626af8c21d5edfaf4aa/68747470733a2f2f636f6465636f762e696f2f67682f4a756c69615472757374776f7274687941492f4c61706c61636552656475782e6a6c2f6272616e63682f6d61696e2f67726170682f62616467652e737667" alt="Coverage" data-canonical-src="https://codecov.io/gh/JuliaTrustworthyAI/LaplaceRedux.jl/branch/main/graph/badge.svg" style="max-width: 100%;"></a> <a href="https://github.com/invenia/BlueStyle"><img src="https://camo.githubusercontent.com/c18fbaa52d94d16b90b19701fc90d289b8a5bb920c74c79bab200b14e75420a4/68747470733a2f2f696d672e736869656c64732e696f2f62616467652f636f64652532307374796c652d626c75652d3434393564312e737667" alt="Code Style: Blue" data-canonical-src="https://img.shields.io/badge/code%20style-blue-4495d1.svg" style="max-width: 100%;"></a> <a href="https://github.com/SciML/ColPrac"><img src="https://camo.githubusercontent.com/85779b6394f8a19cd849938c5e3862184e946784ea3cb531ebbfb9b34ab2ffc2/68747470733a2f2f696d672e736869656c64732e696f2f62616467652f436f6c507261632d436f6e7472696275746f72277325323047756964652d626c756576696f6c65742e706e67" alt="ColPrac: Contributor‚Äôs Guide on Collaborative Practices for Community Packages" data-canonical-src="https://img.shields.io/badge/ColPrac-Contributor's%20Guide-blueviolet.png" style="max-width: 100%;"></a> <a href="https://twitter.com/paltmey" rel="nofollow"><img src="https://camo.githubusercontent.com/60fab44ccab4408ab5e34547279a18ac74a259976c8a14cc3c0b55544d690175/68747470733a2f2f696d672e736869656c64732e696f2f747769747465722f75726c2f68747470732f747769747465722e636f6d2f70616c746d65792e7376673f7374796c653d736f6369616c266c6162656c3d466f6c6c6f7725323025343070616c746d6579" alt="Twitter Badge" data-canonical-src="https://img.shields.io/twitter/url/https/twitter.com/paltmey.svg?style=social&amp;label=Follow%20%40paltmey" style="max-width: 100%;"></a></p>
<p dir="auto"><code>LaplaceRedux.jl</code> is a library written in pure Julia that can be used for effortless Bayesian Deep Learning trough Laplace Approximation (LA). In the development of this package I have drawn inspiration from this Python <a href="https://aleximmer.github.io/Laplace/index.html#setup" rel="nofollow">library</a> and its companion <a href="https://arxiv.org/abs/2106.14806" rel="nofollow">paper</a> (Daxberger et al. 2021).</p>
<h2 dir="auto"><a id="user-content--installation" class="anchor" aria-hidden="true" href="#-installation"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a><g-emoji class="g-emoji" alias="triangular_flag_on_post" fallback-src="https://github.githubassets.com/images/icons/emoji/unicode/1f6a9.png">üö©</g-emoji> Installation</h2>
<p dir="auto">The stable version of this package can be installed as follows:</p>
<div class="highlight highlight-source-julia notranslate position-relative overflow-auto" dir="auto" data-snippet-clipboard-copy-content="using Pkg
Pkg.add(&quot;LaplaceRedux.jl&quot;)"><pre><span class="pl-k">using</span> Pkg
Pkg<span class="pl-k">.</span><span class="pl-c1">add</span>(<span class="pl-s"><span class="pl-pds">"</span>LaplaceRedux.jl<span class="pl-pds">"</span></span>)</pre></div>
<p dir="auto">The development version can be installed like so:</p>
<div class="highlight highlight-source-julia notranslate position-relative overflow-auto" dir="auto" data-snippet-clipboard-copy-content="using Pkg
Pkg.add(&quot;https://github.com/JuliaTrustworthyAI/LaplaceRedux.jl&quot;)"><pre><span class="pl-k">using</span> Pkg
Pkg<span class="pl-k">.</span><span class="pl-c1">add</span>(<span class="pl-s"><span class="pl-pds">"</span>https://github.com/JuliaTrustworthyAI/LaplaceRedux.jl<span class="pl-pds">"</span></span>)</pre></div>
<h2 dir="auto"><a id="user-content-Ô∏è-basic-usage" class="anchor" aria-hidden="true" href="#Ô∏è-basic-usage"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a><g-emoji class="g-emoji" alias="desktop_computer" fallback-src="https://github.githubassets.com/images/icons/emoji/unicode/1f5a5.png">üñ•Ô∏è</g-emoji> Basic Usage</h2>
<p dir="auto"><code>LaplaceRedux.jl</code> can be used for any neural network trained in <a href="https://fluxml.ai/Flux.jl/dev/" rel="nofollow"><code>Flux.jl</code></a>. Below we show basic usage examples involving two simple models for a regression and a classification task, respectively.</p>
<h3 dir="auto"><a id="user-content-regression" class="anchor" aria-hidden="true" href="#regression"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a>Regression</h3>
<p dir="auto">A complete worked example for a regression model can be found in the <a href="https://www.paltmeyer.com/LaplaceRedux.jl/dev/tutorials/regression/" rel="nofollow">docs</a>. Here we jump straight to Laplace Approximation and take the pre-trained model <code>nn</code> as given. Then LA can be implemented as follows, where we specify the model <code>likelihood</code>. The plot show the fitted values overlaid with a 95% confidence interval. As expected, predictive uncertainty quickly increases in areas that are not populated by any training data.</p>
<div class="highlight highlight-source-julia notranslate position-relative overflow-auto" dir="auto" data-snippet-clipboard-copy-content="la = Laplace(nn; likelihood=:regression)
fit!(la, data)
optimize_prior!(la)
plot(la, X, y; zoom=-5, size=(500,500))"><pre>la <span class="pl-k">=</span> <span class="pl-c1">Laplace</span>(nn; likelihood<span class="pl-k">=</span><span class="pl-c1">:regression</span>)
<span class="pl-c1">fit!</span>(la, data)
<span class="pl-c1">optimize_prior!</span>(la)
<span class="pl-c1">plot</span>(la, X, y; zoom<span class="pl-k">=</span><span class="pl-k">-</span><span class="pl-c1">5</span>, size<span class="pl-k">=</span>(<span class="pl-c1">500</span>,<span class="pl-c1">500</span>))</pre></div>
<p dir="auto"><a target="_blank" rel="noopener noreferrer" href="README_files/figure-commonmark/cell-4-output-1.png"><img src="README_files/figure-commonmark/cell-4-output-1.png" alt="" style="max-width: 100%;"></a></p>
<h3 dir="auto"><a id="user-content-binary-classification" class="anchor" aria-hidden="true" href="#binary-classification"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a>Binary Classification</h3>
<p dir="auto">Once again we jump straight to LA and refer to the <a href="https://www.paltmeyer.com/LaplaceRedux.jl/dev/tutorials/mlp/" rel="nofollow">docs</a> for a complete worked example involving binary classification. In this case we need to specify <code>likelihood=:classification</code>. The plot below shows the resulting posterior predictive distributions as contours in the two-dimensional feature space: note how the <strong>Plugin</strong> Approximation on the left compares to the Laplace Approximation on the right.</p>
<div class="highlight highlight-source-julia notranslate position-relative overflow-auto" dir="auto" data-snippet-clipboard-copy-content="theme(:lime)

la = Laplace(nn; likelihood=:classification)
fit!(la, data)
la_untuned = deepcopy(la)   # saving for plotting
optimize_prior!(la; n_steps=500)

# Plot the posterior predictive distribution:
zoom=0
p_plugin = plot(la, X, ys; title=&quot;Plugin&quot;, link_approx=:plugin, clim=(0,1))
p_untuned = plot(la_untuned, X, ys; title=&quot;LA - raw (Œª=$(unique(diag(la_untuned.P‚ÇÄ))[1]))&quot;, clim=(0,1), zoom=zoom)
p_laplace = plot(la, X, ys; title=&quot;LA - tuned (Œª=$(round(unique(diag(la.P‚ÇÄ))[1],digits=2)))&quot;, clim=(0,1), zoom=zoom)
plot(p_plugin, p_untuned, p_laplace, layout=(1,3), size=(1700,400))"><pre><span class="pl-c1">theme</span>(<span class="pl-c1">:lime</span>)

la <span class="pl-k">=</span> <span class="pl-c1">Laplace</span>(nn; likelihood<span class="pl-k">=</span><span class="pl-c1">:classification</span>)
<span class="pl-c1">fit!</span>(la, data)
la_untuned <span class="pl-k">=</span> <span class="pl-c1">deepcopy</span>(la)   <span class="pl-c"><span class="pl-c">#</span> saving for plotting</span>
<span class="pl-c1">optimize_prior!</span>(la; n_steps<span class="pl-k">=</span><span class="pl-c1">500</span>)

<span class="pl-c"><span class="pl-c">#</span> Plot the posterior predictive distribution:</span>
zoom<span class="pl-k">=</span><span class="pl-c1">0</span>
p_plugin <span class="pl-k">=</span> <span class="pl-c1">plot</span>(la, X, ys; title<span class="pl-k">=</span><span class="pl-s"><span class="pl-pds">"</span>Plugin<span class="pl-pds">"</span></span>, link_approx<span class="pl-k">=</span><span class="pl-c1">:plugin</span>, clim<span class="pl-k">=</span>(<span class="pl-c1">0</span>,<span class="pl-c1">1</span>))
p_untuned <span class="pl-k">=</span> <span class="pl-c1">plot</span>(la_untuned, X, ys; title<span class="pl-k">=</span><span class="pl-s"><span class="pl-pds">"</span>LA - raw (Œª=<span class="pl-v">$(<span class="pl-c1">unique</span>(<span class="pl-c1">diag</span>(la_untuned<span class="pl-k">.</span>P‚ÇÄ))[<span class="pl-c1">1</span>])</span>)<span class="pl-pds">"</span></span>, clim<span class="pl-k">=</span>(<span class="pl-c1">0</span>,<span class="pl-c1">1</span>), zoom<span class="pl-k">=</span>zoom)
p_laplace <span class="pl-k">=</span> <span class="pl-c1">plot</span>(la, X, ys; title<span class="pl-k">=</span><span class="pl-s"><span class="pl-pds">"</span>LA - tuned (Œª=<span class="pl-v">$(<span class="pl-c1">round</span>(<span class="pl-c1">unique</span>(<span class="pl-c1">diag</span>(la<span class="pl-k">.</span>P‚ÇÄ))[<span class="pl-c1">1</span>],digits<span class="pl-k">=</span><span class="pl-c1">2</span>))</span>)<span class="pl-pds">"</span></span>, clim<span class="pl-k">=</span>(<span class="pl-c1">0</span>,<span class="pl-c1">1</span>), zoom<span class="pl-k">=</span>zoom)
<span class="pl-c1">plot</span>(p_plugin, p_untuned, p_laplace, layout<span class="pl-k">=</span>(<span class="pl-c1">1</span>,<span class="pl-c1">3</span>), size<span class="pl-k">=</span>(<span class="pl-c1">1700</span>,<span class="pl-c1">400</span>))</pre></div>
<p dir="auto"><a target="_blank" rel="noopener noreferrer" href="README_files/figure-commonmark/cell-6-output-1.svg"><img src="README_files/figure-commonmark/cell-6-output-1.svg" alt="" style="max-width: 100%;"></a></p>
<h2 dir="auto"><a id="user-content--juliacon-2022" class="anchor" aria-hidden="true" href="#-juliacon-2022"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a><g-emoji class="g-emoji" alias="loudspeaker" fallback-src="https://github.githubassets.com/images/icons/emoji/unicode/1f4e2.png">üì¢</g-emoji> JuliaCon 2022</h2>
<p dir="auto">This project was presented at JuliaCon 2022 in July 2022. See <a href="https://pretalx.com/juliacon-2022/talk/Z7MXFS/" rel="nofollow">here</a> for details.</p>
<h2 dir="auto"><a id="user-content-Ô∏è-contribute" class="anchor" aria-hidden="true" href="#Ô∏è-contribute"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a><g-emoji class="g-emoji" alias="hammer_and_wrench" fallback-src="https://github.githubassets.com/images/icons/emoji/unicode/1f6e0.png">üõ†Ô∏è</g-emoji> Contribute</h2>
<p dir="auto">Contributions are very much welcome! Please follow the <a href="https://github.com/SciML/ColPrac">SciML ColPrac guide</a>. You may want to start by having a look at any open <a href="https://github.com/JuliaTrustworthyAI/LaplaceRedux.jl/issues">issues</a>.</p>
<h2 dir="auto"><a id="user-content--references" class="anchor" aria-hidden="true" href="#-references"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a><g-emoji class="g-emoji" alias="mortar_board" fallback-src="https://github.githubassets.com/images/icons/emoji/unicode/1f393.png">üéì</g-emoji> References</h2>
<p dir="auto">Daxberger, Erik, Agustinus Kristiadi, Alexander Immer, Runa Eschenhagen, Matthias Bauer, and Philipp Hennig. 2021. ‚ÄúLaplace Redux-Effortless Bayesian Deep Learning.‚Äù <em>Advances in Neural Information Processing Systems</em> 34.</p>
</article></div>