<div id="readme" class="md" data-path="README.md"><article class="markdown-body entry-content container-lg" itemprop="text"><h1 dir="auto"><a id="user-content-autohedgejl" class="anchor" aria-hidden="true" href="#autohedgejl"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a>AutoHedge.jl</h1>
<p dir="auto">This Julia package provides an implementation of automatic options hedging using automatic differentiation for obtaining the <a href="https://en.wikipedia.org/wiki/Greeks_(finance)" rel="nofollow">Greeks</a>. The package allows users to easily create and backtest complicated hedging strategies for a portfolio of European Options.</p>
<h2 dir="auto"><a id="user-content-installation" class="anchor" aria-hidden="true" href="#installation"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a>Installation</h2>
<p dir="auto">To install the package, simply run the following command in the Julia REPL:</p>
<div class="highlight highlight-source-julia notranslate position-relative overflow-auto" dir="auto" data-snippet-clipboard-copy-content="using Pkg
Pkg.add(url=&quot;https://github.com/kgeoffrey/AutoHedge.jl&quot;)"><pre><span class="pl-k">using</span> Pkg
Pkg<span class="pl-k">.</span><span class="pl-c1">add</span>(url<span class="pl-k">=</span><span class="pl-s"><span class="pl-pds">"</span>https://github.com/kgeoffrey/AutoHedge.jl<span class="pl-pds">"</span></span>)</pre></div>
<h2 dir="auto"><a id="user-content-usage" class="anchor" aria-hidden="true" href="#usage"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a>Usage</h2>
<p dir="auto">To use the automatic options hedging functionality provided by this package, you can import the package into your Julia session:</p>
<div class="highlight highlight-source-julia notranslate position-relative overflow-auto" dir="auto" data-snippet-clipboard-copy-content="using AutoHedge"><pre><span class="pl-k">using</span> AutoHedge</pre></div>
<h3 dir="auto"><a id="user-content-example-1-delta-hedging" class="anchor" aria-hidden="true" href="#example-1-delta-hedging"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a>Example #1: Delta Hedging</h3>
<p dir="auto">Say you have a portfolio of 10 call options and you want to make your portfolio <a href="https://en.wikipedia.org/wiki/Delta_neutral" rel="nofollow">delta neutral</a>. One way of achieving this is to buy or sell specific quantities of underlying stock - this is referred to as Delta Hedging<sup><a href="#user-content-fn-1-d6c283e2765c2d7cd032bf6f0c6690c5" id="user-content-fnref-1-d6c283e2765c2d7cd032bf6f0c6690c5" data-footnote-ref="" aria-describedby="footnote-label">1</a></sup>. First create a portfolio, define the asset to be hedged (10 call options), and the array of hedging instruments (the underlying stock) and hedging strategies (delta in this case):</p>
<div class="highlight highlight-source-julia notranslate position-relative overflow-auto" dir="auto" data-snippet-clipboard-copy-content="call_option = CallOption(100, 130., 5., 0.01, 0.2, 0.)
stock = UnderlyingStock()
portfolio = Portfolio(call_option, 10, [stock], [&quot;delta&quot;])"><pre>call_option <span class="pl-k">=</span> <span class="pl-c1">CallOption</span>(<span class="pl-c1">100</span>, <span class="pl-c1">130.</span>, <span class="pl-c1">5.</span>, <span class="pl-c1">0.01</span>, <span class="pl-c1">0.2</span>, <span class="pl-c1">0.</span>)
stock <span class="pl-k">=</span> <span class="pl-c1">UnderlyingStock</span>()
portfolio <span class="pl-k">=</span> <span class="pl-c1">Portfolio</span>(call_option, <span class="pl-c1">10</span>, [stock], [<span class="pl-s"><span class="pl-pds">"</span>delta<span class="pl-pds">"</span></span>])</pre></div>
<p dir="auto">CallOption takes the arguments S, K, T, r, v, q - which stand for spot price, strike price, passage of time, risk free rate, volatility and continuously compounded dividend yield. The S, T and q can be random upon initiation, as they will be updated during the simulation. Furthermore it is important that the number of hedging strategies is the same as the number of hedging instruments, this will be explained <a href="#How-does-AutoHedge-work?">later below</a>. Next we simulate the price of the underlying stock:</p>
<div class="highlight highlight-source-julia notranslate position-relative overflow-auto" dir="auto" data-snippet-clipboard-copy-content="using Plots

stock_price = randomwalk(100, 500, 1)
plot(stock_price, xlabel=&quot;Time&quot;, ylabel=&quot;Spot Price&quot;)"><pre><span class="pl-k">using</span> Plots

stock_price <span class="pl-k">=</span> <span class="pl-c1">randomwalk</span>(<span class="pl-c1">100</span>, <span class="pl-c1">500</span>, <span class="pl-c1">1</span>)
<span class="pl-c1">plot</span>(stock_price, xlabel<span class="pl-k">=</span><span class="pl-s"><span class="pl-pds">"</span>Time<span class="pl-pds">"</span></span>, ylabel<span class="pl-k">=</span><span class="pl-s"><span class="pl-pds">"</span>Spot Price<span class="pl-pds">"</span></span>)</pre></div>
<p dir="auto"><a target="_blank" rel="noopener noreferrer nofollow" href="https://camo.githubusercontent.com/1e7e5e025c1eae045d07115352e4397addf35956402859780be0d1c89bb3c2b8/68747470733a2f2f692e696d6775722e636f6d2f35556f766d66592e706e67"><img src="https://camo.githubusercontent.com/1e7e5e025c1eae045d07115352e4397addf35956402859780be0d1c89bb3c2b8/68747470733a2f2f692e696d6775722e636f6d2f35556f766d66592e706e67" alt="Picture of Simulated Underlying Price" data-canonical-src="https://i.imgur.com/5UovmfY.png" style="max-width: 100%;"></a></p>
<p dir="auto">Now that we have the evolution of the stock price of the underlying we can run a backtest of the hedging strategy and obtain the borrowing to fund hedging purchases, holdings of hedging instruments and tracking error over time. For the backtest, we also need to define the rebalancing frequency:</p>
<div class="highlight highlight-source-julia notranslate position-relative overflow-auto" dir="auto" data-snippet-clipboard-copy-content="rebalancing_frequency = 5  # we rebalance every 5 periods
borrowing, volumes, tracking_errors = backtest(stock_price, rebalancing_frequency, portfolio)"><pre>rebalancing_frequency <span class="pl-k">=</span> <span class="pl-c1">5</span>  <span class="pl-c"><span class="pl-c">#</span> we rebalance every 5 periods</span>
borrowing, volumes, tracking_errors <span class="pl-k">=</span> <span class="pl-c1">backtest</span>(stock_price, rebalancing_frequency, portfolio)</pre></div>
<p dir="auto">As simple as that! Next we plot the results:</p>
<div class="highlight highlight-source-julia notranslate position-relative overflow-auto" dir="auto" data-snippet-clipboard-copy-content="plot(borrowing, xlabel=&quot;Time&quot;, ylabel = &quot;Cash Borrowing&quot;)
plot(volumes, xlabel=&quot;Time&quot;, ylabel = &quot;Volume&quot;, labels=permutedims(string.(typeof.(portfolio.hedging_instruments))))
plot(tracking_errors, xlabel=&quot;Time&quot;, ylabel = &quot;Tracking Error (Value of Portfolio)&quot;)"><pre><span class="pl-c1">plot</span>(borrowing, xlabel<span class="pl-k">=</span><span class="pl-s"><span class="pl-pds">"</span>Time<span class="pl-pds">"</span></span>, ylabel <span class="pl-k">=</span> <span class="pl-s"><span class="pl-pds">"</span>Cash Borrowing<span class="pl-pds">"</span></span>)
<span class="pl-c1">plot</span>(volumes, xlabel<span class="pl-k">=</span><span class="pl-s"><span class="pl-pds">"</span>Time<span class="pl-pds">"</span></span>, ylabel <span class="pl-k">=</span> <span class="pl-s"><span class="pl-pds">"</span>Volume<span class="pl-pds">"</span></span>, labels<span class="pl-k">=</span><span class="pl-c1">permutedims</span>(<span class="pl-c1">string</span>.(<span class="pl-c1">typeof</span>.(portfolio<span class="pl-k">.</span>hedging_instruments))))
<span class="pl-c1">plot</span>(tracking_errors, xlabel<span class="pl-k">=</span><span class="pl-s"><span class="pl-pds">"</span>Time<span class="pl-pds">"</span></span>, ylabel <span class="pl-k">=</span> <span class="pl-s"><span class="pl-pds">"</span>Tracking Error (Value of Portfolio)<span class="pl-pds">"</span></span>)</pre></div>
<p dir="auto"><a target="_blank" rel="noopener noreferrer nofollow" href="https://camo.githubusercontent.com/95d1834143927fbd1423664ad8f268fd1218f7d81355bfa1b854650fed7a64f8/68747470733a2f2f692e696d6775722e636f6d2f5368584c3048352e706e67"><img src="https://camo.githubusercontent.com/95d1834143927fbd1423664ad8f268fd1218f7d81355bfa1b854650fed7a64f8/68747470733a2f2f692e696d6775722e636f6d2f5368584c3048352e706e67" alt="Borrowing" data-canonical-src="https://i.imgur.com/ShXL0H5.png" style="max-width: 100%;"></a></p>
<p dir="auto"><a target="_blank" rel="noopener noreferrer nofollow" href="https://camo.githubusercontent.com/27e0c228ab2d14327633b66e40c9e6e8d3aad97ca669744c0c8d974e1c00be6f/68747470733a2f2f692e696d6775722e636f6d2f41527959696d6f2e706e67"><img src="https://camo.githubusercontent.com/27e0c228ab2d14327633b66e40c9e6e8d3aad97ca669744c0c8d974e1c00be6f/68747470733a2f2f692e696d6775722e636f6d2f41527959696d6f2e706e67" alt="Volumes" data-canonical-src="https://i.imgur.com/ARyYimo.png" style="max-width: 100%;"></a></p>
<p dir="auto"><a target="_blank" rel="noopener noreferrer nofollow" href="https://camo.githubusercontent.com/e9913bea7035573126ee4d43bf9b60a0a565c7cc90ade5961d56d7bee933062a/68747470733a2f2f692e696d6775722e636f6d2f655369447368562e706e67"><img src="https://camo.githubusercontent.com/e9913bea7035573126ee4d43bf9b60a0a565c7cc90ade5961d56d7bee933062a/68747470733a2f2f692e696d6775722e636f6d2f655369447368562e706e67" alt="Tracking Error" data-canonical-src="https://i.imgur.com/eSiDshV.png" style="max-width: 100%;"></a></p>
<p dir="auto">For this example you could experiment with rebalancing frequencies to reduce the tracking error even further. In the next example you see how you can hedge other greeks</p>
<h3 dir="auto"><a id="user-content-example-2-delta-theta-vega-hedging" class="anchor" aria-hidden="true" href="#example-2-delta-theta-vega-hedging"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a>Example #2: Delta-Theta-Vega Hedging</h3>
<p dir="auto">In this example we will construct a portfolio that has neutral Delta, Theta, Charm and Speed. We have 100 call options in our portfolio and need 3 additional hedging instruments for our strategy:</p>
<div class="highlight highlight-source-julia notranslate position-relative overflow-auto" dir="auto" data-snippet-clipboard-copy-content="call_option = CallOption(100, 130., 5., 0.01, 0.2, 0.)

stock = UnderlyingStock()
f1 = CallOption(100., 130., 5., 0.01, 0.2, 0.)
f2 = PutOption(100., 120., 5., 0.01, 0.2, 0.)

portfolio = Portfolio(call_option, 10, [stock, f1, f2], [&quot;delta&quot;, &quot;theta&quot;, &quot;vega&quot;])"><pre>call_option <span class="pl-k">=</span> <span class="pl-c1">CallOption</span>(<span class="pl-c1">100</span>, <span class="pl-c1">130.</span>, <span class="pl-c1">5.</span>, <span class="pl-c1">0.01</span>, <span class="pl-c1">0.2</span>, <span class="pl-c1">0.</span>)

stock <span class="pl-k">=</span> <span class="pl-c1">UnderlyingStock</span>()
f1 <span class="pl-k">=</span> <span class="pl-c1">CallOption</span>(<span class="pl-c1">100.</span>, <span class="pl-c1">130.</span>, <span class="pl-c1">5.</span>, <span class="pl-c1">0.01</span>, <span class="pl-c1">0.2</span>, <span class="pl-c1">0.</span>)
f2 <span class="pl-k">=</span> <span class="pl-c1">PutOption</span>(<span class="pl-c1">100.</span>, <span class="pl-c1">120.</span>, <span class="pl-c1">5.</span>, <span class="pl-c1">0.01</span>, <span class="pl-c1">0.2</span>, <span class="pl-c1">0.</span>)

portfolio <span class="pl-k">=</span> <span class="pl-c1">Portfolio</span>(call_option, <span class="pl-c1">10</span>, [stock, f1, f2], [<span class="pl-s"><span class="pl-pds">"</span>delta<span class="pl-pds">"</span></span>, <span class="pl-s"><span class="pl-pds">"</span>theta<span class="pl-pds">"</span></span>, <span class="pl-s"><span class="pl-pds">"</span>vega<span class="pl-pds">"</span></span>])</pre></div>
<p dir="auto">We use the same simulated stock price as before and create the backtest:</p>
<div class="highlight highlight-source-julia notranslate position-relative overflow-auto" dir="auto" data-snippet-clipboard-copy-content="rebalancing_frequency = 5
borrowing, volumes, tracking_errors = backtest(stock_price, rebalancing_frequency, portfolio)"><pre>rebalancing_frequency <span class="pl-k">=</span> <span class="pl-c1">5</span>
borrowing, volumes, tracking_errors <span class="pl-k">=</span> <span class="pl-c1">backtest</span>(stock_price, rebalancing_frequency, portfolio)</pre></div>
<p dir="auto"><a target="_blank" rel="noopener noreferrer nofollow" href="https://camo.githubusercontent.com/4fdefe578930ccfffed88305149ad9270fd7dac941cfae60d1300206b4948d7f/68747470733a2f2f692e696d6775722e636f6d2f537276635479452e706e67"><img src="https://camo.githubusercontent.com/4fdefe578930ccfffed88305149ad9270fd7dac941cfae60d1300206b4948d7f/68747470733a2f2f692e696d6775722e636f6d2f537276635479452e706e67" alt="Borrwing" data-canonical-src="https://i.imgur.com/SrvcTyE.png" style="max-width: 100%;"></a></p>
<p dir="auto"><a target="_blank" rel="noopener noreferrer nofollow" href="https://camo.githubusercontent.com/888dd7ee0ab619a3dbc270d651f4d259db6bcb5bc5fea8215d572c497b21c0d2/68747470733a2f2f692e696d6775722e636f6d2f4b6c6a576c667a2e706e67"><img src="https://camo.githubusercontent.com/888dd7ee0ab619a3dbc270d651f4d259db6bcb5bc5fea8215d572c497b21c0d2/68747470733a2f2f692e696d6775722e636f6d2f4b6c6a576c667a2e706e67" alt="Volumes" data-canonical-src="https://i.imgur.com/KljWlfz.png" style="max-width: 100%;"></a></p>
<p dir="auto"><a target="_blank" rel="noopener noreferrer nofollow" href="https://camo.githubusercontent.com/6a0769e6ca0f4b4f038ef1b16d3783449a1674130437e7bc25905b1c88c47b9c/68747470733a2f2f692e696d6775722e636f6d2f4754317337364d2e706e67"><img src="https://camo.githubusercontent.com/6a0769e6ca0f4b4f038ef1b16d3783449a1674130437e7bc25905b1c88c47b9c/68747470733a2f2f692e696d6775722e636f6d2f4754317337364d2e706e67" alt="Volumes" data-canonical-src="https://i.imgur.com/GT1s76M.png" style="max-width: 100%;"></a></p>
<p dir="auto">As you can see, depending on how many greeks you want to hedge, borrowing and asset volume can explode. Furthermore you should be wary of the <a href="https://en.wikipedia.org/wiki/Moneyness" rel="nofollow">Moneyness</a> of your hedging instruments with regard to the simulated stock price, especially when you select many Greeks to hedge this can lead to numerical errors.</p>
<h2 dir="auto"><a id="user-content-how-does-autohedge-work" class="anchor" aria-hidden="true" href="#how-does-autohedge-work"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a>How does AutoHedge work?</h2>
<p dir="auto">AutoHedge uses <a href="https://github.com/JuliaDiff/ForwardDiff.jl">ForwardDiff.jl</a> to get the Greeks of European Options. Next a system of linear equations is solved to obtain the cash borrowings, and hedging instrument volumes. The simple Delta-Hedge shown in Example #1 needs to fulfill 2 requirements, where B is the borrowing and <math-renderer class="js-inline-math" style="display: inline" data-static-url="https://github.githubassets.com/static" data-run-id="d6c283e2765c2d7cd032bf6f0c6690c5">$n_{1}$</math-renderer> the volume of stocks purchased:
It needs to be self-financing:</p>
<math-renderer class="js-display-math" style="display: block" data-static-url="https://github.githubassets.com/static" data-run-id="d6c283e2765c2d7cd032bf6f0c6690c5">$$-Nf + n_{1}S - B = 0$$</math-renderer>
<p dir="auto">and it needs to be Delta Neutral as per definition:</p>
<math-renderer class="js-display-math" style="display: block" data-static-url="https://github.githubassets.com/static" data-run-id="d6c283e2765c2d7cd032bf6f0c6690c5">$$-N\Delta + n_{1} * 1 - 0 = 0$$</math-renderer>
<p dir="auto">By rearranging, we can write the equations in matrix form, so they can be solved easily:</p>
<math-renderer class="js-display-math" style="display: block" data-static-url="https://github.githubassets.com/static" data-run-id="d6c283e2765c2d7cd032bf6f0c6690c5">$$Ax = b$$</math-renderer>
<math-renderer class="js-display-math" style="display: block" data-static-url="https://github.githubassets.com/static" data-run-id="d6c283e2765c2d7cd032bf6f0c6690c5">$$x = A^{-1} b$$</math-renderer>
<p dir="auto">where,</p>
<math-renderer class="js-display-math" style="display: block" data-static-url="https://github.githubassets.com/static" data-run-id="d6c283e2765c2d7cd032bf6f0c6690c5">$$A = \begin{bmatrix} -1 &amp; S \\ 0 &amp; 1 \end{bmatrix}, b =  \begin{bmatrix} Nf \\ N \Delta \end{bmatrix}, x =  \begin{bmatrix} B  \\ n_{1} \end{bmatrix}$$</math-renderer>
<p dir="auto">Similarly, we can add other Greeks, but for the A to be invertible and square, we cannot have an overdetermined system (more equations to balance than variables). Thus for each new hedging strategy we need to add a unique hedging instrument to the portfolio. We take Example #2, where we hedge portfolio delta, theta and vega:</p>
<math-renderer class="js-display-math" style="display: block" data-static-url="https://github.githubassets.com/static" data-run-id="d6c283e2765c2d7cd032bf6f0c6690c5">$$A = \begin{bmatrix} -1 &amp; S &amp; f_2 &amp; f_3 \\ 0 &amp; 1  &amp; \Delta_2 &amp; \Delta_3 \\ 0 &amp; 0  &amp; \Theta_2 &amp; \Theta_3 \\ 0 &amp; 0  &amp; \nu_2 &amp; \nu_3
 \end{bmatrix}, b =  \begin{bmatrix} Nf \\ N \Delta_1 \\ N \Theta_1 \\ N \nu_1  \end{bmatrix}, x =  \begin{bmatrix} B  \\ n_{1}  \\ n_{2}  \\ n_{3} \end{bmatrix}$$</math-renderer>
<h2 dir="auto">
<a id="user-content-contributing" class="anchor" aria-hidden="true" href="#contributing"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a>Contributing</h2>
<p dir="auto">Contributions to this package are welcome! If you find a bug or have a feature request, please create an issue on the GitHub repository. If you would like to contribute code, please fork the repository and create a pull request.</p>
<h2 dir="auto">
<a id="user-content-license" class="anchor" aria-hidden="true" href="#license"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a>License</h2>
<p dir="auto">This package is licensed under the <a href="https://opensource.org/license/mit/" rel="nofollow">MIT License</a>.</p>
<section data-footnotes="" class="footnotes"><h2 id="footnote-label" class="sr-only" dir="auto">Footnotes</h2>
<ol dir="auto">
<li id="user-content-fn-1-d6c283e2765c2d7cd032bf6f0c6690c5">
<p dir="auto"><a href="https://www.csie.ntu.edu.tw/~lyuu/finance1/2007/20070509.pdf">2007 Prof. Yuh-Dauh Lyuu, National Taiwan University</a> <a href="#user-content-fnref-1-d6c283e2765c2d7cd032bf6f0c6690c5" data-footnote-backref="" aria-label="Back to reference 1" class="data-footnote-backref"><g-emoji class="g-emoji" alias="leftwards_arrow_with_hook" fallback-src="https://github.githubassets.com/images/icons/emoji/unicode/21a9.png">↩</g-emoji></a></p>
</li>
</ol>
</section>
</article></div>