<div id="readme" class="md" data-path="README.md"><article class="markdown-body entry-content container-lg" itemprop="text"><h1 dir="auto"><a id="user-content-quantumfluidspectrajl" class="anchor" aria-hidden="true" href="#quantumfluidspectrajl"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a>QuantumFluidSpectra.jl</h1>

<p dir="auto"><a href="https://github.com/AshtonSBradley/QuantumFluidSpectra.jl/actions"><img src="https://github.com/AshtonSBradley/QuantumFluidSpectra.jl/workflows/CI/badge.svg" alt="Build Status" style="max-width: 100%;"></a>
<a href="https://codecov.io/gh/AshtonSBradley/QuantumFluidSpectra.jl" rel="nofollow"><img src="https://camo.githubusercontent.com/24be50bbf930bc5dcc7cca95b5039b9bc7c77fa200019d8b8087fbf3c81ec4e9/68747470733a2f2f636f6465636f762e696f2f67682f417368746f6e53427261646c65792f5175616e74756d466c756964537065637472612e6a6c2f6272616e63682f6d61737465722f67726170682f62616467652e737667" alt="Coverage" data-canonical-src="https://codecov.io/gh/AshtonSBradley/QuantumFluidSpectra.jl/branch/master/graph/badge.svg" style="max-width: 100%;"></a></p>
<p dir="auto">This package provides methods to calculate energy spectra of compressible quantum fluids described by a wavefunction, including dilute-gas Bose-Einstein condensates, polariton BEC, and quantum fluids of light.</p>
<p dir="auto">Fast, accurate, and flexible spectral analysis provides a wealth of information about nonlinear quantum fluid dynamics.</p>
<p dir="auto">We rely on Fourier spectral methods throughout. The user provides a wavefunction and minimal information about the spatial domain.</p>
<h2 dir="auto"><a id="user-content-install" class="anchor" aria-hidden="true" href="#install"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a>Install</h2>
<div class="highlight highlight-source-julia notranslate position-relative overflow-auto" dir="auto" data-snippet-clipboard-copy-content="julia&gt; ]add QuantumFluidSpectra"><pre>julia<span class="pl-k">&gt;</span> ]add QuantumFluidSpectra</pre></div>
<p dir="auto">The setup is described below.</p>
<details><summary><b>Create Field</b></summary>
<div class="highlight highlight-source-julia notranslate position-relative overflow-auto" dir="auto" data-snippet-clipboard-copy-content="# Create arrays including `x` and `k` grids

    n = 100
    L = (1,1)
    N = (n,n)
    X,K,dX,dK = xk_arrays(L,N) # setup domain"><pre><span class="pl-c"><span class="pl-c">#</span> Create arrays including `x` and `k` grids</span>

    n <span class="pl-k">=</span> <span class="pl-c1">100</span>
    L <span class="pl-k">=</span> (<span class="pl-c1">1</span>,<span class="pl-c1">1</span>)
    N <span class="pl-k">=</span> (n,n)
    X,K,dX,dK <span class="pl-k">=</span> <span class="pl-c1">xk_arrays</span>(L,N) <span class="pl-c"><span class="pl-c">#</span> setup domain</span></pre></div>
<div class="highlight highlight-source-julia notranslate position-relative overflow-auto" dir="auto" data-snippet-clipboard-copy-content="# make a test field
    ktest = K[1][2] # pick one of the `k` values
    ψ = @. exp(im*ktest*X[1]*one.(X[2]'))
    psi = Psi(ψ,X,K) # make field object with required arrays."><pre><span class="pl-c"><span class="pl-c">#</span> make a test field</span>
    ktest <span class="pl-k">=</span> K[<span class="pl-c1">1</span>][<span class="pl-c1">2</span>] <span class="pl-c"><span class="pl-c">#</span> pick one of the `k` values</span>
    ψ <span class="pl-k">=</span> <span class="pl-c1">@.</span> <span class="pl-c1">exp</span>(im<span class="pl-k">*</span>ktest<span class="pl-k">*</span>X[<span class="pl-c1">1</span>]<span class="pl-k">*</span><span class="pl-c1">one</span>.(X[<span class="pl-c1">2</span>]<span class="pl-k">'</span>))
    psi <span class="pl-k">=</span> <span class="pl-c1">Psi</span>(ψ,X,K) <span class="pl-c"><span class="pl-c">#</span> make field object with required arrays.</span></pre></div>
</details>
<details><summary><b>Power spectra and correlations</b></summary>
To evaluate the incompressible power spectral density on a particular k grid:
<div class="highlight highlight-source-julia notranslate position-relative overflow-auto" dir="auto" data-snippet-clipboard-copy-content="k = LinRange(0.05,10,300) # can be anything
εki = incompressible_spectrum(k,psi)"><pre>k <span class="pl-k">=</span> <span class="pl-c1">LinRange</span>(<span class="pl-c1">0.05</span>,<span class="pl-c1">10</span>,<span class="pl-c1">300</span>) <span class="pl-c"><span class="pl-c">#</span> can be anything</span>
εki <span class="pl-k">=</span> <span class="pl-c1">incompressible_spectrum</span>(k,psi)</pre></div>
<p dir="auto">The (angle-averaged) two-point correlator of the incompressible velocity field may then be calculated by</p>
<div class="snippet-clipboard-content notranslate position-relative overflow-auto" data-snippet-clipboard-copy-content="r = LinRange(0,10,300) # can be anything
gi = gv(r,k,εki) # pass k vals on which εki is defined"><pre class="notranslate"><code>r = LinRange(0,10,300) # can be anything
gi = gv(r,k,εki) # pass k vals on which εki is defined
</code></pre></div>
<p dir="auto">See the citation below for details.</p>
</details>
<h2 dir="auto"><a id="user-content-example-central-vortex-in-a-2d-bose-einstein-condensate" class="anchor" aria-hidden="true" href="#example-central-vortex-in-a-2d-bose-einstein-condensate"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a>Example: central vortex in a 2D Bose-Einstein condensate</h2>
<p dir="auto">For creation script, see <code>/example_figure/test_2Dtrap_vortex.jl</code>.</p>
<p dir="auto"><a target="_blank" rel="noopener noreferrer" href="/example_figure/central_vortex.png"><img src="/example_figure/central_vortex.png" width="600" style="max-width: 100%;"></a></p>
<p dir="auto">to reproduce Figure 3(a) of <a href="https://arxiv.org/abs/2112.04012%7D" rel="nofollow">https://arxiv.org/abs/2112.04012</a>.</p>
<h1 dir="auto"><a id="user-content-citation" class="anchor" aria-hidden="true" href="#citation"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a>Citation</h1>
<p dir="auto">If you use <code>QuantumFluidSpectra.jl</code> please cite the paper</p>
<div class="highlight highlight-text-bibtex notranslate position-relative overflow-auto" dir="auto" data-snippet-clipboard-copy-content="@article{PhysRevA.106.043322,
  title = {Spectral analysis for compressible quantum fluids},
  author = {Bradley, Ashton S. and Kumar, R. Kishor and Pal, Sukla and Yu, Xiaoquan},
  journal = {Phys. Rev. A},
  volume = {106},
  issue = {4},
  pages = {043322},
  numpages = {15},
  year = {2022},
  month = {Oct},
  publisher = {American Physical Society},
  doi = {10.1103/PhysRevA.106.043322},
  url = {https://link.aps.org/doi/10.1103/PhysRevA.106.043322}
}"><pre><span class="pl-k">@article</span>{<span class="pl-en">PhysRevA.106.043322</span>,
  <span class="pl-s">title</span> = <span class="pl-s"><span class="pl-pds">{</span>Spectral analysis for compressible quantum fluids<span class="pl-pds">}</span></span>,
  <span class="pl-s">author</span> = <span class="pl-s"><span class="pl-pds">{</span>Bradley, Ashton S. and Kumar, R. Kishor and Pal, Sukla and Yu, Xiaoquan<span class="pl-pds">}</span></span>,
  <span class="pl-s">journal</span> = <span class="pl-s"><span class="pl-pds">{</span>Phys. Rev. A<span class="pl-pds">}</span></span>,
  <span class="pl-s">volume</span> = <span class="pl-s"><span class="pl-pds">{</span>106<span class="pl-pds">}</span></span>,
  <span class="pl-s">issue</span> = <span class="pl-s"><span class="pl-pds">{</span>4<span class="pl-pds">}</span></span>,
  <span class="pl-s">pages</span> = <span class="pl-s"><span class="pl-pds">{</span>043322<span class="pl-pds">}</span></span>,
  <span class="pl-s">numpages</span> = <span class="pl-s"><span class="pl-pds">{</span>15<span class="pl-pds">}</span></span>,
  <span class="pl-s">year</span> = <span class="pl-s"><span class="pl-pds">{</span>2022<span class="pl-pds">}</span></span>,
  <span class="pl-s">month</span> = <span class="pl-s"><span class="pl-pds">{</span>Oct<span class="pl-pds">}</span></span>,
  <span class="pl-s">publisher</span> = <span class="pl-s"><span class="pl-pds">{</span>American Physical Society<span class="pl-pds">}</span></span>,
  <span class="pl-s">doi</span> = <span class="pl-s"><span class="pl-pds">{</span>10.1103/PhysRevA.106.043322<span class="pl-pds">}</span></span>,
  <span class="pl-s">url</span> = <span class="pl-s"><span class="pl-pds">{</span>https://link.aps.org/doi/10.1103/PhysRevA.106.043322<span class="pl-pds">}</span></span>
}</pre></div>
</article></div>