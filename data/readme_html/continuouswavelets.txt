<div id="readme" class="md" data-path="README.md"><article class="markdown-body entry-content container-lg" itemprop="text"><h1 dir="auto"><a id="user-content-continuouswavelets" class="anchor" aria-hidden="true" href="#continuouswavelets"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a>ContinuousWavelets</h1>
<p dir="auto"><a href="https://travis-ci.com/dsweber2/ContinuousWavelets.jl" rel="nofollow"><img src="https://camo.githubusercontent.com/85c33dcdfab94342db35b061c5366c7b524883670fa89de119d1276435215e97/68747470733a2f2f7472617669732d63692e636f6d2f64737765626572322f436f6e74696e756f7573576176656c6574732e6a6c2e7376673f6272616e63683d6d6173746572" alt="Build Status" data-canonical-src="https://travis-ci.com/dsweber2/ContinuousWavelets.jl.svg?branch=master" style="max-width: 100%;"></a>
<a href="https://codecov.io/gh/dsweber2/ContinuousWavelets.jl" rel="nofollow"><img src="https://camo.githubusercontent.com/21cf473719f78c413d1fe49c87df97c54ef646f01ef4a397d2ba83f2b7eda594/68747470733a2f2f636f6465636f762e696f2f67682f64737765626572322f436f6e74696e756f7573576176656c6574732e6a6c2f6272616e63682f6d61737465722f67726170682f62616467652e737667" alt="Coverage" data-canonical-src="https://codecov.io/gh/dsweber2/ContinuousWavelets.jl/branch/master/graph/badge.svg" style="max-width: 100%;"></a>
<a href="https://dsweber2.github.io/ContinuousWavelets.jl/dev/" rel="nofollow"><img src="https://camo.githubusercontent.com/7fcec4b2d3ab291529fce8ef6a4fcd4129a0683b2f5d5fe2f5c648f02db8b616/68747470733a2f2f696d672e736869656c64732e696f2f62616467652f646f63732d6465762d626c75652e737667" alt="" data-canonical-src="https://img.shields.io/badge/docs-dev-blue.svg" style="max-width: 100%;"></a></p>
<p dir="auto">This package is an offshoot of <a href="https://github.com/JuliaDSP/Wavelets.jl">Wavelets.jl</a> for the continuous wavelets.
Thanks to <a href="https://github.com/fgerick">Felix Gerick</a> for the initial implementation there, with extension and further adaptation by David Weber and any other contributors listed on the right.
Currently, it implements 1D continuous wavelet transforms with the following mother wavelets:</p>
<p dir="auto"><a target="_blank" rel="noopener noreferrer" href="docs/mothers.svg"><img src="docs/mothers.svg" alt="Mothers" style="max-width: 100%;"></a></p>
<p dir="auto">Which covers several standard continuous wavelet families, both real and analytic, as well as continuous versions of the orthogonal wavelet transforms implemented in <a href="https://github.com/JuliaDSP/Wavelets.jl">Wavelets.jl</a>.</p>
<h2 dir="auto"><a id="user-content-basic-usage" class="anchor" aria-hidden="true" href="#basic-usage"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a>Basic Usage</h2>
<p dir="auto">Install via the package manager and load with <code>using</code></p>
<div class="highlight highlight-source-julia notranslate position-relative overflow-auto" dir="auto" data-snippet-clipboard-copy-content="julia&gt; Pkg.add(&quot;ContinuousWavelets&quot;)
julia&gt; using ContinuousWavelets"><pre>julia<span class="pl-k">&gt;</span> Pkg<span class="pl-k">.</span><span class="pl-c1">add</span>(<span class="pl-s"><span class="pl-pds">"</span>ContinuousWavelets<span class="pl-pds">"</span></span>)
julia<span class="pl-k">&gt;</span> <span class="pl-k">using</span> ContinuousWavelets</pre></div>
<p dir="auto">Basic usage example on a doppler test function.</p>
<div class="highlight highlight-source-julia notranslate position-relative overflow-auto" dir="auto" data-snippet-clipboard-copy-content="julia&gt; using ContinuousWavelets, Plots, Wavelets

julia&gt; n = 2047;

julia&gt; t = range(0, n / 1000, length=n); # 1kHz sampling rate

julia&gt; f = testfunction(n, &quot;Doppler&quot;);

julia&gt; p1 = plot(t, f, legend=false, title=&quot;Doppler&quot;, xticks=false)
Plot{Plots.PyPlotBackend() n=1}

julia&gt; c = wavelet(Morlet(π), β=2)

julia&gt; res = ContinuousWavelets.cwt(f, c)
┌ Warning: the lowest frequency wavelet has more than 1% its max at zero, so it may not be analytic. Think carefully
│   lowAprxAnalyt = 0.06186323501016359
└ @ ContinuousWavelets ~/work/ContinuousWavelets.jl/ContinuousWavelets.jl/src/sanityChecks.jl:6
2047×31 Matrix{ComplexF64}:
 -1.48637e-6+3.8241e-19im   …  0.000109978+9.67834e-5im
 -1.48602e-6+5.15534e-19im     -8.24922e-5+0.000130656im
            ⋮               ⋱             ⋮
 0.000435175+2.30636e-19im  …  -2.47195e-6-1.97048e-8im
 0.000435027-8.28725e-19im     -2.63499e-6+4.62331e-8im"><pre>julia<span class="pl-k">&gt;</span> <span class="pl-k">using</span> ContinuousWavelets, Plots, Wavelets

julia<span class="pl-k">&gt;</span> n <span class="pl-k">=</span> <span class="pl-c1">2047</span>;

julia<span class="pl-k">&gt;</span> t <span class="pl-k">=</span> <span class="pl-c1">range</span>(<span class="pl-c1">0</span>, n <span class="pl-k">/</span> <span class="pl-c1">1000</span>, length<span class="pl-k">=</span>n); <span class="pl-c"><span class="pl-c">#</span> 1kHz sampling rate</span>

julia<span class="pl-k">&gt;</span> f <span class="pl-k">=</span> <span class="pl-c1">testfunction</span>(n, <span class="pl-s"><span class="pl-pds">"</span>Doppler<span class="pl-pds">"</span></span>);

julia<span class="pl-k">&gt;</span> p1 <span class="pl-k">=</span> <span class="pl-c1">plot</span>(t, f, legend<span class="pl-k">=</span><span class="pl-c1">false</span>, title<span class="pl-k">=</span><span class="pl-s"><span class="pl-pds">"</span>Doppler<span class="pl-pds">"</span></span>, xticks<span class="pl-k">=</span><span class="pl-c1">false</span>)
Plot{Plots<span class="pl-k">.</span><span class="pl-c1">PyPlotBackend</span>() n<span class="pl-k">=</span><span class="pl-c1">1</span>}

julia<span class="pl-k">&gt;</span> c <span class="pl-k">=</span> <span class="pl-c1">wavelet</span>(<span class="pl-c1">Morlet</span>(π), β<span class="pl-k">=</span><span class="pl-c1">2</span>)

julia<span class="pl-k">&gt;</span> res <span class="pl-k">=</span> ContinuousWavelets<span class="pl-k">.</span><span class="pl-c1">cwt</span>(f, c)
┌ Warning<span class="pl-k">:</span> the lowest frequency wavelet has more than <span class="pl-c1">1</span><span class="pl-k">%</span> its max at zero, so it may not be analytic. Think carefully
│   lowAprxAnalyt <span class="pl-k">=</span> <span class="pl-c1">0.06186323501016359</span>
└ @ ContinuousWavelets <span class="pl-k">~</span><span class="pl-k">/</span>work<span class="pl-k">/</span>ContinuousWavelets<span class="pl-k">.</span>jl<span class="pl-k">/</span>ContinuousWavelets<span class="pl-k">.</span>jl<span class="pl-k">/</span>src<span class="pl-k">/</span>sanityChecks<span class="pl-k">.</span>jl<span class="pl-k">:</span><span class="pl-c1">6</span>
<span class="pl-c1">2047</span><span class="pl-k">×</span><span class="pl-c1">31</span> Matrix{ComplexF64}<span class="pl-k">:</span>
 <span class="pl-k">-</span><span class="pl-c1">1.48637e-6</span><span class="pl-k">+</span><span class="pl-c1">3.8241e-19im</span>   …  <span class="pl-c1">0.000109978</span><span class="pl-k">+</span><span class="pl-c1">9.67834e-5im</span>
 <span class="pl-k">-</span><span class="pl-c1">1.48602e-6</span><span class="pl-k">+</span><span class="pl-c1">5.15534e-19im</span>     <span class="pl-k">-</span><span class="pl-c1">8.24922e-5</span><span class="pl-k">+</span><span class="pl-c1">0.000130656im</span>
            ⋮               ⋱             ⋮
 <span class="pl-c1">0.000435175</span><span class="pl-k">+</span><span class="pl-c1">2.30636e-19im</span>  …  <span class="pl-k">-</span><span class="pl-c1">2.47195e-6</span><span class="pl-k">-</span><span class="pl-c1">1.97048e-8im</span>
 <span class="pl-c1">0.000435027</span><span class="pl-k">-</span><span class="pl-c1">8.28725e-19im</span>     <span class="pl-k">-</span><span class="pl-c1">2.63499e-6</span><span class="pl-k">+</span><span class="pl-c1">4.62331e-8im</span></pre></div>
<p dir="auto">And now we make a scalogram to actually visualize these entries:</p>
<div class="highlight highlight-source-julia notranslate position-relative overflow-auto" dir="auto" data-snippet-clipboard-copy-content="freqs = getMeanFreq(ContinuousWavelets.computeWavelets(n, c)[1])
freqs[1] = 0
p2 = heatmap(t, freqs, log.(abs.(res).^2)', xlabel= &quot;time (s)&quot;, ylabel=&quot;frequency (Hz)&quot;, colorbar=false, c=cgrad(:viridis, scale=:log10))
l = @layout [a{.3h};b{.7h}]
plot(p1,p2,layout=l)"><pre>freqs <span class="pl-k">=</span> <span class="pl-c1">getMeanFreq</span>(ContinuousWavelets<span class="pl-k">.</span><span class="pl-c1">computeWavelets</span>(n, c)[<span class="pl-c1">1</span>])
freqs[<span class="pl-c1">1</span>] <span class="pl-k">=</span> <span class="pl-c1">0</span>
p2 <span class="pl-k">=</span> <span class="pl-c1">heatmap</span>(t, freqs, <span class="pl-c1">log</span>.(<span class="pl-c1">abs</span>.(res)<span class="pl-k">.^</span><span class="pl-c1">2</span>)<span class="pl-k">'</span>, xlabel<span class="pl-k">=</span> <span class="pl-s"><span class="pl-pds">"</span>time (s)<span class="pl-pds">"</span></span>, ylabel<span class="pl-k">=</span><span class="pl-s"><span class="pl-pds">"</span>frequency (Hz)<span class="pl-pds">"</span></span>, colorbar<span class="pl-k">=</span><span class="pl-c1">false</span>, c<span class="pl-k">=</span><span class="pl-c1">cgrad</span>(<span class="pl-c1">:viridis</span>, scale<span class="pl-k">=</span><span class="pl-c1">:log10</span>))
l <span class="pl-k">=</span> <span class="pl-c1">@layout</span> [a{.<span class="pl-c1">3</span>h};b{.<span class="pl-c1">7</span>h}]
<span class="pl-c1">plot</span>(p1,p2,layout<span class="pl-k">=</span>l)</pre></div>
<p dir="auto"><a target="_blank" rel="noopener noreferrer" href="/docs/doppler.svg"><img src="/docs/doppler.svg" alt="Doppler" style="max-width: 100%;"></a></p>
<p dir="auto">As the cwt frame is redundant, there are many choices of dual/inverse frames. There are three available in this package, <code>NaiveDelta()</code>, <code>PenroseDelta()</code>, and <code>DualFrames()</code>. As a toy example, lets knock out the middle time of the bumps function and apply a high pass filter:</p>
<div class="highlight highlight-source-julia notranslate position-relative overflow-auto" dir="auto" data-snippet-clipboard-copy-content="f = testfunction(n, &quot;Bumps&quot;);
p1 = plot(f, legend = false, title = &quot;Bumps&quot;, xlims = (0, 2000), linewidth = 2)
c = wavelet(dog2, β = 2)
res = ContinuousWavelets.cwt(f, c);
# dropping the middle peaks
res[620:1100, :] .= 0
# and smoothing the remaining peaks
res[:, 10:end] .= 0
freqs = ContinuousWavelets.getMeanFreq(length(f), c)
p2 = heatmap(1:n, freqs, abs.(res)', xlabel = &quot;time (ms)&quot;, ylabel = &quot;Frequency (Hz)&quot;, colorbar = false, c = :viridis)
dropped = ContinuousWavelets.icwt(res, c, DualFrames());
p1 = plot(f, legend=false, title=&quot;Smoothing and dropping bumps&quot;, linewidth=2)
plot!(dropped, linewidth=3)
l = @layout [a{0.3h}; b{0.7h}]
plot(p1, p2, layout=l)"><pre>f <span class="pl-k">=</span> <span class="pl-c1">testfunction</span>(n, <span class="pl-s"><span class="pl-pds">"</span>Bumps<span class="pl-pds">"</span></span>);
p1 <span class="pl-k">=</span> <span class="pl-c1">plot</span>(f, legend <span class="pl-k">=</span> <span class="pl-c1">false</span>, title <span class="pl-k">=</span> <span class="pl-s"><span class="pl-pds">"</span>Bumps<span class="pl-pds">"</span></span>, xlims <span class="pl-k">=</span> (<span class="pl-c1">0</span>, <span class="pl-c1">2000</span>), linewidth <span class="pl-k">=</span> <span class="pl-c1">2</span>)
c <span class="pl-k">=</span> <span class="pl-c1">wavelet</span>(dog2, β <span class="pl-k">=</span> <span class="pl-c1">2</span>)
res <span class="pl-k">=</span> ContinuousWavelets<span class="pl-k">.</span><span class="pl-c1">cwt</span>(f, c);
<span class="pl-c"><span class="pl-c">#</span> dropping the middle peaks</span>
res[<span class="pl-c1">620</span><span class="pl-k">:</span><span class="pl-c1">1100</span>, :] <span class="pl-k">.=</span> <span class="pl-c1">0</span>
<span class="pl-c"><span class="pl-c">#</span> and smoothing the remaining peaks</span>
res[:, <span class="pl-c1">10</span><span class="pl-k">:</span><span class="pl-c1">end</span>] <span class="pl-k">.=</span> <span class="pl-c1">0</span>
freqs <span class="pl-k">=</span> ContinuousWavelets<span class="pl-k">.</span><span class="pl-c1">getMeanFreq</span>(<span class="pl-c1">length</span>(f), c)
p2 <span class="pl-k">=</span> <span class="pl-c1">heatmap</span>(<span class="pl-c1">1</span><span class="pl-k">:</span>n, freqs, <span class="pl-c1">abs</span>.(res)<span class="pl-k">'</span>, xlabel <span class="pl-k">=</span> <span class="pl-s"><span class="pl-pds">"</span>time (ms)<span class="pl-pds">"</span></span>, ylabel <span class="pl-k">=</span> <span class="pl-s"><span class="pl-pds">"</span>Frequency (Hz)<span class="pl-pds">"</span></span>, colorbar <span class="pl-k">=</span> <span class="pl-c1">false</span>, c <span class="pl-k">=</span> <span class="pl-c1">:viridis</span>)
dropped <span class="pl-k">=</span> ContinuousWavelets<span class="pl-k">.</span><span class="pl-c1">icwt</span>(res, c, <span class="pl-c1">DualFrames</span>());
p1 <span class="pl-k">=</span> <span class="pl-c1">plot</span>(f, legend<span class="pl-k">=</span><span class="pl-c1">false</span>, title<span class="pl-k">=</span><span class="pl-s"><span class="pl-pds">"</span>Smoothing and dropping bumps<span class="pl-pds">"</span></span>, linewidth<span class="pl-k">=</span><span class="pl-c1">2</span>)
<span class="pl-c1">plot!</span>(dropped, linewidth<span class="pl-k">=</span><span class="pl-c1">3</span>)
l <span class="pl-k">=</span> <span class="pl-c1">@layout</span> [a{<span class="pl-c1">0.3</span>h}; b{<span class="pl-c1">0.7</span>h}]
<span class="pl-c1">plot</span>(p1, p2, layout<span class="pl-k">=</span>l)</pre></div>
<p dir="auto"><a target="_blank" rel="noopener noreferrer" href="/docs/bumps.svg"><img src="/docs/bumps.svg" alt="Bumps" style="max-width: 100%;"></a></p>
<p dir="auto">It can also handle collections of examples at the same time, should you need to do a batch of transforms:</p>
<div class="highlight highlight-source-julia notranslate position-relative overflow-auto" dir="auto" data-snippet-clipboard-copy-content="julia&gt; exs = cat(testfunction(n, &quot;Doppler&quot;), testfunction(n, &quot;Blocks&quot;), testfunction(n, &quot;Bumps&quot;), testfunction(n, &quot;HeaviSine&quot;), dims=2);

julia&gt; c = wavelet(cDb2, β=2, extraOctaves=-0)


julia&gt; res = circshift(ContinuousWavelets.cwt(exs, c), (0, 1, 0))
┌ Warning: the highest frequency wavelet has more than 1% its max at the end, so it may not be analytic. Think carefully
│   highAprxAnalyt = 0.2677814440444114
└ @ ContinuousWavelets ~/work/ContinuousWavelets.jl/ContinuousWavelets.jl/src/sanityChecks.jl:10
2047×32×4 Array{Float64, 3}:
[:, :, 1] =
 1.89367e-5  0.000266033  …  4.6727e-5    2.99983e-6
 8.33321e-5  0.000266913     1.56557e-5  -4.46419e-5
 ⋮                        ⋱  ⋮
 2.24677e-6  0.00198709   …  4.24042e-6   3.80685e-6
 2.63848e-6  0.00198004      4.3791e-6    3.47575e-6

[:, :, 2] =
  7.81007e-18  0.0226754  0.00955729  …   3.68809e-18
 -3.47114e-18  0.022684   0.00950443     -3.47114e-18
  ⋮                                   ⋱
 -9.29595e-18  0.0341512  0.0108039   …  -3.84208e-19
  1.27592e-18  0.0342157  0.0107729      -1.7043e-18

[:, :, 3] =
 -4.2736e-7   0.0059687   …  4.47839e-8  1.86209e-8
 -4.39691e-7  0.00596762     3.30771e-8  7.78201e-9
  ⋮                       ⋱  ⋮
 -9.41123e-8  0.00339924  …  8.01012e-9  4.78652e-9
 -9.36079e-8  0.0034061      8.3188e-9   4.24252e-9

[:, :, 4] =
  0.000307454  -0.0150898   -0.00391724  …   0.000301757
  6.05948e-5   -0.0152536   -0.00405883      8.45503e-5
  ⋮                                      ⋱
 -0.000307094  -0.00755439  -0.00156729  …  -0.000594673
 -0.000378125  -0.00746687  -0.00146262     -0.00051676"><pre>julia<span class="pl-k">&gt;</span> exs <span class="pl-k">=</span> <span class="pl-c1">cat</span>(<span class="pl-c1">testfunction</span>(n, <span class="pl-s"><span class="pl-pds">"</span>Doppler<span class="pl-pds">"</span></span>), <span class="pl-c1">testfunction</span>(n, <span class="pl-s"><span class="pl-pds">"</span>Blocks<span class="pl-pds">"</span></span>), <span class="pl-c1">testfunction</span>(n, <span class="pl-s"><span class="pl-pds">"</span>Bumps<span class="pl-pds">"</span></span>), <span class="pl-c1">testfunction</span>(n, <span class="pl-s"><span class="pl-pds">"</span>HeaviSine<span class="pl-pds">"</span></span>), dims<span class="pl-k">=</span><span class="pl-c1">2</span>);

julia<span class="pl-k">&gt;</span> c <span class="pl-k">=</span> <span class="pl-c1">wavelet</span>(cDb2, β<span class="pl-k">=</span><span class="pl-c1">2</span>, extraOctaves<span class="pl-k">=</span><span class="pl-k">-</span><span class="pl-c1">0</span>)


julia<span class="pl-k">&gt;</span> res <span class="pl-k">=</span> <span class="pl-c1">circshift</span>(ContinuousWavelets<span class="pl-k">.</span><span class="pl-c1">cwt</span>(exs, c), (<span class="pl-c1">0</span>, <span class="pl-c1">1</span>, <span class="pl-c1">0</span>))
┌ Warning<span class="pl-k">:</span> the highest frequency wavelet has more than <span class="pl-c1">1</span><span class="pl-k">%</span> its max at the <span class="pl-k">end</span>, so it may not be analytic. Think carefully
│   highAprxAnalyt <span class="pl-k">=</span> <span class="pl-c1">0.2677814440444114</span>
└ @ ContinuousWavelets <span class="pl-k">~</span><span class="pl-k">/</span>work<span class="pl-k">/</span>ContinuousWavelets<span class="pl-k">.</span>jl<span class="pl-k">/</span>ContinuousWavelets<span class="pl-k">.</span>jl<span class="pl-k">/</span>src<span class="pl-k">/</span>sanityChecks<span class="pl-k">.</span>jl<span class="pl-k">:</span><span class="pl-c1">10</span>
<span class="pl-c1">2047</span><span class="pl-k">×</span><span class="pl-c1">32</span><span class="pl-k">×</span><span class="pl-c1">4</span> Array{Float64, <span class="pl-c1">3</span>}<span class="pl-k">:</span>
[:, :, <span class="pl-c1">1</span>] <span class="pl-k">=</span>
 <span class="pl-c1">1.89367e-5</span>  <span class="pl-c1">0.000266033</span>  …  <span class="pl-c1">4.6727e-5</span>    <span class="pl-c1">2.99983e-6</span>
 <span class="pl-c1">8.33321e-5</span>  <span class="pl-c1">0.000266913</span>     <span class="pl-c1">1.56557e-5</span>  <span class="pl-k">-</span><span class="pl-c1">4.46419e-5</span>
 ⋮                        ⋱  ⋮
 <span class="pl-c1">2.24677e-6</span>  <span class="pl-c1">0.00198709</span>   …  <span class="pl-c1">4.24042e-6</span>   <span class="pl-c1">3.80685e-6</span>
 <span class="pl-c1">2.63848e-6</span>  <span class="pl-c1">0.00198004</span>      <span class="pl-c1">4.3791e-6</span>    <span class="pl-c1">3.47575e-6</span>

[:, :, <span class="pl-c1">2</span>] <span class="pl-k">=</span>
  <span class="pl-c1">7.81007e-18</span>  <span class="pl-c1">0.0226754</span>  <span class="pl-c1">0.00955729</span>  …   <span class="pl-c1">3.68809e-18</span>
 <span class="pl-k">-</span><span class="pl-c1">3.47114e-18</span>  <span class="pl-c1">0.022684</span>   <span class="pl-c1">0.00950443</span>     <span class="pl-k">-</span><span class="pl-c1">3.47114e-18</span>
  ⋮                                   ⋱
 <span class="pl-k">-</span><span class="pl-c1">9.29595e-18</span>  <span class="pl-c1">0.0341512</span>  <span class="pl-c1">0.0108039</span>   …  <span class="pl-k">-</span><span class="pl-c1">3.84208e-19</span>
  <span class="pl-c1">1.27592e-18</span>  <span class="pl-c1">0.0342157</span>  <span class="pl-c1">0.0107729</span>      <span class="pl-k">-</span><span class="pl-c1">1.7043e-18</span>

[:, :, <span class="pl-c1">3</span>] <span class="pl-k">=</span>
 <span class="pl-k">-</span><span class="pl-c1">4.2736e-7</span>   <span class="pl-c1">0.0059687</span>   …  <span class="pl-c1">4.47839e-8</span>  <span class="pl-c1">1.86209e-8</span>
 <span class="pl-k">-</span><span class="pl-c1">4.39691e-7</span>  <span class="pl-c1">0.00596762</span>     <span class="pl-c1">3.30771e-8</span>  <span class="pl-c1">7.78201e-9</span>
  ⋮                       ⋱  ⋮
 <span class="pl-k">-</span><span class="pl-c1">9.41123e-8</span>  <span class="pl-c1">0.00339924</span>  …  <span class="pl-c1">8.01012e-9</span>  <span class="pl-c1">4.78652e-9</span>
 <span class="pl-k">-</span><span class="pl-c1">9.36079e-8</span>  <span class="pl-c1">0.0034061</span>      <span class="pl-c1">8.3188e-9</span>   <span class="pl-c1">4.24252e-9</span>

[:, :, <span class="pl-c1">4</span>] <span class="pl-k">=</span>
  <span class="pl-c1">0.000307454</span>  <span class="pl-k">-</span><span class="pl-c1">0.0150898</span>   <span class="pl-k">-</span><span class="pl-c1">0.00391724</span>  …   <span class="pl-c1">0.000301757</span>
  <span class="pl-c1">6.05948e-5</span>   <span class="pl-k">-</span><span class="pl-c1">0.0152536</span>   <span class="pl-k">-</span><span class="pl-c1">0.00405883</span>      <span class="pl-c1">8.45503e-5</span>
  ⋮                                      ⋱
 <span class="pl-k">-</span><span class="pl-c1">0.000307094</span>  <span class="pl-k">-</span><span class="pl-c1">0.00755439</span>  <span class="pl-k">-</span><span class="pl-c1">0.00156729</span>  …  <span class="pl-k">-</span><span class="pl-c1">0.000594673</span>
 <span class="pl-k">-</span><span class="pl-c1">0.000378125</span>  <span class="pl-k">-</span><span class="pl-c1">0.00746687</span>  <span class="pl-k">-</span><span class="pl-c1">0.00146262</span>     <span class="pl-k">-</span><span class="pl-c1">0.00051676</span></pre></div>
<p dir="auto">And the plot of these:</p>
<div class="highlight highlight-source-julia notranslate position-relative overflow-auto" dir="auto" data-snippet-clipboard-copy-content="p1 = plot(plot(exs[:, 1], legend=false, title=&quot;Doppler&quot;, yticks=[], xticks=[], linewidth=2), plot(exs[:, 2], legend=false, title=&quot;Blocks&quot;, yticks=[], xticks=[], linewidth=2), plot(exs[:, 3], legend=false, title=&quot;Bumps&quot;, yticks=[], xticks=[], linewidth=2), plot(exs[:, 4], legend=false, title=&quot;HeaviSine&quot;, yticks=[], xticks=[], linewidth=2), layout=(1, 4))
p2 = plot(heatmap(identity.(res[:, :, 1])', xticks=false, yticks=[], c=:viridis, colorbar=false), heatmap(identity.(res[:, :, 2])', xticks=false, yticks=[], c=:viridis, colorbar=false), heatmap(identity.(res[:, :, 3])', xticks=false, yticks=[], c=:viridis, colorbar=false), heatmap(identity.(res[:, :, 4])', xticks=false, yticks=[], c=:viridis, colorbar=false), layout=(1, 4))
l = @layout [a{0.3h}; b{0.7h}]
plot(p1, p2, layout=l)"><pre>p1 <span class="pl-k">=</span> <span class="pl-c1">plot</span>(<span class="pl-c1">plot</span>(exs[:, <span class="pl-c1">1</span>], legend<span class="pl-k">=</span><span class="pl-c1">false</span>, title<span class="pl-k">=</span><span class="pl-s"><span class="pl-pds">"</span>Doppler<span class="pl-pds">"</span></span>, yticks<span class="pl-k">=</span>[], xticks<span class="pl-k">=</span>[], linewidth<span class="pl-k">=</span><span class="pl-c1">2</span>), <span class="pl-c1">plot</span>(exs[:, <span class="pl-c1">2</span>], legend<span class="pl-k">=</span><span class="pl-c1">false</span>, title<span class="pl-k">=</span><span class="pl-s"><span class="pl-pds">"</span>Blocks<span class="pl-pds">"</span></span>, yticks<span class="pl-k">=</span>[], xticks<span class="pl-k">=</span>[], linewidth<span class="pl-k">=</span><span class="pl-c1">2</span>), <span class="pl-c1">plot</span>(exs[:, <span class="pl-c1">3</span>], legend<span class="pl-k">=</span><span class="pl-c1">false</span>, title<span class="pl-k">=</span><span class="pl-s"><span class="pl-pds">"</span>Bumps<span class="pl-pds">"</span></span>, yticks<span class="pl-k">=</span>[], xticks<span class="pl-k">=</span>[], linewidth<span class="pl-k">=</span><span class="pl-c1">2</span>), <span class="pl-c1">plot</span>(exs[:, <span class="pl-c1">4</span>], legend<span class="pl-k">=</span><span class="pl-c1">false</span>, title<span class="pl-k">=</span><span class="pl-s"><span class="pl-pds">"</span>HeaviSine<span class="pl-pds">"</span></span>, yticks<span class="pl-k">=</span>[], xticks<span class="pl-k">=</span>[], linewidth<span class="pl-k">=</span><span class="pl-c1">2</span>), layout<span class="pl-k">=</span>(<span class="pl-c1">1</span>, <span class="pl-c1">4</span>))
p2 <span class="pl-k">=</span> <span class="pl-c1">plot</span>(<span class="pl-c1">heatmap</span>(<span class="pl-c1">identity</span>.(res[:, :, <span class="pl-c1">1</span>])<span class="pl-k">'</span>, xticks<span class="pl-k">=</span><span class="pl-c1">false</span>, yticks<span class="pl-k">=</span>[], c<span class="pl-k">=</span><span class="pl-c1">:viridis</span>, colorbar<span class="pl-k">=</span><span class="pl-c1">false</span>), <span class="pl-c1">heatmap</span>(<span class="pl-c1">identity</span>.(res[:, :, <span class="pl-c1">2</span>])<span class="pl-k">'</span>, xticks<span class="pl-k">=</span><span class="pl-c1">false</span>, yticks<span class="pl-k">=</span>[], c<span class="pl-k">=</span><span class="pl-c1">:viridis</span>, colorbar<span class="pl-k">=</span><span class="pl-c1">false</span>), <span class="pl-c1">heatmap</span>(<span class="pl-c1">identity</span>.(res[:, :, <span class="pl-c1">3</span>])<span class="pl-k">'</span>, xticks<span class="pl-k">=</span><span class="pl-c1">false</span>, yticks<span class="pl-k">=</span>[], c<span class="pl-k">=</span><span class="pl-c1">:viridis</span>, colorbar<span class="pl-k">=</span><span class="pl-c1">false</span>), <span class="pl-c1">heatmap</span>(<span class="pl-c1">identity</span>.(res[:, :, <span class="pl-c1">4</span>])<span class="pl-k">'</span>, xticks<span class="pl-k">=</span><span class="pl-c1">false</span>, yticks<span class="pl-k">=</span>[], c<span class="pl-k">=</span><span class="pl-c1">:viridis</span>, colorbar<span class="pl-k">=</span><span class="pl-c1">false</span>), layout<span class="pl-k">=</span>(<span class="pl-c1">1</span>, <span class="pl-c1">4</span>))
l <span class="pl-k">=</span> <span class="pl-c1">@layout</span> [a{<span class="pl-c1">0.3</span>h}; b{<span class="pl-c1">0.7</span>h}]
<span class="pl-c1">plot</span>(p1, p2, layout<span class="pl-k">=</span>l)</pre></div>
<p dir="auto"><a target="_blank" rel="noopener noreferrer" href="/docs/multiEx.svg"><img src="/docs/multiEx.svg" alt="parallel transforms" style="max-width: 100%;"></a></p>
<p dir="auto">There are also several boundary conditions, depending on the kind of data given; the default <code>SymBoundary()</code> symmetrizes the data, while <code>PerBoundary()</code> assumes it is periodic, and <code>ZPBoundary</code> pads with zeros.
All wavelets are stored in the Fourier domain, and all transforms consist of performing an fft (possibly an rfft if the data is real) of the input, pointwise multiplication (equivalent to convolution in the time domain), and then returning to the time domain.</p>
<p dir="auto">Perhaps somewhat unusually, the averaging function, or father wavelet, is included as an option (the bottom row for the figure above). This can be either the paired averaging function or uniform in frequency (the <code>Dirac</code> averaging). The frequency coverage of the wavelets can be adjusted both in total frequency range both below by the <code>averagingLength</code> or above by the <code>extraOctaves</code> (caveat emptor with how well they will be defined in that case). The frequency density can be adjusted both in terms of the quality/scale factor <code>Q</code>, as well as how quickly this density falls off as the frequency goes to zero via <code>β</code>. Finally, depending on what kind of norm you want to preserve, <code>p</code> determines the norm preserved in the frequency domain (so <code>p=1</code> maintains the 1-norm in frequency, while <code>p=Inf</code> maintains the 1-norm in time).</p>
<h2 dir="auto"><a id="user-content-possible-extensions" class="anchor" aria-hidden="true" href="#possible-extensions"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a>Possible extensions</h2>
<ul dir="auto">
<li>Higher dimensional wavelets have yet to be implemented.</li>
<li>A DCT implementation of the symmetric boundary to halve the space and computational costs.</li>
</ul>
</article></div>