<div id="readme" class="md" data-path="README.md"><article class="markdown-body entry-content container-lg" itemprop="text"><h1 dir="auto"><a id="user-content--the-enzyme-high-performance-automatic-differentiator-of-llvm" class="anchor" aria-hidden="true" href="#-the-enzyme-high-performance-automatic-differentiator-of-llvm"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a><a target="_blank" rel="noopener noreferrer nofollow" href="https://camo.githubusercontent.com/769856605b97b7c5db2cbf12f38358f023820e082d3f63617944b9e4bcd60483/68747470733a2f2f656e7a796d652e6d69742e6564752f6c6f676f2e737667"><img src="https://camo.githubusercontent.com/769856605b97b7c5db2cbf12f38358f023820e082d3f63617944b9e4bcd60483/68747470733a2f2f656e7a796d652e6d69742e6564752f6c6f676f2e737667" width="75" align="left" data-canonical-src="https://enzyme.mit.edu/logo.svg" style="max-width: 100%;"></a> The Enzyme High-Performance Automatic Differentiator of LLVM</h1>
<p dir="auto"><a href="https://enzyme.mit.edu/julia/stable" rel="nofollow"><img src="https://camo.githubusercontent.com/c97f0a5f2ae95755f64a27f1aa8d9a17462941fd3d6c907c7630abd5d3e60acf/68747470733a2f2f696d672e736869656c64732e696f2f62616467652f646f63732d737461626c652d626c75652e737667" alt="Stable" data-canonical-src="https://img.shields.io/badge/docs-stable-blue.svg" style="max-width: 100%;"></a>
<a href="https://enzyme.mit.edu/julia/dev" rel="nofollow"><img src="https://camo.githubusercontent.com/7fcec4b2d3ab291529fce8ef6a4fcd4129a0683b2f5d5fe2f5c648f02db8b616/68747470733a2f2f696d672e736869656c64732e696f2f62616467652f646f63732d6465762d626c75652e737667" alt="Dev" data-canonical-src="https://img.shields.io/badge/docs-dev-blue.svg" style="max-width: 100%;"></a>
<a href="https://github.com/wsmoses/Enzyme.jl/actions"><img src="https://github.com/wsmoses/Enzyme.jl/workflows/CI/badge.svg" alt="Build Status" style="max-width: 100%;"></a>
<a href="https://codecov.io/gh/wsmoses/Enzyme.jl" rel="nofollow"><img src="https://camo.githubusercontent.com/94ccfd51479935b47a0baf05d285cc9a54054211ba396c4ea779ad8bc60c08e8/68747470733a2f2f636f6465636f762e696f2f67682f77736d6f7365732f456e7a796d652e6a6c2f6272616e63682f6d61737465722f67726170682f62616467652e737667" alt="Coverage" data-canonical-src="https://codecov.io/gh/wsmoses/Enzyme.jl/branch/master/graph/badge.svg" style="max-width: 100%;"></a></p>
<p dir="auto">This is a package containing the Julia bindings for <a href="https://github.com/wsmoses/enzyme">Enzyme</a>. This is very much a work in progress and bug reports/discussion is greatly appreciated!</p>
<p dir="auto">Enzyme is a plugin that performs automatic differentiation (AD) of statically analyzable LLVM. It is highly-efficient and its ability perform AD on optimized code allows Enzyme to meet or exceed the performance of state-of-the-art AD tools.</p>
<p dir="auto">Enzyme.jl can be installed in the usual way Julia packages are installed</p>
<div class="snippet-clipboard-content notranslate position-relative overflow-auto" data-snippet-clipboard-copy-content="] add Enzyme"><pre class="notranslate"><code>] add Enzyme
</code></pre></div>
<p dir="auto">Enzyme.jl can be used by calling <code>autodiff</code> on a function to be differentiated as shown below:</p>
<div class="highlight highlight-source-julia notranslate position-relative overflow-auto" dir="auto" data-snippet-clipboard-copy-content="using Enzyme, Test

f1(x) = x*x
# Returns a tuple of active returns, which in this case is simply (2.0,)
@test first(autodiff(Reverse, f1, Active(1.0))[1]) ≈ 2.0"><pre><span class="pl-k">using</span> Enzyme, Test

<span class="pl-en">f1</span>(x) <span class="pl-k">=</span> x<span class="pl-k">*</span>x
<span class="pl-c"><span class="pl-c">#</span> Returns a tuple of active returns, which in this case is simply (2.0,)</span>
<span class="pl-c1">@test</span> <span class="pl-c1">first</span>(<span class="pl-c1">autodiff</span>(Reverse, f1, <span class="pl-c1">Active</span>(<span class="pl-c1">1.0</span>))[<span class="pl-c1">1</span>]) <span class="pl-k">≈</span> <span class="pl-c1">2.0</span></pre></div>
<p dir="auto">For details, see the <a href="https://enzyme.mit.edu/julia" rel="nofollow">package documentation</a>.</p>
<p dir="auto">More information on installing and using Enzyme directly (not through Julia) can be found on our website: <a href="https://enzyme.mit.edu" rel="nofollow">https://enzyme.mit.edu</a>.</p>
<p dir="auto">To get involved or if you have questions, please join our <a href="https://groups.google.com/d/forum/enzyme-dev" rel="nofollow">mailing list</a>.</p>
<p dir="auto">If using this code in an academic setting, please cite the following two papers (first for Enzyme as a whole, then for GPU+optimizations):</p>
<div class="snippet-clipboard-content notranslate position-relative overflow-auto" data-snippet-clipboard-copy-content="@inproceedings{NEURIPS2020_9332c513,
 author = {Moses, William and Churavy, Valentin},
 booktitle = {Advances in Neural Information Processing Systems},
 editor = {H. Larochelle and M. Ranzato and R. Hadsell and M. F. Balcan and H. Lin},
 pages = {12472--12485},
 publisher = {Curran Associates, Inc.},
 title = {Instead of Rewriting Foreign Code for Machine Learning, Automatically Synthesize Fast Gradients},
 url = {https://proceedings.neurips.cc/paper/2020/file/9332c513ef44b682e9347822c2e457ac-Paper.pdf},
 volume = {33},
 year = {2020}
}
@inproceedings{10.1145/3458817.3476165,
author = {Moses, William S. and Churavy, Valentin and Paehler, Ludger and H\&quot;{u}ckelheim, Jan and Narayanan, Sri Hari Krishna and Schanen, Michel and Doerfert, Johannes},
title = {Reverse-Mode Automatic Differentiation and Optimization of GPU Kernels via Enzyme},
year = {2021},
isbn = {9781450384421},
publisher = {Association for Computing Machinery},
address = {New York, NY, USA},
url = {https://doi.org/10.1145/3458817.3476165},
doi = {10.1145/3458817.3476165},
booktitle = {Proceedings of the International Conference for High Performance Computing, Networking, Storage and Analysis},
articleno = {61},
numpages = {16},
keywords = {CUDA, LLVM, ROCm, HPC, AD, GPU, automatic differentiation},
location = {St. Louis, Missouri},
series = {SC '21}
}"><pre class="notranslate"><code>@inproceedings{NEURIPS2020_9332c513,
 author = {Moses, William and Churavy, Valentin},
 booktitle = {Advances in Neural Information Processing Systems},
 editor = {H. Larochelle and M. Ranzato and R. Hadsell and M. F. Balcan and H. Lin},
 pages = {12472--12485},
 publisher = {Curran Associates, Inc.},
 title = {Instead of Rewriting Foreign Code for Machine Learning, Automatically Synthesize Fast Gradients},
 url = {https://proceedings.neurips.cc/paper/2020/file/9332c513ef44b682e9347822c2e457ac-Paper.pdf},
 volume = {33},
 year = {2020}
}
@inproceedings{10.1145/3458817.3476165,
author = {Moses, William S. and Churavy, Valentin and Paehler, Ludger and H\"{u}ckelheim, Jan and Narayanan, Sri Hari Krishna and Schanen, Michel and Doerfert, Johannes},
title = {Reverse-Mode Automatic Differentiation and Optimization of GPU Kernels via Enzyme},
year = {2021},
isbn = {9781450384421},
publisher = {Association for Computing Machinery},
address = {New York, NY, USA},
url = {https://doi.org/10.1145/3458817.3476165},
doi = {10.1145/3458817.3476165},
booktitle = {Proceedings of the International Conference for High Performance Computing, Networking, Storage and Analysis},
articleno = {61},
numpages = {16},
keywords = {CUDA, LLVM, ROCm, HPC, AD, GPU, automatic differentiation},
location = {St. Louis, Missouri},
series = {SC '21}
}
</code></pre></div>
</article></div>