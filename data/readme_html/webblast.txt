<div id="readme" class="md" data-path="README.md"><article class="markdown-body entry-content container-lg" itemprop="text"><h1 dir="auto"><a id="user-content-webblastjl" class="anchor" aria-hidden="true" href="#webblastjl"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a>WebBlast.jl</h1>
<p dir="auto">This package helps you call BLAST (<a href="https://blast.ncbi.nlm.nih.gov/" rel="nofollow">https://blast.ncbi.nlm.nih.gov/</a>) from Julia. It is extremely simple, but tries to remain flexible, as long as you're happy to put in a little extra work.</p>
<p dir="auto">The main functions you'll use is:</p>
<div class="highlight highlight-source-julia notranslate position-relative overflow-auto" dir="auto" data-snippet-clipboard-copy-content="    WebBLAST(query;
        num_hits = 100,
        database = &quot;nt&quot;,
        program = &quot;blastn&quot;)"><pre>    <span class="pl-c1">WebBLAST</span>(query;
        num_hits <span class="pl-k">=</span> <span class="pl-c1">100</span>,
        database <span class="pl-k">=</span> <span class="pl-s"><span class="pl-pds">"</span>nt<span class="pl-pds">"</span></span>,
        program <span class="pl-k">=</span> <span class="pl-s"><span class="pl-pds">"</span>blastn<span class="pl-pds">"</span></span>)</pre></div>
<p dir="auto">NOTE: This relies on querying a public web service, using an API that they list as "deprecated". Please do not count on this working in the long run, and please don't abuse it as that might get it shut down faster.</p>
<p dir="auto"><code>query</code> must be either a String, or an array of String (if searching multiple sequences). These are expected to be nucleotide or amino acid sequences. Just make sure they (nuc or AA) match the database and program! For example, if you pass in amino acid sequences, you can't use the "nt" database, but database = "pdb" should work.</p>
<h2 dir="auto"><a id="user-content-installation" class="anchor" aria-hidden="true" href="#installation"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a>Installation:</h2>
<p dir="auto">Until the package is registered, please use:</p>
<div class="highlight highlight-source-julia notranslate position-relative overflow-auto" dir="auto" data-snippet-clipboard-copy-content="using Pkg
Pkg.add(PackageSpec(name=&quot;WebBlast&quot;, url = &quot;https://github.com/MurrellGroup/WebBlast.jl.git&quot;))"><pre><span class="pl-k">using</span> Pkg
Pkg<span class="pl-k">.</span><span class="pl-c1">add</span>(<span class="pl-c1">PackageSpec</span>(name<span class="pl-k">=</span><span class="pl-s"><span class="pl-pds">"</span>WebBlast<span class="pl-pds">"</span></span>, url <span class="pl-k">=</span> <span class="pl-s"><span class="pl-pds">"</span>https://github.com/MurrellGroup/WebBlast.jl.git<span class="pl-pds">"</span></span>))</pre></div>
<h2 dir="auto"><a id="user-content-example-use" class="anchor" aria-hidden="true" href="#example-use"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a>Example use:</h2>
<div class="highlight highlight-source-julia notranslate position-relative overflow-auto" dir="auto" data-snippet-clipboard-copy-content="using WebBlast

queries = [&quot;MKTLLLTIGFSLIAILQAQDTPALGKDTVAVSGKWYLKAMTADQEVPE&quot;,&quot;MRALLLAIGLGLVAALQAQEFPAVGQPLQDLLGRWYLKAMTSDPEIPG&quot;];
blast_array = WebBLAST(queries, program = &quot;blastp&quot;, database = &quot;pdb&quot;, num_hits = 3);"><pre><span class="pl-k">using</span> WebBlast

queries <span class="pl-k">=</span> [<span class="pl-s"><span class="pl-pds">"</span>MKTLLLTIGFSLIAILQAQDTPALGKDTVAVSGKWYLKAMTADQEVPE<span class="pl-pds">"</span></span>,<span class="pl-s"><span class="pl-pds">"</span>MRALLLAIGLGLVAALQAQEFPAVGQPLQDLLGRWYLKAMTSDPEIPG<span class="pl-pds">"</span></span>];
blast_array <span class="pl-k">=</span> <span class="pl-c1">WebBLAST</span>(queries, program <span class="pl-k">=</span> <span class="pl-s"><span class="pl-pds">"</span>blastp<span class="pl-pds">"</span></span>, database <span class="pl-k">=</span> <span class="pl-s"><span class="pl-pds">"</span>pdb<span class="pl-pds">"</span></span>, num_hits <span class="pl-k">=</span> <span class="pl-c1">3</span>);</pre></div>
<p dir="auto">with output (note the delays, while the BLAST server computes):</p>
<div class="snippet-clipboard-content notranslate position-relative overflow-auto" data-snippet-clipboard-copy-content="Waiting for 35 seconds
Waiting for result...
Waiting for result...
Retrieving hits."><pre class="notranslate"><code>Waiting for 35 seconds
Waiting for result...
Waiting for result...
Retrieving hits.
</code></pre></div>
<p dir="auto">and returns <code>blast_array</code>, which is an array of dictionaries. That array has one element per query (with one query, this will be an array of length 1). Each Query dictionary will have a key "Query_hit_array", which will return an array of hit dictionaries. Each hit can have more than one "High Similarity Pair" (or "HSP"), so the hit dictionary has a key "Hit_hsps" which itself is an array of HSPs. This can be traversed to get whatever you like. For example, here is a code snippet that runs through all HSPs for all hits for all queries and prints out some key properties of the hits:</p>
<div class="highlight highlight-source-julia notranslate position-relative overflow-auto" dir="auto" data-snippet-clipboard-copy-content="for query in blast_array
    for hit in query[&quot;Query_hit_array&quot;]
        for HSP in hit[&quot;Hit_hsps&quot;]
            println(&quot;Query: &quot;, query[&quot;Query-def&quot;])
            println(&quot;Accession: &quot;, hit[&quot;Hit_accession&quot;])
            println(&quot;Identity: &quot;, HSP[&quot;Hsp_identity&quot;])
            println(&quot;Query: &quot;, HSP[&quot;Hsp_qseq&quot;])
            println(&quot;Hit:   &quot;, HSP[&quot;Hsp_hseq&quot;])
        end
    end
end"><pre><span class="pl-k">for</span> query <span class="pl-k">in</span> blast_array
    <span class="pl-k">for</span> hit <span class="pl-k">in</span> query[<span class="pl-s"><span class="pl-pds">"</span>Query_hit_array<span class="pl-pds">"</span></span>]
        <span class="pl-k">for</span> HSP <span class="pl-k">in</span> hit[<span class="pl-s"><span class="pl-pds">"</span>Hit_hsps<span class="pl-pds">"</span></span>]
            <span class="pl-c1">println</span>(<span class="pl-s"><span class="pl-pds">"</span>Query: <span class="pl-pds">"</span></span>, query[<span class="pl-s"><span class="pl-pds">"</span>Query-def<span class="pl-pds">"</span></span>])
            <span class="pl-c1">println</span>(<span class="pl-s"><span class="pl-pds">"</span>Accession: <span class="pl-pds">"</span></span>, hit[<span class="pl-s"><span class="pl-pds">"</span>Hit_accession<span class="pl-pds">"</span></span>])
            <span class="pl-c1">println</span>(<span class="pl-s"><span class="pl-pds">"</span>Identity: <span class="pl-pds">"</span></span>, HSP[<span class="pl-s"><span class="pl-pds">"</span>Hsp_identity<span class="pl-pds">"</span></span>])
            <span class="pl-c1">println</span>(<span class="pl-s"><span class="pl-pds">"</span>Query: <span class="pl-pds">"</span></span>, HSP[<span class="pl-s"><span class="pl-pds">"</span>Hsp_qseq<span class="pl-pds">"</span></span>])
            <span class="pl-c1">println</span>(<span class="pl-s"><span class="pl-pds">"</span>Hit:   <span class="pl-pds">"</span></span>, HSP[<span class="pl-s"><span class="pl-pds">"</span>Hsp_hseq<span class="pl-pds">"</span></span>])
        <span class="pl-k">end</span>
    <span class="pl-k">end</span>
<span class="pl-k">end</span></pre></div>
<p dir="auto">Which gives the following output:</p>
<div class="snippet-clipboard-content notranslate position-relative overflow-auto" data-snippet-clipboard-copy-content="Query: query_1
Accession: 5T43_A
Identity: 14
Query: VSGKWYLKAMTADQEVPE
Hit:   VSGTWYLKAMTVDREFPE
Query: query_1
Accession: 1XKI_A
Identity: 14
Query: VSGKWYLKAMTADQEVPE
Hit:   VSGTWYLKAMTVDREFPE
Query: query_1
Accession: 4RUN_A
Identity: 9
Query: VSGKWYLKAMTADQEVPE
Hit:   ITGTWYVKAMVVDKDFPE
Query: query_2
Accession: 5T43_A
Identity: 14
Query: AVGQPLQDLLGRWYLKAMTSDPEIP
Hit:   ASDEEIQDVSGTWYLKAMTVDREFP
Query: query_2
Accession: 1XKI_A
Identity: 14
Query: AVGQPLQDLLGRWYLKAMTSDPEIP
Hit:   ASDEEIQDVSGTWYLKAMTVDREFP
Query: query_2
Accession: 4QAF_A
Identity: 12
Query: AVGQPLQDLLGRWYLKAMTSD
Hit:   ASDEEIQDVSGTWYLKAMTVD"><pre class="notranslate"><code>Query: query_1
Accession: 5T43_A
Identity: 14
Query: VSGKWYLKAMTADQEVPE
Hit:   VSGTWYLKAMTVDREFPE
Query: query_1
Accession: 1XKI_A
Identity: 14
Query: VSGKWYLKAMTADQEVPE
Hit:   VSGTWYLKAMTVDREFPE
Query: query_1
Accession: 4RUN_A
Identity: 9
Query: VSGKWYLKAMTADQEVPE
Hit:   ITGTWYVKAMVVDKDFPE
Query: query_2
Accession: 5T43_A
Identity: 14
Query: AVGQPLQDLLGRWYLKAMTSDPEIP
Hit:   ASDEEIQDVSGTWYLKAMTVDREFP
Query: query_2
Accession: 1XKI_A
Identity: 14
Query: AVGQPLQDLLGRWYLKAMTSDPEIP
Hit:   ASDEEIQDVSGTWYLKAMTVDREFP
Query: query_2
Accession: 4QAF_A
Identity: 12
Query: AVGQPLQDLLGRWYLKAMTSD
Hit:   ASDEEIQDVSGTWYLKAMTVD
</code></pre></div>
<p dir="auto">However, if you don't want to both with all that, you can instead use:</p>
<div class="highlight highlight-source-julia notranslate position-relative overflow-auto" dir="auto" data-snippet-clipboard-copy-content="df = flatten_to_dataframe(blast_array)"><pre>df <span class="pl-k">=</span> <span class="pl-c1">flatten_to_dataframe</span>(blast_array)</pre></div>
<p dir="auto">which will give you a DataFrame with all of the information per HSP, hit, query, etc.</p>
</article></div>