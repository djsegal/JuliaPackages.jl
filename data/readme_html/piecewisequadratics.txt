<div id="readme" class="md" data-path="README.md"><article class="markdown-body entry-content container-lg" itemprop="text"><h1 dir="auto"><a id="user-content-piecewisequadraticsjl" class="anchor" aria-hidden="true" href="#piecewisequadraticsjl"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a>PiecewiseQuadratics.jl</h1>
<p dir="auto"><a href="https://github.com/JuliaFirstOrder/PiecewiseQuadratics.jl/actions/workflows/ci.yml"><img src="https://github.com/JuliaFirstOrder/PiecewiseQuadratics.jl/actions/workflows/ci.yml/badge.svg" alt="CI" style="max-width: 100%;"></a>
<a href="https://codecov.io/gh/JuliaFirstOrder/PiecewiseQuadratics.jl" rel="nofollow"><img src="https://camo.githubusercontent.com/b0f1d381e4e2729655f476bbde519289560e453cb6dade4cb80fd63849e8aade/68747470733a2f2f636f6465636f762e696f2f67682f4a756c696146697273744f726465722f506965636577697365517561647261746963732e6a6c2f6272616e63682f6d61696e2f67726170682f62616467652e7376673f746f6b656e3d44774343736477496763" alt="codecov" data-canonical-src="https://codecov.io/gh/JuliaFirstOrder/PiecewiseQuadratics.jl/branch/main/graph/badge.svg?token=DwCCsdwIgc" style="max-width: 100%;"></a></p>
<p dir="auto"><a href="https://juliafirstorder.github.io/PiecewiseQuadratics.jl/stable" rel="nofollow"><img src="https://camo.githubusercontent.com/c97f0a5f2ae95755f64a27f1aa8d9a17462941fd3d6c907c7630abd5d3e60acf/68747470733a2f2f696d672e736869656c64732e696f2f62616467652f646f63732d737461626c652d626c75652e737667" alt="" data-canonical-src="https://img.shields.io/badge/docs-stable-blue.svg" style="max-width: 100%;"></a>
<a href="https://juliafirstorder.github.io/PiecewiseQuadratics.jl/dev" rel="nofollow"><img src="https://camo.githubusercontent.com/7fcec4b2d3ab291529fce8ef6a4fcd4129a0683b2f5d5fe2f5c648f02db8b616/68747470733a2f2f696d672e736869656c64732e696f2f62616467652f646f63732d6465762d626c75652e737667" alt="" data-canonical-src="https://img.shields.io/badge/docs-dev-blue.svg" style="max-width: 100%;"></a></p>
<p dir="auto"><strong>PiecewiseQuadratics.jl</strong> is a <a href="http://julialang.org" rel="nofollow">Julia</a> package for manipulation of univariate piecewise quadratic functions of the form</p>
<div class="snippet-clipboard-content notranslate position-relative overflow-auto" data-snippet-clipboard-copy-content="f(x) = p x² + q x + r, ∀ x ∈ [lb, ub]"><pre class="notranslate"><code>f(x) = p x² + q x + r, ∀ x ∈ [lb, ub]
</code></pre></div>
<p dir="auto">where:</p>
<ul dir="auto">
<li><code>p</code>, <code>q</code>, <code>r</code> are scalar</li>
<li><code>x</code> is the decision variable</li>
<li><code>lb</code> is the lower bound of <code>x</code></li>
<li><code>ub</code> is the upper bound of <code>x</code></li>
</ul>
<p dir="auto">There is a particular focus on convex analysis and optimization.  The following operations are supported:</p>
<ul dir="auto">
<li>Addition</li>
<li>Convex envelope</li>
<li>Proximal operator</li>
<li>Minimization</li>
<li>Others, such as scalar multiplication, shifting, perspective transformation.</li>
</ul>
<h3 dir="auto"><a id="user-content-authors" class="anchor" aria-hidden="true" href="#authors"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a>Authors</h3>
<p dir="auto">This package and <a href="https://github.com/JuliaFirstOrder/SeparableOptimization.jl">SeparableOptimization.jl</a> were originally developed by <a href="https://www.nicholasmoehle.com/" rel="nofollow">Nicholas Moehle</a>, <a href="http://ellisbrown.github.io" rel="nofollow">Ellis Brown</a>, and <a href="https://mykel.kochenderfer.com/" rel="nofollow">Mykel Kochenderfer</a> at BlackRock AI Labs.  They were developed to produce the results in the following paper: <a href="https://arxiv.org/abs/2103.05455" rel="nofollow">arXiv:2103.05455</a>.</p>
<h2 dir="auto"><a id="user-content-contents" class="anchor" aria-hidden="true" href="#contents"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a>Contents</h2>
<ul dir="auto">
<li><a href="#installation">Installation</a></li>
<li><a href="#example">Example</a></li>
<li><a href="#contribute">Contribute</a></li>
</ul>
<h2 dir="auto"><a id="user-content-installation" class="anchor" aria-hidden="true" href="#installation"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a>Installation</h2>
<p dir="auto">Use Julia's builtin package manager <a href="https://docs.julialang.org/en/v1/stdlib/Pkg/" rel="nofollow">Pkg</a> to install.
From a Julia REPL:</p>
<div class="highlight highlight-source-julia notranslate position-relative overflow-auto" dir="auto" data-snippet-clipboard-copy-content="] add PiecewiseQuadratics"><pre>] add PiecewiseQuadratics</pre></div>
<h2 dir="auto"><a id="user-content-example" class="anchor" aria-hidden="true" href="#example"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a>Example</h2>
<h3 dir="auto"><a id="user-content-bounded-quadratics" class="anchor" aria-hidden="true" href="#bounded-quadratics"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a>Bounded Quadratics</h3>
<p dir="auto">We specify a bounded quadratic <code>g(x) = x² + 2x + 4, ∀x ∈ [0,5]</code> by</p>
<div class="highlight highlight-source-julia notranslate position-relative overflow-auto" dir="auto" data-snippet-clipboard-copy-content="# (lb, ub, p, q, r)
g = BoundedQuadratic(0, 5, 1, 2, 4)"><pre><span class="pl-c"><span class="pl-c">#</span> (lb, ub, p, q, r)</span>
g <span class="pl-k">=</span> <span class="pl-c1">BoundedQuadratic</span>(<span class="pl-c1">0</span>, <span class="pl-c1">5</span>, <span class="pl-c1">1</span>, <span class="pl-c1">2</span>, <span class="pl-c1">4</span>)</pre></div>
<h3 dir="auto"><a id="user-content-piecewise-quadratics" class="anchor" aria-hidden="true" href="#piecewise-quadratics"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a>Piecewise Quadratics</h3>
<p dir="auto">We specify a piecewise quadratic function by providing a list of bounded quadratics in order. Where the pieces overlap, we take the function value to be the minimum over all possible values.</p>
<p dir="auto">We specify</p>
<p dir="auto"><a target="_blank" rel="noopener noreferrer" href="pwq_eqn.svg"><img src="pwq_eqn.svg" width="40%" style="max-width: 100%;"></a></p>
<p dir="auto">as follows:</p>
<div class="highlight highlight-source-julia notranslate position-relative overflow-auto" dir="auto" data-snippet-clipboard-copy-content="f = PiecewiseQuadratic([
  BoundedQuadratic(-Inf, 3.0, 1.0, -3.0, 3.0),
  BoundedQuadratic(3.0, 4.0, 0.0, -1.0, 3.0),
  BoundedQuadratic(4.0, 6.0, 2.0, -20.0, 47.0),
  BoundedQuadratic(6.0, 7.5, 0.0, 1.0, -7.0),
  BoundedQuadratic(7.5, Inf, 0.0, 4.0, -29.0)
])"><pre>f <span class="pl-k">=</span> <span class="pl-c1">PiecewiseQuadratic</span>([
  <span class="pl-c1">BoundedQuadratic</span>(<span class="pl-k">-</span><span class="pl-c1">Inf</span>, <span class="pl-c1">3.0</span>, <span class="pl-c1">1.0</span>, <span class="pl-k">-</span><span class="pl-c1">3.0</span>, <span class="pl-c1">3.0</span>),
  <span class="pl-c1">BoundedQuadratic</span>(<span class="pl-c1">3.0</span>, <span class="pl-c1">4.0</span>, <span class="pl-c1">0.0</span>, <span class="pl-k">-</span><span class="pl-c1">1.0</span>, <span class="pl-c1">3.0</span>),
  <span class="pl-c1">BoundedQuadratic</span>(<span class="pl-c1">4.0</span>, <span class="pl-c1">6.0</span>, <span class="pl-c1">2.0</span>, <span class="pl-k">-</span><span class="pl-c1">20.0</span>, <span class="pl-c1">47.0</span>),
  <span class="pl-c1">BoundedQuadratic</span>(<span class="pl-c1">6.0</span>, <span class="pl-c1">7.5</span>, <span class="pl-c1">0.0</span>, <span class="pl-c1">1.0</span>, <span class="pl-k">-</span><span class="pl-c1">7.0</span>),
  <span class="pl-c1">BoundedQuadratic</span>(<span class="pl-c1">7.5</span>, <span class="pl-c1">Inf</span>, <span class="pl-c1">0.0</span>, <span class="pl-c1">4.0</span>, <span class="pl-k">-</span><span class="pl-c1">29.0</span>)
])</pre></div>
<h3 dir="auto"><a id="user-content-plot" class="anchor" aria-hidden="true" href="#plot"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a>Plot</h3>
<p dir="auto">Below is a plot of the above piece-wise quadratic and its convex envelope, and the code to generate it.</p>
<div class="highlight highlight-source-julia notranslate position-relative overflow-auto" dir="auto" data-snippet-clipboard-copy-content="using Plots
plot(get_plot(f); grid=false, linestyle=:dash, color=:black, label=&quot;piece-wise quadratic&quot;)
plot!(get_plot(simplify(envelope(f))); color=:blue, la=0.5, label=&quot;envelope&quot;)
"><pre><span class="pl-k">using</span> Plots
<span class="pl-c1">plot</span>(<span class="pl-c1">get_plot</span>(f); grid<span class="pl-k">=</span><span class="pl-c1">false</span>, linestyle<span class="pl-k">=</span><span class="pl-c1">:dash</span>, color<span class="pl-k">=</span><span class="pl-c1">:black</span>, label<span class="pl-k">=</span><span class="pl-s"><span class="pl-pds">"</span>piece-wise quadratic<span class="pl-pds">"</span></span>)
<span class="pl-c1">plot!</span>(<span class="pl-c1">get_plot</span>(<span class="pl-c1">simplify</span>(<span class="pl-c1">envelope</span>(f))); color<span class="pl-k">=</span><span class="pl-c1">:blue</span>, la<span class="pl-k">=</span><span class="pl-c1">0.5</span>, label<span class="pl-k">=</span><span class="pl-s"><span class="pl-pds">"</span>envelope<span class="pl-pds">"</span></span>)
</pre></div>
<p dir="auto"><a target="_blank" rel="noopener noreferrer" href="pwq_plot.svg"><img src="pwq_plot.svg" width="50%" style="max-width: 100%;"></a></p>
<h2 dir="auto"><a id="user-content-contribute" class="anchor" aria-hidden="true" href="#contribute"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a>Contribute</h2>
<p dir="auto">Pull requests are welcome. For major changes, please open an issue first to discuss what you would like to change.</p>
<p dir="auto">Please make sure to update tests as appropriate.  See <code>CONTRIBUTING.md</code> for more detail.</p>
</article></div>