<div id="readme" class="md" data-path="README.md"><article class="markdown-body entry-content container-lg" itemprop="text"><h1 dir="auto"><a id="user-content--fcsfilesjl" class="anchor" aria-hidden="true" href="#-fcsfilesjl"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a><g-emoji class="g-emoji" alias="petri_dish" fallback-src="https://github.githubassets.com/images/icons/emoji/unicode/1f9eb.png">ðŸ§«</g-emoji> FCSFiles.jl</h1>
<p dir="auto">Add <code>FileIO.jl</code> integration for <a href="https://en.wikipedia.org/wiki/Flow_cytometry" rel="nofollow">flow cytometry</a> FCS files.</p>
<table>
<thead>
<tr>
<th>Stable release</th>
<th>Repo status</th>
</tr>
</thead>
<tbody>
<tr>
<td><a target="_blank" rel="noopener noreferrer nofollow" href="https://camo.githubusercontent.com/0d45804af91acf570531ee03ad7913c6766a55e0cf7798e4d8b169109b7d60e7/68747470733a2f2f6a756c69616875622e636f6d2f646f63732f46435346696c65732f76657273696f6e2e737667"><img src="https://camo.githubusercontent.com/0d45804af91acf570531ee03ad7913c6766a55e0cf7798e4d8b169109b7d60e7/68747470733a2f2f6a756c69616875622e636f6d2f646f63732f46435346696c65732f76657273696f6e2e737667" alt="" data-canonical-src="https://juliahub.com/docs/FCSFiles/version.svg" style="max-width: 100%;"></a></td>
<td><a href="https://github.com/tlnagy/FCSFiles.jl/actions"><img src="https://github.com/tlnagy/FCSFiles.jl/workflows/CI/badge.svg" alt="" style="max-width: 100%;"></a> <a href="https://codecov.io/gh/tlnagy/FCSFiles.jl" rel="nofollow"><img src="https://camo.githubusercontent.com/18704f21ca732896630367d75bed7cb21132ab24d063da1bf19081b4ee3b6803/68747470733a2f2f636f6465636f762e696f2f67682f746c6e6167792f46435346696c65732e6a6c2f6272616e63682f6d61737465722f67726170682f62616467652e737667" alt="" data-canonical-src="https://codecov.io/gh/tlnagy/FCSFiles.jl/branch/master/graph/badge.svg" style="max-width: 100%;"></a></td>
</tr>
</tbody>
</table>
<h2 dir="auto"><a id="user-content-loading-an-fcsfile" class="anchor" aria-hidden="true" href="#loading-an-fcsfile"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a>Loading an FCSFile</h2>
<p dir="auto">FCS files can be loaded by using the FileIO interface.</p>
<div class="highlight highlight-source-julia notranslate position-relative overflow-auto" dir="auto" data-snippet-clipboard-copy-content="julia&gt; using FileIO

julia&gt; flowrun = load(&quot;example.fcs&quot;)
FCS.FlowSample{Float32}
    Machine: LSRFortessa
    Begin Time: 14:12:03
    End Time: 14:12:25
    Date: 17-MAR-2017
    File: Specimen_001_Tube_002_002.fcs
    Axes:
        FSC-A
        FSC-H
        FSC-W
        SSC-A
        SSC-H
        SSC-W
        B_530-30-A
        Time"><pre>julia<span class="pl-k">&gt;</span> <span class="pl-k">using</span> FileIO

julia<span class="pl-k">&gt;</span> flowrun <span class="pl-k">=</span> <span class="pl-c1">load</span>(<span class="pl-s"><span class="pl-pds">"</span>example.fcs<span class="pl-pds">"</span></span>)
FCS<span class="pl-k">.</span>FlowSample{Float32}
    Machine<span class="pl-k">:</span> LSRFortessa
    Begin Time<span class="pl-k">:</span> <span class="pl-c1">14</span><span class="pl-k">:</span><span class="pl-c1">12</span><span class="pl-k">:</span><span class="pl-c1">03</span>
    End Time<span class="pl-k">:</span> <span class="pl-c1">14</span><span class="pl-k">:</span><span class="pl-c1">12</span><span class="pl-k">:</span><span class="pl-c1">25</span>
    Date<span class="pl-k">:</span> <span class="pl-c1">17</span><span class="pl-k">-</span>MAR<span class="pl-k">-</span><span class="pl-c1">2017</span>
    File<span class="pl-k">:</span> Specimen_001_Tube_002_002<span class="pl-k">.</span>fcs
    Axes<span class="pl-k">:</span>
        FSC<span class="pl-k">-</span>A
        FSC<span class="pl-k">-</span>H
        FSC<span class="pl-k">-</span>W
        SSC<span class="pl-k">-</span>A
        SSC<span class="pl-k">-</span>H
        SSC<span class="pl-k">-</span>W
        B_530<span class="pl-k">-</span><span class="pl-c1">30</span><span class="pl-k">-</span>A
        Time</pre></div>
<h2 dir="auto"><a id="user-content-metadata" class="anchor" aria-hidden="true" href="#metadata"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a>Metadata</h2>
<p dir="auto">Once loaded the parameters of the FCS file are available as properties.</p>
<div class="snippet-clipboard-content notranslate position-relative overflow-auto" data-snippet-clipboard-copy-content="julia&gt; flowrun.last_modified
&quot;2019-Oct-03 15:35:15&quot;

julia&gt; flowrun.p1n
&quot;FSC-A&quot;"><pre class="notranslate"><code>julia&gt; flowrun.last_modified
"2019-Oct-03 15:35:15"

julia&gt; flowrun.p1n
"FSC-A"
</code></pre></div>
<h2 dir="auto"><a id="user-content-indexing" class="anchor" aria-hidden="true" href="#indexing"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a>Indexing</h2>
<p dir="auto">There are many ways to index into the FCS file. You can index the FCS file as a matrix (actually an <code>AxisArray</code>).</p>
<div class="snippet-clipboard-content notranslate position-relative overflow-auto" data-snippet-clipboard-copy-content="julia&gt; flowrun[:, 1]
1-dimensional AxisArray{Float32,1,...} with axes:
    :param, [&quot;FSC-A&quot;, &quot;FSC-H&quot;, &quot;SSC-A&quot;, &quot;SSC-H&quot;, &quot;B1-A&quot;, &quot;B1-H&quot;, &quot;B2-A&quot;, &quot;B2-H&quot;, &quot;HDR-CE&quot;, &quot;HDR-SE&quot;  â€¦  &quot;V2-A&quot;, &quot;V2-H&quot;, &quot;Y1-A&quot;, &quot;Y1-H&quot;, &quot;Y2-A&quot;, &quot;Y2-H&quot;, &quot;Y3-A&quot;, &quot;Y3-H&quot;, &quot;Y4-A&quot;, &quot;Y4-H&quot;]
And data, a 23-element Vector{Float32}:
 19.319384
 12.838199
 44.391308
 20.214031
  0.01834727
  0.72980446
 -0.25282443
  0.4430968
  â‹®
  0.54869235
 -0.027989198
  0.48970717
  4.498265
  5.900927
  0.02512901
  0.3956769"><pre class="notranslate"><code>julia&gt; flowrun[:, 1]
1-dimensional AxisArray{Float32,1,...} with axes:
    :param, ["FSC-A", "FSC-H", "SSC-A", "SSC-H", "B1-A", "B1-H", "B2-A", "B2-H", "HDR-CE", "HDR-SE"  â€¦  "V2-A", "V2-H", "Y1-A", "Y1-H", "Y2-A", "Y2-H", "Y3-A", "Y3-H", "Y4-A", "Y4-H"]
And data, a 23-element Vector{Float32}:
 19.319384
 12.838199
 44.391308
 20.214031
  0.01834727
  0.72980446
 -0.25282443
  0.4430968
  â‹®
  0.54869235
 -0.027989198
  0.48970717
  4.498265
  5.900927
  0.02512901
  0.3956769
</code></pre></div>
<p dir="auto">This retrieves the values of all the parameters for the first event in the FCS file.</p>
<p dir="auto">Similarly you can get the values of a single parameter for all events.</p>
<div class="snippet-clipboard-content notranslate position-relative overflow-auto" data-snippet-clipboard-copy-content="julia&gt; flowrun[1, :]
1-dimensional AxisArray{Float32,1,...} with axes:
    :event, 1:83562
And data, a 83562-element Vector{Float32}:
 19.319384
 22.961153
 36.157864
 30.91769
  5.644829
 14.188097
 34.42944
  4.4080987
  â‹®
 23.391977
 -4.813841
 -1.2413055
 11.075016
 13.712906
 23.54529
  5.740017"><pre class="notranslate"><code>julia&gt; flowrun[1, :]
1-dimensional AxisArray{Float32,1,...} with axes:
    :event, 1:83562
And data, a 83562-element Vector{Float32}:
 19.319384
 22.961153
 36.157864
 30.91769
  5.644829
 14.188097
 34.42944
  4.4080987
  â‹®
 23.391977
 -4.813841
 -1.2413055
 11.075016
 13.712906
 23.54529
  5.740017
</code></pre></div>
<p dir="auto">You can also take ranges of events.</p>
<div class="snippet-clipboard-content notranslate position-relative overflow-auto" data-snippet-clipboard-copy-content="julia&gt; flowrun[1, end-99:end]
1-dimensional AxisArray{Float32,1,...} with axes:
    :event, 83463:83562
And data, a 100-element Vector{Float32}:
   4.576562
   2.553804
  10.608879
  -6.4025674
 -18.626959
   6.1649327
  24.049818
  21.735662
   â‹®
  23.391977
  -4.813841
  -1.2413055
  11.075016
  13.712906
  23.54529
   5.740017"><pre class="notranslate"><code>julia&gt; flowrun[1, end-99:end]
1-dimensional AxisArray{Float32,1,...} with axes:
    :event, 83463:83562
And data, a 100-element Vector{Float32}:
   4.576562
   2.553804
  10.608879
  -6.4025674
 -18.626959
   6.1649327
  24.049818
  21.735662
   â‹®
  23.391977
  -4.813841
  -1.2413055
  11.075016
  13.712906
  23.54529
   5.740017
</code></pre></div>
<p dir="auto">If you know the name of a parameter you can use that name to index.</p>
<div class="snippet-clipboard-content notranslate position-relative overflow-auto" data-snippet-clipboard-copy-content="julia&gt; flowrun[&quot;FSC-A&quot;]
1-dimensional AxisArray{Float32,1,...} with axes:
    :event, 1:83562
And data, a 83562-element Vector{Float32}:
 19.319384
 22.961153
 36.157864
 30.91769
  5.644829
 14.188097
 34.42944
  4.4080987
  â‹®
 23.391977
 -4.813841
 -1.2413055
 11.075016
 13.712906
 23.54529
  5.740017"><pre class="notranslate"><code>julia&gt; flowrun["FSC-A"]
1-dimensional AxisArray{Float32,1,...} with axes:
    :event, 1:83562
And data, a 83562-element Vector{Float32}:
 19.319384
 22.961153
 36.157864
 30.91769
  5.644829
 14.188097
 34.42944
  4.4080987
  â‹®
 23.391977
 -4.813841
 -1.2413055
 11.075016
 13.712906
 23.54529
  5.740017
</code></pre></div>
<p dir="auto">Or you can get multiple parameters at the same time.</p>
<div class="snippet-clipboard-content notranslate position-relative overflow-auto" data-snippet-clipboard-copy-content="julia&gt; flowrun[[&quot;FSC-A&quot;, &quot;FSC-H&quot;]]
2-dimensional AxisArray{Float32,2,...} with axes:
    :param, [&quot;FSC-A&quot;, &quot;FSC-H&quot;]
    :event, 1:83562
And data, a 2Ã—83562 Matrix{Float32}:
 19.3194  22.9612   36.1579  30.9177  â€¦  11.075    13.7129   23.5453   5.74002
 12.8382   3.40729  17.4995  14.0875      8.80171   5.29686  13.0893  11.3576"><pre class="notranslate"><code>julia&gt; flowrun[["FSC-A", "FSC-H"]]
2-dimensional AxisArray{Float32,2,...} with axes:
    :param, ["FSC-A", "FSC-H"]
    :event, 1:83562
And data, a 2Ã—83562 Matrix{Float32}:
 19.3194  22.9612   36.1579  30.9177  â€¦  11.075    13.7129   23.5453   5.74002
 12.8382   3.40729  17.4995  14.0875      8.80171   5.29686  13.0893  11.3576
</code></pre></div>
<p dir="auto">In general, any indexing that works with <code>AxisArray</code>s should work the same with FCS files.</p>
<h2 dir="auto"><a id="user-content-plotting" class="anchor" aria-hidden="true" href="#plotting"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a>Plotting</h2>
<p dir="auto">Here is an example which constructs a 2D histogram visualisation of a FCS file.</p>
<div class="snippet-clipboard-content notranslate position-relative overflow-auto" data-snippet-clipboard-copy-content="julia&gt; using Gadfly

julia&gt; p = plot(x=flowrun[&quot;FSC-A&quot;], y=flowrun[&quot;SSC-A&quot;], Geom.histogram2d,
Guide.xlabel(&quot;FSC-A&quot;), Guide.ylabel(&quot;SSC-A&quot;), Coord.cartesian(xmin=0, ymin=0))

julia&gt; draw(PNG(&quot;example.png&quot;, 10cm, 7cm, dpi=300), p)"><pre class="notranslate"><code>julia&gt; using Gadfly

julia&gt; p = plot(x=flowrun["FSC-A"], y=flowrun["SSC-A"], Geom.histogram2d,
Guide.xlabel("FSC-A"), Guide.ylabel("SSC-A"), Coord.cartesian(xmin=0, ymin=0))

julia&gt; draw(PNG("example.png", 10cm, 7cm, dpi=300), p)
</code></pre></div>
<p dir="auto"><a target="_blank" rel="noopener noreferrer" href="example.png"><img src="example.png" alt="" style="max-width: 100%;"></a></p>
</article></div>