<div id="readme" class="md" data-path="README.md"><article class="markdown-body entry-content container-lg" itemprop="text"><h1 dir="auto"><a id="user-content-mimirffspsjl" class="anchor" aria-hidden="true" href="#mimirffspsjl"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a>MimiRFFSPs.jl</h1>
<p dir="auto">This repository holds a component using the <a href="https://www.mimiframework.org" rel="nofollow">Mimi</a> framework which provides parameters from the Resources for the Future (RFF) RFF Socioeconomic Projections (RFF SPs). These include socioeconomic (population and GDP) and emissions (CO2, CH4, and CH4), to be connected with as desired with other Mimi components and run in Mimi models.</p>
<h2 dir="auto"><a id="user-content-preparing-the-software-environment" class="anchor" aria-hidden="true" href="#preparing-the-software-environment"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a>Preparing the Software Environment</h2>
<p dir="auto">To add the package to your current environment, run the following command at the Julia package REPL:</p>
<div class="highlight highlight-source-julia notranslate position-relative overflow-auto" dir="auto" data-snippet-clipboard-copy-content="pkg&gt; add MimiRFFSPs"><pre>pkg<span class="pl-k">&gt;</span> add MimiRFFSPs</pre></div>
<p dir="auto">You probably also want to install the Mimi package into your Julia environment, so that you can use some of the tools in there:</p>
<div class="snippet-clipboard-content notranslate position-relative overflow-auto" data-snippet-clipboard-copy-content="pkg&gt; add Mimi"><pre class="notranslate"><code>pkg&gt; add Mimi
</code></pre></div>
<h2 dir="auto"><a id="user-content-running-the-model" class="anchor" aria-hidden="true" href="#running-the-model"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a>Running the Model</h2>
<p dir="auto">The model uses the Mimi framework and it is highly recommended to read the Mimi documentation first to understand the code structure. This model presents two components, which will most often be used in tandem. The basic way to access the MimiRFFSPs components, both <code>RFF-SPs</code> and <code>RegionAggregatorSum</code> and explore the results is the following:</p>
<div class="highlight highlight-source-julia notranslate position-relative overflow-auto" dir="auto" data-snippet-clipboard-copy-content="using Mimi 
using MimiRFFSPs

# Create the a model
m = Model()

# Set the time dimension for the whole model, which can run longer than an individual component if desired
set_dimension!(m, :time, 1750:2300)

# Add the Sps component as imported from `MimiRFFSPs`

add_comp!(m, MimiRFFSPs.SPs, first = 2020, last = 2300)

# Set country dimension and related parameter: As of now this must be exactly the 184 countries in the following file, but we will add flexibility for this in the future.
all_countries = load(joinpath(@__DIR__, &quot;data&quot;, &quot;keys&quot;, &quot;MimiRFFSPs_ISO3.csv&quot;)) |&gt; DataFrame
set_dimension!(m, :country, all_countries.ISO3)
update_param!(m, :SPs, :country_names, all_countries.ISO3) # should match the dimension

# Run the model
run(m)

# Explore interactive plots of all the model output.
explore(m)

# Access a specific variable
emissions = m[:SPs, :gdp]"><pre><span class="pl-k">using</span> Mimi 
<span class="pl-k">using</span> MimiRFFSPs

<span class="pl-c"><span class="pl-c">#</span> Create the a model</span>
m <span class="pl-k">=</span> <span class="pl-c1">Model</span>()

<span class="pl-c"><span class="pl-c">#</span> Set the time dimension for the whole model, which can run longer than an individual component if desired</span>
<span class="pl-c1">set_dimension!</span>(m, <span class="pl-c1">:time</span>, <span class="pl-c1">1750</span><span class="pl-k">:</span><span class="pl-c1">2300</span>)

<span class="pl-c"><span class="pl-c">#</span> Add the Sps component as imported from `MimiRFFSPs`</span>

<span class="pl-c1">add_comp!</span>(m, MimiRFFSPs<span class="pl-k">.</span>SPs, first <span class="pl-k">=</span> <span class="pl-c1">2020</span>, last <span class="pl-k">=</span> <span class="pl-c1">2300</span>)

<span class="pl-c"><span class="pl-c">#</span> Set country dimension and related parameter: As of now this must be exactly the 184 countries in the following file, but we will add flexibility for this in the future.</span>
all_countries <span class="pl-k">=</span> <span class="pl-c1">load</span>(<span class="pl-c1">joinpath</span>(<span class="pl-c1">@__DIR__</span>, <span class="pl-s"><span class="pl-pds">"</span>data<span class="pl-pds">"</span></span>, <span class="pl-s"><span class="pl-pds">"</span>keys<span class="pl-pds">"</span></span>, <span class="pl-s"><span class="pl-pds">"</span>MimiRFFSPs_ISO3.csv<span class="pl-pds">"</span></span>)) <span class="pl-k">|&gt;</span> DataFrame
<span class="pl-c1">set_dimension!</span>(m, <span class="pl-c1">:country</span>, all_countries<span class="pl-k">.</span>ISO3)
<span class="pl-c1">update_param!</span>(m, <span class="pl-c1">:SPs</span>, <span class="pl-c1">:country_names</span>, all_countries<span class="pl-k">.</span>ISO3) <span class="pl-c"><span class="pl-c">#</span> should match the dimension</span>

<span class="pl-c"><span class="pl-c">#</span> Run the model</span>
<span class="pl-c1">run</span>(m)

<span class="pl-c"><span class="pl-c">#</span> Explore interactive plots of all the model output.</span>
<span class="pl-c1">explore</span>(m)

<span class="pl-c"><span class="pl-c">#</span> Access a specific variable</span>
emissions <span class="pl-k">=</span> m[<span class="pl-c1">:SPs</span>, <span class="pl-c1">:gdp</span>]</pre></div>
<p dir="auto">The <code>id</code> parameter in this component (default id of 6546) which allows one to run the model with a specified parameter set of ID <code>id</code> within the data.  By nature of these projections, this component should be run using a Monte Carlo Simulation sampling over the IDs in order to obtain a representative distribution of plausible outcomes, but providing an ID may be useful for debugging purposes. See the section below for more information.</p>
<p dir="auto">Also note that the <code>SPs</code> component has optional arguments <code>start_year</code> (default = 2020) and <code>end_year</code> (default = 2300) that can be altered to values within the 2020 - 2300 timeframe.  Timesteps must be annual as of now, but we will add flexibility to this in the future.</p>
<hr>
<p dir="auto">If a user wants to connect the <code>m[:SPs, :population]</code> output variable to another Mimi component that requires population at a more aggregated regional level, the <code>RegionAggregatorSum</code> component can be helpful. This helper component aggregates countries to regions with a provided mapping via the <code>sum</code> function (other functions can be added as desired, this is a relatively new and nimble component). You will need to provide a mapping between the input regions (countries here) and output regions (regions here) in a Vector of the length of the input regions and each element being one of the output regions. Note that this component is not yet optimized for performance.</p>
<div class="highlight highlight-source-julia notranslate position-relative overflow-auto" dir="auto" data-snippet-clipboard-copy-content="# Start with the model `m` from above and add the component with the name `:PopulationAggregator`
add_comp!(m, MimiRFFSPs.RegionAggregatorSum, :PopulationAggregator, first = 2020, last = 2300)

# Bring in a dummy mapping between the countries list from the model above and our current one. Note that this DataFrame has two columns, `InputRegion` and `OutputRegion`, where `InputRegion` is identical to `all_countries.ISO3` above but we will reset here for clarity.
mapping = load(joinpath(@__DIR__, &quot;test&quot;, &quot;data&quot;, &quot;MimiRFFSPs_dummyInputOutput.csv&quot;)) |&gt; DataFrame
inputregions = mapping.Input_Region
outputregions = sort(unique(mapping.Output_Region))

# Set the region dimensions
set_dimension!(m, :inputregions, inputregions)
set_dimension!(m, :outputregions, outputregions)

# Provide the mapping parameter as well as the the names of the input regions and output regions, which should just take copies of what you provided to `set_dimension!` above
update_param!(m, :PopulationAggregator, :input_region_names, inputregions)
update_param!(m, :PopulationAggregator, :output_region_names, outputregions)
update_param!(m, :PopulationAggregator, :input_output_mapping, mapping.Output_Region) # Vector with length of input regions, each element matching an output region in the output_region_names parameter (and outputregions dimension)

# Make SPs component `:population` variable the feed into the `:input` variable of the `PopulationAggregator` component
connect_param!(m, :PopulationAggregator, :input, :SPs, :population)

run(m)

# View the aggregated population variable, aggregated from 184 countries to 11 regions
getdataframe(m, :PopulationAggregator, :output)
"><pre><span class="pl-c"><span class="pl-c">#</span> Start with the model `m` from above and add the component with the name `:PopulationAggregator`</span>
<span class="pl-c1">add_comp!</span>(m, MimiRFFSPs<span class="pl-k">.</span>RegionAggregatorSum, <span class="pl-c1">:PopulationAggregator</span>, first <span class="pl-k">=</span> <span class="pl-c1">2020</span>, last <span class="pl-k">=</span> <span class="pl-c1">2300</span>)

<span class="pl-c"><span class="pl-c">#</span> Bring in a dummy mapping between the countries list from the model above and our current one. Note that this DataFrame has two columns, `InputRegion` and `OutputRegion`, where `InputRegion` is identical to `all_countries.ISO3` above but we will reset here for clarity.</span>
mapping <span class="pl-k">=</span> <span class="pl-c1">load</span>(<span class="pl-c1">joinpath</span>(<span class="pl-c1">@__DIR__</span>, <span class="pl-s"><span class="pl-pds">"</span>test<span class="pl-pds">"</span></span>, <span class="pl-s"><span class="pl-pds">"</span>data<span class="pl-pds">"</span></span>, <span class="pl-s"><span class="pl-pds">"</span>MimiRFFSPs_dummyInputOutput.csv<span class="pl-pds">"</span></span>)) <span class="pl-k">|&gt;</span> DataFrame
inputregions <span class="pl-k">=</span> mapping<span class="pl-k">.</span>Input_Region
outputregions <span class="pl-k">=</span> <span class="pl-c1">sort</span>(<span class="pl-c1">unique</span>(mapping<span class="pl-k">.</span>Output_Region))

<span class="pl-c"><span class="pl-c">#</span> Set the region dimensions</span>
<span class="pl-c1">set_dimension!</span>(m, <span class="pl-c1">:inputregions</span>, inputregions)
<span class="pl-c1">set_dimension!</span>(m, <span class="pl-c1">:outputregions</span>, outputregions)

<span class="pl-c"><span class="pl-c">#</span> Provide the mapping parameter as well as the the names of the input regions and output regions, which should just take copies of what you provided to `set_dimension!` above</span>
<span class="pl-c1">update_param!</span>(m, <span class="pl-c1">:PopulationAggregator</span>, <span class="pl-c1">:input_region_names</span>, inputregions)
<span class="pl-c1">update_param!</span>(m, <span class="pl-c1">:PopulationAggregator</span>, <span class="pl-c1">:output_region_names</span>, outputregions)
<span class="pl-c1">update_param!</span>(m, <span class="pl-c1">:PopulationAggregator</span>, <span class="pl-c1">:input_output_mapping</span>, mapping<span class="pl-k">.</span>Output_Region) <span class="pl-c"><span class="pl-c">#</span> Vector with length of input regions, each element matching an output region in the output_region_names parameter (and outputregions dimension)</span>

<span class="pl-c"><span class="pl-c">#</span> Make SPs component `:population` variable the feed into the `:input` variable of the `PopulationAggregator` component</span>
<span class="pl-c1">connect_param!</span>(m, <span class="pl-c1">:PopulationAggregator</span>, <span class="pl-c1">:input</span>, <span class="pl-c1">:SPs</span>, <span class="pl-c1">:population</span>)

<span class="pl-c1">run</span>(m)

<span class="pl-c"><span class="pl-c">#</span> View the aggregated population variable, aggregated from 184 countries to 11 regions</span>
<span class="pl-c1">getdataframe</span>(m, <span class="pl-c1">:PopulationAggregator</span>, <span class="pl-c1">:output</span>)
</pre></div>
<h2 dir="auto"><a id="user-content-data-sources" class="anchor" aria-hidden="true" href="#data-sources"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a>Data Sources</h2>
<p dir="auto">Most data inputs to this model and components are hosted on <code>Zenodo.com</code> and retrieved upon  along with a snapshot of the <code>rff-socioeconomic-projections</code> private Github repository at the time when these data were produced. These files will be downloaded automatically to your machine upon running this package, as indicated by the following <code>__init__()</code> function specification from <code>MimiRFFSPs.jl</code>.</p>
<div class="snippet-clipboard-content notranslate position-relative overflow-auto" data-snippet-clipboard-copy-content="function __init__()
    register(DataDep(
        &quot;rffsps_v5&quot;,
        &quot;RFF SPs version v5&quot;,
        &quot;https://zenodo.org/record/6016583/files/rffsps_v5.7z&quot;,
        &quot;a39b51d7552d198123b1863ea5a131533715a7a7c9ff6fad4b493594ece49497&quot;,
        post_fetch_method=unpack
    ))
end"><pre class="notranslate"><code>function __init__()
    register(DataDep(
        "rffsps_v5",
        "RFF SPs version v5",
        "https://zenodo.org/record/6016583/files/rffsps_v5.7z",
        "a39b51d7552d198123b1863ea5a131533715a7a7c9ff6fad4b493594ece49497",
        post_fetch_method=unpack
    ))
end
</code></pre></div>
<p dir="auto">Details on any files hosted within this repository in the <code>data</code> folder can be found in Data_README.md within that folder.</p>
<h2 dir="auto"><a id="user-content-citations" class="anchor" aria-hidden="true" href="#citations"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a>Citations</h2>
<p dir="auto">Rennert, K. et al. The Social Cost of Carbon: Advances in Long-Term Probabilistic Projections of Population, GDP, Emissions, and Discount Rates. Brook. Pap. Econ. Act. (Forthcoming).</p>
</article></div>