<div id="readme" class="md" data-path="README.md"><article class="markdown-body entry-content container-lg" itemprop="text"><h1 dir="auto"><a id="user-content-semidiscretizationmethodjl" class="anchor" aria-hidden="true" href="#semidiscretizationmethodjl"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a>SemiDiscretizationMethod.jl</h1>
<p dir="auto">Julia package to investigate the behaviour of linear delay differential equations based on the book
<a href="http://link.springer.com/10.1007/978-1-4614-0335-7" rel="nofollow">Semi-Discretization for Time-Delay Systems (by Insperger and Stepan)</a>.</p>
<p dir="auto">This package provides a tool to approximate the stability properties and stationary behaviour of linear periodic delay systems of the form:</p>
<p dir="auto">$$\dot{\mathbf{x}}(t) = \mathbf{A}(t) \mathbf{x}(t) + \sum_{j=1}^g \mathbf{B}<em>j(t) \mathbf{x}(t-\tau_j(t))+\mathbf{c}(t)$$
by transforming the underlying differential equation into the mapping:
$$\mathbf{y}</em>{n+1} = \mathbf{F}_n\mathbf{y}_n+\mathbf{f}_n,$$</p>
<p dir="auto">where <math-renderer class="js-inline-math" style="display: inline" data-static-url="https://github.githubassets.com/static" data-run-id="6a0ebcdbb76d8438df8687a3845f22ce">$n$</math-renderer> is the discrete time (<math-renderer class="js-inline-math" style="display: inline" data-static-url="https://github.githubassets.com/static" data-run-id="6a0ebcdbb76d8438df8687a3845f22ce">$t_n = n \Delta t$</math-renderer>), <math-renderer class="js-inline-math" style="display: inline" data-static-url="https://github.githubassets.com/static" data-run-id="6a0ebcdbb76d8438df8687a3845f22ce">$\mathbf{F}_n$</math-renderer> is the mapping matrix constructed using <math-renderer class="js-inline-math" style="display: inline" data-static-url="https://github.githubassets.com/static" data-run-id="6a0ebcdbb76d8438df8687a3845f22ce">$\mathbf{A}(t)$</math-renderer>, <math-renderer class="js-inline-math" style="display: inline" data-static-url="https://github.githubassets.com/static" data-run-id="6a0ebcdbb76d8438df8687a3845f22ce">$\mathbf{B}(t)$</math-renderer> and <math-renderer class="js-inline-math" style="display: inline" data-static-url="https://github.githubassets.com/static" data-run-id="6a0ebcdbb76d8438df8687a3845f22ce">$\tau_j(t)$</math-renderer>, while the vector <math-renderer class="js-inline-math" style="display: inline" data-static-url="https://github.githubassets.com/static" data-run-id="6a0ebcdbb76d8438df8687a3845f22ce">$\mathbf{y}_n$</math-renderer> is the discretized state space vector:</p>
<p dir="auto">$$ \mathbf{y}<em>n = \left(\mathbf{x}(t_n)^\top, \mathbf{x}(t</em>{n-1})^\top,\ldots,\mathbf{x}(t_{n-r})\right)^\top!.$$</p>
<p dir="auto">Each coefficient matrices of delay differential equations are periodic, with a principle period of <math-renderer class="js-inline-math" style="display: inline" data-static-url="https://github.githubassets.com/static" data-run-id="6a0ebcdbb76d8438df8687a3845f22ce">$P$</math-renderer>, namely:
$\mathbf A(t)=\mathbf A(t+P),; \mathbf B_j(t)=\mathbf B_j(t+P),; \tau_j(t)=\tau_j(t+P)$) and <math-renderer class="js-inline-math" style="display: inline" data-static-url="https://github.githubassets.com/static" data-run-id="6a0ebcdbb76d8438df8687a3845f22ce">$\mathbf{c}(t)=\mathbf{c}(t+P)$</math-renderer>
Furthermore, the integer <math-renderer class="js-inline-math" style="display: inline" data-static-url="https://github.githubassets.com/static" data-run-id="6a0ebcdbb76d8438df8687a3845f22ce">$r$</math-renderer> is chosen in a way, that <math-renderer class="js-inline-math" style="display: inline" data-static-url="https://github.githubassets.com/static" data-run-id="6a0ebcdbb76d8438df8687a3845f22ce">$r\Delta t\geq \max_{t \in \left[0,P\right],j=1\ldots g}\tau_j(t)$</math-renderer>
(the discretized "history function" contains all possible delayed values).</p>
<p dir="auto">With the use of the discrete mapping, the stability of the original system can be investigated (approximately), by the spectral radius <math-renderer class="js-inline-math" style="display: inline" data-static-url="https://github.githubassets.com/static" data-run-id="6a0ebcdbb76d8438df8687a3845f22ce">$\rho$</math-renderer> of the product of the mapping matrices <math-renderer class="js-inline-math" style="display: inline" data-static-url="https://github.githubassets.com/static" data-run-id="6a0ebcdbb76d8438df8687a3845f22ce">$\mathbf{F}_n$</math-renderer> over a period:</p>
<p dir="auto"><math-renderer class="js-display-math" style="display: block" data-static-url="https://github.githubassets.com/static" data-run-id="6a0ebcdbb76d8438df8687a3845f22ce">$$\rho\left(\prod_{i=0}^{p-1}\mathbf{F}_{n+i}\right): \quad
\begin{matrix}
&lt;1 &amp; \Rightarrow &amp; \text{the mapping is stable}\\
&gt;1 &amp; \Rightarrow &amp; \text{the mapping is unstable}
\end{matrix}
$$</math-renderer></p>
<p dir="auto">Furthermore, the stationary solution can be determined by the periodic fix point (stationary orbit) of the mapping.</p>
<h1 dir="auto">
<a id="user-content-citing" class="anchor" aria-hidden="true" href="#citing"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a>Citing</h1>
<p dir="auto">If you use this package as part of your research, teaching, or other activities, we would be grateful if you could cite the book it is based on (BibTeX entry):</p>
<div class="snippet-clipboard-content notranslate position-relative overflow-auto" data-snippet-clipboard-copy-content="@book{Insperger2011,
address = {New York, NY},
author = {Insperger, Tam{\'{a}}s and St{\'{e}}p{\'{a}}n, G{\'{a}}bor},
doi = {10.1007/978-1-4614-0335-7},
isbn = {978-1-4614-0334-0},
publisher = {Springer New York},
series = {Applied Mathematical Sciences},
title = {{Semi-Discretization for Time-Delay Systems}},
url = {http://link.springer.com/10.1007/978-1-4614-0335-7},
volume = {178},
year = {2011}
}"><pre class="notranslate"><code>@book{Insperger2011,
address = {New York, NY},
author = {Insperger, Tam{\'{a}}s and St{\'{e}}p{\'{a}}n, G{\'{a}}bor},
doi = {10.1007/978-1-4614-0335-7},
isbn = {978-1-4614-0334-0},
publisher = {Springer New York},
series = {Applied Mathematical Sciences},
title = {{Semi-Discretization for Time-Delay Systems}},
url = {http://link.springer.com/10.1007/978-1-4614-0335-7},
volume = {178},
year = {2011}
}
</code></pre></div>
<p dir="auto">If you are interested in the behaviour of your linear delay model in the presence of Gaussian white noise, please consider the <a href="https://github.com/HTSykora/StochasticSemiDiscretizationMethod.jl">StochasticSemiDiscretizationMethod.jl</a> package.</p>
<h1 dir="auto">
<a id="user-content-usage-with-examples" class="anchor" aria-hidden="true" href="#usage-with-examples"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a>Usage with examples</h1>
<h2 dir="auto">
<a id="user-content-installation" class="anchor" aria-hidden="true" href="#installation"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a>Installation</h2>
<div class="highlight highlight-source-julia notranslate position-relative overflow-auto" dir="auto" data-snippet-clipboard-copy-content="julia&gt; ] add SemiDiscretizationMethod"><pre>julia<span class="pl-k">&gt;</span> ] add SemiDiscretizationMethod</pre></div>
<h2 dir="auto">
<a id="user-content-hayes-equations" class="anchor" aria-hidden="true" href="#hayes-equations"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a>Hayes equations</h2>
<p dir="auto"><math-renderer class="js-display-math" style="display: block" data-static-url="https://github.githubassets.com/static" data-run-id="6a0ebcdbb76d8438df8687a3845f22ce">$$\dot{x}(t) = a ,x(t) + b ,x(t-1) + 1.$$</math-renderer></p>
<p dir="auto">Here</p>
<p dir="auto"><math-renderer class="js-display-math" style="display: block" data-static-url="https://github.githubassets.com/static" data-run-id="6a0ebcdbb76d8438df8687a3845f22ce">$$ \mathbf{A}(t) \equiv \begin{bmatrix} a \end{bmatrix},
\quad \mathbf{B}_1(t) \equiv \begin{bmatrix}b\end{bmatrix},
\quad \tau_1(t) \equiv 1 ,
\quad \text{and} \quad \mathbf{c}(t) \equiv \begin{bmatrix} 1 \end{bmatrix}.$$</math-renderer></p>
<p dir="auto">(Page 13 of the book referenced above)</p>
<div class="highlight highlight-source-julia notranslate position-relative overflow-auto" dir="auto" data-snippet-clipboard-copy-content="using SemiDiscretizationMethod"><pre><span class="pl-k">using</span> SemiDiscretizationMethod</pre></div>
<div class="highlight highlight-source-julia notranslate position-relative overflow-auto" dir="auto" data-snippet-clipboard-copy-content="function createHayesProblem(a,b)
    AMx =  ProportionalMX(a*ones(1,1));
    τ1=1. 
    BMx1 = DelayMX(τ1,b*ones(1,1));
    cVec = Additive(ones(1))
    LDDEProblem(AMx,[BMx1],cVec)
end"><pre><span class="pl-k">function</span> <span class="pl-en">createHayesProblem</span>(a,b)
    AMx <span class="pl-k">=</span>  <span class="pl-c1">ProportionalMX</span>(a<span class="pl-k">*</span><span class="pl-c1">ones</span>(<span class="pl-c1">1</span>,<span class="pl-c1">1</span>));
    τ1<span class="pl-k">=</span><span class="pl-c1">1.</span> 
    BMx1 <span class="pl-k">=</span> <span class="pl-c1">DelayMX</span>(τ1,b<span class="pl-k">*</span><span class="pl-c1">ones</span>(<span class="pl-c1">1</span>,<span class="pl-c1">1</span>));
    cVec <span class="pl-k">=</span> <span class="pl-c1">Additive</span>(<span class="pl-c1">ones</span>(<span class="pl-c1">1</span>))
    <span class="pl-c1">LDDEProblem</span>(AMx,[BMx1],cVec)
<span class="pl-k">end</span></pre></div>
<div class="highlight highlight-source-julia notranslate position-relative overflow-auto" dir="auto" data-snippet-clipboard-copy-content="hayes_lddep=createHayesProblem(-1.,-1.); # LDDE problem for Hayes equation
method=SemiDiscretization(1,0.1) # 1st order semi discretization with Δt=0.1
τmax=1. # the largest τ of the system
mapping=DiscreteMapping(hayes_lddep,method,τmax,n_steps=1,calculate_additive=true); #The discrete mapping of the system"><pre>hayes_lddep<span class="pl-k">=</span><span class="pl-c1">createHayesProblem</span>(<span class="pl-k">-</span><span class="pl-c1">1.</span>,<span class="pl-k">-</span><span class="pl-c1">1.</span>); <span class="pl-c"><span class="pl-c">#</span> LDDE problem for Hayes equation</span>
method<span class="pl-k">=</span><span class="pl-c1">SemiDiscretization</span>(<span class="pl-c1">1</span>,<span class="pl-c1">0.1</span>) <span class="pl-c"><span class="pl-c">#</span> 1st order semi discretization with Δt=0.1</span>
τmax<span class="pl-k">=</span><span class="pl-c1">1.</span> <span class="pl-c"><span class="pl-c">#</span> the largest τ of the system</span>
mapping<span class="pl-k">=</span><span class="pl-c1">DiscreteMapping</span>(hayes_lddep,method,τmax,n_steps<span class="pl-k">=</span><span class="pl-c1">1</span>,calculate_additive<span class="pl-k">=</span><span class="pl-c1">true</span>); <span class="pl-c"><span class="pl-c">#</span>The discrete mapping of the system</span></pre></div>
<div class="highlight highlight-source-julia notranslate position-relative overflow-auto" dir="auto" data-snippet-clipboard-copy-content="@show spectralRadiusOfMapping(mapping); # spectral radius ρ of the mapping matrix (ρ&gt;1 unstable, ρ&lt;1 stable)
@show fixPointOfMapping(mapping); # stationary solution of the hayes equation (equilibrium position)

# spectralRadiusOfMapping(mapping) = 0.941189374166563
# fixPointOfMapping(mapping) = [0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5]"><pre><span class="pl-c1">@show</span> <span class="pl-c1">spectralRadiusOfMapping</span>(mapping); <span class="pl-c"><span class="pl-c">#</span> spectral radius ρ of the mapping matrix (ρ&gt;1 unstable, ρ&lt;1 stable)</span>
<span class="pl-c1">@show</span> <span class="pl-c1">fixPointOfMapping</span>(mapping); <span class="pl-c"><span class="pl-c">#</span> stationary solution of the hayes equation (equilibrium position)</span>

<span class="pl-c"><span class="pl-c">#</span> spectralRadiusOfMapping(mapping) = 0.941189374166563</span>
<span class="pl-c"><span class="pl-c">#</span> fixPointOfMapping(mapping) = [0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5]</span></pre></div>
<h3 dir="auto">
<a id="user-content-stability-borders-of-the-hayes-equation" class="anchor" aria-hidden="true" href="#stability-borders-of-the-hayes-equation"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a>Stability borders of the Hayes Equation</h3>
<div class="highlight highlight-source-julia notranslate position-relative overflow-auto" dir="auto" data-snippet-clipboard-copy-content="using MDBM

using Plots
gr();
using LaTeXStrings"><pre><span class="pl-k">using</span> MDBM

<span class="pl-k">using</span> Plots
<span class="pl-c1">gr</span>();
<span class="pl-k">using</span> LaTeXStrings</pre></div>
<div class="highlight highlight-source-julia notranslate position-relative overflow-auto" dir="auto" data-snippet-clipboard-copy-content="method=SemiDiscretization(4,0.1);
τmax=1.

foo(a,b) = log(spectralRadiusOfMapping(DiscreteMapping(createHayesProblem(a,b),method,τmax,
    n_steps=1))); # No additive term calculated

axis=[Axis(-15.0:15.,:a),
    Axis(-15.0:15.,:b)]

iteration=3;
stab_border_points=getinterpolatedsolution(solve!(MDBM_Problem(foo,axis),iteration));

scatter(stab_border_points...,xlim=(-15.,15.),ylim=(-15.,15.),
    label=&quot;&quot;,title=&quot;Stability border of the Hayes equation&quot;,xlabel=L&quot;a&quot;,ylabel=L&quot;b&quot;,
    guidefontsize=14,tickfont = font(10),markersize=2,markerstrokewidth=0)"><pre>method<span class="pl-k">=</span><span class="pl-c1">SemiDiscretization</span>(<span class="pl-c1">4</span>,<span class="pl-c1">0.1</span>);
τmax<span class="pl-k">=</span><span class="pl-c1">1.</span>

<span class="pl-en">foo</span>(a,b) <span class="pl-k">=</span> <span class="pl-c1">log</span>(<span class="pl-c1">spectralRadiusOfMapping</span>(<span class="pl-c1">DiscreteMapping</span>(<span class="pl-c1">createHayesProblem</span>(a,b),method,τmax,
    n_steps<span class="pl-k">=</span><span class="pl-c1">1</span>))); <span class="pl-c"><span class="pl-c">#</span> No additive term calculated</span>

axis<span class="pl-k">=</span>[<span class="pl-c1">Axis</span>(<span class="pl-k">-</span><span class="pl-c1">15.0</span><span class="pl-k">:</span><span class="pl-c1">15.</span>,<span class="pl-c1">:a</span>),
    <span class="pl-c1">Axis</span>(<span class="pl-k">-</span><span class="pl-c1">15.0</span><span class="pl-k">:</span><span class="pl-c1">15.</span>,<span class="pl-c1">:b</span>)]

iteration<span class="pl-k">=</span><span class="pl-c1">3</span>;
stab_border_points<span class="pl-k">=</span><span class="pl-c1">getinterpolatedsolution</span>(<span class="pl-c1">solve!</span>(<span class="pl-c1">MDBM_Problem</span>(foo,axis),iteration));

<span class="pl-c1">scatter</span>(stab_border_points<span class="pl-k">...</span>,xlim<span class="pl-k">=</span>(<span class="pl-k">-</span><span class="pl-c1">15.</span>,<span class="pl-c1">15.</span>),ylim<span class="pl-k">=</span>(<span class="pl-k">-</span><span class="pl-c1">15.</span>,<span class="pl-c1">15.</span>),
    label<span class="pl-k">=</span><span class="pl-s"><span class="pl-pds">"</span><span class="pl-pds">"</span></span>,title<span class="pl-k">=</span><span class="pl-s"><span class="pl-pds">"</span>Stability border of the Hayes equation<span class="pl-pds">"</span></span>,xlabel<span class="pl-k">=</span><span class="pl-s"><span class="pl-pds"><span class="pl-c1">L</span>"</span>a<span class="pl-pds">"</span></span>,ylabel<span class="pl-k">=</span><span class="pl-s"><span class="pl-pds"><span class="pl-c1">L</span>"</span>b<span class="pl-pds">"</span></span>,
    guidefontsize<span class="pl-k">=</span><span class="pl-c1">14</span>,tickfont <span class="pl-k">=</span> <span class="pl-c1">font</span>(<span class="pl-c1">10</span>),markersize<span class="pl-k">=</span><span class="pl-c1">2</span>,markerstrokewidth<span class="pl-k">=</span><span class="pl-c1">0</span>)</pre></div>
<p dir="auto"><a target="_blank" rel="noopener noreferrer" href="./assets/HayesStability.png"><img src="./assets/HayesStability.png" alt="" style="max-width: 100%;"></a></p>
<h2 dir="auto">
<a id="user-content-delay-mathieu-equation" class="anchor" aria-hidden="true" href="#delay-mathieu-equation"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a>Delay Mathieu equation</h2>
<p dir="auto"><math-renderer class="js-display-math" style="display: block" data-static-url="https://github.githubassets.com/static" data-run-id="6a0ebcdbb76d8438df8687a3845f22ce">$$\ddot{x}(t) + a_1 \,\dot{x}(t)+(\delta + \varepsilon \cos(t))x(t)= b_0 \,x(t-2\pi) + \sin(2t)$$</math-renderer></p>

<p dir="auto">(Page 77 of the book referenced above)</p>
<div class="highlight highlight-source-julia notranslate position-relative overflow-auto" dir="auto" data-snippet-clipboard-copy-content="function createMathieuProblem(δ,ε,b0,a1;T=2π)
    AMx =  ProportionalMX(t-&gt;@SMatrix [0. 1.; -δ-ε*cos(2π/T*t) -a1]);
    τ1=2π # if function is needed, the use τ1 = t-&gt;foo(t)
    BMx1 = DelayMX(τ1,t-&gt;@SMatrix [0. 0.; b0 0.]);
    cVec = Additive(t-&gt;@SVector [0.,sin(4π/T*t)])
    LDDEProblem(AMx,[BMx1],cVec)
end;"><pre><span class="pl-k">function</span> <span class="pl-en">createMathieuProblem</span>(δ,ε,b0,a1;T<span class="pl-k">=</span><span class="pl-c1">2</span>π)
    AMx <span class="pl-k">=</span>  <span class="pl-c1">ProportionalMX</span>(t<span class="pl-k">-&gt;</span><span class="pl-c1">@SMatrix</span> [<span class="pl-c1">0.</span> <span class="pl-c1">1.</span>; <span class="pl-k">-</span>δ<span class="pl-k">-</span>ε<span class="pl-k">*</span><span class="pl-c1">cos</span>(<span class="pl-c1">2</span>π<span class="pl-k">/</span>T<span class="pl-k">*</span>t) <span class="pl-k">-</span>a1]);
    τ1<span class="pl-k">=</span><span class="pl-c1">2</span>π <span class="pl-c"><span class="pl-c">#</span> if function is needed, the use τ1 = t-&gt;foo(t)</span>
    BMx1 <span class="pl-k">=</span> <span class="pl-c1">DelayMX</span>(τ1,t<span class="pl-k">-&gt;</span><span class="pl-c1">@SMatrix</span> [<span class="pl-c1">0.</span> <span class="pl-c1">0.</span>; b0 <span class="pl-c1">0.</span>]);
    cVec <span class="pl-k">=</span> <span class="pl-c1">Additive</span>(t<span class="pl-k">-&gt;</span><span class="pl-c1">@SVector</span> [<span class="pl-c1">0.</span>,<span class="pl-c1">sin</span>(<span class="pl-c1">4</span>π<span class="pl-k">/</span>T<span class="pl-k">*</span>t)])
    <span class="pl-c1">LDDEProblem</span>(AMx,[BMx1],cVec)
<span class="pl-k">end</span>;</pre></div>
<div class="highlight highlight-source-julia notranslate position-relative overflow-auto" dir="auto" data-snippet-clipboard-copy-content="τmax=2π # the largest τ of the system
P=2π #Principle period of the system (sin(t)=sin(t+P)) 
mathieu_lddep=createMathieuProblem(3.,2.,-0.15,0.1,T=P); # LDDE problem for Hayes equation
method=SemiDiscretization(1,0.01) # 1st order semi discretization with Δt=0.01
# if P = τmax, then n_steps is automatically calculated
mapping=DiscreteMapping(mathieu_lddep,method,τmax,
    n_steps=Int((P+100eps(P))÷method.Δt),calculate_additive=true); #The discrete mapping of the system

@show spectralRadiusOfMapping(mapping); # spectral radius ρ of the mapping matrix (ρ&gt;1 unstable, ρ&lt;1 stable)
# spectralRadiusOfMapping(mapping) = 0.5131596340374617
fp=fixPointOfMapping(mapping); # stationary solution of the hayes equation (equilibrium position)

# fixPointOfMapping plotted
plot(0.0:method.Δt:P,fp[1:2:end],
    xlabel=L&quot;-s&quot;,title=L&quot;t \in [nP,(n+1)P],\quad n \to \infty&quot;,guidefontsize=14,linewidth=3,
    label=L&quot;x(t-s)&quot;,legendfontsize=11,tickfont = font(10))
plot!(0.0:method.Δt:P,fp[2:2:end],
    xlabel=L&quot;-s&quot;,linewidth=3,
    label=L&quot;\dot{x}(t-s)&quot;)
plot!(0.0:method.Δt:P,sin.(2*(0.0:method.Δt:P)),linewidth=3,label=L&quot;\sin(2t)&quot;)"><pre>τmax<span class="pl-k">=</span><span class="pl-c1">2</span>π <span class="pl-c"><span class="pl-c">#</span> the largest τ of the system</span>
P<span class="pl-k">=</span><span class="pl-c1">2</span>π <span class="pl-c"><span class="pl-c">#</span>Principle period of the system (sin(t)=sin(t+P)) </span>
mathieu_lddep<span class="pl-k">=</span><span class="pl-c1">createMathieuProblem</span>(<span class="pl-c1">3.</span>,<span class="pl-c1">2.</span>,<span class="pl-k">-</span><span class="pl-c1">0.15</span>,<span class="pl-c1">0.1</span>,T<span class="pl-k">=</span>P); <span class="pl-c"><span class="pl-c">#</span> LDDE problem for Hayes equation</span>
method<span class="pl-k">=</span><span class="pl-c1">SemiDiscretization</span>(<span class="pl-c1">1</span>,<span class="pl-c1">0.01</span>) <span class="pl-c"><span class="pl-c">#</span> 1st order semi discretization with Δt=0.01</span>
<span class="pl-c"><span class="pl-c">#</span> if P = τmax, then n_steps is automatically calculated</span>
mapping<span class="pl-k">=</span><span class="pl-c1">DiscreteMapping</span>(mathieu_lddep,method,τmax,
    n_steps<span class="pl-k">=</span><span class="pl-c1">Int</span>((P<span class="pl-k">+</span><span class="pl-c1">100</span><span class="pl-c1">eps</span>(P))<span class="pl-k">÷</span>method<span class="pl-k">.</span>Δt),calculate_additive<span class="pl-k">=</span><span class="pl-c1">true</span>); <span class="pl-c"><span class="pl-c">#</span>The discrete mapping of the system</span>

<span class="pl-c1">@show</span> <span class="pl-c1">spectralRadiusOfMapping</span>(mapping); <span class="pl-c"><span class="pl-c">#</span> spectral radius ρ of the mapping matrix (ρ&gt;1 unstable, ρ&lt;1 stable)</span>
<span class="pl-c"><span class="pl-c">#</span> spectralRadiusOfMapping(mapping) = 0.5131596340374617</span>
fp<span class="pl-k">=</span><span class="pl-c1">fixPointOfMapping</span>(mapping); <span class="pl-c"><span class="pl-c">#</span> stationary solution of the hayes equation (equilibrium position)</span>

<span class="pl-c"><span class="pl-c">#</span> fixPointOfMapping plotted</span>
<span class="pl-c1">plot</span>(<span class="pl-c1">0.0</span><span class="pl-k">:</span>method<span class="pl-k">.</span>Δt<span class="pl-k">:</span>P,fp[<span class="pl-c1">1</span><span class="pl-k">:</span><span class="pl-c1">2</span><span class="pl-k">:</span><span class="pl-c1">end</span>],
    xlabel<span class="pl-k">=</span><span class="pl-s"><span class="pl-pds"><span class="pl-c1">L</span>"</span>-s<span class="pl-pds">"</span></span>,title<span class="pl-k">=</span><span class="pl-s"><span class="pl-pds"><span class="pl-c1">L</span>"</span>t <span class="pl-cce">\i</span>n [nP,(n+1)P],<span class="pl-cce">\q</span>uad n <span class="pl-cce">\t</span>o <span class="pl-cce">\i</span>nfty<span class="pl-pds">"</span></span>,guidefontsize<span class="pl-k">=</span><span class="pl-c1">14</span>,linewidth<span class="pl-k">=</span><span class="pl-c1">3</span>,
    label<span class="pl-k">=</span><span class="pl-s"><span class="pl-pds"><span class="pl-c1">L</span>"</span>x(t-s)<span class="pl-pds">"</span></span>,legendfontsize<span class="pl-k">=</span><span class="pl-c1">11</span>,tickfont <span class="pl-k">=</span> <span class="pl-c1">font</span>(<span class="pl-c1">10</span>))
<span class="pl-c1">plot!</span>(<span class="pl-c1">0.0</span><span class="pl-k">:</span>method<span class="pl-k">.</span>Δt<span class="pl-k">:</span>P,fp[<span class="pl-c1">2</span><span class="pl-k">:</span><span class="pl-c1">2</span><span class="pl-k">:</span><span class="pl-c1">end</span>],
    xlabel<span class="pl-k">=</span><span class="pl-s"><span class="pl-pds"><span class="pl-c1">L</span>"</span>-s<span class="pl-pds">"</span></span>,linewidth<span class="pl-k">=</span><span class="pl-c1">3</span>,
    label<span class="pl-k">=</span><span class="pl-s"><span class="pl-pds"><span class="pl-c1">L</span>"</span><span class="pl-cce">\d</span>ot{x}(t-s)<span class="pl-pds">"</span></span>)
<span class="pl-c1">plot!</span>(<span class="pl-c1">0.0</span><span class="pl-k">:</span>method<span class="pl-k">.</span>Δt<span class="pl-k">:</span>P,<span class="pl-c1">sin</span>.(<span class="pl-c1">2</span><span class="pl-k">*</span>(<span class="pl-c1">0.0</span><span class="pl-k">:</span>method<span class="pl-k">.</span>Δt<span class="pl-k">:</span>P)),linewidth<span class="pl-k">=</span><span class="pl-c1">3</span>,label<span class="pl-k">=</span><span class="pl-s"><span class="pl-pds"><span class="pl-c1">L</span>"</span><span class="pl-cce">\s</span>in(2t)<span class="pl-pds">"</span></span>)</pre></div>
<p dir="auto"><a target="_blank" rel="noopener noreferrer" href="./assets/MathieuStationary.png"><img src="./assets/MathieuStationary.png" alt="" style="max-width: 100%;"></a></p>
<h3 dir="auto">
<a id="user-content-stability-chart-of-the-delayed-mathieu-equation" class="anchor" aria-hidden="true" href="#stability-chart-of-the-delayed-mathieu-equation"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a>Stability Chart of the delayed Mathieu equation</h3>
<div class="highlight highlight-source-julia notranslate position-relative overflow-auto" dir="auto" data-snippet-clipboard-copy-content="a1=0.1;
ε=1;
τmax=2π;
T=1π;
method=SemiDiscretization(2,T/40);

foo(δ,b0) = log(spectralRadiusOfMapping(DiscreteMapping(createMathieuProblem(δ,ε,b0,a1,T=T),method,τmax,
    n_steps=Int((T+100eps(T))÷method.Δt)))); # No additive term calculated

axis=[Axis(-1:0.2:5.,:δ),
    Axis(-2:0.2:1.5,:b0)]"><pre>a1<span class="pl-k">=</span><span class="pl-c1">0.1</span>;
ε<span class="pl-k">=</span><span class="pl-c1">1</span>;
τmax<span class="pl-k">=</span><span class="pl-c1">2</span>π;
T<span class="pl-k">=</span><span class="pl-c1">1</span>π;
method<span class="pl-k">=</span><span class="pl-c1">SemiDiscretization</span>(<span class="pl-c1">2</span>,T<span class="pl-k">/</span><span class="pl-c1">40</span>);

<span class="pl-en">foo</span>(δ,b0) <span class="pl-k">=</span> <span class="pl-c1">log</span>(<span class="pl-c1">spectralRadiusOfMapping</span>(<span class="pl-c1">DiscreteMapping</span>(<span class="pl-c1">createMathieuProblem</span>(δ,ε,b0,a1,T<span class="pl-k">=</span>T),method,τmax,
    n_steps<span class="pl-k">=</span><span class="pl-c1">Int</span>((T<span class="pl-k">+</span><span class="pl-c1">100</span><span class="pl-c1">eps</span>(T))<span class="pl-k">÷</span>method<span class="pl-k">.</span>Δt)))); <span class="pl-c"><span class="pl-c">#</span> No additive term calculated</span>

axis<span class="pl-k">=</span>[<span class="pl-c1">Axis</span>(<span class="pl-k">-</span><span class="pl-c1">1</span><span class="pl-k">:</span><span class="pl-c1">0.2</span><span class="pl-k">:</span><span class="pl-c1">5.</span>,<span class="pl-c1">:δ</span>),
    <span class="pl-c1">Axis</span>(<span class="pl-k">-</span><span class="pl-c1">2</span><span class="pl-k">:</span><span class="pl-c1">0.2</span><span class="pl-k">:</span><span class="pl-c1">1.5</span>,<span class="pl-c1">:b0</span>)]</pre></div>
<div class="highlight highlight-source-julia notranslate position-relative overflow-auto" dir="auto" data-snippet-clipboard-copy-content="iteration=3;
stab_border_points=getinterpolatedsolution(solve!(MDBM_Problem(foo,axis),iteration));

scatter(stab_border_points...,xlim=(-1.,5),ylim=(-2.,1.5),
    label=&quot;&quot;,title=&quot;Stability border of the delay Mathieu equation&quot;,xlabel=L&quot;\delta&quot;,ylabel=L&quot;b_0&quot;,
    guidefontsize=14,tickfont = font(10),markersize=2,markerstrokewidth=0)"><pre>iteration<span class="pl-k">=</span><span class="pl-c1">3</span>;
stab_border_points<span class="pl-k">=</span><span class="pl-c1">getinterpolatedsolution</span>(<span class="pl-c1">solve!</span>(<span class="pl-c1">MDBM_Problem</span>(foo,axis),iteration));

<span class="pl-c1">scatter</span>(stab_border_points<span class="pl-k">...</span>,xlim<span class="pl-k">=</span>(<span class="pl-k">-</span><span class="pl-c1">1.</span>,<span class="pl-c1">5</span>),ylim<span class="pl-k">=</span>(<span class="pl-k">-</span><span class="pl-c1">2.</span>,<span class="pl-c1">1.5</span>),
    label<span class="pl-k">=</span><span class="pl-s"><span class="pl-pds">"</span><span class="pl-pds">"</span></span>,title<span class="pl-k">=</span><span class="pl-s"><span class="pl-pds">"</span>Stability border of the delay Mathieu equation<span class="pl-pds">"</span></span>,xlabel<span class="pl-k">=</span><span class="pl-s"><span class="pl-pds"><span class="pl-c1">L</span>"</span><span class="pl-cce">\d</span>elta<span class="pl-pds">"</span></span>,ylabel<span class="pl-k">=</span><span class="pl-s"><span class="pl-pds"><span class="pl-c1">L</span>"</span>b_0<span class="pl-pds">"</span></span>,
    guidefontsize<span class="pl-k">=</span><span class="pl-c1">14</span>,tickfont <span class="pl-k">=</span> <span class="pl-c1">font</span>(<span class="pl-c1">10</span>),markersize<span class="pl-k">=</span><span class="pl-c1">2</span>,markerstrokewidth<span class="pl-k">=</span><span class="pl-c1">0</span>)</pre></div>
<p dir="auto"><a target="_blank" rel="noopener noreferrer" href="./assets/MathieuStability.png"><img src="./assets/MathieuStability.png" alt="" style="max-width: 100%;"></a></p>
</article></div>