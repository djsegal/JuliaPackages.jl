<div id="readme" class="md" data-path="README.md"><article class="markdown-body entry-content container-lg" itemprop="text"><p><strong><a href="#quickstart">Quickstart</a></strong> |
<strong><a href="#configure-the-etcd-server">Configure the Etcd server</a></strong> |
<strong><a href="#using-etcd-client">Using Etcd Client</a></strong></p>
<h1><a id="user-content-etcdjl" class="anchor" aria-hidden="true" href="#etcdjl"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>Etcd.jl</h1>
<p>A Julia <a href="https://github.com/coreos/etcd">Etcd</a> client implementation.</p>
<h2><a id="user-content-quickstart" class="anchor" aria-hidden="true" href="#quickstart"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>Quickstart</h2>
<div class="highlight highlight-source-julia"><pre>julia<span class="pl-k">&gt;</span> Pkg<span class="pl-k">.</span><span class="pl-c1">add</span>(<span class="pl-s"><span class="pl-pds">"</span>Etcd<span class="pl-pds">"</span></span>)
julia<span class="pl-k">&gt;</span> <span class="pl-k">using</span> Etcd</pre></div>
<h3><a id="user-content-configure-the-etcd-server" class="anchor" aria-hidden="true" href="#configure-the-etcd-server"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>Configure the Etcd server</h3>
<p>The library defaults to Etcd server at 127.0.0.1:4001.</p>
<div class="highlight highlight-source-julia"><pre>server <span class="pl-k">=</span> Etcd<span class="pl-k">.</span><span class="pl-c1">EtcdServer</span>()
<span class="pl-c1">EtcdServer</span>(<span class="pl-s"><span class="pl-pds">"</span>127.0.0.1<span class="pl-pds">"</span></span>,<span class="pl-c1">4001</span>,<span class="pl-s"><span class="pl-pds">"</span>v2<span class="pl-pds">"</span></span>)</pre></div>
<p>Or you can specify the server ip address and port number.</p>
<div class="highlight highlight-source-julia"><pre>server <span class="pl-k">=</span> Etcd<span class="pl-k">.</span><span class="pl-c1">EtcdServer</span>(<span class="pl-s"><span class="pl-pds">"</span>172.17.42.1<span class="pl-pds">"</span></span>,<span class="pl-c1">5001</span>)
<span class="pl-c1">EtcdServer</span>(<span class="pl-s"><span class="pl-pds">"</span>172.17.42.1<span class="pl-pds">"</span></span>,<span class="pl-c1">5001</span>,<span class="pl-s"><span class="pl-pds">"</span>v2<span class="pl-pds">"</span></span>)</pre></div>
<h3><a id="user-content-using-etcd-client" class="anchor" aria-hidden="true" href="#using-etcd-client"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>Using Etcd Client</h3>
<h4><a id="user-content-setting-key-values" class="anchor" aria-hidden="true" href="#setting-key-values"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>Setting Key Values</h4>
<div class="highlight highlight-source-julia"><pre>etcd <span class="pl-k">=</span> Etcd<span class="pl-k">.</span><span class="pl-c1">EtcdServer</span>()
<span class="pl-c1">EtcdServer</span>(<span class="pl-s"><span class="pl-pds">"</span>127.0.0.1<span class="pl-pds">"</span></span>,<span class="pl-c1">4001</span>,<span class="pl-s"><span class="pl-pds">"</span>v2<span class="pl-pds">"</span></span>)</pre></div>
<p>Set a value on the <code>/foo/bar</code> key:</p>
<div class="highlight highlight-source-julia"><pre>julia<span class="pl-k">&gt;</span> Etcd<span class="pl-k">.</span><span class="pl-c1">set</span>(etcd,<span class="pl-s"><span class="pl-pds">"</span>/foo/bar<span class="pl-pds">"</span></span>,<span class="pl-s"><span class="pl-pds">"</span>Hello World<span class="pl-pds">"</span></span>)
[<span class="pl-s"><span class="pl-pds">"</span>action<span class="pl-pds">"</span></span><span class="pl-k">=&gt;</span><span class="pl-s"><span class="pl-pds">"</span>set<span class="pl-pds">"</span></span>,<span class="pl-s"><span class="pl-pds">"</span>node<span class="pl-pds">"</span></span><span class="pl-k">=&gt;</span>[<span class="pl-s"><span class="pl-pds">"</span>createdIndex<span class="pl-pds">"</span></span><span class="pl-k">=&gt;</span><span class="pl-c1">1803</span>,<span class="pl-s"><span class="pl-pds">"</span>key<span class="pl-pds">"</span></span><span class="pl-k">=&gt;</span><span class="pl-s"><span class="pl-pds">"</span>/foo/bar<span class="pl-pds">"</span></span>,<span class="pl-s"><span class="pl-pds">"</span>value<span class="pl-pds">"</span></span><span class="pl-k">=&gt;</span><span class="pl-s"><span class="pl-pds">"</span>Hello World<span class="pl-pds">"</span></span>,<span class="pl-s"><span class="pl-pds">"</span>modifiedIndex<span class="pl-pds">"</span></span><span class="pl-k">=&gt;</span><span class="pl-c1">1803</span>]]</pre></div>
<p>Set a value on the <code>/foo/bar</code> key with a value that expires in 60 seconds:</p>
<div class="highlight highlight-source-julia"><pre>julia<span class="pl-k">&gt;</span> Etcd<span class="pl-k">.</span><span class="pl-c1">set</span>(etcd,<span class="pl-s"><span class="pl-pds">"</span>/foo/bar<span class="pl-pds">"</span></span>,<span class="pl-s"><span class="pl-pds">"</span>Hello World<span class="pl-pds">"</span></span>,ttl<span class="pl-k">=</span><span class="pl-c1">60</span>)
[<span class="pl-s"><span class="pl-pds">"</span>action<span class="pl-pds">"</span></span><span class="pl-k">=&gt;</span><span class="pl-s"><span class="pl-pds">"</span>set<span class="pl-pds">"</span></span>,<span class="pl-s"><span class="pl-pds">"</span>node<span class="pl-pds">"</span></span><span class="pl-k">=&gt;</span>[<span class="pl-s"><span class="pl-pds">"</span>createdIndex<span class="pl-pds">"</span></span><span class="pl-k">=&gt;</span><span class="pl-c1">1805</span>,<span class="pl-s"><span class="pl-pds">"</span>key<span class="pl-pds">"</span></span><span class="pl-k">=&gt;</span><span class="pl-s"><span class="pl-pds">"</span>/foo/bar<span class="pl-pds">"</span></span>,<span class="pl-s"><span class="pl-pds">"</span>value<span class="pl-pds">"</span></span><span class="pl-k">=&gt;</span><span class="pl-s"><span class="pl-pds">"</span>Hello World<span class="pl-pds">"</span></span>,<span class="pl-s"><span class="pl-pds">"</span>expiration<span class="pl-pds">"</span></span><span class="pl-k">=&gt;</span><span class="pl-s"><span class="pl-pds">"</span>2014-03-25T01:19:39.182867998Z<span class="pl-pds">"</span></span>,<span class="pl-s"><span class="pl-pds">"</span>ttl<span class="pl-pds">"</span></span><span class="pl-k">=&gt;</span><span class="pl-c1">60</span>,<span class="pl-s"><span class="pl-pds">"</span>modifiedIndex<span class="pl-pds">"</span></span><span class="pl-k">=&gt;</span><span class="pl-c1">1805</span>]]</pre></div>
<p>Note that the ttl value can be set with all the following commands by specifying <code>ttl=ttl_expiry_time_in_seconds</code></p>
<p>Conditionally set a value on <code>/foo/bar</code> if the previous value was "Hello world". <code>test_and_set</code> is an alias for <code>compare_and_swap</code>.</p>
<div class="highlight highlight-source-julia"><pre>julia<span class="pl-k">&gt;</span> Etcd<span class="pl-k">.</span><span class="pl-c1">compare_and_swap</span>(etcd,<span class="pl-s"><span class="pl-pds">"</span>/foo/bar<span class="pl-pds">"</span></span>,<span class="pl-s"><span class="pl-pds">"</span>Goodbye Cruel World<span class="pl-pds">"</span></span>,prev_value<span class="pl-k">=</span><span class="pl-s"><span class="pl-pds">"</span>Hello World<span class="pl-pds">"</span></span>)
[<span class="pl-s"><span class="pl-pds">"</span>action<span class="pl-pds">"</span></span><span class="pl-k">=&gt;</span><span class="pl-s"><span class="pl-pds">"</span>compareAndSwap<span class="pl-pds">"</span></span>,<span class="pl-s"><span class="pl-pds">"</span>prevNode<span class="pl-pds">"</span></span><span class="pl-k">=&gt;</span>[<span class="pl-s"><span class="pl-pds">"</span>createdIndex<span class="pl-pds">"</span></span><span class="pl-k">=&gt;</span><span class="pl-c1">1811</span>,<span class="pl-s"><span class="pl-pds">"</span>key<span class="pl-pds">"</span></span><span class="pl-k">=&gt;</span><span class="pl-s"><span class="pl-pds">"</span>/foo/bar<span class="pl-pds">"</span></span>,<span class="pl-s"><span class="pl-pds">"</span>value<span class="pl-pds">"</span></span><span class="pl-k">=&gt;</span><span class="pl-s"><span class="pl-pds">"</span>Hello World<span class="pl-pds">"</span></span>,<span class="pl-s"><span class="pl-pds">"</span>modifiedIndex<span class="pl-pds">"</span></span><span class="pl-k">=&gt;</span><span class="pl-c1">1811</span>],<span class="pl-s"><span class="pl-pds">"</span>node<span class="pl-pds">"</span></span><span class="pl-k">=&gt;</span>[<span class="pl-s"><span class="pl-pds">"</span>createdIndex<span class="pl-pds">"</span></span><span class="pl-k">=&gt;</span><span class="pl-c1">1811</span>,<span class="pl-s"><span class="pl-pds">"</span>key<span class="pl-pds">"</span></span><span class="pl-k">=&gt;</span><span class="pl-s"><span class="pl-pds">"</span>/foo/bar<span class="pl-pds">"</span></span>,<span class="pl-s"><span class="pl-pds">"</span>value<span class="pl-pds">"</span></span><span class="pl-k">=&gt;</span><span class="pl-s"><span class="pl-pds">"</span>Goodbye Cruel World<span class="pl-pds">"</span></span>,<span class="pl-s"><span class="pl-pds">"</span>modifiedIndex<span class="pl-pds">"</span></span><span class="pl-k">=&gt;</span><span class="pl-c1">1812</span>]]</pre></div>
<p>You can also conditionally set a value based on the previous etcd index.
Conditionally set a value on <code>/foo/bar</code> if the previous etcd index was 1818:</p>
<div class="highlight highlight-source-julia"><pre>julia<span class="pl-k">&gt;</span> Etcd<span class="pl-k">.</span><span class="pl-c1">compare_and_swap</span>(etcd,<span class="pl-s"><span class="pl-pds">"</span>/foo/bar<span class="pl-pds">"</span></span>,<span class="pl-s"><span class="pl-pds">"</span>Goodbye Cruel World<span class="pl-pds">"</span></span>,prev_index<span class="pl-k">=</span><span class="pl-c1">1818</span>)
[<span class="pl-s"><span class="pl-pds">"</span>action<span class="pl-pds">"</span></span><span class="pl-k">=&gt;</span><span class="pl-s"><span class="pl-pds">"</span>compareAndSwap<span class="pl-pds">"</span></span>,<span class="pl-s"><span class="pl-pds">"</span>prevNode<span class="pl-pds">"</span></span><span class="pl-k">=&gt;</span>[<span class="pl-s"><span class="pl-pds">"</span>createdIndex<span class="pl-pds">"</span></span><span class="pl-k">=&gt;</span><span class="pl-c1">1818</span>,<span class="pl-s"><span class="pl-pds">"</span>key<span class="pl-pds">"</span></span><span class="pl-k">=&gt;</span><span class="pl-s"><span class="pl-pds">"</span>/foo/bar<span class="pl-pds">"</span></span>,<span class="pl-s"><span class="pl-pds">"</span>value<span class="pl-pds">"</span></span><span class="pl-k">=&gt;</span><span class="pl-s"><span class="pl-pds">"</span>Hello World<span class="pl-pds">"</span></span>,<span class="pl-s"><span class="pl-pds">"</span>modifiedIndex<span class="pl-pds">"</span></span><span class="pl-k">=&gt;</span><span class="pl-c1">1818</span>],<span class="pl-s"><span class="pl-pds">"</span>node<span class="pl-pds">"</span></span><span class="pl-k">=&gt;</span>[<span class="pl-s"><span class="pl-pds">"</span>createdIndex<span class="pl-pds">"</span></span><span class="pl-k">=&gt;</span><span class="pl-c1">1818</span>,<span class="pl-s"><span class="pl-pds">"</span>key<span class="pl-pds">"</span></span><span class="pl-k">=&gt;</span><span class="pl-s"><span class="pl-pds">"</span>/foo/bar<span class="pl-pds">"</span></span>,<span class="pl-s"><span class="pl-pds">"</span>value<span class="pl-pds">"</span></span><span class="pl-k">=&gt;</span><span class="pl-s"><span class="pl-pds">"</span>Goodbye Cruel World<span class="pl-pds">"</span></span>,<span class="pl-s"><span class="pl-pds">"</span>modifiedIndex<span class="pl-pds">"</span></span><span class="pl-k">=&gt;</span><span class="pl-c1">1820</span>]]</pre></div>
<p>Create a new key <code>/foo/boo</code>, only if the key did not previously exist:</p>
<div class="highlight highlight-source-julia"><pre>julia<span class="pl-k">&gt;</span> Etcd<span class="pl-k">.</span><span class="pl-c1">create</span>(etcd,<span class="pl-s"><span class="pl-pds">"</span>/foo/boo<span class="pl-pds">"</span></span>,<span class="pl-s"><span class="pl-pds">"</span>Hello World<span class="pl-pds">"</span></span>)
[<span class="pl-s"><span class="pl-pds">"</span>action<span class="pl-pds">"</span></span><span class="pl-k">=&gt;</span><span class="pl-s"><span class="pl-pds">"</span>create<span class="pl-pds">"</span></span>,<span class="pl-s"><span class="pl-pds">"</span>node<span class="pl-pds">"</span></span><span class="pl-k">=&gt;</span>[<span class="pl-s"><span class="pl-pds">"</span>createdIndex<span class="pl-pds">"</span></span><span class="pl-k">=&gt;</span><span class="pl-c1">1822</span>,<span class="pl-s"><span class="pl-pds">"</span>key<span class="pl-pds">"</span></span><span class="pl-k">=&gt;</span><span class="pl-s"><span class="pl-pds">"</span>/foo/boo<span class="pl-pds">"</span></span>,<span class="pl-s"><span class="pl-pds">"</span>value<span class="pl-pds">"</span></span><span class="pl-k">=&gt;</span><span class="pl-s"><span class="pl-pds">"</span>Hello World<span class="pl-pds">"</span></span>,<span class="pl-s"><span class="pl-pds">"</span>modifiedIndex<span class="pl-pds">"</span></span><span class="pl-k">=&gt;</span><span class="pl-c1">1822</span>]]</pre></div>
<p>Create a new dir <code>/fooDir</code>, only if the directory did not previously exist:</p>
<div class="highlight highlight-source-julia"><pre>julia<span class="pl-k">&gt;</span> Etcd<span class="pl-k">.</span><span class="pl-c1">create_dir</span>(etcd,<span class="pl-s"><span class="pl-pds">"</span>/fooDir<span class="pl-pds">"</span></span>)
[<span class="pl-s"><span class="pl-pds">"</span>action<span class="pl-pds">"</span></span><span class="pl-k">=&gt;</span><span class="pl-s"><span class="pl-pds">"</span>create<span class="pl-pds">"</span></span>,<span class="pl-s"><span class="pl-pds">"</span>node<span class="pl-pds">"</span></span><span class="pl-k">=&gt;</span>[<span class="pl-s"><span class="pl-pds">"</span>createdIndex<span class="pl-pds">"</span></span><span class="pl-k">=&gt;</span><span class="pl-c1">1826</span>,<span class="pl-s"><span class="pl-pds">"</span>key<span class="pl-pds">"</span></span><span class="pl-k">=&gt;</span><span class="pl-s"><span class="pl-pds">"</span>/fooDir<span class="pl-pds">"</span></span>,<span class="pl-s"><span class="pl-pds">"</span>dir<span class="pl-pds">"</span></span><span class="pl-k">=&gt;</span><span class="pl-c1">true</span>,<span class="pl-s"><span class="pl-pds">"</span>modifiedIndex<span class="pl-pds">"</span></span><span class="pl-k">=&gt;</span><span class="pl-c1">1826</span>]]</pre></div>
<p>Update an existing key <code>/foo/bar</code>, only if the key already existed:</p>
<div class="highlight highlight-source-julia"><pre>julia<span class="pl-k">&gt;</span> Etcd<span class="pl-k">.</span><span class="pl-c1">update</span>(etcd,<span class="pl-s"><span class="pl-pds">"</span>/foo/boo<span class="pl-pds">"</span></span>,<span class="pl-s"><span class="pl-pds">"</span>Merhaba<span class="pl-pds">"</span></span>)
[<span class="pl-s"><span class="pl-pds">"</span>action<span class="pl-pds">"</span></span><span class="pl-k">=&gt;</span><span class="pl-s"><span class="pl-pds">"</span>update<span class="pl-pds">"</span></span>,<span class="pl-s"><span class="pl-pds">"</span>prevNode<span class="pl-pds">"</span></span><span class="pl-k">=&gt;</span>[<span class="pl-s"><span class="pl-pds">"</span>createdIndex<span class="pl-pds">"</span></span><span class="pl-k">=&gt;</span><span class="pl-c1">1822</span>,<span class="pl-s"><span class="pl-pds">"</span>key<span class="pl-pds">"</span></span><span class="pl-k">=&gt;</span><span class="pl-s"><span class="pl-pds">"</span>/foo/boo<span class="pl-pds">"</span></span>,<span class="pl-s"><span class="pl-pds">"</span>value<span class="pl-pds">"</span></span><span class="pl-k">=&gt;</span><span class="pl-s"><span class="pl-pds">"</span>Hello World<span class="pl-pds">"</span></span>,<span class="pl-s"><span class="pl-pds">"</span>modifiedIndex<span class="pl-pds">"</span></span><span class="pl-k">=&gt;</span><span class="pl-c1">1822</span>],<span class="pl-s"><span class="pl-pds">"</span>node<span class="pl-pds">"</span></span><span class="pl-k">=&gt;</span>[<span class="pl-s"><span class="pl-pds">"</span>createdIndex<span class="pl-pds">"</span></span><span class="pl-k">=&gt;</span><span class="pl-c1">1822</span>,<span class="pl-s"><span class="pl-pds">"</span>key<span class="pl-pds">"</span></span><span class="pl-k">=&gt;</span><span class="pl-s"><span class="pl-pds">"</span>/foo/boo<span class="pl-pds">"</span></span>,<span class="pl-s"><span class="pl-pds">"</span>value<span class="pl-pds">"</span></span><span class="pl-k">=&gt;</span><span class="pl-s"><span class="pl-pds">"</span>Merhaba<span class="pl-pds">"</span></span>,<span class="pl-s"><span class="pl-pds">"</span>modifiedIndex<span class="pl-pds">"</span></span><span class="pl-k">=&gt;</span><span class="pl-c1">1828</span>]]</pre></div>
<p>You can also Create (<code>create_dir</code>) or update (<code>update_dir</code>) a directory.</p>
<h4><a id="user-content-retrieving-key-values" class="anchor" aria-hidden="true" href="#retrieving-key-values"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>Retrieving key values</h4>
<p>Get the current value for a single key in the local etcd node:</p>
<div class="highlight highlight-source-julia"><pre>julia<span class="pl-k">&gt;</span> Etcd<span class="pl-k">.</span><span class="pl-c1">get</span>(etcd,<span class="pl-s"><span class="pl-pds">"</span>/foo/bar<span class="pl-pds">"</span></span>)
[<span class="pl-s"><span class="pl-pds">"</span>action<span class="pl-pds">"</span></span><span class="pl-k">=&gt;</span><span class="pl-s"><span class="pl-pds">"</span>get<span class="pl-pds">"</span></span>,<span class="pl-s"><span class="pl-pds">"</span>node<span class="pl-pds">"</span></span><span class="pl-k">=&gt;</span>[<span class="pl-s"><span class="pl-pds">"</span>createdIndex<span class="pl-pds">"</span></span><span class="pl-k">=&gt;</span><span class="pl-c1">1817</span>,<span class="pl-s"><span class="pl-pds">"</span>key<span class="pl-pds">"</span></span><span class="pl-k">=&gt;</span><span class="pl-s"><span class="pl-pds">"</span>/foo/bar<span class="pl-pds">"</span></span>,<span class="pl-s"><span class="pl-pds">"</span>value<span class="pl-pds">"</span></span><span class="pl-k">=&gt;</span><span class="pl-s"><span class="pl-pds">"</span>Hello World<span class="pl-pds">"</span></span>,<span class="pl-s"><span class="pl-pds">"</span>modifiedIndex<span class="pl-pds">"</span></span><span class="pl-k">=&gt;</span><span class="pl-c1">1817</span>]]</pre></div>
<p>Add <code>recursive=true</code> to recursively list sub-directories.</p>
<p>Check for existence of a key:</p>
<div class="highlight highlight-source-julia"><pre>julia<span class="pl-k">&gt;</span> Etcd<span class="pl-k">.</span><span class="pl-c1">exists</span>(etcd,<span class="pl-s"><span class="pl-pds">"</span>/foo/bar<span class="pl-pds">"</span></span>)
<span class="pl-c1">true</span></pre></div>
<h4><a id="user-content-deleting-keys" class="anchor" aria-hidden="true" href="#deleting-keys"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>Deleting keys</h4>
<p>Delete a key:</p>
<div class="highlight highlight-source-julia"><pre>julia<span class="pl-k">&gt;</span> Etcd<span class="pl-k">.</span><span class="pl-c1">create_dir</span>(etcd,<span class="pl-s"><span class="pl-pds">"</span>/foo/qux<span class="pl-pds">"</span></span>)
julia<span class="pl-k">&gt;</span> Etcd<span class="pl-k">.</span><span class="pl-c1">delete</span>(etcd,<span class="pl-s"><span class="pl-pds">"</span>/foo/boo<span class="pl-pds">"</span></span>)
[<span class="pl-s"><span class="pl-pds">"</span>action<span class="pl-pds">"</span></span><span class="pl-k">=&gt;</span><span class="pl-s"><span class="pl-pds">"</span>delete<span class="pl-pds">"</span></span>,<span class="pl-s"><span class="pl-pds">"</span>prevNode<span class="pl-pds">"</span></span><span class="pl-k">=&gt;</span>[<span class="pl-s"><span class="pl-pds">"</span>createdIndex<span class="pl-pds">"</span></span><span class="pl-k">=&gt;</span><span class="pl-c1">1822</span>,<span class="pl-s"><span class="pl-pds">"</span>key<span class="pl-pds">"</span></span><span class="pl-k">=&gt;</span><span class="pl-s"><span class="pl-pds">"</span>/foo/boo<span class="pl-pds">"</span></span>,<span class="pl-s"><span class="pl-pds">"</span>value<span class="pl-pds">"</span></span><span class="pl-k">=&gt;</span><span class="pl-s"><span class="pl-pds">"</span>Merhaba<span class="pl-pds">"</span></span>,<span class="pl-s"><span class="pl-pds">"</span>modifiedIndex<span class="pl-pds">"</span></span><span class="pl-k">=&gt;</span><span class="pl-c1">1828</span>],<span class="pl-s"><span class="pl-pds">"</span>node<span class="pl-pds">"</span></span><span class="pl-k">=&gt;</span>[<span class="pl-s"><span class="pl-pds">"</span>createdIndex<span class="pl-pds">"</span></span><span class="pl-k">=&gt;</span><span class="pl-c1">1822</span>,<span class="pl-s"><span class="pl-pds">"</span>key<span class="pl-pds">"</span></span><span class="pl-k">=&gt;</span><span class="pl-s"><span class="pl-pds">"</span>/foo/boo<span class="pl-pds">"</span></span>,<span class="pl-s"><span class="pl-pds">"</span>modifiedIndex<span class="pl-pds">"</span></span><span class="pl-k">=&gt;</span><span class="pl-c1">1837</span>]]</pre></div>
<p>Delete an empty directory:</p>
<div class="highlight highlight-source-julia"><pre>julia<span class="pl-k">&gt;</span> Etcd<span class="pl-k">.</span><span class="pl-c1">delete_dir</span>(etcd,<span class="pl-s"><span class="pl-pds">"</span>/foo/qux<span class="pl-pds">"</span></span>)
[<span class="pl-s"><span class="pl-pds">"</span>action<span class="pl-pds">"</span></span><span class="pl-k">=&gt;</span><span class="pl-s"><span class="pl-pds">"</span>delete<span class="pl-pds">"</span></span>,<span class="pl-s"><span class="pl-pds">"</span>prevNode<span class="pl-pds">"</span></span><span class="pl-k">=&gt;</span>[<span class="pl-s"><span class="pl-pds">"</span>createdIndex<span class="pl-pds">"</span></span><span class="pl-k">=&gt;</span><span class="pl-c1">1838</span>,<span class="pl-s"><span class="pl-pds">"</span>key<span class="pl-pds">"</span></span><span class="pl-k">=&gt;</span><span class="pl-s"><span class="pl-pds">"</span>/foo/qux<span class="pl-pds">"</span></span>,<span class="pl-s"><span class="pl-pds">"</span>dir<span class="pl-pds">"</span></span><span class="pl-k">=&gt;</span><span class="pl-c1">true</span>,<span class="pl-s"><span class="pl-pds">"</span>modifiedIndex<span class="pl-pds">"</span></span><span class="pl-k">=&gt;</span><span class="pl-c1">1838</span>],<span class="pl-s"><span class="pl-pds">"</span>node<span class="pl-pds">"</span></span><span class="pl-k">=&gt;</span>[<span class="pl-s"><span class="pl-pds">"</span>createdIndex<span class="pl-pds">"</span></span><span class="pl-k">=&gt;</span><span class="pl-c1">1838</span>,<span class="pl-s"><span class="pl-pds">"</span>key<span class="pl-pds">"</span></span><span class="pl-k">=&gt;</span><span class="pl-s"><span class="pl-pds">"</span>/foo/qux<span class="pl-pds">"</span></span>,<span class="pl-s"><span class="pl-pds">"</span>dir<span class="pl-pds">"</span></span><span class="pl-k">=&gt;</span><span class="pl-c1">true</span>,<span class="pl-s"><span class="pl-pds">"</span>modifiedIndex<span class="pl-pds">"</span></span><span class="pl-k">=&gt;</span><span class="pl-c1">1839</span>]] </pre></div>
<p>Recursively delete a key and all child keys:</p>
<div class="highlight highlight-source-julia"><pre>julia<span class="pl-k">&gt;</span> Etcd<span class="pl-k">.</span><span class="pl-c1">get</span>(etcd,<span class="pl-s"><span class="pl-pds">"</span>/foo<span class="pl-pds">"</span></span>,recursive<span class="pl-k">=</span><span class="pl-c1">true</span>)
[<span class="pl-s"><span class="pl-pds">"</span>action<span class="pl-pds">"</span></span><span class="pl-k">=&gt;</span><span class="pl-s"><span class="pl-pds">"</span>get<span class="pl-pds">"</span></span>,<span class="pl-s"><span class="pl-pds">"</span>node<span class="pl-pds">"</span></span><span class="pl-k">=&gt;</span>[<span class="pl-s"><span class="pl-pds">"</span>nodes<span class="pl-pds">"</span></span><span class="pl-k">=&gt;</span>{[<span class="pl-s"><span class="pl-pds">"</span>createdIndex<span class="pl-pds">"</span></span><span class="pl-k">=&gt;</span><span class="pl-c1">1817</span>,<span class="pl-s"><span class="pl-pds">"</span>key<span class="pl-pds">"</span></span><span class="pl-k">=&gt;</span><span class="pl-s"><span class="pl-pds">"</span>/foo/bar<span class="pl-pds">"</span></span>,<span class="pl-s"><span class="pl-pds">"</span>value<span class="pl-pds">"</span></span><span class="pl-k">=&gt;</span><span class="pl-s"><span class="pl-pds">"</span>Hello World<span class="pl-pds">"</span></span>,<span class="pl-s"><span class="pl-pds">"</span>modifiedIndex<span class="pl-pds">"</span></span><span class="pl-k">=&gt;</span><span class="pl-c1">1817</span>],[<span class="pl-s"><span class="pl-pds">"</span>createdIndex<span class="pl-pds">"</span></span><span class="pl-k">=&gt;</span><span class="pl-c1">1818</span>,<span class="pl-s"><span class="pl-pds">"</span>key<span class="pl-pds">"</span></span><span class="pl-k">=&gt;</span><span class="pl-s"><span class="pl-pds">"</span>/foo/baz<span class="pl-pds">"</span></span>,<span class="pl-s"><span class="pl-pds">"</span>value<span class="pl-pds">"</span></span><span class="pl-k">=&gt;</span><span class="pl-s"><span class="pl-pds">"</span>Goodbye Cruel World<span class="pl-pds">"</span></span>,<span class="pl-s"><span class="pl-pds">"</span>modifiedIndex<span class="pl-pds">"</span></span><span class="pl-k">=&gt;</span><span class="pl-c1">1820</span>]},<span class="pl-s"><span class="pl-pds">"</span>createdIndex<span class="pl-pds">"</span></span><span class="pl-k">=&gt;</span><span class="pl-c1">1803</span>,<span class="pl-s"><span class="pl-pds">"</span>key<span class="pl-pds">"</span></span><span class="pl-k">=&gt;</span><span class="pl-s"><span class="pl-pds">"</span>/foo<span class="pl-pds">"</span></span>,<span class="pl-s"><span class="pl-pds">"</span>dir<span class="pl-pds">"</span></span><span class="pl-k">=&gt;</span><span class="pl-c1">true</span>,<span class="pl-s"><span class="pl-pds">"</span>modifiedIndex<span class="pl-pds">"</span></span><span class="pl-k">=&gt;</span><span class="pl-c1">1803</span>]]
ulia<span class="pl-k">&gt;</span> Etcd<span class="pl-k">.</span><span class="pl-c1">delete_dir</span>(etcd,<span class="pl-s"><span class="pl-pds">"</span>/foo<span class="pl-pds">"</span></span>,recursive<span class="pl-k">=</span><span class="pl-c1">true</span>)
[<span class="pl-s"><span class="pl-pds">"</span>action<span class="pl-pds">"</span></span><span class="pl-k">=&gt;</span><span class="pl-s"><span class="pl-pds">"</span>delete<span class="pl-pds">"</span></span>,<span class="pl-s"><span class="pl-pds">"</span>prevNode<span class="pl-pds">"</span></span><span class="pl-k">=&gt;</span>[<span class="pl-s"><span class="pl-pds">"</span>createdIndex<span class="pl-pds">"</span></span><span class="pl-k">=&gt;</span><span class="pl-c1">1803</span>,<span class="pl-s"><span class="pl-pds">"</span>key<span class="pl-pds">"</span></span><span class="pl-k">=&gt;</span><span class="pl-s"><span class="pl-pds">"</span>/foo<span class="pl-pds">"</span></span>,<span class="pl-s"><span class="pl-pds">"</span>dir<span class="pl-pds">"</span></span><span class="pl-k">=&gt;</span><span class="pl-c1">true</span>,<span class="pl-s"><span class="pl-pds">"</span>modifiedIndex<span class="pl-pds">"</span></span><span class="pl-k">=&gt;</span><span class="pl-c1">1803</span>],<span class="pl-s"><span class="pl-pds">"</span>node<span class="pl-pds">"</span></span><span class="pl-k">=&gt;</span>[<span class="pl-s"><span class="pl-pds">"</span>createdIndex<span class="pl-pds">"</span></span><span class="pl-k">=&gt;</span><span class="pl-c1">1803</span>,<span class="pl-s"><span class="pl-pds">"</span>key<span class="pl-pds">"</span></span><span class="pl-k">=&gt;</span><span class="pl-s"><span class="pl-pds">"</span>/foo<span class="pl-pds">"</span></span>,<span class="pl-s"><span class="pl-pds">"</span>dir<span class="pl-pds">"</span></span><span class="pl-k">=&gt;</span><span class="pl-c1">true</span>,<span class="pl-s"><span class="pl-pds">"</span>modifiedIndex<span class="pl-pds">"</span></span><span class="pl-k">=&gt;</span><span class="pl-c1">1844</span>]]
julia<span class="pl-k">&gt;</span> Etcd<span class="pl-k">.</span><span class="pl-c1">get</span>(etcd,<span class="pl-s"><span class="pl-pds">"</span>/foo<span class="pl-pds">"</span></span>,recursive<span class="pl-k">=</span><span class="pl-c1">true</span>)
[<span class="pl-s"><span class="pl-pds">"</span>message<span class="pl-pds">"</span></span><span class="pl-k">=&gt;</span><span class="pl-s"><span class="pl-pds">"</span>Key not found<span class="pl-pds">"</span></span>,<span class="pl-s"><span class="pl-pds">"</span>cause<span class="pl-pds">"</span></span><span class="pl-k">=&gt;</span><span class="pl-s"><span class="pl-pds">"</span>/foo<span class="pl-pds">"</span></span>,<span class="pl-s"><span class="pl-pds">"</span>index<span class="pl-pds">"</span></span><span class="pl-k">=&gt;</span><span class="pl-c1">1844</span>,<span class="pl-s"><span class="pl-pds">"</span>errorCode<span class="pl-pds">"</span></span><span class="pl-k">=&gt;</span><span class="pl-c1">100</span>]</pre></div>
<p>Conditionally delete <code>/foo/bar</code> if the previous value was "Hello world":</p>
<div class="highlight highlight-source-julia"><pre>julia<span class="pl-k">&gt;</span> Etcd<span class="pl-k">.</span><span class="pl-c1">create</span>(etcd,<span class="pl-s"><span class="pl-pds">"</span>/foo/bar<span class="pl-pds">"</span></span>,<span class="pl-s"><span class="pl-pds">"</span>bar value<span class="pl-pds">"</span></span>)
[<span class="pl-s"><span class="pl-pds">"</span>action<span class="pl-pds">"</span></span><span class="pl-k">=&gt;</span><span class="pl-s"><span class="pl-pds">"</span>create<span class="pl-pds">"</span></span>,<span class="pl-s"><span class="pl-pds">"</span>node<span class="pl-pds">"</span></span><span class="pl-k">=&gt;</span>[<span class="pl-s"><span class="pl-pds">"</span>createdIndex<span class="pl-pds">"</span></span><span class="pl-k">=&gt;</span><span class="pl-c1">1845</span>,<span class="pl-s"><span class="pl-pds">"</span>key<span class="pl-pds">"</span></span><span class="pl-k">=&gt;</span><span class="pl-s"><span class="pl-pds">"</span>/foo/bar<span class="pl-pds">"</span></span>,<span class="pl-s"><span class="pl-pds">"</span>value<span class="pl-pds">"</span></span><span class="pl-k">=&gt;</span><span class="pl-s"><span class="pl-pds">"</span>bar value<span class="pl-pds">"</span></span>,<span class="pl-s"><span class="pl-pds">"</span>modifiedIndex<span class="pl-pds">"</span></span><span class="pl-k">=&gt;</span><span class="pl-c1">1845</span>]]
julia<span class="pl-k">&gt;</span> Etcd<span class="pl-k">.</span><span class="pl-c1">compare_and_delete</span>(etcd,<span class="pl-s"><span class="pl-pds">"</span>/foo/bar<span class="pl-pds">"</span></span>,prev_value<span class="pl-k">=</span><span class="pl-s"><span class="pl-pds">"</span>bar value<span class="pl-pds">"</span></span>)
[<span class="pl-s"><span class="pl-pds">"</span>action<span class="pl-pds">"</span></span><span class="pl-k">=&gt;</span><span class="pl-s"><span class="pl-pds">"</span>compareAndDelete<span class="pl-pds">"</span></span>,<span class="pl-s"><span class="pl-pds">"</span>prevNode<span class="pl-pds">"</span></span><span class="pl-k">=&gt;</span>[<span class="pl-s"><span class="pl-pds">"</span>createdIndex<span class="pl-pds">"</span></span><span class="pl-k">=&gt;</span><span class="pl-c1">1845</span>,<span class="pl-s"><span class="pl-pds">"</span>key<span class="pl-pds">"</span></span><span class="pl-k">=&gt;</span><span class="pl-s"><span class="pl-pds">"</span>/foo/bar<span class="pl-pds">"</span></span>,<span class="pl-s"><span class="pl-pds">"</span>value<span class="pl-pds">"</span></span><span class="pl-k">=&gt;</span><span class="pl-s"><span class="pl-pds">"</span>bar value<span class="pl-pds">"</span></span>,<span class="pl-s"><span class="pl-pds">"</span>modifiedIndex<span class="pl-pds">"</span></span><span class="pl-k">=&gt;</span><span class="pl-c1">1845</span>],<span class="pl-s"><span class="pl-pds">"</span>node<span class="pl-pds">"</span></span><span class="pl-k">=&gt;</span>[<span class="pl-s"><span class="pl-pds">"</span>createdIndex<span class="pl-pds">"</span></span><span class="pl-k">=&gt;</span><span class="pl-c1">1845</span>,<span class="pl-s"><span class="pl-pds">"</span>key<span class="pl-pds">"</span></span><span class="pl-k">=&gt;</span><span class="pl-s"><span class="pl-pds">"</span>/foo/bar<span class="pl-pds">"</span></span>,<span class="pl-s"><span class="pl-pds">"</span>modifiedIndex<span class="pl-pds">"</span></span><span class="pl-k">=&gt;</span><span class="pl-c1">1846</span>]]</pre></div>
<p>Conditionally delete <code>/foo/bar</code> if the previous etcd index was 1849:</p>
<div class="highlight highlight-source-julia"><pre>julia<span class="pl-k">&gt;</span> Etcd<span class="pl-k">.</span><span class="pl-c1">create</span>(etl,<span class="pl-s"><span class="pl-pds">"</span>/foo/bar<span class="pl-pds">"</span></span>,<span class="pl-s"><span class="pl-pds">"</span>Hello World<span class="pl-pds">"</span></span>)
[<span class="pl-s"><span class="pl-pds">"</span>action<span class="pl-pds">"</span></span><span class="pl-k">=&gt;</span><span class="pl-s"><span class="pl-pds">"</span>create<span class="pl-pds">"</span></span>,<span class="pl-s"><span class="pl-pds">"</span>node<span class="pl-pds">"</span></span><span class="pl-k">=&gt;</span>[<span class="pl-s"><span class="pl-pds">"</span>createdIndex<span class="pl-pds">"</span></span><span class="pl-k">=&gt;</span><span class="pl-c1">1849</span>,<span class="pl-s"><span class="pl-pds">"</span>key<span class="pl-pds">"</span></span><span class="pl-k">=&gt;</span><span class="pl-s"><span class="pl-pds">"</span>/foo/bar<span class="pl-pds">"</span></span>,<span class="pl-s"><span class="pl-pds">"</span>value<span class="pl-pds">"</span></span><span class="pl-k">=&gt;</span><span class="pl-s"><span class="pl-pds">"</span>Hello World<span class="pl-pds">"</span></span>,<span class="pl-s"><span class="pl-pds">"</span>modifiedIndex<span class="pl-pds">"</span></span><span class="pl-k">=&gt;</span><span class="pl-c1">1849</span>]]
julia<span class="pl-k">&gt;</span> Etcd<span class="pl-k">.</span><span class="pl-c1">compare_and_delete</span>(etl,<span class="pl-s"><span class="pl-pds">"</span>/foo/bar<span class="pl-pds">"</span></span>,prev_index<span class="pl-k">=</span><span class="pl-c1">1849</span>)
[<span class="pl-s"><span class="pl-pds">"</span>action<span class="pl-pds">"</span></span><span class="pl-k">=&gt;</span><span class="pl-s"><span class="pl-pds">"</span>compareAndDelete<span class="pl-pds">"</span></span>,<span class="pl-s"><span class="pl-pds">"</span>prevNode<span class="pl-pds">"</span></span><span class="pl-k">=&gt;</span>[<span class="pl-s"><span class="pl-pds">"</span>createdIndex<span class="pl-pds">"</span></span><span class="pl-k">=&gt;</span><span class="pl-c1">1849</span>,<span class="pl-s"><span class="pl-pds">"</span>key<span class="pl-pds">"</span></span><span class="pl-k">=&gt;</span><span class="pl-s"><span class="pl-pds">"</span>/foo/bar<span class="pl-pds">"</span></span>,<span class="pl-s"><span class="pl-pds">"</span>value<span class="pl-pds">"</span></span><span class="pl-k">=&gt;</span><span class="pl-s"><span class="pl-pds">"</span>Hello World<span class="pl-pds">"</span></span>,<span class="pl-s"><span class="pl-pds">"</span>modifiedIndex<span class="pl-pds">"</span></span><span class="pl-k">=&gt;</span><span class="pl-c1">1849</span>],<span class="pl-s"><span class="pl-pds">"</span>node<span class="pl-pds">"</span></span><span class="pl-k">=&gt;</span>[<span class="pl-s"><span class="pl-pds">"</span>createdIndex<span class="pl-pds">"</span></span><span class="pl-k">=&gt;</span><span class="pl-c1">1849</span>,<span class="pl-s"><span class="pl-pds">"</span>key<span class="pl-pds">"</span></span><span class="pl-k">=&gt;</span><span class="pl-s"><span class="pl-pds">"</span>/foo/bar<span class="pl-pds">"</span></span>,<span class="pl-s"><span class="pl-pds">"</span>modifiedIndex<span class="pl-pds">"</span></span><span class="pl-k">=&gt;</span><span class="pl-c1">1850</span>]]</pre></div>
<h4><a id="user-content-watching-for-changes" class="anchor" aria-hidden="true" href="#watching-for-changes"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>Watching for changes</h4>
<p>Watch for only the next change on a key:</p>
<div class="highlight highlight-source-julia"><pre>julia<span class="pl-k">&gt;</span> Etcd<span class="pl-k">.</span><span class="pl-c1">watch</span>(etcd,<span class="pl-s"><span class="pl-pds">"</span>/foo/bar<span class="pl-pds">"</span></span>,ev<span class="pl-k">-&gt;</span><span class="pl-c1">println</span>(<span class="pl-s"><span class="pl-pds">"</span>I'm watching you:<span class="pl-pds">"</span></span>,ev))
Task (queued) @<span class="pl-c1">0x00000000024b65f0</span>
<span class="pl-k">...</span>
<span class="pl-k">...</span> next make some modification to <span class="pl-s"><span class="pl-pds">"</span>/foo/bar<span class="pl-pds">"</span></span> key and the callback is then called<span class="pl-k">:</span>
<span class="pl-k">...</span>
I<span class="pl-k">'</span>m watching you<span class="pl-k">:</span>[<span class="pl-s"><span class="pl-pds">"</span>action<span class="pl-pds">"</span></span><span class="pl-k">=&gt;</span><span class="pl-s"><span class="pl-pds">"</span>update<span class="pl-pds">"</span></span>,<span class="pl-s"><span class="pl-pds">"</span>prevNode<span class="pl-pds">"</span></span><span class="pl-k">=&gt;</span>[<span class="pl-s"><span class="pl-pds">"</span>createdIndex<span class="pl-pds">"</span></span><span class="pl-k">=&gt;</span><span class="pl-c1">1851</span>,<span class="pl-s"><span class="pl-pds">"</span>key<span class="pl-pds">"</span></span><span class="pl-k">=&gt;</span><span class="pl-s"><span class="pl-pds">"</span>/foo/bar<span class="pl-pds">"</span></span>,<span class="pl-s"><span class="pl-pds">"</span>value<span class="pl-pds">"</span></span><span class="pl-k">=&gt;</span><span class="pl-s"><span class="pl-pds">"</span>Hello World<span class="pl-pds">"</span></span>,<span class="pl-s"><span class="pl-pds">"</span>modifiedIndex<span class="pl-pds">"</span></span><span class="pl-k">=&gt;</span><span class="pl-c1">1851</span>],<span class="pl-s"><span class="pl-pds">"</span>node<span class="pl-pds">"</span></span><span class="pl-k">=&gt;</span>[<span class="pl-s"><span class="pl-pds">"</span>createdIndex<span class="pl-pds">"</span></span><span class="pl-k">=&gt;</span><span class="pl-c1">1851</span>,<span class="pl-s"><span class="pl-pds">"</span>key<span class="pl-pds">"</span></span><span class="pl-k">=&gt;</span><span class="pl-s"><span class="pl-pds">"</span>/foo/bar<span class="pl-pds">"</span></span>,<span class="pl-s"><span class="pl-pds">"</span>value<span class="pl-pds">"</span></span><span class="pl-k">=&gt;</span><span class="pl-s"><span class="pl-pds">"</span>Who's watching the watchers<span class="pl-pds">"</span></span>,<span class="pl-s"><span class="pl-pds">"</span>modifiedIndex<span class="pl-pds">"</span></span><span class="pl-k">=&gt;</span><span class="pl-c1">1852</span>]]</pre></div>
<p>You can also specify the following options:</p>
<ul>
<li><code>recursive=true</code> to watch the key and all it's children.</li>
<li><code>wait_index</code> to watch starting with the provided index.</li>
</ul>
<p>Continuously watch a key:</p>
<div class="highlight highlight-source-julia"><pre>julia<span class="pl-k">&gt;</span> Etcd<span class="pl-k">.</span><span class="pl-c1">keep_watching</span>(etcd,<span class="pl-s"><span class="pl-pds">"</span>/foo/bar<span class="pl-pds">"</span></span>,ev<span class="pl-k">-&gt;</span><span class="pl-c1">println</span>(<span class="pl-s"><span class="pl-pds">"</span>I'll keep on watching you:<span class="pl-pds">"</span></span>,ev))
<span class="pl-k">....</span> The callback will keep getting called <span class="pl-k">for</span> every change to the key</pre></div>
<p>Watch conditionally, while passing a function which will terminate the watch when it evaluates to <code>true</code>, for example:</p>
<div class="highlight highlight-source-julia"><pre>julia<span class="pl-k">&gt;</span> Etcd<span class="pl-k">.</span><span class="pl-c1">watch_until</span>(etcd,<span class="pl-s"><span class="pl-pds">"</span>/foo<span class="pl-pds">"</span></span>,ev<span class="pl-k">-&gt;</span><span class="pl-c1">println</span>(<span class="pl-s"><span class="pl-pds">"</span>I'll be watching you (only 3 times):<span class="pl-pds">"</span></span>,ev),<span class="pl-k">begin</span> <span class="pl-k">let</span> l <span class="pl-k">=</span> <span class="pl-c1">0</span>; ev<span class="pl-k">-&gt;</span><span class="pl-k">begin</span> l <span class="pl-k">+=</span> <span class="pl-c1">1</span>; <span class="pl-k">if</span> l <span class="pl-k">&gt;</span> <span class="pl-c1">2</span> <span class="pl-c1">true</span> <span class="pl-k">else</span> <span class="pl-c1">false</span> <span class="pl-k">end</span> <span class="pl-k">end</span> <span class="pl-k">end</span> <span class="pl-k">end</span>,recursive<span class="pl-k">=</span><span class="pl-c1">true</span>)</pre></div>
<h4><a id="user-content-get-all-machines-in-the-cluster" class="anchor" aria-hidden="true" href="#get-all-machines-in-the-cluster"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>Get all machines in the cluster</h4>
<div class="highlight highlight-source-julia"><pre>julia<span class="pl-k">&gt;</span> Etcd<span class="pl-k">.</span><span class="pl-c1">machines</span>(etcd)
<span class="pl-s"><span class="pl-pds">"</span>http://172.17.42.1:5001, http://172.17.42.1:5002, http://172.17.42.1:5003<span class="pl-pds">"</span></span></pre></div>
<h4><a id="user-content-getting-etcd-stats" class="anchor" aria-hidden="true" href="#getting-etcd-stats"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>Getting Etcd stats</h4>
<p>You can retrieve Etcd stats by specifying one of <code>store</code>, <code>self</code> or <code>leader</code>.</p>
<p>For example to get the <code>store</code> stats:</p>
<div class="highlight highlight-source-julia"><pre>julia<span class="pl-k">&gt;</span> Etcd<span class="pl-k">.</span><span class="pl-c1">stats</span>(etcd,<span class="pl-s"><span class="pl-pds">"</span>store<span class="pl-pds">"</span></span>)
[<span class="pl-s"><span class="pl-pds">"</span>getsSuccess<span class="pl-pds">"</span></span><span class="pl-k">=&gt;</span><span class="pl-c1">193</span>,<span class="pl-s"><span class="pl-pds">"</span>updateFail<span class="pl-pds">"</span></span><span class="pl-k">=&gt;</span><span class="pl-c1">88</span>,<span class="pl-s"><span class="pl-pds">"</span>watchers<span class="pl-pds">"</span></span><span class="pl-k">=&gt;</span><span class="pl-c1">1</span>,<span class="pl-s"><span class="pl-pds">"</span>setsSuccess<span class="pl-pds">"</span></span><span class="pl-k">=&gt;</span><span class="pl-c1">710</span>,<span class="pl-s"><span class="pl-pds">"</span>setsFail<span class="pl-pds">"</span></span><span class="pl-k">=&gt;</span><span class="pl-c1">2869</span>,<span class="pl-s"><span class="pl-pds">"</span>expireCount<span class="pl-pds">"</span></span><span class="pl-k">=&gt;</span><span class="pl-c1">460</span>,<span class="pl-s"><span class="pl-pds">"</span>compareAndSwapSuccess<span class="pl-pds">"</span></span><span class="pl-k">=&gt;</span><span class="pl-c1">3</span>,<span class="pl-s"><span class="pl-pds">"</span>getsFail<span class="pl-pds">"</span></span><span class="pl-k">=&gt;</span><span class="pl-c1">10</span>,<span class="pl-s"><span class="pl-pds">"</span>deleteSuccess<span class="pl-pds">"</span></span><span class="pl-k">=&gt;</span><span class="pl-c1">8</span>,<span class="pl-s"><span class="pl-pds">"</span>createFail<span class="pl-pds">"</span></span><span class="pl-k">=&gt;</span><span class="pl-c1">10</span>,<span class="pl-s"><span class="pl-pds">"</span>createSuccess<span class="pl-pds">"</span></span><span class="pl-k">=&gt;</span><span class="pl-c1">25</span>,<span class="pl-s"><span class="pl-pds">"</span>compareAndDeleteSuccess<span class="pl-pds">"</span></span><span class="pl-k">=&gt;</span><span class="pl-c1">3</span>,<span class="pl-s"><span class="pl-pds">"</span>deleteFail<span class="pl-pds">"</span></span><span class="pl-k">=&gt;</span><span class="pl-c1">3</span>,<span class="pl-s"><span class="pl-pds">"</span>compareAndSwapFail<span class="pl-pds">"</span></span><span class="pl-k">=&gt;</span><span class="pl-c1">1</span>,<span class="pl-s"><span class="pl-pds">"</span>updateSuccess<span class="pl-pds">"</span></span><span class="pl-k">=&gt;</span><span class="pl-c1">386</span>,<span class="pl-s"><span class="pl-pds">"</span>compareAndDeleteFail<span class="pl-pds">"</span></span><span class="pl-k">=&gt;</span><span class="pl-c1">0</span>]</pre></div>
<h4><a id="user-content-leaderelection-module" class="anchor" aria-hidden="true" href="#leaderelection-module"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>Leader/Election module</h4>
<p>Set a leader for the cluster (notice the leading slash is omitted) by specifying a name and a ttl as follows:</p>
<div class="highlight highlight-source-julia"><pre>julia<span class="pl-k">&gt;</span> Etcd<span class="pl-k">.</span><span class="pl-c1">set_leader</span>(etcd,<span class="pl-s"><span class="pl-pds">"</span>my-cluster<span class="pl-pds">"</span></span>,name<span class="pl-k">=</span><span class="pl-s"><span class="pl-pds">"</span>leader-1<span class="pl-pds">"</span></span>,ttl<span class="pl-k">=</span><span class="pl-c1">60</span>)
<span class="pl-s"><span class="pl-pds">"</span>1853<span class="pl-pds">"</span></span></pre></div>
<p>Get the leader of the cluster:</p>
<div class="highlight highlight-source-julia"><pre>julia<span class="pl-k">&gt;</span> Etcd<span class="pl-k">.</span><span class="pl-c1">get_leader</span>(etcd,<span class="pl-s"><span class="pl-pds">"</span>my-cluster<span class="pl-pds">"</span></span>)
<span class="pl-s"><span class="pl-pds">"</span>leader-1<span class="pl-pds">"</span></span></pre></div>
<p>Deleting the leader:</p>
<div class="highlight highlight-source-julia"><pre>julia<span class="pl-k">&gt;</span> Etcd<span class="pl-k">.</span><span class="pl-c1">delete_leader</span>(etcd,<span class="pl-s"><span class="pl-pds">"</span>my-cluster<span class="pl-pds">"</span></span>,name<span class="pl-k">=</span><span class="pl-s"><span class="pl-pds">"</span>leader-1<span class="pl-pds">"</span></span>)
<span class="pl-s"><span class="pl-pds">"</span><span class="pl-pds">"</span></span></pre></div>
<h4><a id="user-content-locking-module" class="anchor" aria-hidden="true" href="#locking-module"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>Locking module</h4>
<p>The lock module can be used to provide a distributed lock for resources among multiple clients. Only one client can have access to the lock at a time, once the lock holder releases the lock the next client waiting for the lock can acquire it.</p>
<p><code>lock_retrieve</code> gets the lock index of the lock. <code>lock_acquire</code> is used to acquire the lock and it will return the lock index.</p>
<div class="highlight highlight-source-julia"><pre><span class="pl-k">...</span> another client acquires the lock
<span class="pl-k">$</span> curl <span class="pl-k">-</span>L http<span class="pl-k">:</span><span class="pl-k">//</span><span class="pl-c1">127.0.0.1</span><span class="pl-k">:</span><span class="pl-c1">4001</span><span class="pl-k">/</span>mod<span class="pl-k">/</span>v2<span class="pl-k">/</span>lock<span class="pl-k">/</span>mylock <span class="pl-k">-</span>XPOST <span class="pl-k">-</span>d ttl<span class="pl-k">=</span><span class="pl-c1">100</span>
<span class="pl-c1">1876</span>
julia<span class="pl-k">&gt;</span> Etcd<span class="pl-k">.</span><span class="pl-c1">lock_retrieve</span>(etcd,<span class="pl-s"><span class="pl-pds">"</span>mylock<span class="pl-pds">"</span></span>)
<span class="pl-s"><span class="pl-pds">"</span>1876<span class="pl-pds">"</span></span>
julia<span class="pl-k">&gt;</span> Etcd<span class="pl-k">.</span><span class="pl-c1">lock_acquire</span>(etcd,<span class="pl-s"><span class="pl-pds">"</span>mylock<span class="pl-pds">"</span></span>,ttl<span class="pl-k">=</span><span class="pl-c1">100</span>)
<span class="pl-k">...</span> blocks until ttl <span class="pl-k">for</span> lock expires or until lock is released <span class="pl-k">...</span>
<span class="pl-s"><span class="pl-pds">"</span>1878<span class="pl-pds">"</span></span></pre></div>
<p>You can also renew the lock:</p>
<div class="highlight highlight-source-julia"><pre>julia<span class="pl-k">&gt;</span> Etcd<span class="pl-k">.</span><span class="pl-c1">lock_renew</span>(etcd,<span class="pl-s"><span class="pl-pds">"</span>mylock<span class="pl-pds">"</span></span>,index<span class="pl-k">=</span><span class="pl-c1">1885</span>,ttl<span class="pl-k">=</span><span class="pl-c1">60</span>)</pre></div>
<p>And release the lock:</p>
<div class="highlight highlight-source-julia"><pre>julia<span class="pl-k">&gt;</span> Etcd<span class="pl-k">.</span><span class="pl-c1">lock_release</span>(etcd,<span class="pl-s"><span class="pl-pds">"</span>mylock<span class="pl-pds">"</span></span>,index<span class="pl-k">=</span><span class="pl-c1">1890</span>) </pre></div>
</article></div>