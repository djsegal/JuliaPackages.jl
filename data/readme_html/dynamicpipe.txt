<div id="readme" class="md" data-path="README.md"><article class="markdown-body entry-content container-lg" itemprop="text"><h1 dir="auto"><a id="user-content-readme" class="anchor" aria-hidden="true" href="#readme"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a>README</h1>
<p dir="auto">DynamicPipe is designed to best replicate magrittr's pipe operator, <code>%&gt;%</code>, from R in Julia. The below R code</p>
<div class="highlight highlight-source-r notranslate position-relative overflow-auto" dir="auto" data-snippet-clipboard-copy-content="library(tidyverse)

star_wars_summary &lt;- starwars %&gt;%
  group_by(species) %&gt;%
  summarise(N = n()
            ,mass = mean(mass, na.rm = TRUE)) %&gt;%
  filter(N &gt; 1
         ,mass &gt; 50) %&gt;% 
  mutate(proportion = N/sum(N)) %&gt;% 
  arrange(desc(proportion))"><pre>library(<span class="pl-smi">tidyverse</span>)

<span class="pl-smi">star_wars_summary</span> <span class="pl-k">&lt;-</span> <span class="pl-smi">starwars</span> %<span class="pl-k">&gt;</span>%
  group_by(<span class="pl-smi">species</span>) %<span class="pl-k">&gt;</span>%
  summarise(<span class="pl-v">N</span> <span class="pl-k">=</span> n()
            ,<span class="pl-v">mass</span> <span class="pl-k">=</span> mean(<span class="pl-smi">mass</span>, <span class="pl-v">na.rm</span> <span class="pl-k">=</span> <span class="pl-c1">TRUE</span>)) %<span class="pl-k">&gt;</span>%
  filter(<span class="pl-smi">N</span> <span class="pl-k">&gt;</span> <span class="pl-c1">1</span>
         ,<span class="pl-smi">mass</span> <span class="pl-k">&gt;</span> <span class="pl-c1">50</span>) %<span class="pl-k">&gt;</span>% 
  mutate(<span class="pl-v">proportion</span> <span class="pl-k">=</span> <span class="pl-smi">N</span><span class="pl-k">/</span>sum(<span class="pl-smi">N</span>)) %<span class="pl-k">&gt;</span>% 
  arrange(desc(<span class="pl-smi">proportion</span>))</pre></div>
<p dir="auto">is eqivelant to</p>
<div class="highlight highlight-source-julia notranslate position-relative overflow-auto" dir="auto" data-snippet-clipboard-copy-content="using DataFrames, DataFramesMeta, DynamicPipe, Statistics
# assuming the data is already loaded in

starwars_summary = starwars |&gt;
    @&gt;  groupby(:species) |&gt;
        @combine(N = length(:species)
                 ,mass = mean(:mass |&gt; skipmissing)) |&gt;
        @where(:N .&gt; 1
               ,:mass .&gt; 50) |&gt;
        @transform(proportion = :N ./ sum(:N)) |&gt;
        @orderby(-:proportion)"><pre><span class="pl-k">using</span> DataFrames, DataFramesMeta, DynamicPipe, Statistics
<span class="pl-c"><span class="pl-c">#</span> assuming the data is already loaded in</span>

starwars_summary <span class="pl-k">=</span> starwars <span class="pl-k">|&gt;</span>
    @<span class="pl-k">&gt;</span>  <span class="pl-c1">groupby</span>(<span class="pl-c1">:species</span>) <span class="pl-k">|&gt;</span>
        <span class="pl-c1">@combine</span>(N <span class="pl-k">=</span> <span class="pl-c1">length</span>(<span class="pl-c1">:species</span>)
                 ,mass <span class="pl-k">=</span> <span class="pl-c1">mean</span>(<span class="pl-c1">:mass</span> <span class="pl-k">|&gt;</span> skipmissing)) <span class="pl-k">|&gt;</span>
        <span class="pl-c1">@where</span>(<span class="pl-c1">:N</span> <span class="pl-k">.&gt;</span> <span class="pl-c1">1</span>
               ,<span class="pl-c1">:mass</span> <span class="pl-k">.&gt;</span> <span class="pl-c1">50</span>) <span class="pl-k">|&gt;</span>
        <span class="pl-c1">@transform</span>(proportion <span class="pl-k">=</span> <span class="pl-c1">:N</span> <span class="pl-k">./</span> <span class="pl-c1">sum</span>(<span class="pl-c1">:N</span>)) <span class="pl-k">|&gt;</span>
        <span class="pl-c1">@orderby</span>(<span class="pl-k">-</span><span class="pl-c1">:proportion</span>)</pre></div>
<p dir="auto">. Dynamic Pipes gives similar functionality to other Julia piping packages only it allows for continuos typing without the need to call a macro before you start writing the pipe. This means the user does not have to move the cursor back to the to the start of text they typed in order to pipe it into a function. This is achieved through the <code>@&gt;</code> macro.</p>
<h2 dir="auto"><a id="" class="anchor" aria-hidden="true" href="#"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a><code>@&gt;</code></h2>
<p dir="auto">This macro creates an anonymous function using similar rewriting rules as R's <code>%&gt;%</code>. The following rules apply to macros and functions.</p>
<ol dir="auto">
<li>Whatever is on the left of a <code>|&gt;</code> or <code>.|&gt;</code> is passed into the function of the right of the <code>|&gt;</code> or <code>.|&gt;</code>.</li>
<li>Underscores are used to represent the argument that is passed into the function. Hence <code>2 |&gt; @&gt; sqrt(_)</code> is equivalent to <code>2 |&gt; x -&gt; sqrt(x)</code> which is equivalent to <code>sqrt(2)</code>.</li>
<li>If there is no underscore then the argument is assumed the be the first argument of the function call. Hence, <code>2 |&gt; @&gt; +(2)</code> is equivalent to <code>+(2, 2)</code>. The following lines,
<div class="highlight highlight-source-julia notranslate position-relative overflow-auto" dir="auto" data-snippet-clipboard-copy-content="2 |&gt; 
    @&gt;  sqrt()
    
#and

2 |&gt;
    @&gt;  sqrt "><pre><span class="pl-c1">2</span> <span class="pl-k">|&gt;</span> 
    @<span class="pl-k">&gt;</span>  <span class="pl-c1">sqrt</span>()
    
<span class="pl-c"><span class="pl-c">#</span>and</span>

<span class="pl-c1">2</span> <span class="pl-k">|&gt;</span>
    @<span class="pl-k">&gt;</span>  sqrt </pre></div>
are both equivalent to <code>2 |&gt; x -&gt; sqrt(x)</code>.</li>
<li>Separate anonymous functions are created for expressions between <code>|&gt;</code> and <code>.|&gt;</code> with expression on the left piped into the expression on the right hence,
<div class="highlight highlight-source-julia notranslate position-relative overflow-auto" dir="auto" data-snippet-clipboard-copy-content="2 |&gt;
    @&gt;  _ + 2 |&gt;
        sqrt()"><pre><span class="pl-c1">2</span> <span class="pl-k">|&gt;</span>
    @<span class="pl-k">&gt;</span>  _ <span class="pl-k">+</span> <span class="pl-c1">2</span> <span class="pl-k">|&gt;</span>
        <span class="pl-c1">sqrt</span>()</pre></div>
is equivalent to
<div class="highlight highlight-source-julia notranslate position-relative overflow-auto" dir="auto" data-snippet-clipboard-copy-content="2 |&gt;
    x -&gt; x + 2 |&gt;
    x -&gt; sqrt(x)"><pre><span class="pl-c1">2</span> <span class="pl-k">|&gt;</span>
    x <span class="pl-k">-&gt;</span> x <span class="pl-k">+</span> <span class="pl-c1">2</span> <span class="pl-k">|&gt;</span>
    x <span class="pl-k">-&gt;</span> <span class="pl-c1">sqrt</span>(x)</pre></div>
and returns <code>2</code>.</li>
<li>The only macro that <code>@&gt;</code> doesn't act on is itself and <code>@&gt;&gt;</code>. This allows for pipes within pipes so
<div class="highlight highlight-source-julia notranslate position-relative overflow-auto" dir="auto" data-snippet-clipboard-copy-content="2 |&gt;
    @&gt;  [√1, √_, 3 |&gt; @&gt; √_] |&gt;
        sum()"><pre><span class="pl-c1">2</span> <span class="pl-k">|&gt;</span>
    @<span class="pl-k">&gt;</span>  [<span class="pl-k">√</span><span class="pl-c1">1</span>, <span class="pl-k">√</span>_, <span class="pl-c1">3</span> <span class="pl-k">|&gt;</span> @<span class="pl-k">&gt;</span> <span class="pl-k">√</span>_] <span class="pl-k">|&gt;</span>
        <span class="pl-c1">sum</span>()</pre></div>
is equivalent to
<div class="highlight highlight-source-julia notranslate position-relative overflow-auto" dir="auto" data-snippet-clipboard-copy-content="2 |&gt;
    x -&gt; [√1, √x, 3 |&gt; y -&gt; √y] |&gt;
    x -&gt; sum(x)"><pre><span class="pl-c1">2</span> <span class="pl-k">|&gt;</span>
    x <span class="pl-k">-&gt;</span> [<span class="pl-k">√</span><span class="pl-c1">1</span>, <span class="pl-k">√</span>x, <span class="pl-c1">3</span> <span class="pl-k">|&gt;</span> y <span class="pl-k">-&gt;</span> <span class="pl-k">√</span>y] <span class="pl-k">|&gt;</span>
    x <span class="pl-k">-&gt;</span> <span class="pl-c1">sum</span>(x)</pre></div>
</li>
<li>If the first element in a sequency of pipe charecters does not contain an underscore then a new pipe is formed. So
<div class="highlight highlight-source-julia notranslate position-relative overflow-auto" dir="auto" data-snippet-clipboard-copy-content="2 |&gt;
    @&gt;  [_, 3, 4 |&gt; _/2]"><pre><span class="pl-c1">2</span> <span class="pl-k">|&gt;</span>
    @<span class="pl-k">&gt;</span>  [_, <span class="pl-c1">3</span>, <span class="pl-c1">4</span> <span class="pl-k">|&gt;</span> _<span class="pl-k">/</span><span class="pl-c1">2</span>]</pre></div>
is equivalent to <code>[2, 3, 4/2]</code> not <code>[2, 3, 2/2]</code>.</li>
</ol>
<p dir="auto">Like <a href="https://github.com/jkrumbiegel/Chain.jl">Chain.jl</a> the <code>@&gt;</code> macro also supports <code>begin ... end</code> block syntax so you don't have to keep typing <code>|&gt;</code>. Hence,</p>
<div class="highlight highlight-source-julia notranslate position-relative overflow-auto" dir="auto" data-snippet-clipboard-copy-content="2 |&gt; 
    @&gt; begin
    _ + 2
    sqrt()
end"><pre><span class="pl-c1">2</span> <span class="pl-k">|&gt;</span> 
    @<span class="pl-k">&gt;</span> <span class="pl-k">begin</span>
    _ <span class="pl-k">+</span> <span class="pl-c1">2</span>
    <span class="pl-c1">sqrt</span>()
<span class="pl-k">end</span></pre></div>
<p dir="auto">is equivalent to</p>
<div class="highlight highlight-source-julia notranslate position-relative overflow-auto" dir="auto" data-snippet-clipboard-copy-content="2 |&gt; 
    @&gt;  _ + 2 |&gt;
        sqrt()"><pre><span class="pl-c1">2</span> <span class="pl-k">|&gt;</span> 
    @<span class="pl-k">&gt;</span>  _ <span class="pl-k">+</span> <span class="pl-c1">2</span> <span class="pl-k">|&gt;</span>
        <span class="pl-c1">sqrt</span>()</pre></div>
<p dir="auto">Begin end block syntax can only be used to define the outermost pipe so</p>
<div class="highlight highlight-source-julia notranslate position-relative overflow-auto" dir="auto" data-snippet-clipboard-copy-content="2 |&gt;
    @&gt; begin
        [_, 3, begin 
                4 
                _/2
            end]
    end"><pre><span class="pl-c1">2</span> <span class="pl-k">|&gt;</span>
    @<span class="pl-k">&gt;</span> <span class="pl-k">begin</span>
        [_, <span class="pl-c1">3</span>, <span class="pl-c1">begin</span> 
                <span class="pl-c1">4</span> 
                _<span class="pl-k">/</span><span class="pl-c1">2</span>
            <span class="pl-c1">end</span>]
    <span class="pl-k">end</span></pre></div>
<p dir="auto">is not equivalent to</p>
<div class="highlight highlight-source-julia notranslate position-relative overflow-auto" dir="auto" data-snippet-clipboard-copy-content="    2 |&gt;
        @&gt;  [_, 3, 4 |&gt; _/2]"><pre>    <span class="pl-c1">2</span> <span class="pl-k">|&gt;</span>
        @<span class="pl-k">&gt;</span>  [_, <span class="pl-c1">3</span>, <span class="pl-c1">4</span> <span class="pl-k">|&gt;</span> _<span class="pl-k">/</span><span class="pl-c1">2</span>]</pre></div>
<h2 dir="auto"><a id="user-content--1" class="anchor" aria-hidden="true" href="#-1"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a><code>@&gt;&gt;</code></h2>
<p dir="auto">The package also contains a <code>@&gt;&gt;</code> macro that follows most of the same rules as <code>@&gt;</code> only it is used at the beginning of pipes.</p>
<div class="highlight highlight-source-julia notranslate position-relative overflow-auto" dir="auto" data-snippet-clipboard-copy-content="@&gt;&gt; 2 |&gt;
    _ + 2 |&gt;
    sqrt()"><pre>@<span class="pl-k">&gt;&gt;</span> <span class="pl-c1">2</span> <span class="pl-k">|&gt;</span>
    _ <span class="pl-k">+</span> <span class="pl-c1">2</span> <span class="pl-k">|&gt;</span>
    <span class="pl-c1">sqrt</span>()</pre></div>
<p dir="auto">is equivalent to</p>
<div class="highlight highlight-source-julia notranslate position-relative overflow-auto" dir="auto" data-snippet-clipboard-copy-content="2 |&gt; 
    @&gt;  _ + 2 |&gt;
        sqrt()"><pre><span class="pl-c1">2</span> <span class="pl-k">|&gt;</span> 
    @<span class="pl-k">&gt;</span>  _ <span class="pl-k">+</span> <span class="pl-c1">2</span> <span class="pl-k">|&gt;</span>
        <span class="pl-c1">sqrt</span>()</pre></div>
<p dir="auto">. In order to allow pipes within pipes underscores are allowed in the first part of the pipe. Hence</p>
<div class="highlight highlight-source-julia notranslate position-relative overflow-auto" dir="auto" data-snippet-clipboard-copy-content="2 |&gt;
    @&gt;  [√1, √_, @&gt;&gt; _ |&gt; √(_ + 1)] |&gt;
        sum()"><pre><span class="pl-c1">2</span> <span class="pl-k">|&gt;</span>
    @<span class="pl-k">&gt;</span>  [<span class="pl-k">√</span><span class="pl-c1">1</span>, <span class="pl-k">√</span>_, @<span class="pl-k">&gt;&gt;</span> _ <span class="pl-k">|&gt;</span> <span class="pl-k">√</span>(_ <span class="pl-k">+</span> <span class="pl-c1">1</span>)] <span class="pl-k">|&gt;</span>
        <span class="pl-c1">sum</span>()</pre></div>
<p dir="auto">is equivalent to</p>
<div class="highlight highlight-source-julia notranslate position-relative overflow-auto" dir="auto" data-snippet-clipboard-copy-content="2 |&gt;
    x -&gt; [√1, √x, x |&gt; y -&gt; √(y + 1)] |&gt;
    x -&gt; sum(x)"><pre><span class="pl-c1">2</span> <span class="pl-k">|&gt;</span>
    x <span class="pl-k">-&gt;</span> [<span class="pl-k">√</span><span class="pl-c1">1</span>, <span class="pl-k">√</span>x, x <span class="pl-k">|&gt;</span> y <span class="pl-k">-&gt;</span> <span class="pl-k">√</span>(y <span class="pl-k">+</span> <span class="pl-c1">1</span>)] <span class="pl-k">|&gt;</span>
    x <span class="pl-k">-&gt;</span> <span class="pl-c1">sum</span>(x)</pre></div>
<p dir="auto">. <code>@&gt;&gt;</code> supports <code>begin ... end</code> block syntax in two ways. Both</p>
<div class="highlight highlight-source-julia notranslate position-relative overflow-auto" dir="auto" data-snippet-clipboard-copy-content="@&gt;&gt; 2 begin
    _ + 2 
    sqrt()
end"><pre>@<span class="pl-k">&gt;&gt;</span> <span class="pl-c1">2</span> <span class="pl-k">begin</span>
    _ <span class="pl-k">+</span> <span class="pl-c1">2</span> 
    <span class="pl-c1">sqrt</span>()
<span class="pl-k">end</span></pre></div>
<p dir="auto">and</p>
<div class="highlight highlight-source-julia notranslate position-relative overflow-auto" dir="auto" data-snippet-clipboard-copy-content="@&gt;&gt; begin
    2
    _ + 2 
    sqrt()
end"><pre>@<span class="pl-k">&gt;&gt;</span> <span class="pl-k">begin</span>
    <span class="pl-c1">2</span>
    _ <span class="pl-k">+</span> <span class="pl-c1">2</span> 
    <span class="pl-c1">sqrt</span>()
<span class="pl-k">end</span></pre></div>
<p dir="auto">are equivalent to</p>
<div class="highlight highlight-source-julia notranslate position-relative overflow-auto" dir="auto" data-snippet-clipboard-copy-content="2 |&gt;
    @&gt;  _ + 2 |&gt;
        sqrt()"><pre><span class="pl-c1">2</span> <span class="pl-k">|&gt;</span>
    @<span class="pl-k">&gt;</span>  _ <span class="pl-k">+</span> <span class="pl-c1">2</span> <span class="pl-k">|&gt;</span>
        <span class="pl-c1">sqrt</span>()</pre></div>
<p dir="auto">.</p>
</article></div>