<div id="readme" class="md" data-path="README.md"><article class="markdown-body entry-content container-lg" itemprop="text"><h1><a id="user-content-ns2d" class="anchor" aria-hidden="true" href="#ns2d"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>NS2D</h1>
<p><a target="_blank" rel="noopener noreferrer" href="https://camo.githubusercontent.com/0058ce9713cb93a553c2f23207afbb49b1b852a70a4a24de20e2e816c58b299e/68747470733a2f2f696d672e736869656c64732e696f2f62616467652f6c6966656379636c652d6578706572696d656e74616c2d6f72616e67652e737667"><img src="https://camo.githubusercontent.com/0058ce9713cb93a553c2f23207afbb49b1b852a70a4a24de20e2e816c58b299e/68747470733a2f2f696d672e736869656c64732e696f2f62616467652f6c6966656379636c652d6578706572696d656e74616c2d6f72616e67652e737667" alt="Lifecycle" data-canonical-src="https://img.shields.io/badge/lifecycle-experimental-orange.svg" style="max-width:100%;"></a>
<a href="https://travis-ci.com/loiseaujc/NS2D.jl" rel="nofollow"><img src="https://camo.githubusercontent.com/5d276a28fd86b658e691939114dca0a57570f30bfcbcb4793ddd1a28c2dbf275/68747470733a2f2f7472617669732d63692e636f6d2f6c6f69736561756a632f4e5332442e6a6c2e7376673f6272616e63683d6d6173746572" alt="Build Status" data-canonical-src="https://travis-ci.com/loiseaujc/NS2D.jl.svg?branch=master" style="max-width:100%;"></a>
<a href="https://ci.appveyor.com/project/loiseaujc/NS2D-jl" rel="nofollow"><img src="https://camo.githubusercontent.com/f4607343959229f11200b9b38937c8868e1a535c838970279cc30003ae4d4775/68747470733a2f2f63692e6170707665796f722e636f6d2f6170692f70726f6a656374732f7374617475732f6769746875622f6c6f69736561756a632f4e5332442e6a6c3f7376673d74727565" alt="Build Status" data-canonical-src="https://ci.appveyor.com/api/projects/status/github/loiseaujc/NS2D.jl?svg=true" style="max-width:100%;"></a>
<a href="https://codecov.io/gh/loiseaujc/NS2D.jl" rel="nofollow"><img src="https://camo.githubusercontent.com/69010bb82911333966a19ff701558fb8bd57d00b1905c950f99af32869ee0b49/68747470733a2f2f636f6465636f762e696f2f67682f6c6f69736561756a632f4e5332442e6a6c2f6272616e63682f6d61737465722f67726170682f62616467652e737667" alt="Coverage" data-canonical-src="https://codecov.io/gh/loiseaujc/NS2D.jl/branch/master/graph/badge.svg" style="max-width:100%;"></a></p>
<p><a target="_blank" rel="noopener noreferrer" href="imgs/anim_vorticity.gif"><img src="imgs/anim_vorticity.gif" alt="Julia flow" style="max-width:100%;"></a></p>
<h2><a id="user-content-overview" class="anchor" aria-hidden="true" href="#overview"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>Overview</h2>
<p>NS2D is a simple pseudo-spectral solver for the two-dimensional Navier-Stokes equations in a doubly periodic domain written in Julia.
Its aim is primarily to get myself familiar with the Julia ecosystem for scientific computing as well as illustrating how pseudo-spectral solvers work for my students.
If you nonetheless think that such a simple solver written in Julia could be beneficial for your research, please do not hesitate to use it, fork it and/or send pull requests !</p>
<h2><a id="user-content-method--capabilities" class="anchor" aria-hidden="true" href="#method--capabilities"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>Method / Capabilities</h2>
<p>NS2D solves the two-dimensional Navier-Stokes equations in a doubly-periodic domain using the vorticity-streamfunction formulation.
Most of the computation is performed in spectral space while the non-linear advection term is computed in physical space using standard techniques for dealiasing.
At its core, NS2D uses <a href="https://github.com/JuliaMath/FFTW.jl">FFTW.jl</a> with multi-threading and preallocated arrays for in-place fast Fourier transforms while time-integration is performed thanks to <a href="https://github.com/SciML/DifferentialEquations.jl">DifferentialEquations.jl</a>.</p>
<h2><a id="user-content-examples" class="anchor" aria-hidden="true" href="#examples"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>Examples</h2>
<p>Below is a list of canonical examples that can be simulate using NS2D.</p>
<h3><a id="user-content-taylor-green-vortices" class="anchor" aria-hidden="true" href="#taylor-green-vortices"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>Taylor-Green vortices</h3>
<p>In two dimensions, the <a href="https://en.wikipedia.org/wiki/Taylor%E2%80%93Green_vortex" rel="nofollow">Taylor-Green vortices</a> are one of the few analytic solutions to the incompressible Navier-Stokes we know of.
It is quite often used for testing and validation of the spatial and/or temporal accuracy of Navier-Stokes solvers.
The figure below shows the initial vorticity field (top panel) and the maximum pointwise error over time between the analytic solution and the one simulated using NS2D (bottom panel).</p>
<p><a target="_blank" rel="noopener noreferrer" href="imgs/taylor_green_vortices.png"><img src="imgs/taylor_green_vortices.png" alt="" style="max-width:100%;"></a><a target="_blank" rel="noopener noreferrer" href="imgs/taylor_green_vortices_error.png"><img src="imgs/taylor_green_vortices_error.png" alt="" style="max-width:100%;"></a></p>
<p>These results have been obtained with :</p>
<ul>
<li>Viscosity <code>Î½=1e-3</code>,</li>
<li>Number of grid points per direction <code>n=128</code>,</li>
<li>Fifth order accurate time-stepping with variable time step using <code>alg=Tsit5()</code> from <a href="https://github.com/SciML/DifferentialEquations.jl">DifferentialEquations.jl</a>,</li>
<li>Absolute and relative tolerances set to <code>abstol = 1e-8</code> and <code>reltol=1e-6</code>, respectively.</li>
</ul>
<h3><a id="user-content-two-dimensional-decaying-isotropic-turbulence" class="anchor" aria-hidden="true" href="#two-dimensional-decaying-isotropic-turbulence"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>Two-dimensional decaying isotropic turbulence</h3>
<p>TBA</p>
<h3><a id="user-content-two-dimensional-kolmogorov-flow" class="anchor" aria-hidden="true" href="#two-dimensional-kolmogorov-flow"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>Two-dimensional Kolmogorov flow</h3>
<p>TBA</p>
<h2><a id="user-content-developments-goals" class="anchor" aria-hidden="true" href="#developments-goals"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>Developments goals</h2>
<p>As stated, NS2D is primary a sandbox for me to get familiar with the Julia ecosystem and test some ideas.
Below is a non-exhaustive lists of such ideas.
If you are interested in any of them, please do not hesitate to get in touch !</p>
<ul>
<li>Deterministic and stochastic forcing for forced turbulence,</li>
<li>Parallel computing,</li>
<li>GPU acceleration with <code>CUDA.jl</code>,</li>
<li>Automatic differentiation with <code>JuliaDiff</code> for optimization and machine-learning,</li>
</ul>
</article></div>