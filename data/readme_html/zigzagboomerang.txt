<div id="readme" class="md" data-path="README.md"><article class="markdown-body entry-content container-lg" itemprop="text"><h1 dir="auto"><a id="user-content-zigzagboomerang" class="anchor" aria-hidden="true" href="#zigzagboomerang"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a>ZigZagBoomerang</h1>
<p dir="auto"><a target="_blank" rel="noopener noreferrer nofollow" href="https://raw.githubusercontent.com/mschauer/ZigZagBoomerang.jl/master/figures/fastforward.png"><img src="https://raw.githubusercontent.com/mschauer/ZigZagBoomerang.jl/master/figures/fastforward.png" width="200" style="max-width: 100%;"></a></p>
<p dir="auto"><a href="https://mschauer.github.io/ZigZagBoomerang.jl/stable" rel="nofollow"><img src="https://camo.githubusercontent.com/c97f0a5f2ae95755f64a27f1aa8d9a17462941fd3d6c907c7630abd5d3e60acf/68747470733a2f2f696d672e736869656c64732e696f2f62616467652f646f63732d737461626c652d626c75652e737667" alt="Stable" data-canonical-src="https://img.shields.io/badge/docs-stable-blue.svg" style="max-width: 100%;"></a>
<a href="https://mschauer.github.io/ZigZagBoomerang.jl/dev/index.html" rel="nofollow"><img src="https://camo.githubusercontent.com/7fcec4b2d3ab291529fce8ef6a4fcd4129a0683b2f5d5fe2f5c648f02db8b616/68747470733a2f2f696d672e736869656c64732e696f2f62616467652f646f63732d6465762d626c75652e737667" alt="Dev" data-canonical-src="https://img.shields.io/badge/docs-dev-blue.svg" style="max-width: 100%;"></a>
<a href="https://travis-ci.com/mschauer/ZigZagBoomerang.jl" rel="nofollow"><img src="https://camo.githubusercontent.com/c536bb4a2017a4122f362f78200cda2947c140bc914b3858feb0f6da61ae2e55/68747470733a2f2f7472617669732d63692e636f6d2f6d736368617565722f5a69675a6167426f6f6d6572616e672e6a6c2e7376673f6272616e63683d6d6173746572" alt="Build Status" data-canonical-src="https://travis-ci.com/mschauer/ZigZagBoomerang.jl.svg?branch=master" style="max-width: 100%;"></a>
<a href="https://zenodo.org/badge/latestdoi/276593775" rel="nofollow"><img src="https://camo.githubusercontent.com/cbe568e4b45cfc3675e8f0556d38782b558491d21bffaa7df80dd5332915d6bc/68747470733a2f2f7a656e6f646f2e6f72672f62616467652f3237363539333737352e737667" alt="DOI" data-canonical-src="https://zenodo.org/badge/276593775.svg" style="max-width: 100%;"></a></p>
<h2 dir="auto"><a id="user-content-overview" class="anchor" aria-hidden="true" href="#overview"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a>Overview</h2>
<p dir="auto">Markov chain Monte Carlo (MCMC) methods are used to sample from a probability distribution, for example the posterior distribution in a Bayesian model. <em>Piecewise deterministic Monte Carlo</em> (PDMC) methods which are implemented in <code>ZigZagBoomerang.jl</code> have the same goal except for the fact that here the distribution is explored through the continuous movement of a particle and not one point at a time.</p>
<p dir="auto">Here, the particle changes direction at random times and moves otherwise on deterministic trajectories (for example along a line with constant velocity, see the picture)</p>
<p dir="auto"><a target="_blank" rel="noopener noreferrer nofollow" href="https://user-images.githubusercontent.com/1923437/113114754-f5bc8380-920b-11eb-90ea-d509fc453a9d.gif"><img src="https://user-images.githubusercontent.com/1923437/113114754-f5bc8380-920b-11eb-90ea-d509fc453a9d.gif" alt="bouncy" data-animated-image="" style="max-width: 100%;"></a></p>
<p dir="auto">The random direction changes are calibrated such that the trajectory of the particle samples the right distribution; from the trajectory, the quantities of interest, such as the posterior mean and standard deviation, can be estimated.</p>
<p dir="auto">The decision of whether to change direction only requires the evaluation of a partial derivatives which depend on few coordinates -- the neighbourhood of the coordinate in the Markov blanket. That allows exploiting multiple processor cores using Julia's multithreaded parallelism (or other forms of parallel computing).</p>
<p dir="auto">Joris Bierken's <a href="https://diamweb.ewi.tudelft.nl/~joris/pdmps.html" rel="nofollow">Overview over Piecewise Deterministic Monte Carlo</a> together with our announcement on Discourse <a href="https://discourse.julialang.org/t/ann-zigzagboomerang-jl/57287" rel="nofollow">[ANN] <code>ZigZagBoomerang.jl</code></a> is a good starting point for the theory and applications of the methods covered in  <code>ZigZagBoomerang.jl</code>.</p>
<h2 dir="auto"><a id="user-content-features" class="anchor" aria-hidden="true" href="#features"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a>Features</h2>
<p dir="auto"><em>Subsampling.</em> One highlight is that these samplers do not introduce error by allowing subsampling of data. This is because they just need an unbiased estimate of the gradient of the log densities to sample from a target distribution. [1]</p>
<p dir="auto">The factorised samplers make use of a sparse Gaussian approximation of the target density (in form of a sparse precision matrix <code>Γ</code>).</p>
<p dir="auto"><em>Local factorised samplers</em>. ZigZag and the factorised Boomerang can optionally make use of the sparsity of the gradient of the log density, see <code>spdmp</code>. [3]</p>
<p dir="auto"><em>Sticky samplers.</em> A recent feature is the addition of <em>sticky</em> PDMPs for variable selection (order 10000s of variables for well structured problems.), see <code>sspdmp</code>. [4]</p>
<p dir="auto"><em>Multithreaded Zig-Zag</em>. We are currently developing a multi-threaded version of the local Zig-Zag.</p>
<p dir="auto"><em>Probabilistic programming with PDMPs</em>. One challenge with PDMPs is their less familiar theory compared to Markov chains. We strive to provide  a ready-to-use sampler suitable as backend for other packages with the aim of making PDMP methods more accecible for users.</p>
<h2 dir="auto"><a id="user-content-contents" class="anchor" aria-hidden="true" href="#contents"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a>Contents</h2>
<p dir="auto">The package provides efficient and modular implementations
of samplers of several piecewise deterministic Markov processes (PDMP), the Bouncy Particle, the Boomerang, the ZigZag, and the factorised Boomerang and their sticky versions.</p>
<p dir="auto">The sampler requires the gradient of the potential of the target density as input and are called through <code>pdmp</code> producing a trajectory. <code>pdmp_inner!</code> gives access to the transition function of the sampler.</p>
<p dir="auto">The non-factorised samplers (Bouncy Particle, the Boomerang)
take a function <code>∇ϕ!(y, x)</code> writing the gradient of the potential <code>ϕ(x) = -log(p(x))</code> of the target density <code>p</code> into <code>y</code>. The factorised samplers (factorised Boomerang and ZigZag) take <code>∇ϕ(x, i)</code>, the <code>i</code>'s partial derivative of <code>ϕ</code> (that is <code>y[i]</code>.)</p>
<p dir="auto">See [<a href="https://github.com/mschauer/ZigZagBoomerang.jl/tree/master/scripts/logistic.jl">https://github.com/mschauer/ZigZagBoomerang.jl/tree/master/scripts/logistic.jl</a>] for a worked out example (logistic regression with n=8840, p=442 and sparse Gramian) sampling from a non-Gaussian target with structured sparse gradient of the potential and unbiased estimate of the gradient subsampling of the n observations.</p>
<p dir="auto"><a target="_blank" rel="noopener noreferrer nofollow" href="https://raw.githubusercontent.com/mschauer/ZigZagBoomerang.jl/master/figures/logisticZigZag.png"><img src="https://raw.githubusercontent.com/mschauer/ZigZagBoomerang.jl/master/figures/logisticZigZag.png" width="600" style="max-width: 100%;"></a></p>
<h2 dir="auto"><a id="user-content-juliacon-2021" class="anchor" aria-hidden="true" href="#juliacon-2021"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a>JuliaCon 2021</h2>
<p dir="auto"><a href="https://www.youtube.com/watch?v=wJAjP_I1BnQ" rel="nofollow"><img src="https://camo.githubusercontent.com/b3ab46182437a0b97f89174cf131815dec2467e6778b90ec739fe7bc26fc6a32/68747470733a2f2f696d672e796f75747562652e636f6d2f76692f774a416a505f4931426e512f302e6a7067" alt="ZigZagBoomerang.jl - parallel inference and variable selection | Moritz Schauer | JuliaCon2021" data-canonical-src="https://img.youtube.com/vi/wJAjP_I1BnQ/0.jpg" style="max-width: 100%;"></a></p>
<h2 dir="auto"><a id="user-content-gallery" class="anchor" aria-hidden="true" href="#gallery"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a>Gallery</h2>
<p dir="auto"><a target="_blank" rel="noopener noreferrer nofollow" href="https://raw.githubusercontent.com/mschauer/ZigZagBoomerang.jl/master/figures/zigzag.png"><img src="https://raw.githubusercontent.com/mschauer/ZigZagBoomerang.jl/master/figures/zigzag.png" width="300" style="max-width: 100%;"></a><a target="_blank" rel="noopener noreferrer nofollow" href="https://raw.githubusercontent.com/mschauer/ZigZagBoomerang.jl/master/figures/boomerang.png"><img src="https://raw.githubusercontent.com/mschauer/ZigZagBoomerang.jl/master/figures/boomerang.png" width="300" style="max-width: 100%;"></a></p>
<p dir="auto"><a target="_blank" rel="noopener noreferrer nofollow" href="https://raw.githubusercontent.com/mschauer/ZigZagBoomerang.jl/master/figures/localzigzag.png"><img src="https://raw.githubusercontent.com/mschauer/ZigZagBoomerang.jl/master/figures/localzigzag.png" width="300" style="max-width: 100%;"></a><a target="_blank" rel="noopener noreferrer nofollow" href="https://raw.githubusercontent.com/mschauer/ZigZagBoomerang.jl/master/figures/factboom.png"><img src="https://raw.githubusercontent.com/mschauer/ZigZagBoomerang.jl/master/figures/factboom.png" width="300" style="max-width: 100%;"></a></p>
<p dir="auto"><a target="_blank" rel="noopener noreferrer nofollow" href="https://raw.githubusercontent.com/mschauer/ZigZagBoomerang.jl/master/figures/localzigzag3d.png"><img src="https://raw.githubusercontent.com/mschauer/ZigZagBoomerang.jl/master/figures/localzigzag3d.png" width="300" style="max-width: 100%;"></a><a target="_blank" rel="noopener noreferrer nofollow" href="https://raw.githubusercontent.com/mschauer/ZigZagBoomerang.jl/master/figures/factboom3d.png"><img src="https://raw.githubusercontent.com/mschauer/ZigZagBoomerang.jl/master/figures/factboom3d.png" width="300" style="max-width: 100%;"></a></p>
<p dir="auto"><a target="_blank" rel="noopener noreferrer nofollow" href="https://raw.githubusercontent.com/mschauer/ZigZagBoomerang.jl/master/figures/surf10.png"><img src="https://raw.githubusercontent.com/mschauer/ZigZagBoomerang.jl/master/figures/surf10.png" width="200" style="max-width: 100%;"></a><a target="_blank" rel="noopener noreferrer nofollow" href="https://raw.githubusercontent.com/mschauer/ZigZagBoomerang.jl/master/figures/surf30.png"><img src="https://raw.githubusercontent.com/mschauer/ZigZagBoomerang.jl/master/figures/surf30.png" width="200" style="max-width: 100%;"></a><a target="_blank" rel="noopener noreferrer nofollow" href="https://raw.githubusercontent.com/mschauer/ZigZagBoomerang.jl/master/figures/surf50.png"><img src="https://raw.githubusercontent.com/mschauer/ZigZagBoomerang.jl/master/figures/surf50.png" width="200" style="max-width: 100%;"></a></p>
<p dir="auto">Showing mixing and convergence from white noise to a Gaussian random field: ZigZag after 10, after 30, after 50 time units. See the script folder for the example and a video.</p>
<h2 dir="auto"><a id="user-content-examples" class="anchor" aria-hidden="true" href="#examples"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a>Examples</h2>
<p dir="auto">See [<a href="https://github.com/mschauer/ZigZagBoomerang.jl/tree/master/scripts">https://github.com/mschauer/ZigZagBoomerang.jl/tree/master/scripts</a>].</p>
<h2 dir="auto"><a id="user-content-literature" class="anchor" aria-hidden="true" href="#literature"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a>Literature</h2>
<ol dir="auto">
<li>Joris Bierkens, Paul Fearnhead, Gareth Roberts: The Zig-Zag Process and Super-Efficient Sampling for Bayesian Analysis of Big Data. <em>The Annals of Statistics</em>, 2019, 47. Vol., Nr. 3, pp. 1288-1320. [<a href="https://arxiv.org/abs/1607.03188" rel="nofollow">https://arxiv.org/abs/1607.03188</a>].</li>
<li>Joris Bierkens, Sebastiano Grazzi, Kengo Kamatani and Gareth Robers: The Boomerang Sampler. <em>ICML 2020</em>. [<a href="https://arxiv.org/abs/2006.13777" rel="nofollow">https://arxiv.org/abs/2006.13777</a>].</li>
<li>Joris Bierkens, Sebastiano Grazzi, Frank van der Meulen, Moritz Schauer: A piecewise deterministic Monte Carlo method for diffusion bridges.  <em>Statistics and Computing</em>, 2021 (to appear). [<a href="https://arxiv.org/abs/2001.05889" rel="nofollow">https://arxiv.org/abs/2001.05889</a>].</li>
<li>Joris Bierkens, Sebastiano Grazzi, Frank van der Meulen, Moritz Schauer: Sticky PDMP samplers for sparse and local inference problems.  2020. [<a href="https://arxiv.org/abs/2103.08478" rel="nofollow">https://arxiv.org/abs/2103.08478</a>].</li>
<li>Joris Bierkens, Alexandre Bouchard-Côté, Arnaud Doucet, Andrew B. Duncan, Paul Fearnhead, Thibaut Lienart, Gareth Roberts, Sebastian J. Vollmer:
Piecewise deterministic Markov processes for scalable Monte Carlo on restricted domains, <em>Statistics &amp; Probability Letters</em>, 136. 2018.
[<a href="https://doi.org/10.1016/j.spl.2018.02.021" rel="nofollow">https://doi.org/10.1016/j.spl.2018.02.021</a>].</li>
<li>Joris Bierkens, Andrea Bertazzi: Adaptive Schemes for Piecewise Deterministic Monte Carlo Algorithms, 2020. [<a href="https://arxiv.org/abs/arXiv:2012.13924" rel="nofollow">https://arxiv.org/abs/arXiv:2012.13924</a>].</li>
<li>Werner Krauth: Event-chain Monte Carlo: foundations, applications, and prospects, 2021. [<a href="https://arxiv.org/abs/2102.07217" rel="nofollow">https://arxiv.org/abs/2102.07217</a>].</li>
<li>Alexandre Bouchard-Côté, Sebastian J. Vollmer, Arnaud Doucet: The Bouncy Particle Sampler: A Nonreversible Rejection-Free Markov Chain Monte Carlo Method, <em>Journal of the American Statistical Association</em>, 113:522, 855-867, DOI: 10.1080/01621459.2017.1294075.</li>
</ol>
<ul dir="auto">
<li>[<a href="https://github.com/jbierkens/ICML-boomerang/">https://github.com/jbierkens/ICML-boomerang/</a>] (code accompanying the paper "The Boomerang Sampler")</li>
</ul>
</article></div>