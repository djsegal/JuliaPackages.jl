<div id="readme" class="md" data-path="README.md"><article class="markdown-body entry-content container-lg" itemprop="text"><h1 dir="auto"><a id="user-content-xranklin" class="anchor" aria-hidden="true" href="#xranklin"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a>Xranklin</h1>
<p dir="auto"><a href="https://github.com/tlienart/Xranklin.jl/actions"><img src="https://github.com/tlienart/Xranklin.jl/workflows/CI/badge.svg" alt="CI Actions Status" style="max-width: 100%;"></a>
<a href="https://codecov.io/gh/tlienart/Xranklin.jl" rel="nofollow"><img src="https://camo.githubusercontent.com/cf644c051b002cfed60b96e3fd4414f0e81fa1b30cad1080a0c423057a30d529/68747470733a2f2f636f6465636f762e696f2f67682f746c69656e6172742f5872616e6b6c696e2e6a6c2f6272616e63682f6d61696e2f67726170682f62616467652e7376673f746f6b656e3d3767556e317a49455877" alt="codecov" data-canonical-src="https://codecov.io/gh/tlienart/Xranklin.jl/branch/main/graph/badge.svg?token=7gUn1zIEXw" style="max-width: 100%;"></a></p>
<h2 dir="auto"><a id="user-content-about" class="anchor" aria-hidden="true" href="#about"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a>About</h2>
<p dir="auto">This repo contains the code for the next minor (and, once properly tested, major) version of
<a href="https://github.com/tlienart/Franklin.jl">Franklin.jl</a>.
The code has basically been re-written from scratch, and your help is needed to uncover bugs and problems.</p>
<p dir="auto">Most of what's offered by Franklin is also offered by Xranklin (apart from what's listed in <a href="https://github.com/tlienart/Xranklin.jl/issues/65" data-hovercard-type="issue" data-hovercard-url="/tlienart/Xranklin.jl/issues/65/hovercard">this issue</a> which we should make as precise as possible).</p>
<p dir="auto"><a href="https://tlienart.github.io/Xranklin.jl/" rel="nofollow"><strong>Link to the new docs</strong></a> (under active construction, note that the search won't work, and I'm also aware that the nav does not work well on mobile phone).</p>
<h2 dir="auto"><a id="user-content-how-to-help-test-this" class="anchor" aria-hidden="true" href="#how-to-help-test-this"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a>How to help test this?</h2>
<p dir="auto"><strong>Assumptions</strong>:</p>
<ul dir="auto">
<li>you are familiar with Franklin, and already have a website repo that works,</li>
<li>you're using GitHub and GitHub deployment (if not, it's also great, but you'll be more on your own for now),</li>
<li>you're using Julia 1.6+</li>
<li>your editor uses LF (lines end with <code>\n</code>, this is only a concern for you if you're on Windows but if you use a modern editor, it should be the default or easy to set)</li>
</ul>
<p dir="auto">Here's a suggested workflow:</p>
<ol dir="auto">
<li>duplicate an existing Franklin-repo and give me collaborator access to that duplicated repo (to speed up debugging),</li>
<li>clone the repo locally, and add <code>Xranklin</code> to your environment with <code>Pkg.add(url="https://github.com/tlienart/Xranklin.jl", rev="main");</code></li>
<li><code>cd</code> to the repo and do <code>using Xranklin; serve(debug=true)</code>, this will generate a lot of output,</li>
<li>if you have errors, check the migration points below to see if the error can be quickly fixed, if not, open an issue
<ul dir="auto">
<li>indicate your OS, Julia version, link to the repo and to the commit that failed if not the latest</li>
<li>indicate the patch version of Xranklin,</li>
<li>copy paste the error and previous few lines in the issue,</li>
</ul>
</li>
<li>assuming things work locally, test the deployment
<ul dir="auto">
<li>make sure you adjust <code>prepath</code> in <code>config.md</code></li>
<li>create or change the <code>.github/workflows/deploy.yml</code> to the script below</li>
<li>check if it deploys successfully (check in the repo settings that <code>Pages</code> consume <code>gh-pages</code>)</li>
</ul>
</li>
<li>thoughts, feedback, open an issue</li>
<li>thanks a lot!!</li>
</ol>
<details>
  <summary>Click here to expand the github deploy script</summary>
<div class="highlight highlight-source-yaml notranslate position-relative overflow-auto" dir="auto" data-snippet-clipboard-copy-content="name: Build and Deploy
on:
  push:
    branches:
      - main
jobs:
  build-and-deploy:
    runs-on: ubuntu-latest
    steps:
      - name: Git checkout
        uses: actions/checkout@v3

      - name: Cache
        uses: actions/cache@v2
        with:
          path: |
                __cache
                ~/.julia
          key: ${{ runner.os }}-franklin-cache-${{ github.sha }}
          restore-keys: ${{ runner.os }}-franklin-cache-

      # Julia
      - name: Install Julia
        uses: julia-actions/setup-julia@v1
        with:
          version: 1.7

      # Website build
      - run: julia -e '
          using Pkg; Pkg.add(url=&quot;https://github.com/tlienart/Xranklin.jl&quot;, rev=&quot;main&quot;);
          using Xranklin; build();'

      # Deployment and caching
      - run: touch __site/.nojekyll
      - name: Deploy ðŸš€
        uses: JamesIves/github-pages-deploy-action@releases/v4
        with:
          BRANCH: gh-pages
          FOLDER: __site"><pre><span class="pl-ent">name</span>: <span class="pl-s">Build and Deploy</span>
<span class="pl-ent">on</span>:
  <span class="pl-ent">push</span>:
    <span class="pl-ent">branches</span>:
      - <span class="pl-s">main</span>
<span class="pl-ent">jobs</span>:
  <span class="pl-ent">build-and-deploy</span>:
    <span class="pl-ent">runs-on</span>: <span class="pl-s">ubuntu-latest</span>
    <span class="pl-ent">steps</span>:
      - <span class="pl-ent">name</span>: <span class="pl-s">Git checkout</span>
        <span class="pl-ent">uses</span>: <span class="pl-s">actions/checkout@v3</span>

      - <span class="pl-ent">name</span>: <span class="pl-s">Cache</span>
        <span class="pl-ent">uses</span>: <span class="pl-s">actions/cache@v2</span>
        <span class="pl-ent">with</span>:
          <span class="pl-ent">path</span>: <span class="pl-s">|</span>
<span class="pl-s">                __cache</span>
<span class="pl-s">                ~/.julia</span>
<span class="pl-s"></span>          <span class="pl-ent">key</span>: <span class="pl-s">${{ runner.os }}-franklin-cache-${{ github.sha }}</span>
          <span class="pl-ent">restore-keys</span>: <span class="pl-s">${{ runner.os }}-franklin-cache-</span>

      <span class="pl-c"><span class="pl-c">#</span> Julia</span>
      - <span class="pl-ent">name</span>: <span class="pl-s">Install Julia</span>
        <span class="pl-ent">uses</span>: <span class="pl-s">julia-actions/setup-julia@v1</span>
        <span class="pl-ent">with</span>:
          <span class="pl-ent">version</span>: <span class="pl-c1">1.7</span>

      <span class="pl-c"><span class="pl-c">#</span> Website build</span>
      - <span class="pl-ent">run</span>: <span class="pl-s">julia -e '</span>
          <span class="pl-s">using Pkg; Pkg.add(url="https://github.com/tlienart/Xranklin.jl", rev="main");</span>
          <span class="pl-s">using Xranklin; build();'</span>

      <span class="pl-c"><span class="pl-c">#</span> Deployment and caching</span>
      - <span class="pl-ent">run</span>: <span class="pl-s">touch __site/.nojekyll</span>
      - <span class="pl-ent">name</span>: <span class="pl-s">Deploy ðŸš€</span>
        <span class="pl-ent">uses</span>: <span class="pl-s">JamesIves/github-pages-deploy-action@releases/v4</span>
        <span class="pl-ent">with</span>:
          <span class="pl-ent">BRANCH</span>: <span class="pl-s">gh-pages</span>
          <span class="pl-ent">FOLDER</span>: <span class="pl-s">__site</span></pre></div>
</details>
<h2 dir="auto"><a id="user-content-migration-notes" class="anchor" aria-hidden="true" href="#migration-notes"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a>Migration notes</h2>
<p dir="auto"><a href="https://tlienart.github.io/Xranklin.jl/" rel="nofollow"><strong>Link to the new docs</strong></a>, the docs are being built so expect rough edges but if you find things that can be added or explained better, please open issues. Don't worry too much about layout issues for now.</p>
<p dir="auto"><strong>Changes</strong>:</p>
<ul dir="auto">
<li>page variable definitions, move from <code>@def x = ...</code> to <code>+++ ... +++</code> blocks (see <a href="https://tlienart.github.io/Xranklin.jl/syntax/vars+funs/" rel="nofollow">docs</a>), <code>@def</code> will still work but will not allow multi-line assignments, generally <code>+++...+++</code> are preferred now</li>
<li><code>@delay</code> is removed (it's not required anymore)</li>
<li><code>lxfuns</code> now take arguments as <code>hfuns</code> (a list of parameters corresponding to the braces) see <a href="https://github.com/tlienart/Xranklin.jl/blob/3eb0ce295f0505a7c0519558392d95c2e72fa52d/src/convert/markdown/lxfuns/misc.jl#L1-L11">this example</a></li>
<li><code>envfuns</code> now take arguments differently, see <a href="https://github.com/tlienart/Xranklin.jl/blob/3eb0ce295f0505a7c0519558392d95c2e72fa52d/src/convert/markdown/envfuns/math.jl#L20-L29">this example</a></li>
<li><code>Dates</code> is <strong>not</strong> available by default, you have to explicitly add <code>using Dates</code> in your <code>utils.jl</code> or in your <code>+++...+++</code> blocks in order to be able to call things like <code>Date(2022,2,1)</code></li>
</ul>
<p dir="auto">This has not yet been migrated and so you shouldn't expect it to work (see also <a href="https://github.com/tlienart/Xranklin.jl/issues/65" data-hovercard-type="issue" data-hovercard-url="/tlienart/Xranklin.jl/issues/65/hovercard">this issue</a>)</p>
<ul dir="auto">
<li>RSS generation</li>
<li>sitemap generation</li>
<li>robots generation</li>
<li>slug</li>
<li>lunr</li>
</ul>
<h3 dir="auto"><a id="user-content-iterative-process" class="anchor" aria-hidden="true" href="#iterative-process"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a>Iterative process</h3>
<p dir="auto">It helps to use <code>ignore = ...</code> in your <code>config.md</code> to avoid trying to build your full site
at once which will be very helpful in gradually debugging things. For instance you may have
something like</p>
<div class="snippet-clipboard-content notranslate position-relative overflow-auto" data-snippet-clipboard-copy-content="ignore = [&quot;posts/&quot;, &quot;about/&quot;, &quot;foo/bar.md&quot;]"><pre class="notranslate"><code>ignore = ["posts/", "about/", "foo/bar.md"]
</code></pre></div>
<p dir="auto">to indicate that the directories <code>posts/</code> and <code>about/</code> as well as the file <code>foo/bar.md</code> should be ignored.</p>
<h3 dir="auto"><a id="user-content-quirks" class="anchor" aria-hidden="true" href="#quirks"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a>Quirks</h3>
<p dir="auto">Now that there's a <code>__cache</code> folder generated alongside the <code>__site</code> folder, add it to your
<code>.gitignore</code> file so it doesn't get pushed.
So it will look something like this:</p>
<div class="snippet-clipboard-content notranslate position-relative overflow-auto" data-snippet-clipboard-copy-content="__site/
__cache/
.DS_Store  # if you're on macos"><pre class="notranslate"><code>__site/
__cache/
.DS_Store  # if you're on macos
</code></pre></div>
<hr>
<h2 dir="auto"><a id="user-content-dev-notes" class="anchor" aria-hidden="true" href="#dev-notes"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a>Dev Notes</h2>
<h3 dir="auto"><a id="user-content-breaking-changes-from-franklin" class="anchor" aria-hidden="true" href="#breaking-changes-from-franklin"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a>Breaking changes from Franklin</h3>
<ul dir="auto">
<li><code>lx_fun</code> now take args as <code>hfuns</code> so <code>lx_foo(p::Vector{String})</code></li>
<li><code>@def</code> do not accept multiline assignments anymore, generally prefer <code>+++...+++</code> blocks</li>
<li>hard assumption of LF (i.e. end of lines are <code>\n</code> and not <code>\r\n</code>) (<em>LF Assumption</em>)</li>
</ul>
<p dir="auto"><strong>Notes</strong></p>
<ul dir="auto">
<li>(<strong>LF Assumption</strong>) this could be relaxed, not sure how many people would have an issue;
also for it to make sense would need to test on a windows box.
To relax, update <code>FranklinParser</code> to have a token for <code>\r\n</code>, and update things with occurrences
of <code>\n</code> (including the <code>process_line_return</code> function). Potentially having an editor with <code>\r\n</code>
will not make things fail (since we'll capture the <code>\n</code>) but it's not tested.</li>
</ul>
<h3 dir="auto"><a id="user-content-latex" class="anchor" aria-hidden="true" href="#latex"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a>LaTeX</h3>
<ul dir="auto">
<li>hyperrefs</li>
<li>booktabs (for tables)</li>
<li>csquotes (for blockquotes)</li>
</ul>
</article></div>