<div id="readme" class="md" data-path="README.md"><article class="markdown-body entry-content container-lg" itemprop="text"><p align="center" dir="auto">
<a target="_blank" rel="noopener noreferrer" href="./docs/assets/logo.svg"><img height="200px" src="./docs/assets/logo.svg" style="max-width: 100%;"></a>
</p>
<h1 dir="auto"><a id="user-content-solventshellinteractions" class="anchor" aria-hidden="true" href="#solventshellinteractions"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a>SolventShellInteractions</h1>
<p dir="auto">Computes the non-bonded potential of the molecules which have at least
one atom within a distance from a solute. Used to evaluate the interactions of a solvent
with a solute, for the solvent molecules in coordination shells. The coordination
number is also computed.</p>
<p dir="auto">Currently only works with Gromacs topology and trajectory formats.</p>
<p dir="auto">The calculations run in parallel if <code>julia</code> is initialized with multi-threading support, i. e. with <code>julia -t auto</code>, for example.</p>
<h2 dir="auto"><a id="user-content-installation" class="anchor" aria-hidden="true" href="#installation"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a>Installation</h2>
<div class="highlight highlight-source-julia notranslate position-relative overflow-auto" dir="auto" data-snippet-clipboard-copy-content="julia&gt; import Pkg

julia&gt; Pkg.add(url=&quot;http://github.com/m3g/SolventShellInteractions.jl&quot;)"><pre>julia<span class="pl-k">&gt;</span> <span class="pl-k">import</span> Pkg

julia<span class="pl-k">&gt;</span> Pkg<span class="pl-k">.</span><span class="pl-c1">add</span>(url<span class="pl-k">=</span><span class="pl-s"><span class="pl-pds">"</span>http://github.com/m3g/SolventShellInteractions.jl<span class="pl-pds">"</span></span>)</pre></div>
<h2 dir="auto"><a id="user-content-example" class="anchor" aria-hidden="true" href="#example"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a>Example</h2>
<div class="highlight highlight-source-julia notranslate position-relative overflow-auto" dir="auto" data-snippet-clipboard-copy-content="using Plots
using PDBTools
using SolventShellInteractions

dir=&quot;./test/files&quot;

# read pdb file
pdb = readPDB(&quot;$dir/system.pdb&quot;)

# solute atoms
solute = select(pdb, &quot;protein&quot;)
solvent = select(pdb, &quot;resname EMI&quot;)

# trajectory file (Gromacs xtc only)
trajectory = &quot;$dir/simulation_short.xtc&quot;

# topology file
topology_file = &quot;$dir/processed.top&quot;

# distance of the first dip in the distribution
cutoff = 10.

# compute electrostatic potential
cn, q, lj = nonbonded(
    solute,
    solvent,
    cutoff,
    trajectory, 
    topology_file,
)

plot(
    [ cn q lj ],
    xlabel=[ &quot;&quot; &quot;&quot; &quot;step&quot; ],
    ylabel=[ &quot;coordination\n number&quot; &quot;electrostatic\n energy / kJ / mol&quot; &quot;LJ energy / kJ / mol&quot; ],
    linewidth=2, 
    framestyle=:box,
    labels=:none,
    layout=(3,1),
    size=(600,700),
)"><pre><span class="pl-k">using</span> Plots
<span class="pl-k">using</span> PDBTools
<span class="pl-k">using</span> SolventShellInteractions

dir<span class="pl-k">=</span><span class="pl-s"><span class="pl-pds">"</span>./test/files<span class="pl-pds">"</span></span>

<span class="pl-c"><span class="pl-c">#</span> read pdb file</span>
pdb <span class="pl-k">=</span> <span class="pl-c1">readPDB</span>(<span class="pl-s"><span class="pl-pds">"</span><span class="pl-v">$dir</span>/system.pdb<span class="pl-pds">"</span></span>)

<span class="pl-c"><span class="pl-c">#</span> solute atoms</span>
solute <span class="pl-k">=</span> <span class="pl-c1">select</span>(pdb, <span class="pl-s"><span class="pl-pds">"</span>protein<span class="pl-pds">"</span></span>)
solvent <span class="pl-k">=</span> <span class="pl-c1">select</span>(pdb, <span class="pl-s"><span class="pl-pds">"</span>resname EMI<span class="pl-pds">"</span></span>)

<span class="pl-c"><span class="pl-c">#</span> trajectory file (Gromacs xtc only)</span>
trajectory <span class="pl-k">=</span> <span class="pl-s"><span class="pl-pds">"</span><span class="pl-v">$dir</span>/simulation_short.xtc<span class="pl-pds">"</span></span>

<span class="pl-c"><span class="pl-c">#</span> topology file</span>
topology_file <span class="pl-k">=</span> <span class="pl-s"><span class="pl-pds">"</span><span class="pl-v">$dir</span>/processed.top<span class="pl-pds">"</span></span>

<span class="pl-c"><span class="pl-c">#</span> distance of the first dip in the distribution</span>
cutoff <span class="pl-k">=</span> <span class="pl-c1">10.</span>

<span class="pl-c"><span class="pl-c">#</span> compute electrostatic potential</span>
cn, q, lj <span class="pl-k">=</span> <span class="pl-c1">nonbonded</span>(
    solute,
    solvent,
    cutoff,
    trajectory, 
    topology_file,
)

<span class="pl-c1">plot</span>(
    [ cn q lj ],
    xlabel<span class="pl-k">=</span>[ <span class="pl-s"><span class="pl-pds">"</span><span class="pl-pds">"</span></span> <span class="pl-s"><span class="pl-pds">"</span><span class="pl-pds">"</span></span> <span class="pl-s"><span class="pl-pds">"</span>step<span class="pl-pds">"</span></span> ],
    ylabel<span class="pl-k">=</span>[ <span class="pl-s"><span class="pl-pds">"</span>coordination<span class="pl-cce">\n</span> number<span class="pl-pds">"</span></span> <span class="pl-s"><span class="pl-pds">"</span>electrostatic<span class="pl-cce">\n</span> energy / kJ / mol<span class="pl-pds">"</span></span> <span class="pl-s"><span class="pl-pds">"</span>LJ energy / kJ / mol<span class="pl-pds">"</span></span> ],
    linewidth<span class="pl-k">=</span><span class="pl-c1">2</span>, 
    framestyle<span class="pl-k">=</span><span class="pl-c1">:box</span>,
    labels<span class="pl-k">=</span><span class="pl-c1">:none</span>,
    layout<span class="pl-k">=</span>(<span class="pl-c1">3</span>,<span class="pl-c1">1</span>),
    size<span class="pl-k">=</span>(<span class="pl-c1">600</span>,<span class="pl-c1">700</span>),
)</pre></div>
<p dir="auto">Will produce (for a longer trajectory):</p>
<p dir="auto"><a target="_blank" rel="noopener noreferrer" href="./docs/example.png"><img src="./docs/example.png" alt="example.png" style="max-width: 100%;"></a></p>
<h3 dir="auto"><a id="user-content-options" class="anchor" aria-hidden="true" href="#options"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a>Options</h3>
<p dir="auto">Some keyword arguments can be passed to the <code>nonbonded</code> function:</p>
<table>
<thead>
<tr>
<th align="center">keyword</th>
<th align="center">values</th>
<th align="center">default</th>
<th align="left">meaning</th>
</tr>
</thead>
<tbody>
<tr>
<td align="center"><code>show_progress</code></td>
<td align="center"><code>true/false</code></td>
<td align="center"><code>true</code></td>
<td align="left">Display or not the progress bar.</td>
</tr>
<tr>
<td align="center"><code>combination_rule</code></td>
<td align="center"><code>:geometric/:arithmetic</code></td>
<td align="center"><code>:geometric</code></td>
<td align="left">Type of combination rule for the sigma parameters of the LJ potential.</td>
</tr>
<tr>
<td align="center"><code>standard_cutoff</code></td>
<td align="center"><code>true/false</code></td>
<td align="center"><code>false</code></td>
<td align="left">Use a standard cutoff, and thus no interaction above the cutoff distance will be considered.</td>
</tr>
<tr>
<td align="center"><code>shift</code></td>
<td align="center"><code>true/false</code></td>
<td align="center"><code>false</code></td>
<td align="left">Use a shifting function, as described <a href="https://www.ks.uiuc.edu/Research/namd/2.10/ug/node23.html" rel="nofollow">here</a>.</td>
</tr>
</tbody>
</table>
<p dir="auto">Note that with <code>standard_cutoff</code> and/or <code>shift</code> turned on, the calculation is not particularly interesting, as it does not represent anymore the interaction of the complete molecules that have at least one atom within the desired distance range. These options are mostly used for testing purposes.</p>
<h2 dir="auto"><a id="user-content-related-work" class="anchor" aria-hidden="true" href="#related-work"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a>Related work:</h2>
<p dir="auto"><a href="https://github.com/m3g/ComplexMixtures.jl">ComplexMixtures.jl</a>:  Investigating the structure of solutions of complex-shaped molecules from a solvent-shell perspective J. Mol. Liq. 117945, 2021.</p>
<p dir="auto"><a href="https://github.com/m3g/MolecularMinimumDistances.jl">MolecularMinimumDistances.jl</a>: Computes the set of minimum distances between to sets of particles, which can be grouped (like in molecules).</p>
<h2 dir="auto"><a id="user-content-references" class="anchor" aria-hidden="true" href="#references"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a>References:</h2>
<p dir="auto">This package uses the following libraries, which should be cited independently:</p>
<p dir="auto"><a href="https://github.com/m3g/CellListMap.jl">CellListMap.jl</a>: Efficient and customizable cell list implementation for calculation of pairwise particle properties within a cutoff. Computer Physics Communications, 279, 108452, 2022. (<a href="https://doi.org/10.1016/j.cpc.2022.108452" rel="nofollow">https://doi.org/10.1016/j.cpc.2022.108452</a>)</p>
<p dir="auto"><a href="https://github.com/chemfiles/Chemfiles.jl">Chemfiles.jl</a>: A high-quality library for reading and writing trajectory files created by computational chemistry simulations programs. <a href="https://doi.org/10.5281/zenodo.1202207" rel="nofollow">10.5281/zenodo.1202207</a>.</p>
</article></div>