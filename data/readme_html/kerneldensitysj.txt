<div id="readme" class="md" data-path="README.md"><article class="markdown-body entry-content container-lg" itemprop="text"><h1 dir="auto"><a id="user-content-kerneldensitysjjl" class="anchor" aria-hidden="true" href="#kerneldensitysjjl"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a>KernelDensitySJ.jl</h1>
<p dir="auto"><a href="https://travis-ci.com/rasmushenningsson/KernelDensitySJ.jl" rel="nofollow"><img src="https://camo.githubusercontent.com/d579e8311c9ee81c4485c1e347cacee5420cbff7e4ce07c11d5b2036f28a49b7/68747470733a2f2f7472617669732d63692e636f6d2f7261736d757368656e6e696e6773736f6e2f4b65726e656c44656e73697479534a2e6a6c2e7376673f6272616e63683d6d6173746572" alt="Build Status" data-canonical-src="https://travis-ci.com/rasmushenningsson/KernelDensitySJ.jl.svg?branch=master" style="max-width: 100%;"></a>
<a href="https://ci.appveyor.com/project/rasmushenningsson/KernelDensitySJ-jl" rel="nofollow"><img src="https://camo.githubusercontent.com/5105da613bd681f43ccf2ecff04a5c301b674ffe816c10022b026c627434bf46/68747470733a2f2f63692e6170707665796f722e636f6d2f6170692f70726f6a656374732f7374617475732f6769746875622f7261736d757368656e6e696e6773736f6e2f4b65726e656c44656e73697479534a2e6a6c3f7376673d74727565" alt="Build Status" data-canonical-src="https://ci.appveyor.com/api/projects/status/github/rasmushenningsson/KernelDensitySJ.jl?svg=true" style="max-width: 100%;"></a>
<a href="https://codecov.io/gh/rasmushenningsson/KernelDensitySJ.jl" rel="nofollow"><img src="https://camo.githubusercontent.com/43415e45d51c8506aafcfb7fd378a6d8b3f72ddbca334e48896242e9f058ffdc/68747470733a2f2f636f6465636f762e696f2f67682f7261736d757368656e6e696e6773736f6e2f4b65726e656c44656e73697479534a2e6a6c2f6272616e63682f6d61737465722f67726170682f62616467652e737667" alt="Coverage" data-canonical-src="https://codecov.io/gh/rasmushenningsson/KernelDensitySJ.jl/branch/master/graph/badge.svg" style="max-width: 100%;"></a>
<a href="https://coveralls.io/github/rasmushenningsson/KernelDensitySJ.jl?branch=master" rel="nofollow"><img src="https://camo.githubusercontent.com/a706172c097a8dedcd04293f96176407afcd34592202d7bdc2e295688c4d8a2a/68747470733a2f2f636f766572616c6c732e696f2f7265706f732f6769746875622f7261736d757368656e6e696e6773736f6e2f4b65726e656c44656e73697479534a2e6a6c2f62616467652e7376673f6272616e63683d6d6173746572" alt="Coverage" data-canonical-src="https://coveralls.io/repos/github/rasmushenningsson/KernelDensitySJ.jl/badge.svg?branch=master" style="max-width: 100%;"></a></p>
<h2 dir="auto"><a id="user-content-overview" class="anchor" aria-hidden="true" href="#overview"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a>Overview</h2>
<p dir="auto">KernelDensitySJ.jl is a package for <a href="https://en.wikipedia.org/wiki/Kernel_density_estimation" rel="nofollow">Kernel Density Estimation</a> and function estimation by <a href="https://en.wikipedia.org/wiki/Kernel_smoother#Gaussian_kernel_smoother" rel="nofollow">Gaussian Kernel Smoothing</a>.</p>
<p dir="auto">More specifically, this package implements accurate, robust and reasonably fast algorithms for:</p>
<ul dir="auto">
<li>Kernel Density Estimation in one dimension using Sheather and Jones algorithm for bandwidth selection, also known as width.SJ or bw.SJ. (The specific version of the algorithm is sometimes referred to as "solve-the-equation".) Only Gaussian kernels are supported.</li>
<li>Evaluation of the density.</li>
<li>Gaussian Kernel Smoothing, i.e. given a set of points (x and y values), computes a weighted average of the y values with weights coming from gaussian kernels placed at each x value.</li>
</ul>
<p dir="auto">Extra care is taken to handle outliers and extreme values for different parameters, ensuring that the results are accurate for a very wide range of inputs.</p>
<h2 dir="auto"><a id="user-content-installation" class="anchor" aria-hidden="true" href="#installation"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a>Installation</h2>
<p dir="auto">Start the Julia REPL, press ']' to enter package mode and type</p>
<div class="snippet-clipboard-content notranslate position-relative overflow-auto" data-snippet-clipboard-copy-content="add KernelDensitySJ"><pre class="notranslate"><code>add KernelDensitySJ
</code></pre></div>
<h2 dir="auto"><a id="user-content-usage-example" class="anchor" aria-hidden="true" href="#usage-example"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a>Usage Example</h2>
<p dir="auto">Let's start with some random points on the x-axis for a simple example.</p>
<div class="highlight highlight-source-julia notranslate position-relative overflow-auto" dir="auto" data-snippet-clipboard-copy-content="using KernelDensitySJ
px = -1 .+ 2.0.*rand(40)"><pre><span class="pl-k">using</span> KernelDensitySJ
px <span class="pl-k">=</span> <span class="pl-k">-</span><span class="pl-c1">1</span> <span class="pl-k">.+</span> <span class="pl-c1">2.0</span><span class="pl-k">.*</span><span class="pl-c1">rand</span>(<span class="pl-c1">40</span>)</pre></div>
<p dir="auto">Now we can estimate the bandwidth</p>
<div class="highlight highlight-source-julia notranslate position-relative overflow-auto" dir="auto" data-snippet-clipboard-copy-content="bw = bwsj(px)"><pre>bw <span class="pl-k">=</span> <span class="pl-c1">bwsj</span>(px)</pre></div>
<p dir="auto">and evaluate the density</p>
<div class="highlight highlight-source-julia notranslate position-relative overflow-auto" dir="auto" data-snippet-clipboard-copy-content="x = range(-1.0,stop=1.0,length=201)
yd = density(px, bw, x)"><pre>x <span class="pl-k">=</span> <span class="pl-c1">range</span>(<span class="pl-k">-</span><span class="pl-c1">1.0</span>,stop<span class="pl-k">=</span><span class="pl-c1">1.0</span>,length<span class="pl-k">=</span><span class="pl-c1">201</span>)
yd <span class="pl-k">=</span> <span class="pl-c1">density</span>(px, bw, x)</pre></div>
<p dir="auto"><a target="_blank" rel="noopener noreferrer nofollow" href="https://raw.githubusercontent.com/rasmushenningsson/KernelDensitySJ.jl/master/images/pl3.svg"><img src="https://raw.githubusercontent.com/rasmushenningsson/KernelDensitySJ.jl/master/images/pl3.svg" alt="density" style="max-width: 100%;"></a></p>
<p dir="auto">If we also have y values for the points</p>
<div class="highlight highlight-source-julia notranslate position-relative overflow-auto" dir="auto" data-snippet-clipboard-copy-content="py = cos.(π.*px) .+ 0.2.*randn(40)"><pre>py <span class="pl-k">=</span> <span class="pl-c1">cos</span>.(π<span class="pl-k">.*</span>px) <span class="pl-k">.+</span> <span class="pl-c1">0.2</span><span class="pl-k">.*</span><span class="pl-c1">randn</span>(<span class="pl-c1">40</span>)</pre></div>
<p dir="auto">then we can make a smooth estimate of the underlying function by</p>
<div class="highlight highlight-source-julia notranslate position-relative overflow-auto" dir="auto" data-snippet-clipboard-copy-content="ys = smooth(px, py, bw, x)"><pre>ys <span class="pl-k">=</span> <span class="pl-c1">smooth</span>(px, py, bw, x)</pre></div>
<p dir="auto"><a target="_blank" rel="noopener noreferrer nofollow" href="https://raw.githubusercontent.com/rasmushenningsson/KernelDensitySJ.jl/master/images/pl4.svg"><img src="https://raw.githubusercontent.com/rasmushenningsson/KernelDensitySJ.jl/master/images/pl4.svg" alt="smooth" style="max-width: 100%;"></a></p>
<p dir="auto">The desired precision can be controlled by the <code>rtol</code> and <code>atol</code> keyword arguments.</p>
<p dir="auto">Here is how it looks like with a couple of different values for the bandwidth:
<a target="_blank" rel="noopener noreferrer nofollow" href="https://raw.githubusercontent.com/rasmushenningsson/KernelDensitySJ.jl/master/images/pl1.svg"><img src="https://raw.githubusercontent.com/rasmushenningsson/KernelDensitySJ.jl/master/images/pl1.svg" alt="density2" style="max-width: 100%;"></a>
<a target="_blank" rel="noopener noreferrer nofollow" href="https://raw.githubusercontent.com/rasmushenningsson/KernelDensitySJ.jl/master/images/pl2.svg"><img src="https://raw.githubusercontent.com/rasmushenningsson/KernelDensitySJ.jl/master/images/pl2.svg" alt="smooth2" style="max-width: 100%;"></a></p>
<h2 dir="auto"><a id="user-content-technical-details" class="anchor" aria-hidden="true" href="#technical-details"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a>Technical Details</h2>
<p dir="auto">The bandwidth is computed by solving equation (12) in [Sheather and Jones, 1991] using root-finding methods.
To solve the equation both accurately and fast, this packages computes and successively refines lower and upper bounds of the target function for a given bandwidth until the bounds no longer includes 0, which is enough to bracket the root.</p>
<p dir="auto">The <code>density</code> and <code>smooth</code> functions use a similar approach by refining upper and lower bounds until the desired tolerance has been achieved. It's common that the weight is very close to zero for points far away from the evaluation point and this strategy ensures that we do not spend unnecessary computing power there, while still having accurate bounds for the error.</p>
<p dir="auto">The upper and lower bounds are computed by splitting the estimated functions into intervals where the functions are convex/concave and using <a href="https://en.wikipedia.org/wiki/Jensen's_inequality" rel="nofollow">Jensen's inequality</a> for one direction and a linear approximation for the other.</p>
<h2 dir="auto"><a id="user-content-references" class="anchor" aria-hidden="true" href="#references"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a>References</h2>
<ul dir="auto">
<li>Sheather, S. J., &amp; Jones, M. C. (1991). A reliable data‐based bandwidth selection method for kernel density estimation. Journal of the Royal Statistical Society: Series B (Methodological), 53(3), 683-690.</li>
</ul>
<h1 dir="auto"><a id="user-content-other-kernel-density-estimation-packages" class="anchor" aria-hidden="true" href="#other-kernel-density-estimation-packages"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a>Other Kernel Density Estimation Packages</h1>
<p dir="auto">The following packages also implement Kernel Density Estimation in Julia:</p>
<ul dir="auto">
<li><a href="https://github.com/JuliaStats/KernelDensity.jl">KernelDensity.jl</a></li>
<li><a href="https://github.com/JuliaRobotics/KernelDensityEstimate.jl">KernelDensityEstimate.jl</a></li>
</ul>
</article></div>