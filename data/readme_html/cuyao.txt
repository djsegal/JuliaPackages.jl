<div id="readme" class="md" data-path="README.md"><article class="markdown-body entry-content container-lg" itemprop="text"><p dir="auto"><strong>Build status</strong>: <a href="https://gitlab.com/JuliaGPU/CuYao.jl/pipelines" rel="nofollow"><img src="https://camo.githubusercontent.com/f8f40e7858b2ed30612daae2667ecc6ae6143d5ed87784dfb4c08f702883f4cd/68747470733a2f2f6769746c61622e636f6d2f4a756c69614750552f437559616f2e6a6c2f6261646765732f6d61737465722f706970656c696e652e737667" alt="" data-canonical-src="https://gitlab.com/JuliaGPU/CuYao.jl/badges/master/pipeline.svg" style="max-width: 100%;"></a></p>
<p dir="auto">CUDA support for <a href="https://github.com/QuantumBFS/Yao.jl">Yao.jl</a>.</p>
<p dir="auto"><strong>Only tested locally, expect some adventures and rough edges.</strong></p>
<h2 dir="auto"><a id="user-content-installation" class="anchor" aria-hidden="true" href="#installation"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a>Installation</h2>
<p dir="auto">
CuYao is a  
    <a href="https://julialang.org" rel="nofollow">
        <img src="https://camo.githubusercontent.com/02667703c3b4e0ae66798bbc3180d99463f5d920c7ae4882da5ca516b4f16b5c/68747470733a2f2f6a756c69616c616e672e6f72672f66617669636f6e2e69636f" width="16em" data-canonical-src="https://julialang.org/favicon.ico" style="max-width: 100%;">
        Julia Language
    </a>
      package. It provides CUDA support for <a href="https://github.com/QuantumBFS/Yao.jl">Yao.jl</a>. To install CuYao,
    please <a href="https://docs.julialang.org/en/v1/manual/getting-started/" rel="nofollow">open
    Julia's interactive session (known as REPL)</a> and press <kbd>]</kbd> key in the REPL to use the package mode, then type the following command
</p>
<p dir="auto">For stable release</p>
<div class="highlight highlight-source-julia notranslate position-relative overflow-auto" dir="auto" data-snippet-clipboard-copy-content="pkg&gt; add CuYao"><pre>pkg<span class="pl-k">&gt;</span> add CuYao</pre></div>
<p dir="auto">For current master</p>
<div class="highlight highlight-source-julia notranslate position-relative overflow-auto" dir="auto" data-snippet-clipboard-copy-content="pkg&gt; add CuYao#master"><pre>pkg<span class="pl-k">&gt;</span> add CuYao<span class="pl-c"><span class="pl-c">#</span>master</span></pre></div>
<p dir="auto">You don't need to install Yao if you have <code>CuYao</code> installed. They share the same API except CUDA backend.</p>
<h2 dir="auto"><a id="user-content-documentation" class="anchor" aria-hidden="true" href="#documentation"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a>Documentation</h2>
<p dir="auto">For documentation of <a href="https://github.com/QuantumBFS/Yao.jl">Yao</a>, please refer to <a href="https://quantumbfs.github.io/Yao.jl/stable" rel="nofollow">documentation (stable)</a>.</p>
<p dir="auto"><code>CuYao.jl</code> provides only two extra APIs, <code>reg |&gt; cu</code> to upload a register to GPU, and <code>cureg |&gt; cpu</code> to download a register to CPU.</p>
<p dir="auto">To start, see the following example</p>
<div class="highlight highlight-source-julia notranslate position-relative overflow-auto" dir="auto" data-snippet-clipboard-copy-content="using CuYao

cureg = rand_state(9; nbatch=1000) |&gt; cu   # or `curand_state(9; nbatch=1000)`.
cureg |&gt; put(9, 2=&gt;Z)
measure!(cureg |&gt; append_qubits!(1) |&gt; focus!(4,1,3))
cureg |&gt; relax!(4,1,3) |&gt; cpu"><pre><span class="pl-k">using</span> CuYao

cureg <span class="pl-k">=</span> <span class="pl-c1">rand_state</span>(<span class="pl-c1">9</span>; nbatch<span class="pl-k">=</span><span class="pl-c1">1000</span>) <span class="pl-k">|&gt;</span> cu   <span class="pl-c"><span class="pl-c">#</span> or `curand_state(9; nbatch=1000)`.</span>
cureg <span class="pl-k">|&gt;</span> <span class="pl-c1">put</span>(<span class="pl-c1">9</span>, <span class="pl-c1">2</span><span class="pl-k">=&gt;</span>Z)
<span class="pl-c1">measure!</span>(cureg <span class="pl-k">|&gt;</span> <span class="pl-c1">append_qubits!</span>(<span class="pl-c1">1</span>) <span class="pl-k">|&gt;</span> <span class="pl-c1">focus!</span>(<span class="pl-c1">4</span>,<span class="pl-c1">1</span>,<span class="pl-c1">3</span>))
cureg <span class="pl-k">|&gt;</span> <span class="pl-c1">relax!</span>(<span class="pl-c1">4</span>,<span class="pl-c1">1</span>,<span class="pl-c1">3</span>) <span class="pl-k">|&gt;</span> cpu</pre></div>
<p dir="auto">Constructors <code>curand_state</code>, <code>cuzero_state</code>, <code>cuproduct_state</code>, <code>cuuniform_state</code> and <code>cughz_state</code> are tailored for GPU,
they are faster than uploading a CPU register to CPU.</p>
<h2 dir="auto"><a id="user-content-features" class="anchor" aria-hidden="true" href="#features"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a>Features</h2>
<h3 dir="auto"><a id="user-content-supported-gates" class="anchor" aria-hidden="true" href="#supported-gates"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a>Supported Gates</h3>
<ul dir="auto">
<li>general U(N) gate</li>
<li>general U(1) gate</li>
<li>better X, Y, Z gate</li>
<li>better T, S gate</li>
<li>SWAP gate</li>
<li>better control gates</li>
<li>BP diff blocks</li>
</ul>
<h3 dir="auto"><a id="user-content-supported-register-operations" class="anchor" aria-hidden="true" href="#supported-register-operations"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a>Supported Register Operations</h3>
<ul dir="auto">
<li>measure!, measure_reset!, measure_remove!, select</li>
<li>append_qudits!, append_qubits!</li>
<li>insert_qudit!, insert_qubits!</li>
<li>focus!, relax!</li>
<li>join</li>
<li>density_matrix</li>
<li>fidelity (not including density matrix)</li>
<li>expect</li>
</ul>
<h3 dir="auto"><a id="user-content-other-operations" class="anchor" aria-hidden="true" href="#other-operations"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a>Other Operations</h3>
<ul dir="auto">
<li>autodiff is supported when the only parameterized gates are rotation gates in a circuit.</li>
</ul>
<h2 dir="auto"><a id="user-content-the-team" class="anchor" aria-hidden="true" href="#the-team"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a>The Team</h2>
<p dir="auto">This project is an effort of QuantumBFS, an open source organization for quantum science. Yao is currently maintained by <a href="https://github.com/Roger-luo">Xiu-Zhe (Roger) Luo</a> and <a href="https://github.com/GiggleLiu">Jin-Guo Liu</a> with contributions from open source community. All the contributors are listed in the <a href="https://github.com/QuantumBFS/Yao.jl/graphs/contributors">contributors</a>.</p>
<h2 dir="auto"><a id="user-content-license" class="anchor" aria-hidden="true" href="#license"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a>License</h2>
<p dir="auto"><strong>CuYao</strong> is released under the Apache 2 license.</p>
</article></div>