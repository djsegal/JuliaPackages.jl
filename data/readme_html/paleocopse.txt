<div id="readme" class="md" data-path="README.md"><article class="markdown-body entry-content container-lg" itemprop="text"><h1 dir="auto"><a id="user-content-paleocopsejl" class="anchor" aria-hidden="true" href="#paleocopsejl"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a>PALEOcopse.jl</h1>
<p dir="auto"><a href="https://github.com/PALEOtoolkit/PALEOcopse.jl/actions/workflows/CI.yml"><img src="https://github.com/PALEOtoolkit/PALEOcopse.jl/actions/workflows/CI.yml/badge.svg" alt="CI" style="max-width: 100%;"></a>
<a href="https://PALEOtoolkit.github.io/PALEOcopse.jl/dev" rel="nofollow"><img src="https://camo.githubusercontent.com/7fcec4b2d3ab291529fce8ef6a4fcd4129a0683b2f5d5fe2f5c648f02db8b616/68747470733a2f2f696d672e736869656c64732e696f2f62616467652f646f63732d6465762d626c75652e737667" alt="" data-canonical-src="https://img.shields.io/badge/docs-dev-blue.svg" style="max-width: 100%;"></a></p>
<p dir="auto">Julia version of the COPSE (Carbon, Oxygen, Phosphorus, Sulphur and Evolution) biogeochemical model.</p>
<p dir="auto">The model predicts the coupled histories and controls on atmospheric O2, CO2 and ocean composition over Phanerozoic time, and is described in the following publications:</p>
<p dir="auto">Bergman, N. M., Lenton, T. M., &amp; Watson, A. J. (2004). COPSE: A new model of biogeochemical cycling over Phanerozoic time. American Journal of Science, 304(5), 397–437. <a href="https://doi.org/10.2475/ajs.304.5.397" rel="nofollow">https://doi.org/10.2475/ajs.304.5.397</a></p>
<p dir="auto">Mills, B., Daines, S. J., &amp; Lenton, T. M. (2014). Changing tectonic controls on the long-term carbon cycle from Mesozoic to present. Geochemistry, Geophysics, Geosystems, 15(12), 4866–4884. <a href="https://doi.org/10.1002/2014GC005530" rel="nofollow">https://doi.org/10.1002/2014GC005530</a></p>
<p dir="auto">Lenton, T. M., Dahl, T. W., Daines, S. J., Mills, B. J. W., Ozaki, K., Saltzman, M. R., &amp; Porada, P. (2016). Earliest land plants created modern levels of atmospheric oxygen. Proceedings of the National Academy of Sciences, 113(35), 9704–9709. <a href="https://doi.org/10.1073/pnas.1604787113" rel="nofollow">https://doi.org/10.1073/pnas.1604787113</a></p>
<p dir="auto">Lenton, T. M., Daines, S.J., Mills, B. J. W. (2018). COPSE reloaded: An improved model of biogeochemical cycling over Phanerozoic time. Earth Science Reviews, 178, 1-28. <a href="https://10.1016/j.earscirev.2017.12.004" rel="nofollow">https://10.1016/j.earscirev.2017.12.004</a></p>
<h2 dir="auto"><a id="user-content-julia-implementation" class="anchor" aria-hidden="true" href="#julia-implementation"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a>Julia implementation</h2>
<p dir="auto">The Julia version of COPSE uses the <a href="https://github.com/PALEOtoolkit/PALEOboxes.jl">PALEOboxes</a> coupler and <a href="https://github.com/PALEOtoolkit/PALEOmodel.jl">PALEOmodel</a> solvers.</p>
<p dir="auto">The COPSE model is componentized into land, atmosphere, ocean, oceanfloor and sedcrust Domains with explicit transfer of biogeochemical fluxes between them, allowing the PALEO Reactions for each Domain to be reused to create a hierarchy of coupled models eg including a spatially-resolved ocean component.</p>
<p dir="auto">The implementation is mathematically equivalent to the <a href="https://github.com/sjdaines/COPSE">Matlab version</a> and is tested against archived model output.</p>
<h2 dir="auto"><a id="user-content-installation-and-running-the-model" class="anchor" aria-hidden="true" href="#installation-and-running-the-model"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a>Installation and running the model</h2>
<h3 dir="auto"><a id="user-content-installation" class="anchor" aria-hidden="true" href="#installation"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a>Installation</h3>
<p dir="auto">NB: requires Julia 1.6 or later.  To check the Julia version:</p>
<div class="snippet-clipboard-content notranslate position-relative overflow-auto" data-snippet-clipboard-copy-content="julia&gt; versioninfo()"><pre class="notranslate"><code>julia&gt; versioninfo()
</code></pre></div>
<p dir="auto">Clone this github repository to local directory <code>PALEOcopse</code>: from a linux bash prompt or a Windows terminal,</p>
<div class="snippet-clipboard-content notranslate position-relative overflow-auto" data-snippet-clipboard-copy-content="$ git clone https://github.com/PALEOtoolkit/PALEOcopse.jl.git PALEOcopse"><pre class="notranslate"><code>$ git clone https://github.com/PALEOtoolkit/PALEOcopse.jl.git PALEOcopse
</code></pre></div>
<p dir="auto">Start julia and navigate to the <code>PALEOcopse/examples</code> folder, and run <code>setup.jl</code> to configure the <code>PALEOcopse/examples</code>
Julia environment to use the local (downloaded) version of the PALEOcopse package:</p>
<div class="snippet-clipboard-content notranslate position-relative overflow-auto" data-snippet-clipboard-copy-content="julia&gt; cd(&quot;PALEOcopse/examples&quot;)
julia&gt; include(&quot;setup.jl&quot;) # use the local version of PALEOcopse packages to allow local modifications"><pre class="notranslate"><code>julia&gt; cd("PALEOcopse/examples")
julia&gt; include("setup.jl") # use the local version of PALEOcopse packages to allow local modifications
</code></pre></div>
<h3 dir="auto"><a id="user-content-running-the-model" class="anchor" aria-hidden="true" href="#running-the-model"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a>Running the model</h3>
<p dir="auto">Start julia and navigate to the <code>PALEOcopse</code> folder, then:</p>
<div class="snippet-clipboard-content notranslate position-relative overflow-auto" data-snippet-clipboard-copy-content="julia&gt; cd(&quot;examples/COPSE&quot;)
julia&gt; import Pkg
julia&gt; Pkg.activate(&quot;..&quot;) # use the PALEOcopse/examples environment

julia&gt; include(&quot;COPSE_reloaded_reloaded.jl&quot;)"><pre class="notranslate"><code>julia&gt; cd("examples/COPSE")
julia&gt; import Pkg
julia&gt; Pkg.activate("..") # use the PALEOcopse/examples environment

julia&gt; include("COPSE_reloaded_reloaded.jl")
</code></pre></div>
<h2 dir="auto"><a id="user-content-evaluation-data" class="anchor" aria-hidden="true" href="#evaluation-data"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a>Evaluation data</h2>
<p dir="auto">Datasets are not part of the public release but are available on request from the authors.</p>
<h2 dir="auto"><a id="user-content-using-paleocopse-reactions-from-other-models" class="anchor" aria-hidden="true" href="#using-paleocopse-reactions-from-other-models"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a>Using PALEOcopse Reactions from other models</h2>
<p dir="auto">The PALEO Reactions comprising the COPSE model are available when the registered PALEOcopse package is loaded (without downloading the repository), ie</p>
<div class="snippet-clipboard-content notranslate position-relative overflow-auto" data-snippet-clipboard-copy-content="julia&gt; Pkg.add(&quot;PALEOcopse&quot;)
julia&gt; import PALEOcopse"><pre class="notranslate"><code>julia&gt; Pkg.add("PALEOcopse")
julia&gt; import PALEOcopse
</code></pre></div>
</article></div>