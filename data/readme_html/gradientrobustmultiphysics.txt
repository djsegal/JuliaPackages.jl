<div id="readme" class="md" data-path="README.md"><article class="markdown-body entry-content container-lg" itemprop="text"><p dir="auto"><a href="https://github.com/chmerdon/GradientRobustMultiPhysics.jl/actions"><img src="https://github.com/chmerdon/GradientRobustMultiPhysics.jl/workflows/linux-macos-windows/badge.svg" alt="Build status" style="max-width: 100%;"></a>
<a href="https://chmerdon.github.io/GradientRobustMultiPhysics.jl/stable/index.html" rel="nofollow"><img src="https://camo.githubusercontent.com/c97f0a5f2ae95755f64a27f1aa8d9a17462941fd3d6c907c7630abd5d3e60acf/68747470733a2f2f696d672e736869656c64732e696f2f62616467652f646f63732d737461626c652d626c75652e737667" alt="" data-canonical-src="https://img.shields.io/badge/docs-stable-blue.svg" style="max-width: 100%;"></a>
<a href="https://chmerdon.github.io/GradientRobustMultiPhysics.jl/dev/index.html" rel="nofollow"><img src="https://camo.githubusercontent.com/7fcec4b2d3ab291529fce8ef6a4fcd4129a0683b2f5d5fe2f5c648f02db8b616/68747470733a2f2f696d672e736869656c64732e696f2f62616467652f646f63732d6465762d626c75652e737667" alt="" data-canonical-src="https://img.shields.io/badge/docs-dev-blue.svg" style="max-width: 100%;"></a>
<a href="https://zenodo.org/badge/latestdoi/229078096" rel="nofollow"><img src="https://camo.githubusercontent.com/83f1cc4a9057528987b4413f47fdc47467e4f99013ba99473c329c92be5ee289/68747470733a2f2f7a656e6f646f2e6f72672f62616467652f3232393037383039362e737667" alt="DOI" data-canonical-src="https://zenodo.org/badge/229078096.svg" style="max-width: 100%;"></a></p>
<h1 dir="auto"><a id="user-content-gradientrobustmultiphysicsjl" class="anchor" aria-hidden="true" href="#gradientrobustmultiphysicsjl"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a>GradientRobustMultiPhysics.jl</h1>
<p dir="auto">finite element module for Julia focussing on gradient-robust finite element methods and multiphysics applications, part of the meta-package <a href="https://github.com/WIAS-BERLIN/PDELib.jl">PDELIB.jl</a></p>
<h3 dir="auto"><a id="user-content-featureslimitations" class="anchor" aria-hidden="true" href="#featureslimitations"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a>Features/Limitations:</h3>
<ul dir="auto">
<li>solves 1D, 2D and 3D problems in Cartesian coordinates</li>
<li>several available finite elements (scalar and vector-valued, H1, Hdiv and Hcurl on different geometries), see <a href="https://chmerdon.github.io/GradientRobustMultiPhysics.jl/stable/fems/" rel="nofollow">here</a> for a complete list</li>
<li>finite elements can be broken (e.g. piecewise Hdiv) or live on faces or edges (experimental feature)</li>
<li>grids by <a href="https://github.com/j-fu/ExtendableGrids.jl">ExtendableGrids.jl</a></li>
<li>PDEDescription module for easy and close-to-physics problem description (as variational equations) independent from the actual discretisation</li>
<li>Newton terms for nonlinear operators are added automatically by automatic differentiation (experimental feature)</li>
<li>solver can run fixed-point iterations between subsets of equations of the PDEDescription</li>
<li>time-dependent problems can be integrated in time by internal backward Euler or Crank-Nicolson implementation or via the external module <a href="https://github.com/SciML/DifferentialEquations.jl">DifferentialEquations.jl</a> (experimental)</li>
<li>reconstruction operators for gradient-robust Stokes discretisations (BR-&gt;RT0/BDM1 or CR-&gt;RT0 in 2D/3D, and P2B-&gt;RT1/BDM2 in 2D, more to come)</li>
<li>plotting via functionality of <a href="https://github.com/j-fu/GridVisualize.jl">GridVisualize.jl</a></li>
<li>export into csv files (or vtk files via <a href="https://github.com/jipolanco/WriteVTK.jl">WriteVTK.jl</a> interface of <a href="https://github.com/j-fu/ExtendableGrids.jl">ExtendableGrids.jl</a>)</li>
</ul>
<h3 dir="auto"><a id="user-content-quick-example" class="anchor" aria-hidden="true" href="#quick-example"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a>Quick Example</h3>
<p dir="auto">The following minimal example demonstrates how to setup a Poisson problem.</p>
<div class="highlight highlight-source-julia notranslate position-relative overflow-auto" dir="auto" data-snippet-clipboard-copy-content="using GradientRobustMultiPhysics
using ExtendableGrids

# build/load any grid (here: a uniform-refined 2D unit square into triangles)
xgrid = uniform_refine(grid_unitsquare(Triangle2D), 4)

# create empty PDE description
Problem = PDEDescription(&quot;Poisson problem&quot;)

# add unknown(s) (here: &quot;u&quot; that gets id 1 for later reference)
add_unknown!(Problem; unknown_name = &quot;u&quot;, equation_name = &quot;Poisson equation&quot;)

# add left-hand side PDEoperator(s) (here: only Laplacian with diffusion coefficient 1e-3)
add_operator!(Problem, [1,1], LaplaceOperator(1e-3))

# define right-hand side function (as a constant DataFunction, x and t dependency explained in documentation)
f = DataFunction([1]; name = &quot;f&quot;)

# add right-hand side data (here: f = [1] in region(s) [1])
add_rhsdata!(Problem, 1, LinearForm(Identity, f; regions = [1]))

# add boundary data (here: zero data for boundary regions 1:4)
add_boundarydata!(Problem, 1, [1,2,3,4], HomogeneousDirichletBoundary)

# discretise = choose FEVector with appropriate FESpaces
FEType = H1P2{1,2} # quadratic element with 1 component in 2D
Solution = FEVector(FESpace{FEType}(xgrid); name = &quot;u_h&quot;)

# inspect problem and Solution vector structure
@show Problem Solution

# solve
solve!(Solution, Problem)"><pre><span class="pl-k">using</span> GradientRobustMultiPhysics
<span class="pl-k">using</span> ExtendableGrids

<span class="pl-c"><span class="pl-c">#</span> build/load any grid (here: a uniform-refined 2D unit square into triangles)</span>
xgrid <span class="pl-k">=</span> <span class="pl-c1">uniform_refine</span>(<span class="pl-c1">grid_unitsquare</span>(Triangle2D), <span class="pl-c1">4</span>)

<span class="pl-c"><span class="pl-c">#</span> create empty PDE description</span>
Problem <span class="pl-k">=</span> <span class="pl-c1">PDEDescription</span>(<span class="pl-s"><span class="pl-pds">"</span>Poisson problem<span class="pl-pds">"</span></span>)

<span class="pl-c"><span class="pl-c">#</span> add unknown(s) (here: "u" that gets id 1 for later reference)</span>
<span class="pl-c1">add_unknown!</span>(Problem; unknown_name <span class="pl-k">=</span> <span class="pl-s"><span class="pl-pds">"</span>u<span class="pl-pds">"</span></span>, equation_name <span class="pl-k">=</span> <span class="pl-s"><span class="pl-pds">"</span>Poisson equation<span class="pl-pds">"</span></span>)

<span class="pl-c"><span class="pl-c">#</span> add left-hand side PDEoperator(s) (here: only Laplacian with diffusion coefficient 1e-3)</span>
<span class="pl-c1">add_operator!</span>(Problem, [<span class="pl-c1">1</span>,<span class="pl-c1">1</span>], <span class="pl-c1">LaplaceOperator</span>(<span class="pl-c1">1e-3</span>))

<span class="pl-c"><span class="pl-c">#</span> define right-hand side function (as a constant DataFunction, x and t dependency explained in documentation)</span>
f <span class="pl-k">=</span> <span class="pl-c1">DataFunction</span>([<span class="pl-c1">1</span>]; name <span class="pl-k">=</span> <span class="pl-s"><span class="pl-pds">"</span>f<span class="pl-pds">"</span></span>)

<span class="pl-c"><span class="pl-c">#</span> add right-hand side data (here: f = [1] in region(s) [1])</span>
<span class="pl-c1">add_rhsdata!</span>(Problem, <span class="pl-c1">1</span>, <span class="pl-c1">LinearForm</span>(Identity, f; regions <span class="pl-k">=</span> [<span class="pl-c1">1</span>]))

<span class="pl-c"><span class="pl-c">#</span> add boundary data (here: zero data for boundary regions 1:4)</span>
<span class="pl-c1">add_boundarydata!</span>(Problem, <span class="pl-c1">1</span>, [<span class="pl-c1">1</span>,<span class="pl-c1">2</span>,<span class="pl-c1">3</span>,<span class="pl-c1">4</span>], HomogeneousDirichletBoundary)

<span class="pl-c"><span class="pl-c">#</span> discretise = choose FEVector with appropriate FESpaces</span>
FEType <span class="pl-k">=</span> H1P2{<span class="pl-c1">1</span>,<span class="pl-c1">2</span>} <span class="pl-c"><span class="pl-c">#</span> quadratic element with 1 component in 2D</span>
Solution <span class="pl-k">=</span> <span class="pl-c1">FEVector</span>(<span class="pl-c1">FESpace</span><span class="pl-c1">{FEType}</span>(xgrid); name <span class="pl-k">=</span> <span class="pl-s"><span class="pl-pds">"</span>u_h<span class="pl-pds">"</span></span>)

<span class="pl-c"><span class="pl-c">#</span> inspect problem and Solution vector structure</span>
<span class="pl-c1">@show</span> Problem Solution

<span class="pl-c"><span class="pl-c">#</span> solve</span>
<span class="pl-c1">solve!</span>(Solution, Problem)</pre></div>
<h3 dir="auto"><a id="user-content-other-examples" class="anchor" aria-hidden="true" href="#other-examples"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a>Other Examples</h3>
<p dir="auto">More extensive examples can be found in the <a href="https://chmerdon.github.io/GradientRobustMultiPhysics.jl/stable/index.html" rel="nofollow">documentation</a>
and interactive <a href="https://github.com/fonsp/Pluto.jl">Pluto</a> notebooks can be found in the subfolder examples/pluto for download.</p>
<h3 dir="auto"><a id="user-content-installation" class="anchor" aria-hidden="true" href="#installation"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a>Installation</h3>
<p dir="auto">via Julia package manager in Julia 1.6 or above:</p>
<div class="snippet-clipboard-content notranslate position-relative overflow-auto" data-snippet-clipboard-copy-content="# latest stable version
(@v1.6) pkg&gt; add GradientRobustMultiPhysics
# latest version
(@v1.6) pkg&gt; add GradientRobustMultiPhysics#master"><pre lang="@example" class="notranslate"><code># latest stable version
(@v1.6) pkg&gt; add GradientRobustMultiPhysics
# latest version
(@v1.6) pkg&gt; add GradientRobustMultiPhysics#master
</code></pre></div>
<h3 dir="auto"><a id="user-content-dependencies-on-other-julia-packages" class="anchor" aria-hidden="true" href="#dependencies-on-other-julia-packages"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a>Dependencies on other Julia packages:</h3>
<p dir="auto"><a href="https://github.com/j-fu/ExtendableGrids.jl">ExtendableGrids.jl</a><br>
<a href="https://github.com/j-fu/GridVisualize.jl">GridVisualize.jl</a><br>
<a href="https://github.com/j-fu/ExtendableSparse.jl">ExtendableSparse.jl</a><br>
<a href="https://github.com/JuliaDocs/DocStringExtensions.jl">DocStringExtensions.jl</a><br>
<a href="https://github.com/JuliaDiff/ForwardDiff.jl">ForwardDiff.jl</a><br>
<a href="https://github.com/JuliaDiff/DiffResults.jl">DiffResults.jl</a><br>
<a href="https://github.com/JuliaArrays/StaticArrays.jl">StaticArrays.jl</a></p>
</article></div>