<div id="readme" class="md" data-path="README.md"><article class="markdown-body entry-content container-lg" itemprop="text"><h1 dir="auto"><a id="user-content-linearfitxyerrorsjl" class="anchor" aria-hidden="true" href="#linearfitxyerrorsjl"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a>LinearFitXYerrors.jl</h1>
<p dir="auto"><a target="_blank" rel="noopener noreferrer nofollow" href="https://user-images.githubusercontent.com/20739393/132685450-1a34351f-ad02-49ee-9d57-b498437e356a.png"><img src="https://user-images.githubusercontent.com/20739393/132685450-1a34351f-ad02-49ee-9d57-b498437e356a.png" width="320" style="max-width: 100%;"></a></p>
<p dir="auto">This small Julia package, based on York et al. (2004), performs 1D linear fitting of experimental data with uncertainties in both X and Y:</p>
<div class="snippet-clipboard-content notranslate position-relative overflow-auto" data-snippet-clipboard-copy-content=" Linear fit:             Y = a + b*X                             [1]
        
 Errors:                 X ± σX;  Y ± σY                         [2]

 Errors' correlation:    r =  = cov(σX, σY) / (σX * σY)          [3]"><pre class="notranslate"><code> Linear fit:             Y = a + b*X                             [1]
        
 Errors:                 X ± σX;  Y ± σY                         [2]

 Errors' correlation:    r =  = cov(σX, σY) / (σX * σY)          [3]
</code></pre></div>
<p dir="auto">where:</p>
<ul dir="auto">
<li><code>X</code> and <code>Y</code> are input data vectors with length ≥ 3</li>
<li>Optional standard deviation errors <code>σX</code> and <code>σY</code> are vectors or scalars</li>
<li>Optional <code>r</code> is the correlation between the <code>σX</code> and <code>σY</code> errors.<br>
<code>r</code> can be a vector or scalar</li>
</ul>
<p dir="auto">For the <code>σX</code> and <code>σY</code> errors (error ellipses) a bivariate Gaussian distribution is assumed.<br>
If no errors are provided, or if only <code>σX</code> or <code>σY</code> are provided, then equivalent regression results could be obtained using the <a href="https://github.com/JuliaNLSolvers/LsqFit.jl">LsqFit.jl</a> package.</p>
<p dir="auto">The package computes:</p>
<ul dir="auto">
<li>The intercept <code>a</code>, the slope <code>b</code> and their uncertainties <code>σa</code> and <code>σb</code></li>
<li><code>σa95</code> and <code>σb95</code>: 95%-confidence intervals using a two-tailed t-Student distribution, e.g.: <code>b ± σb95 = b ± t(0.975,N-2)*σb</code></li>
<li>Goodness of fit <code>S</code> (reduced Χ² test): Standard Error of Estimate with Χ² distribution with N-2 degrees of freedom<br>
<code>S ~ 1</code>: fit consistent with errors, <code>S &gt; 1</code>: poor fit, <code>S &gt;&gt; 1</code>: errors underestimated, <code>S &lt; 1</code>: overfitting or errors overestimated</li>
<li>Pearson's correlation coefficient <code>ρ</code> that accounts for data errors</li>
<li>Optional display of results with error ellipses and confidence intervals (the latter for no errors case only)</li>
</ul>
<p dir="auto">The default argument <code>isplot=false</code> can be turned on to plot the results.<br>
Currently <code>using Plots.jl; gr()</code> is used.</p>
<h2 dir="auto"></h2>
<h2 dir="auto"><a id="user-content-installation" class="anchor" aria-hidden="true" href="#installation"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a>Installation</h2>
<div class="highlight highlight-source-julia notranslate position-relative overflow-auto" dir="auto" data-snippet-clipboard-copy-content="julia&gt; ] add LinearFitXYerrors
julia&gt; using LinearFitXYerrors"><pre>julia<span class="pl-k">&gt;</span> ] add LinearFitXYerrors
julia<span class="pl-k">&gt;</span> <span class="pl-k">using</span> LinearFitXYerrors</pre></div>
<h2 dir="auto"></h2>
<h2 dir="auto"><a id="user-content-useage" class="anchor" aria-hidden="true" href="#useage"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a>Useage</h2>
<div class="highlight highlight-source-julia notranslate position-relative overflow-auto" dir="auto" data-snippet-clipboard-copy-content="# The input data and regression results are returned in the fields of the `st` structure (::stfitxy):

st = linearfitxy(X, Y)    # no errors in X and Y, no plot displayed

st = linearfitxy(X, Y; σX, σY, isplot=true)    # X-Y errors non-correlated (r=0); plot with ratio=1

st = linearfitxy(X, Y; σX, σY, r=0, isplot=true, ratio=:auto)  # X-Y errors non-correlated (r=0); plot with auto ratio"><pre><span class="pl-c"><span class="pl-c">#</span> The input data and regression results are returned in the fields of the `st` structure (::stfitxy):</span>

st <span class="pl-k">=</span> <span class="pl-c1">linearfitxy</span>(X, Y)    <span class="pl-c"><span class="pl-c">#</span> no errors in X and Y, no plot displayed</span>

st <span class="pl-k">=</span> <span class="pl-c1">linearfitxy</span>(X, Y; σX, σY, isplot<span class="pl-k">=</span><span class="pl-c1">true</span>)    <span class="pl-c"><span class="pl-c">#</span> X-Y errors non-correlated (r=0); plot with ratio=1</span>

st <span class="pl-k">=</span> <span class="pl-c1">linearfitxy</span>(X, Y; σX, σY, r<span class="pl-k">=</span><span class="pl-c1">0</span>, isplot<span class="pl-k">=</span><span class="pl-c1">true</span>, ratio<span class="pl-k">=</span><span class="pl-c1">:auto</span>)  <span class="pl-c"><span class="pl-c">#</span> X-Y errors non-correlated (r=0); plot with auto ratio</span></pre></div>
<h2 dir="auto"><a id="user-content-notes" class="anchor" aria-hidden="true" href="#notes"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a>Notes:</h2>
<ul dir="auto">
<li>The objective for this first package was to learn how to publish a Julia package via Github while implementing York's technique.</li>
<li>Currently the confidence interval "hyperbolic" plot ribbons are only provided for the case where input data have no errors, but in all cases, linear ribbons accounting for the standard deviation of the regression results are produced.</li>
<li>The package author is not a statistician and the topics of "errors in variables" and "confidence intervals" are beyond his expertise.</li>
<li>While the results seem to be consistent with the references provided, one notable exception is Amen (2012). The latter estimates standard deviation errors for regression in Example-2 that seem to be much smaller than using this package technique (York et al., 2004). However, the input data in that example have large correlated errors and York's solution seems reasonable (tbc).</li>
</ul>
<h2 dir="auto"></h2>
<h2 dir="auto"><a id="user-content-references" class="anchor" aria-hidden="true" href="#references"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a>References:</h2>
<p dir="auto"><em>Altman, D. and Gardner, M. [1988] Statistics in Medicine: Calculating confidence intervals for regression and correlation. British Medical Journal, 296(6631), pp.1238–1242.</em></p>
<p dir="auto"><em>Amen, S. [2012] Linear estimation for data with error ellipses. MSc. Statistics, Univ. of Texas</em></p>
<p dir="auto"><em>Cantrell, C. [2008] Technical Note: Review of methods for linear least-squares fitting of data and application to atmospheric chemistry problems. Atmospheric Chem. &amp; Physics, 8(17), pp.5477–5487</em></p>
<p dir="auto"><em>Mahon, K. [1996] The New “York” Regression: Application of an Improved Statistical Method to Geochemistry. International Geology Review, 38(4), pp.293–303</em></p>
<p dir="auto"><em>Reduced Chi-aquared Test: <a href="https://en.wikipedia.org/wiki/Reduced_chi-squared_statistic" rel="nofollow">https://en.wikipedia.org/wiki/Reduced_chi-squared_statistic</a></em></p>
<p dir="auto"><em>Regression dilution: <a href="https://en.wikipedia.org/wiki/Regression_dilution" rel="nofollow">https://en.wikipedia.org/wiki/Regression_dilution</a></em></p>
<p dir="auto"><em>York, D. [1966] Least-squares fitting of a straight line. Canadian Journal of Physics, 44(5), pp.1079–1086</em></p>
<p dir="auto"><em>York, D. [1969] Least squares fitting of a straight line with correlated errors. Earth and Planetary Science Letters, 5, pp.320–324.</em></p>
<p dir="auto"><em>York, D., Evensen, N., Martinez, M. and Delgado J. [2004] Unified equations for the slope; intercept and standard errors of the best straight line. Am. J.Phys. 72 [3]</em></p>
<h2 dir="auto"></h2>
<h4 dir="auto"><a id="user-content-nb-find-the-julia-code-for-the-displayed-examples-below-in-the-repository-examples-folder" class="anchor" aria-hidden="true" href="#nb-find-the-julia-code-for-the-displayed-examples-below-in-the-repository-examples-folder"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a><em>NB: find the Julia code for the displayed examples below in the repository <a href="https://github.com/rafael-guerra-www/LinearFitXYerrors.jl/tree/master/examples">examples folder</a></em></h4>
<h2 dir="auto"><a id="user-content-example-0-no-errors-in-x-and-y" class="anchor" aria-hidden="true" href="#example-0-no-errors-in-x-and-y"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a>Example-0: no errors in X and Y</h2>
<p dir="auto"><em>Reference: Altman and Gardner (1988)</em></p>
<p dir="auto"><a target="_blank" rel="noopener noreferrer nofollow" href="https://user-images.githubusercontent.com/20739393/132855741-7fbc7d80-76af-4f0b-a960-13e12872f8fd.png"><img src="https://user-images.githubusercontent.com/20739393/132855741-7fbc7d80-76af-4f0b-a960-13e12872f8fd.png" alt="Example0b_LinearFitXYerrors" style="max-width: 100%;"></a></p>
<h2 dir="auto"><a id="user-content-example-1-uncorrelated-errors-in-x-and-y" class="anchor" aria-hidden="true" href="#example-1-uncorrelated-errors-in-x-and-y"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a>Example-1: uncorrelated errors in X and Y</h2>
<p dir="auto"><em>References: York (1966) and Cantrell (2008)</em></p>
<p dir="auto"><a target="_blank" rel="noopener noreferrer nofollow" href="https://user-images.githubusercontent.com/20739393/132855764-ce6f5e40-8d5f-4d18-9c10-bdd23fec927b.png"><img src="https://user-images.githubusercontent.com/20739393/132855764-ce6f5e40-8d5f-4d18-9c10-bdd23fec927b.png" alt="Example1_LinearFitXYerrors" style="max-width: 100%;"></a></p>
<h2 dir="auto"><a id="user-content-example-2-correlated-errors-in-x-and-y" class="anchor" aria-hidden="true" href="#example-2-correlated-errors-in-x-and-y"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a>Example-2: correlated errors in X and Y</h2>
<p dir="auto"><em>Reference: Amen (2012)</em></p>
<p dir="auto"><a target="_blank" rel="noopener noreferrer nofollow" href="https://user-images.githubusercontent.com/20739393/132855799-20aeb2fb-c327-46c6-b864-dc5ebca75736.png"><img src="https://user-images.githubusercontent.com/20739393/132855799-20aeb2fb-c327-46c6-b864-dc5ebca75736.png" alt="Example2_LinearFitXYerrors" style="max-width: 100%;"></a></p>
<h2 dir="auto"><a id="user-content-example-3-correlated-errors-in-x-and-y" class="anchor" aria-hidden="true" href="#example-3-correlated-errors-in-x-and-y"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a>Example-3: correlated errors in X and Y</h2>
<p dir="auto"><em>Reference: Mahon (1996)</em></p>
<p dir="auto"><a target="_blank" rel="noopener noreferrer nofollow" href="https://user-images.githubusercontent.com/20739393/132855823-f056ce55-c017-4360-9ecf-b5fbcd6f3582.png"><img src="https://user-images.githubusercontent.com/20739393/132855823-f056ce55-c017-4360-9ecf-b5fbcd6f3582.png" alt="Example3_LinearFitXYerrors" style="max-width: 100%;"></a></p>
</article></div>