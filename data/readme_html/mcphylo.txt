<div id="readme" class="md" data-path="Readme.md"><article class="markdown-body entry-content container-lg" itemprop="text"><p><a href="https://codecov.io/gh/erathorn/MCPhylo.jl" rel="nofollow"><img src="https://camo.githubusercontent.com/8392b0c74f800ca64fa6092cebb088052ff785cae9616ac981f06eb73c125f19/68747470733a2f2f636f6465636f762e696f2f67682f65726174686f726e2f4d435068796c6f2e6a6c2f6272616e63682f6d61737465722f67726170682f62616467652e7376673f746f6b656e3d3035445152475141494b" alt="codecov" data-canonical-src="https://codecov.io/gh/erathorn/MCPhylo.jl/branch/master/graph/badge.svg?token=05DQRGQAIK" style="max-width:100%;"></a></p>
<h1><a id="user-content-mcphylo" class="anchor" aria-hidden="true" href="#mcphylo"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>MCPhylo</h1>
<p>This package does phylogenetic computations in Julia. It is an extension of the <code>Mamba</code> package which does Markov Chain Monte Carlo (MCMC) sampling for Bayesian analysis. (<a href="https://mambajl.readthedocs.io/en/latest/" rel="nofollow">https://mambajl.readthedocs.io/en/latest/</a>)
<strong>MCPhylo</strong> extends <code>Mamba</code> by a tree module to perform phylogenetic computations.</p>
<p>which currently supports the output of newick strings for tree structures.
The goal is to facilitate phylogenetic computations in computational historical
linguistics. To facilitate the inference of phylogenetic trees,
<em>Probabilistic Path Hamiltonian Dynamics</em> (<a href="https://arxiv.org/pdf/1702.07814.pdf" rel="nofollow">https://arxiv.org/pdf/1702.07814.pdf</a>)
are implemented.</p>
<p><strong>This package is currently under heavy development.</strong></p>
<p><strong>This package needs at least Julia 1.4.2. This package is not backwards compatible!</strong></p>
<p><strong>This module is build on a forked instance of Mamba 0.12.0</strong></p>
<p><strong>Note</strong> This package uses multithreading. (<a href="https://docs.julialang.org/en/v1/base/multi-threading/" rel="nofollow">https://docs.julialang.org/en/v1/base/multi-threading/</a>)</p>
<hr>
<h2><a id="user-content-citation" class="anchor" aria-hidden="true" href="#citation"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>Citation</h2>
<p>If you use this software in an academic publication please cite the following paper
No-U-Turn sampling for phylogenetic trees, Wahle (2021).  (<a href="https://doi.org/10.1101/2021.03.16.435623" rel="nofollow">bioRxiv Paper</a>)</p>
<hr>
<h2><a id="user-content-general-information" class="anchor" aria-hidden="true" href="#general-information"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>General Information</h2>
<p>In order to use the current version of the package clone the repo and place it into your current working directory.</p>
<div class="highlight highlight-source-julia position-relative" data-snippet-clipboard-copy-content="include(&quot;./src/MCPhylo.jl&quot;)
using .MCPhylo
"><pre><span class="pl-c1">include</span>(<span class="pl-s"><span class="pl-pds">"</span>./src/MCPhylo.jl<span class="pl-pds">"</span></span>)
<span class="pl-k">using</span> <span class="pl-k">.</span>MCPhylo</pre></div>
<p>Installation of the package may also work.</p>
<div class="highlight highlight-source-julia position-relative" data-snippet-clipboard-copy-content="using Pkg
Pkg.add(&quot;https://github.com/erathorn/JuliaTree&quot;)
"><pre><span class="pl-k">using</span> Pkg
Pkg<span class="pl-k">.</span><span class="pl-c1">add</span>(<span class="pl-s"><span class="pl-pds">"</span>https://github.com/erathorn/JuliaTree<span class="pl-pds">"</span></span>)</pre></div>
<p>The setup of a model is as in the original Mamba package.</p>
<p>Nexus and CSV files with binarized cognate data are supported.</p>
<h2><a id="user-content-new-functions" class="anchor" aria-hidden="true" href="#new-functions"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>New Functions</h2>
<p>The standard <code>mcmc</code> function from <code>Mamba</code> takes an extra Boolean argument <code>trees</code> indicating if the sampled trees should be stored. If set to <em>true</em> the trees will be stored. The default is <em>false</em>.</p>
<p>You can flush the model parameters and the sampled trees to a file, using the <code>to_file</code> function. It takes as a first argument an MCMC object and second a path to a folder where the results should be stored. This file can be read by the Tracer software (<a href="https://github.com/beast-dev/tracer/">https://github.com/beast-dev/tracer/</a>). Additionally, if trees are stored it will create a file with newick strings of these trees.</p>
<h3><a id="user-content-new--adjusted-samplers" class="anchor" aria-hidden="true" href="#new--adjusted-samplers"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>New &amp; Adjusted Samplers</h3>
<p><code>PNUTS </code> is a sampler which does <em>Phylogenetic No-U-Turn sampling</em> (Wahle (2021)).  (<a href="https://doi.org/10.1101/2021.03.16.435623" rel="nofollow">bioRxiv Paper</a>)</p>
<p>It samples tree stochastic nodes.</p>
<p><code>RWM</code> Random walk metroplis hastings sampling can work with trees now. For numerical nodes the sampler and the function signature is as in the original Mamba package. For tree structures the signature is slightly different: <code>RWM(:tree, :all)</code> or <code>RWM(:tree, [:NNI, :Swing])</code> The first variant uses all available tree manipulation moves (see [Tree Manipulation](TreeStuff.md#Tree Manipulation)), the second variant only makes use of a user defined subset of these moves. Ladderization of the tree is not an eligible tree manipulation move</p>
<p><code>NUTS</code> can take the argument <code>dtype=:Zygote</code> to use Zygote for the calculation of the gradient. The default is finite differencing.</p>
<p><code>Slice</code> can also sample trees. It does a slice sampling operation on the branch lengths of the tree.</p>
<h2><a id="user-content-tree-functionalities" class="anchor" aria-hidden="true" href="#tree-functionalities"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>Tree Functionalities</h2>
<p>For the available tree functionalities see: <a href="TreeStuff.md">Tree Functionalities</a></p>
</article></div>