<div id="readme" class="md" data-path="README.md"><article class="markdown-body entry-content container-lg" itemprop="text"><h1><a id="user-content-matlabdiffeqjl" class="anchor" aria-hidden="true" href="#matlabdiffeqjl"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>MATLABDiffEq.jl</h1>
<p><a href="https://gitter.im/JuliaDiffEq/Lobby?utm_source=badge&amp;utm_medium=badge&amp;utm_campaign=pr-badge&amp;utm_content=badge" rel="nofollow"><img src="https://camo.githubusercontent.com/063a520f1733d1b53d1e2fdb37b70a8016dd36f6/68747470733a2f2f6261646765732e6769747465722e696d2f4a756c69614469666645712f4c6f6262792e737667" alt="Join the chat at https://gitter.im/JuliaDiffEq/Lobby" data-canonical-src="https://badges.gitter.im/JuliaDiffEq/Lobby.svg" style="max-width:100%;"></a></p>
<p>MATLABDiffEq.jl is a common interface binding for the <a href="https://www.mathworks.com/products/matlab.html" rel="nofollow">MATLAB</a> ordinary differential equation solvers. It uses the <a href="https://github.com/JuliaInterop/MATLAB.jl">MATLAB.jl</a> interop in order to
send the differential equation over to MATLAB and solve it. Note that this
package requires the differential equation function to be defined using
<a href="https://github.com/JuliaDiffEq/ParameterizedFunctions.jl">ParameterizedFunctions.jl</a>.</p>
<p>Note that this package isn't for production use and is mostly just for benchmarking
and helping new users migrate models over to Julia.
For more efficient solvers, see the
<a href="https://github.com/JuliaDiffEq/DifferentialEquations.jl">DifferentialEquations.jl documentation</a>.</p>
<h2><a id="user-content-installation" class="anchor" aria-hidden="true" href="#installation"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>Installation</h2>
<p>To install MATLABDiffEq.jl, use the following:</p>
<div class="highlight highlight-source-julia"><pre><span class="pl-k">using</span> Pkg
Pkg<span class="pl-k">.</span><span class="pl-c1">add</span>(<span class="pl-s"><span class="pl-pds">"</span>MATLABDiffEq<span class="pl-pds">"</span></span>)</pre></div>
<h2><a id="user-content-using-matlabdiffeqjl" class="anchor" aria-hidden="true" href="#using-matlabdiffeqjl"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>Using MATLABDiffEq.jl</h2>
<p>MATLABDiffEq.jl is simply a solver on the DiffEq common interface, so for details see the <a href="https://juliadiffeq.github.io/DiffEqDocs.jl/dev/" rel="nofollow">DifferentialEquations.jl documentation</a>.
However, the only options implemented are those for error calculations
(<code>timeseries_error</code>), <code>saveat</code> and tolerances.</p>
<p>Note that the algorithms are defined to have the same name as the MATLAB algorithms,
but are not exported. Thus to use <code>ode45</code>, you would specify the algorithm as
<code>MATLABDiffEq.ode45()</code>.</p>
<h2><a id="user-content-example" class="anchor" aria-hidden="true" href="#example"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>Example</h2>
<div class="highlight highlight-source-julia"><pre><span class="pl-k">using</span> MATLABDiffEq, ParameterizedFunctions

f <span class="pl-k">=</span> <span class="pl-c1">@ode_def</span> LotkaVolterra <span class="pl-k">begin</span>
  dx <span class="pl-k">=</span> <span class="pl-c1">1.5</span>x <span class="pl-k">-</span> x<span class="pl-k">*</span>y
  dy <span class="pl-k">=</span> <span class="pl-k">-</span><span class="pl-c1">3</span>y <span class="pl-k">+</span> x<span class="pl-k">*</span>y
<span class="pl-k">end</span>

tspan <span class="pl-k">=</span> (<span class="pl-c1">0.0</span>,<span class="pl-c1">10.0</span>)
u0 <span class="pl-k">=</span> [<span class="pl-c1">1.0</span>,<span class="pl-c1">1.0</span>]
prob <span class="pl-k">=</span> <span class="pl-c1">ODEProblem</span>(f,u0,tspan)
sol <span class="pl-k">=</span> <span class="pl-c1">solve</span>(prob,MATLABDiffEq<span class="pl-k">.</span><span class="pl-c1">ode45</span>())

<span class="pl-k">function</span> <span class="pl-en">lorenz</span>(du,u,p,t)
   du[<span class="pl-c1">1</span>] <span class="pl-k">=</span> <span class="pl-c1">10.0</span>(u[<span class="pl-c1">2</span>]<span class="pl-k">-</span>u[<span class="pl-c1">1</span>])
   du[<span class="pl-c1">2</span>] <span class="pl-k">=</span> u[<span class="pl-c1">1</span>]<span class="pl-k">*</span>(<span class="pl-c1">28.0</span><span class="pl-k">-</span>u[<span class="pl-c1">3</span>]) <span class="pl-k">-</span> u[<span class="pl-c1">2</span>]
   du[<span class="pl-c1">3</span>] <span class="pl-k">=</span> u[<span class="pl-c1">1</span>]<span class="pl-k">*</span>u[<span class="pl-c1">2</span>] <span class="pl-k">-</span> (<span class="pl-c1">8</span><span class="pl-k">/</span><span class="pl-c1">3</span>)<span class="pl-k">*</span>u[<span class="pl-c1">3</span>]
<span class="pl-k">end</span>
u0 <span class="pl-k">=</span> [<span class="pl-c1">1.0</span>;<span class="pl-c1">0.0</span>;<span class="pl-c1">0.0</span>]
tspan <span class="pl-k">=</span> (<span class="pl-c1">0.0</span>,<span class="pl-c1">100.0</span>)
prob <span class="pl-k">=</span> <span class="pl-c1">ODEProblem</span>(lorenz,u0,tspan)
sol <span class="pl-k">=</span> <span class="pl-c1">solve</span>(prob,MATLABDiffEq<span class="pl-k">.</span><span class="pl-c1">ode45</span>())</pre></div>
<h2><a id="user-content-measuring-overhead" class="anchor" aria-hidden="true" href="#measuring-overhead"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>Measuring Overhead</h2>
<p>To measure the overhead of over the wrapper, note that the variables
from the session will be still stored in MATLAB after the computation
is done. Thus you can simply call the same ODE function and time it
directly. This is done by:</p>
<div class="highlight highlight-source-julia"><pre><span class="pl-c1">@time</span> MATLABDiffEq<span class="pl-k">.</span><span class="pl-c1">eval_string</span>(<span class="pl-s"><span class="pl-pds">"</span>[t,u] = <span class="pl-v">$(algstr)</span>(diffeqf,tspan,u0,options);<span class="pl-pds">"</span></span>)</pre></div>
<p>To be even more pedantic, you can play around in the actual MATLAB
session by using</p>
<pre><code>MATLABDiffEq.show_msession()
</code></pre>
<h2><a id="user-content-overhead-amount" class="anchor" aria-hidden="true" href="#overhead-amount"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>Overhead Amount</h2>
<p>Generally, for long enough problems the overhead is minimal. Example:</p>
<div class="highlight highlight-source-julia"><pre><span class="pl-k">using</span> DiffEqBase, ParameterizedFunctions, MATLABDiffEq
f <span class="pl-k">=</span> <span class="pl-c1">@ode_def_bare</span> RigidBodyBench <span class="pl-k">begin</span>
  dy1  <span class="pl-k">=</span> <span class="pl-k">-</span><span class="pl-c1">2</span><span class="pl-k">*</span>y2<span class="pl-k">*</span>y3
  dy2  <span class="pl-k">=</span> <span class="pl-c1">1.25</span><span class="pl-k">*</span>y1<span class="pl-k">*</span>y3
  dy3  <span class="pl-k">=</span> <span class="pl-k">-</span><span class="pl-c1">0.5</span><span class="pl-k">*</span>y1<span class="pl-k">*</span>y2 <span class="pl-k">+</span> <span class="pl-c1">0.25</span><span class="pl-k">*</span><span class="pl-c1">sin</span>(t)<span class="pl-k">^</span><span class="pl-c1">2</span>
<span class="pl-k">end</span>
prob <span class="pl-k">=</span> <span class="pl-c1">ODEProblem</span>(f,[<span class="pl-c1">1.0</span>;<span class="pl-c1">0.0</span>;<span class="pl-c1">0.9</span>],(<span class="pl-c1">0.0</span>,<span class="pl-c1">100.0</span>))
alg <span class="pl-k">=</span> MATLABDiffEq<span class="pl-k">.</span><span class="pl-c1">ode45</span>()
algstr <span class="pl-k">=</span> <span class="pl-c1">string</span>(<span class="pl-c1">typeof</span>(alg)<span class="pl-k">.</span>name<span class="pl-k">.</span>name)</pre></div>
<p>For this, we get the following:</p>
<div class="highlight highlight-source-julia"><pre>julia<span class="pl-k">&gt;</span> <span class="pl-c1">@time</span> sol <span class="pl-k">=</span> <span class="pl-c1">solve</span>(prob,alg);
  <span class="pl-c1">0.063918</span> seconds (<span class="pl-c1">38.84</span> k allocations<span class="pl-k">:</span> <span class="pl-c1">1.556</span> MB)

julia<span class="pl-k">&gt;</span> <span class="pl-c1">@time</span> sol <span class="pl-k">=</span> <span class="pl-c1">solve</span>(prob,alg);
  <span class="pl-c1">0.062600</span> seconds (<span class="pl-c1">38.84</span> k allocations<span class="pl-k">:</span> <span class="pl-c1">1.556</span> MB)

julia<span class="pl-k">&gt;</span> <span class="pl-c1">@time</span> sol <span class="pl-k">=</span> <span class="pl-c1">solve</span>(prob,alg);
  <span class="pl-c1">0.061438</span> seconds (<span class="pl-c1">38.84</span> k allocations<span class="pl-k">:</span> <span class="pl-c1">1.556</span> MB)

julia<span class="pl-k">&gt;</span> <span class="pl-c1">@time</span> sol <span class="pl-k">=</span> <span class="pl-c1">solve</span>(prob,alg);
  <span class="pl-c1">0.065460</span> seconds (<span class="pl-c1">38.84</span> k allocations<span class="pl-k">:</span> <span class="pl-c1">1.556</span> MB)

julia<span class="pl-k">&gt;</span> <span class="pl-c1">@time</span> MATLABDiffEq<span class="pl-k">.</span><span class="pl-c1">eval_string</span>(<span class="pl-s"><span class="pl-pds">"</span>[t,u] = <span class="pl-v">$(algstr)</span>(diffeqf,tspan,u0,options);<span class="pl-pds">"</span></span>)
  <span class="pl-c1">0.058249</span> seconds (<span class="pl-c1">11</span> allocations<span class="pl-k">:</span> <span class="pl-c1">528</span> bytes)

julia<span class="pl-k">&gt;</span> <span class="pl-c1">@time</span> MATLABDiffEq<span class="pl-k">.</span><span class="pl-c1">eval_string</span>(<span class="pl-s"><span class="pl-pds">"</span>[t,u] = <span class="pl-v">$(algstr)</span>(diffeqf,tspan,u0,options);<span class="pl-pds">"</span></span>)
  <span class="pl-c1">0.060367</span> seconds (<span class="pl-c1">11</span> allocations<span class="pl-k">:</span> <span class="pl-c1">528</span> bytes)

julia<span class="pl-k">&gt;</span> <span class="pl-c1">@time</span> MATLABDiffEq<span class="pl-k">.</span><span class="pl-c1">eval_string</span>(<span class="pl-s"><span class="pl-pds">"</span>[t,u] = <span class="pl-v">$(algstr)</span>(diffeqf,tspan,u0,options);<span class="pl-pds">"</span></span>)
  <span class="pl-c1">0.060171</span> seconds (<span class="pl-c1">11</span> allocations<span class="pl-k">:</span> <span class="pl-c1">528</span> bytes)

julia<span class="pl-k">&gt;</span> <span class="pl-c1">@time</span> MATLABDiffEq<span class="pl-k">.</span><span class="pl-c1">eval_string</span>(<span class="pl-s"><span class="pl-pds">"</span>[t,u] = <span class="pl-v">$(algstr)</span>(diffeqf,tspan,u0,options);<span class="pl-pds">"</span></span>)
  <span class="pl-c1">0.058928</span> seconds (<span class="pl-c1">11</span> allocations<span class="pl-k">:</span> <span class="pl-c1">528</span> bytes)</pre></div>
<h2><a id="user-content-benchmark" class="anchor" aria-hidden="true" href="#benchmark"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>Benchmark</h2>
<p>The following benchmarks demonstrate a <strong>100x performance advantage for the
pure-Julia methods over the MATLAB ODE solvers</strong> across a range of stiff and
non-stiff ODEs. These were ran with Julia 1.2, MATLAB 2019B, deSolve 1.2.5,
and SciPy 1.3.1 after verifying negligible overhead on interop. Note that the
MATLAB solvers do outperform that of Python and R.</p>
<h4><a id="user-content-non-stiff-problem-1-lotka-volterra" class="anchor" aria-hidden="true" href="#non-stiff-problem-1-lotka-volterra"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>Non-Stiff Problem 1: Lotka-Volterra</h4>
<div class="highlight highlight-source-julia"><pre>f <span class="pl-k">=</span> <span class="pl-c1">@ode_def_bare</span> LotkaVolterra <span class="pl-k">begin</span>
  dx <span class="pl-k">=</span> a<span class="pl-k">*</span>x <span class="pl-k">-</span> b<span class="pl-k">*</span>x<span class="pl-k">*</span>y
  dy <span class="pl-k">=</span> <span class="pl-k">-</span>c<span class="pl-k">*</span>y <span class="pl-k">+</span> d<span class="pl-k">*</span>x<span class="pl-k">*</span>y
<span class="pl-k">end</span> a b c d
p <span class="pl-k">=</span> [<span class="pl-c1">1.5</span>,<span class="pl-c1">1</span>,<span class="pl-c1">3</span>,<span class="pl-c1">1</span>]
tspan <span class="pl-k">=</span> (<span class="pl-c1">0.0</span>,<span class="pl-c1">10.0</span>)
u0 <span class="pl-k">=</span> [<span class="pl-c1">1.0</span>,<span class="pl-c1">1.0</span>]
prob <span class="pl-k">=</span> <span class="pl-c1">ODEProblem</span>(f,u0,tspan,p)
sol <span class="pl-k">=</span> <span class="pl-c1">solve</span>(prob,<span class="pl-c1">Vern7</span>(),abstol<span class="pl-k">=</span><span class="pl-c1">1</span><span class="pl-k">/</span><span class="pl-c1">10</span><span class="pl-k">^</span><span class="pl-c1">14</span>,reltol<span class="pl-k">=</span><span class="pl-c1">1</span><span class="pl-k">/</span><span class="pl-c1">10</span><span class="pl-k">^</span><span class="pl-c1">14</span>)
test_sol <span class="pl-k">=</span> <span class="pl-c1">TestSolution</span>(sol)

setups <span class="pl-k">=</span> [<span class="pl-c1">Dict</span>(<span class="pl-c1">:alg</span><span class="pl-k">=&gt;</span><span class="pl-c1">DP5</span>())
          <span class="pl-c1">Dict</span>(<span class="pl-c1">:alg</span><span class="pl-k">=&gt;</span><span class="pl-c1">dopri5</span>())
          <span class="pl-c1">Dict</span>(<span class="pl-c1">:alg</span><span class="pl-k">=&gt;</span><span class="pl-c1">Tsit5</span>())
          <span class="pl-c1">Dict</span>(<span class="pl-c1">:alg</span><span class="pl-k">=&gt;</span><span class="pl-c1">Vern7</span>())
          <span class="pl-c1">Dict</span>(<span class="pl-c1">:alg</span><span class="pl-k">=&gt;</span>MATLABDiffEq<span class="pl-k">.</span><span class="pl-c1">ode45</span>())
          <span class="pl-c1">Dict</span>(<span class="pl-c1">:alg</span><span class="pl-k">=&gt;</span>MATLABDiffEq<span class="pl-k">.</span><span class="pl-c1">ode113</span>())
          <span class="pl-c1">Dict</span>(<span class="pl-c1">:alg</span><span class="pl-k">=&gt;</span>SciPyDiffEq<span class="pl-k">.</span><span class="pl-c1">RK45</span>())
          <span class="pl-c1">Dict</span>(<span class="pl-c1">:alg</span><span class="pl-k">=&gt;</span>SciPyDiffEq<span class="pl-k">.</span><span class="pl-c1">LSODA</span>())
          <span class="pl-c1">Dict</span>(<span class="pl-c1">:alg</span><span class="pl-k">=&gt;</span>SciPyDiffEq<span class="pl-k">.</span><span class="pl-c1">odeint</span>())
          <span class="pl-c1">Dict</span>(<span class="pl-c1">:alg</span><span class="pl-k">=&gt;</span>deSolveDiffEq<span class="pl-k">.</span><span class="pl-c1">lsoda</span>())
          <span class="pl-c1">Dict</span>(<span class="pl-c1">:alg</span><span class="pl-k">=&gt;</span>deSolveDiffEq<span class="pl-k">.</span><span class="pl-c1">ode45</span>())
          <span class="pl-c1">Dict</span>(<span class="pl-c1">:alg</span><span class="pl-k">=&gt;</span><span class="pl-c1">CVODE_Adams</span>())
  ]

names <span class="pl-k">=</span> [
  <span class="pl-s"><span class="pl-pds">"</span>Julia: DP5<span class="pl-pds">"</span></span>
  <span class="pl-s"><span class="pl-pds">"</span>Hairer: dopri5<span class="pl-pds">"</span></span>
  <span class="pl-s"><span class="pl-pds">"</span>Julia: Tsit5<span class="pl-pds">"</span></span>
  <span class="pl-s"><span class="pl-pds">"</span>Julia: Vern7<span class="pl-pds">"</span></span>
  <span class="pl-s"><span class="pl-pds">"</span>MATLAB: ode45<span class="pl-pds">"</span></span>
  <span class="pl-s"><span class="pl-pds">"</span>MATLAB: ode113<span class="pl-pds">"</span></span>
  <span class="pl-s"><span class="pl-pds">"</span>SciPy: RK45<span class="pl-pds">"</span></span>
  <span class="pl-s"><span class="pl-pds">"</span>SciPy: LSODA<span class="pl-pds">"</span></span>
  <span class="pl-s"><span class="pl-pds">"</span>SciPy: odeint<span class="pl-pds">"</span></span>
  <span class="pl-s"><span class="pl-pds">"</span>deSolve: lsoda<span class="pl-pds">"</span></span>
  <span class="pl-s"><span class="pl-pds">"</span>deSolve: ode45<span class="pl-pds">"</span></span>
  <span class="pl-s"><span class="pl-pds">"</span>Sundials: Adams<span class="pl-pds">"</span></span>
  ]

abstols <span class="pl-k">=</span> <span class="pl-c1">1.0</span> <span class="pl-k">./</span> <span class="pl-c1">10.0</span> <span class="pl-k">.^</span> (<span class="pl-c1">6</span><span class="pl-k">:</span><span class="pl-c1">13</span>)
reltols <span class="pl-k">=</span> <span class="pl-c1">1.0</span> <span class="pl-k">./</span> <span class="pl-c1">10.0</span> <span class="pl-k">.^</span> (<span class="pl-c1">3</span><span class="pl-k">:</span><span class="pl-c1">10</span>)
wp <span class="pl-k">=</span> <span class="pl-c1">WorkPrecisionSet</span>(prob,abstols,reltols,setups;
                      names <span class="pl-k">=</span> names,
                      appxsol<span class="pl-k">=</span>test_sol,dense<span class="pl-k">=</span><span class="pl-c1">false</span>,
                      save_everystep<span class="pl-k">=</span><span class="pl-c1">false</span>,numruns<span class="pl-k">=</span><span class="pl-c1">100</span>,maxiters<span class="pl-k">=</span><span class="pl-c1">10000000</span>,
                      timeseries_errors<span class="pl-k">=</span><span class="pl-c1">false</span>,verbose<span class="pl-k">=</span><span class="pl-c1">false</span>)
<span class="pl-c1">plot</span>(wp,title<span class="pl-k">=</span><span class="pl-s"><span class="pl-pds">"</span>Non-stiff 1: Lotka-Volterra<span class="pl-pds">"</span></span>)</pre></div>
<p><a target="_blank" rel="noopener noreferrer" href="https://user-images.githubusercontent.com/1814174/71537082-ef42ac00-28e4-11ea-9acc-67dfd9990221.png"><img src="https://user-images.githubusercontent.com/1814174/71537082-ef42ac00-28e4-11ea-9acc-67dfd9990221.png" alt="" style="max-width:100%;"></a></p>
<h4><a id="user-content-non-stiff-problem-2-rigid-body" class="anchor" aria-hidden="true" href="#non-stiff-problem-2-rigid-body"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>Non-Stiff Problem 2: Rigid Body</h4>
<div class="highlight highlight-source-julia"><pre>f <span class="pl-k">=</span> <span class="pl-c1">@ode_def_bare</span> RigidBodyBench <span class="pl-k">begin</span>
  dy1  <span class="pl-k">=</span> <span class="pl-k">-</span><span class="pl-c1">2</span><span class="pl-k">*</span>y2<span class="pl-k">*</span>y3
  dy2  <span class="pl-k">=</span> <span class="pl-c1">1.25</span><span class="pl-k">*</span>y1<span class="pl-k">*</span>y3
  dy3  <span class="pl-k">=</span> <span class="pl-k">-</span><span class="pl-c1">0.5</span><span class="pl-k">*</span>y1<span class="pl-k">*</span>y2 <span class="pl-k">+</span> <span class="pl-c1">0.25</span><span class="pl-k">*</span><span class="pl-c1">sin</span>(t)<span class="pl-k">^</span><span class="pl-c1">2</span>
<span class="pl-k">end</span>
prob <span class="pl-k">=</span> <span class="pl-c1">ODEProblem</span>(f,[<span class="pl-c1">1.0</span>;<span class="pl-c1">0.0</span>;<span class="pl-c1">0.9</span>],(<span class="pl-c1">0.0</span>,<span class="pl-c1">100.0</span>))
sol <span class="pl-k">=</span> <span class="pl-c1">solve</span>(prob,<span class="pl-c1">Vern7</span>(),abstol<span class="pl-k">=</span><span class="pl-c1">1</span><span class="pl-k">/</span><span class="pl-c1">10</span><span class="pl-k">^</span><span class="pl-c1">14</span>,reltol<span class="pl-k">=</span><span class="pl-c1">1</span><span class="pl-k">/</span><span class="pl-c1">10</span><span class="pl-k">^</span><span class="pl-c1">14</span>)
test_sol <span class="pl-k">=</span> <span class="pl-c1">TestSolution</span>(sol)

setups <span class="pl-k">=</span> [<span class="pl-c1">Dict</span>(<span class="pl-c1">:alg</span><span class="pl-k">=&gt;</span><span class="pl-c1">DP5</span>())
          <span class="pl-c1">Dict</span>(<span class="pl-c1">:alg</span><span class="pl-k">=&gt;</span><span class="pl-c1">dopri5</span>())
          <span class="pl-c1">Dict</span>(<span class="pl-c1">:alg</span><span class="pl-k">=&gt;</span><span class="pl-c1">Tsit5</span>())
          <span class="pl-c1">Dict</span>(<span class="pl-c1">:alg</span><span class="pl-k">=&gt;</span><span class="pl-c1">Vern7</span>())
          <span class="pl-c1">Dict</span>(<span class="pl-c1">:alg</span><span class="pl-k">=&gt;</span>MATLABDiffEq<span class="pl-k">.</span><span class="pl-c1">ode45</span>())
          <span class="pl-c1">Dict</span>(<span class="pl-c1">:alg</span><span class="pl-k">=&gt;</span>MATLABDiffEq<span class="pl-k">.</span><span class="pl-c1">ode113</span>())
          <span class="pl-c1">Dict</span>(<span class="pl-c1">:alg</span><span class="pl-k">=&gt;</span>SciPyDiffEq<span class="pl-k">.</span><span class="pl-c1">RK45</span>())
          <span class="pl-c1">Dict</span>(<span class="pl-c1">:alg</span><span class="pl-k">=&gt;</span>SciPyDiffEq<span class="pl-k">.</span><span class="pl-c1">LSODA</span>())
          <span class="pl-c1">Dict</span>(<span class="pl-c1">:alg</span><span class="pl-k">=&gt;</span>SciPyDiffEq<span class="pl-k">.</span><span class="pl-c1">odeint</span>())
          <span class="pl-c1">Dict</span>(<span class="pl-c1">:alg</span><span class="pl-k">=&gt;</span>deSolveDiffEq<span class="pl-k">.</span><span class="pl-c1">lsoda</span>())
          <span class="pl-c1">Dict</span>(<span class="pl-c1">:alg</span><span class="pl-k">=&gt;</span>deSolveDiffEq<span class="pl-k">.</span><span class="pl-c1">ode45</span>())
          <span class="pl-c1">Dict</span>(<span class="pl-c1">:alg</span><span class="pl-k">=&gt;</span><span class="pl-c1">CVODE_Adams</span>())
  ]

names <span class="pl-k">=</span> [
  <span class="pl-s"><span class="pl-pds">"</span>Julia: DP5<span class="pl-pds">"</span></span>
  <span class="pl-s"><span class="pl-pds">"</span>Hairer: dopri5<span class="pl-pds">"</span></span>
  <span class="pl-s"><span class="pl-pds">"</span>Julia: Tsit5<span class="pl-pds">"</span></span>
  <span class="pl-s"><span class="pl-pds">"</span>Julia: Vern7<span class="pl-pds">"</span></span>
  <span class="pl-s"><span class="pl-pds">"</span>MATLAB: ode45<span class="pl-pds">"</span></span>
  <span class="pl-s"><span class="pl-pds">"</span>MATLAB: ode113<span class="pl-pds">"</span></span>
  <span class="pl-s"><span class="pl-pds">"</span>SciPy: RK45<span class="pl-pds">"</span></span>
  <span class="pl-s"><span class="pl-pds">"</span>SciPy: LSODA<span class="pl-pds">"</span></span>
  <span class="pl-s"><span class="pl-pds">"</span>SciPy: odeint<span class="pl-pds">"</span></span>
  <span class="pl-s"><span class="pl-pds">"</span>deSolve: lsoda<span class="pl-pds">"</span></span>
  <span class="pl-s"><span class="pl-pds">"</span>deSolve: ode45<span class="pl-pds">"</span></span>
  <span class="pl-s"><span class="pl-pds">"</span>Sundials: Adams<span class="pl-pds">"</span></span>
  ]

abstols <span class="pl-k">=</span> <span class="pl-c1">1.0</span> <span class="pl-k">./</span> <span class="pl-c1">10.0</span> <span class="pl-k">.^</span> (<span class="pl-c1">6</span><span class="pl-k">:</span><span class="pl-c1">13</span>)
reltols <span class="pl-k">=</span> <span class="pl-c1">1.0</span> <span class="pl-k">./</span> <span class="pl-c1">10.0</span> <span class="pl-k">.^</span> (<span class="pl-c1">3</span><span class="pl-k">:</span><span class="pl-c1">10</span>)
wp <span class="pl-k">=</span> <span class="pl-c1">WorkPrecisionSet</span>(prob,abstols,reltols,setups;
                      names <span class="pl-k">=</span> names,
                      appxsol<span class="pl-k">=</span>test_sol,dense<span class="pl-k">=</span><span class="pl-c1">false</span>,
                      save_everystep<span class="pl-k">=</span><span class="pl-c1">false</span>,numruns<span class="pl-k">=</span><span class="pl-c1">100</span>,maxiters<span class="pl-k">=</span><span class="pl-c1">10000000</span>,
                      timeseries_errors<span class="pl-k">=</span><span class="pl-c1">false</span>,verbose<span class="pl-k">=</span><span class="pl-c1">false</span>)
<span class="pl-c1">plot</span>(wp,title<span class="pl-k">=</span><span class="pl-s"><span class="pl-pds">"</span>Non-stiff 2: Rigid-Body<span class="pl-pds">"</span></span>)</pre></div>
<p><a target="_blank" rel="noopener noreferrer" href="https://user-images.githubusercontent.com/1814174/71537083-ef42ac00-28e4-11ea-8dc7-a5dca0518baf.png"><img src="https://user-images.githubusercontent.com/1814174/71537083-ef42ac00-28e4-11ea-8dc7-a5dca0518baf.png" alt="" style="max-width:100%;"></a></p>
<h4><a id="user-content-stiff-problem-1-rober" class="anchor" aria-hidden="true" href="#stiff-problem-1-rober"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>Stiff Problem 1: ROBER</h4>
<div class="highlight highlight-source-julia"><pre>rober <span class="pl-k">=</span> <span class="pl-c1">@ode_def</span> <span class="pl-k">begin</span>
  dy₁ <span class="pl-k">=</span> <span class="pl-k">-</span>k₁<span class="pl-k">*</span>y₁<span class="pl-k">+</span>k₃<span class="pl-k">*</span>y₂<span class="pl-k">*</span>y₃
  dy₂ <span class="pl-k">=</span>  k₁<span class="pl-k">*</span>y₁<span class="pl-k">-</span>k₂<span class="pl-k">*</span>y₂<span class="pl-k">^</span><span class="pl-c1">2</span><span class="pl-k">-</span>k₃<span class="pl-k">*</span>y₂<span class="pl-k">*</span>y₃
  dy₃ <span class="pl-k">=</span>  k₂<span class="pl-k">*</span>y₂<span class="pl-k">^</span><span class="pl-c1">2</span>
<span class="pl-k">end</span> k₁ k₂ k₃
prob <span class="pl-k">=</span> <span class="pl-c1">ODEProblem</span>(rober,[<span class="pl-c1">1.0</span>,<span class="pl-c1">0.0</span>,<span class="pl-c1">0.0</span>],(<span class="pl-c1">0.0</span>,<span class="pl-c1">1e5</span>),[<span class="pl-c1">0.04</span>,<span class="pl-c1">3e7</span>,<span class="pl-c1">1e4</span>])
sol <span class="pl-k">=</span> <span class="pl-c1">solve</span>(prob,<span class="pl-c1">CVODE_BDF</span>(),abstol<span class="pl-k">=</span><span class="pl-c1">1</span><span class="pl-k">/</span><span class="pl-c1">10</span><span class="pl-k">^</span><span class="pl-c1">14</span>,reltol<span class="pl-k">=</span><span class="pl-c1">1</span><span class="pl-k">/</span><span class="pl-c1">10</span><span class="pl-k">^</span><span class="pl-c1">14</span>)
test_sol <span class="pl-k">=</span> <span class="pl-c1">TestSolution</span>(sol)

abstols <span class="pl-k">=</span> <span class="pl-c1">1.0</span> <span class="pl-k">./</span> <span class="pl-c1">10.0</span> <span class="pl-k">.^</span> (<span class="pl-c1">7</span><span class="pl-k">:</span><span class="pl-c1">8</span>)
reltols <span class="pl-k">=</span> <span class="pl-c1">1.0</span> <span class="pl-k">./</span> <span class="pl-c1">10.0</span> <span class="pl-k">.^</span> (<span class="pl-c1">3</span><span class="pl-k">:</span><span class="pl-c1">4</span>);

setups <span class="pl-k">=</span> [<span class="pl-c1">Dict</span>(<span class="pl-c1">:alg</span><span class="pl-k">=&gt;</span><span class="pl-c1">Rosenbrock23</span>())
          <span class="pl-c1">Dict</span>(<span class="pl-c1">:alg</span><span class="pl-k">=&gt;</span><span class="pl-c1">TRBDF2</span>())
          <span class="pl-c1">Dict</span>(<span class="pl-c1">:alg</span><span class="pl-k">=&gt;</span><span class="pl-c1">RadauIIA5</span>())
          <span class="pl-c1">Dict</span>(<span class="pl-c1">:alg</span><span class="pl-k">=&gt;</span><span class="pl-c1">rodas</span>())
          <span class="pl-c1">Dict</span>(<span class="pl-c1">:alg</span><span class="pl-k">=&gt;</span><span class="pl-c1">radau</span>())
          <span class="pl-c1">Dict</span>(<span class="pl-c1">:alg</span><span class="pl-k">=&gt;</span>MATLABDiffEq<span class="pl-k">.</span><span class="pl-c1">ode23s</span>())
          <span class="pl-c1">Dict</span>(<span class="pl-c1">:alg</span><span class="pl-k">=&gt;</span>MATLABDiffEq<span class="pl-k">.</span><span class="pl-c1">ode15s</span>())
          <span class="pl-c1">Dict</span>(<span class="pl-c1">:alg</span><span class="pl-k">=&gt;</span>SciPyDiffEq<span class="pl-k">.</span><span class="pl-c1">LSODA</span>())
          <span class="pl-c1">Dict</span>(<span class="pl-c1">:alg</span><span class="pl-k">=&gt;</span>SciPyDiffEq<span class="pl-k">.</span><span class="pl-c1">BDF</span>())
          <span class="pl-c1">Dict</span>(<span class="pl-c1">:alg</span><span class="pl-k">=&gt;</span>SciPyDiffEq<span class="pl-k">.</span><span class="pl-c1">odeint</span>())
          <span class="pl-c1">Dict</span>(<span class="pl-c1">:alg</span><span class="pl-k">=&gt;</span>deSolveDiffEq<span class="pl-k">.</span><span class="pl-c1">lsoda</span>())
          <span class="pl-c1">Dict</span>(<span class="pl-c1">:alg</span><span class="pl-k">=&gt;</span><span class="pl-c1">CVODE_BDF</span>())
          ]

names <span class="pl-k">=</span> [
  <span class="pl-s"><span class="pl-pds">"</span>Julia: Rosenbrock23<span class="pl-pds">"</span></span>
  <span class="pl-s"><span class="pl-pds">"</span>Julia: TRBDF2<span class="pl-pds">"</span></span>
  <span class="pl-s"><span class="pl-pds">"</span>Julia: radau<span class="pl-pds">"</span></span>
  <span class="pl-s"><span class="pl-pds">"</span>Hairer: rodas<span class="pl-pds">"</span></span>
  <span class="pl-s"><span class="pl-pds">"</span>Hairer: radau<span class="pl-pds">"</span></span>
  <span class="pl-s"><span class="pl-pds">"</span>MATLAB: ode23s<span class="pl-pds">"</span></span>
  <span class="pl-s"><span class="pl-pds">"</span>MATLAB: ode15s<span class="pl-pds">"</span></span>
  <span class="pl-s"><span class="pl-pds">"</span>SciPy: LSODA<span class="pl-pds">"</span></span>
  <span class="pl-s"><span class="pl-pds">"</span>SciPy: BDF<span class="pl-pds">"</span></span>
  <span class="pl-s"><span class="pl-pds">"</span>SciPy: odeint<span class="pl-pds">"</span></span>
  <span class="pl-s"><span class="pl-pds">"</span>deSolve: lsoda<span class="pl-pds">"</span></span>
  <span class="pl-s"><span class="pl-pds">"</span>Sundials: CVODE<span class="pl-pds">"</span></span>
  ]

wp <span class="pl-k">=</span> <span class="pl-c1">WorkPrecisionSet</span>(prob,abstols,reltols,setups;
                      names <span class="pl-k">=</span> names,print_names <span class="pl-k">=</span> <span class="pl-c1">true</span>,
                      dense<span class="pl-k">=</span><span class="pl-c1">false</span>,verbose <span class="pl-k">=</span> <span class="pl-c1">false</span>,
                      save_everystep<span class="pl-k">=</span><span class="pl-c1">false</span>,appxsol<span class="pl-k">=</span>test_sol,
                      maxiters<span class="pl-k">=</span><span class="pl-c1">Int</span>(<span class="pl-c1">1e5</span>))
<span class="pl-c1">plot</span>(wp,title<span class="pl-k">=</span><span class="pl-s"><span class="pl-pds">"</span>Stiff 1: ROBER<span class="pl-pds">"</span></span>, legend<span class="pl-k">=</span><span class="pl-c1">:topleft</span>)</pre></div>
<p><a target="_blank" rel="noopener noreferrer" href="https://user-images.githubusercontent.com/1814174/71537080-ef42ac00-28e4-11ea-9abd-37631cd18ad9.png"><img src="https://user-images.githubusercontent.com/1814174/71537080-ef42ac00-28e4-11ea-9abd-37631cd18ad9.png" alt="" style="max-width:100%;"></a></p>
<h4><a id="user-content-stiff-problem-2-hires" class="anchor" aria-hidden="true" href="#stiff-problem-2-hires"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>Stiff Problem 2: HIRES</h4>
<div class="highlight highlight-source-julia"><pre>f <span class="pl-k">=</span> <span class="pl-c1">@ode_def</span> Hires <span class="pl-k">begin</span>
  dy1 <span class="pl-k">=</span> <span class="pl-k">-</span><span class="pl-c1">1.71</span><span class="pl-k">*</span>y1 <span class="pl-k">+</span> <span class="pl-c1">0.43</span><span class="pl-k">*</span>y2 <span class="pl-k">+</span> <span class="pl-c1">8.32</span><span class="pl-k">*</span>y3 <span class="pl-k">+</span> <span class="pl-c1">0.0007</span>
  dy2 <span class="pl-k">=</span> <span class="pl-c1">1.71</span><span class="pl-k">*</span>y1 <span class="pl-k">-</span> <span class="pl-c1">8.75</span><span class="pl-k">*</span>y2
  dy3 <span class="pl-k">=</span> <span class="pl-k">-</span><span class="pl-c1">10.03</span><span class="pl-k">*</span>y3 <span class="pl-k">+</span> <span class="pl-c1">0.43</span><span class="pl-k">*</span>y4 <span class="pl-k">+</span> <span class="pl-c1">0.035</span><span class="pl-k">*</span>y5
  dy4 <span class="pl-k">=</span> <span class="pl-c1">8.32</span><span class="pl-k">*</span>y2 <span class="pl-k">+</span> <span class="pl-c1">1.71</span><span class="pl-k">*</span>y3 <span class="pl-k">-</span> <span class="pl-c1">1.12</span><span class="pl-k">*</span>y4
  dy5 <span class="pl-k">=</span> <span class="pl-k">-</span><span class="pl-c1">1.745</span><span class="pl-k">*</span>y5 <span class="pl-k">+</span> <span class="pl-c1">0.43</span><span class="pl-k">*</span>y6 <span class="pl-k">+</span> <span class="pl-c1">0.43</span><span class="pl-k">*</span>y7
  dy6 <span class="pl-k">=</span> <span class="pl-k">-</span><span class="pl-c1">280.0</span><span class="pl-k">*</span>y6<span class="pl-k">*</span>y8 <span class="pl-k">+</span> <span class="pl-c1">0.69</span><span class="pl-k">*</span>y4 <span class="pl-k">+</span> <span class="pl-c1">1.71</span><span class="pl-k">*</span>y5 <span class="pl-k">-</span>
           <span class="pl-c1">0.43</span><span class="pl-k">*</span>y6 <span class="pl-k">+</span> <span class="pl-c1">0.69</span><span class="pl-k">*</span>y7
  dy7 <span class="pl-k">=</span> <span class="pl-c1">280.0</span><span class="pl-k">*</span>y6<span class="pl-k">*</span>y8 <span class="pl-k">-</span> <span class="pl-c1">1.81</span><span class="pl-k">*</span>y7
  dy8 <span class="pl-k">=</span> <span class="pl-k">-</span><span class="pl-c1">280.0</span><span class="pl-k">*</span>y6<span class="pl-k">*</span>y8 <span class="pl-k">+</span> <span class="pl-c1">1.81</span><span class="pl-k">*</span>y7
<span class="pl-k">end</span>

u0 <span class="pl-k">=</span> <span class="pl-c1">zeros</span>(<span class="pl-c1">8</span>)
u0[<span class="pl-c1">1</span>] <span class="pl-k">=</span> <span class="pl-c1">1</span>
u0[<span class="pl-c1">8</span>] <span class="pl-k">=</span> <span class="pl-c1">0.0057</span>
prob <span class="pl-k">=</span> <span class="pl-c1">ODEProblem</span>(f,u0,(<span class="pl-c1">0.0</span>,<span class="pl-c1">321.8122</span>))

sol <span class="pl-k">=</span> <span class="pl-c1">solve</span>(prob,<span class="pl-c1">Rodas5</span>(),abstol<span class="pl-k">=</span><span class="pl-c1">1</span><span class="pl-k">/</span><span class="pl-c1">10</span><span class="pl-k">^</span><span class="pl-c1">14</span>,reltol<span class="pl-k">=</span><span class="pl-c1">1</span><span class="pl-k">/</span><span class="pl-c1">10</span><span class="pl-k">^</span><span class="pl-c1">14</span>)
test_sol <span class="pl-k">=</span> <span class="pl-c1">TestSolution</span>(sol)

abstols <span class="pl-k">=</span> <span class="pl-c1">1.0</span> <span class="pl-k">./</span> <span class="pl-c1">10.0</span> <span class="pl-k">.^</span> (<span class="pl-c1">5</span><span class="pl-k">:</span><span class="pl-c1">8</span>)
reltols <span class="pl-k">=</span> <span class="pl-c1">1.0</span> <span class="pl-k">./</span> <span class="pl-c1">10.0</span> <span class="pl-k">.^</span> (<span class="pl-c1">1</span><span class="pl-k">:</span><span class="pl-c1">4</span>);

setups <span class="pl-k">=</span> [<span class="pl-c1">Dict</span>(<span class="pl-c1">:alg</span><span class="pl-k">=&gt;</span><span class="pl-c1">Rosenbrock23</span>())
          <span class="pl-c1">Dict</span>(<span class="pl-c1">:alg</span><span class="pl-k">=&gt;</span><span class="pl-c1">TRBDF2</span>())
          <span class="pl-c1">Dict</span>(<span class="pl-c1">:alg</span><span class="pl-k">=&gt;</span><span class="pl-c1">RadauIIA5</span>())
          <span class="pl-c1">Dict</span>(<span class="pl-c1">:alg</span><span class="pl-k">=&gt;</span><span class="pl-c1">rodas</span>())
          <span class="pl-c1">Dict</span>(<span class="pl-c1">:alg</span><span class="pl-k">=&gt;</span><span class="pl-c1">radau</span>())
          <span class="pl-c1">Dict</span>(<span class="pl-c1">:alg</span><span class="pl-k">=&gt;</span>MATLABDiffEq<span class="pl-k">.</span><span class="pl-c1">ode23s</span>())
          <span class="pl-c1">Dict</span>(<span class="pl-c1">:alg</span><span class="pl-k">=&gt;</span>MATLABDiffEq<span class="pl-k">.</span><span class="pl-c1">ode15s</span>())
          <span class="pl-c1">Dict</span>(<span class="pl-c1">:alg</span><span class="pl-k">=&gt;</span>SciPyDiffEq<span class="pl-k">.</span><span class="pl-c1">LSODA</span>())
          <span class="pl-c1">Dict</span>(<span class="pl-c1">:alg</span><span class="pl-k">=&gt;</span>SciPyDiffEq<span class="pl-k">.</span><span class="pl-c1">BDF</span>())
          <span class="pl-c1">Dict</span>(<span class="pl-c1">:alg</span><span class="pl-k">=&gt;</span>SciPyDiffEq<span class="pl-k">.</span><span class="pl-c1">odeint</span>())
          <span class="pl-c1">Dict</span>(<span class="pl-c1">:alg</span><span class="pl-k">=&gt;</span>deSolveDiffEq<span class="pl-k">.</span><span class="pl-c1">lsoda</span>())
          <span class="pl-c1">Dict</span>(<span class="pl-c1">:alg</span><span class="pl-k">=&gt;</span><span class="pl-c1">CVODE_BDF</span>())
          ]

names <span class="pl-k">=</span> [
  <span class="pl-s"><span class="pl-pds">"</span>Julia: Rosenbrock23<span class="pl-pds">"</span></span>
  <span class="pl-s"><span class="pl-pds">"</span>Julia: TRBDF2<span class="pl-pds">"</span></span>
  <span class="pl-s"><span class="pl-pds">"</span>Julia: radau<span class="pl-pds">"</span></span>
  <span class="pl-s"><span class="pl-pds">"</span>Hairer: rodas<span class="pl-pds">"</span></span>
  <span class="pl-s"><span class="pl-pds">"</span>Hairer: radau<span class="pl-pds">"</span></span>
  <span class="pl-s"><span class="pl-pds">"</span>MATLAB: ode23s<span class="pl-pds">"</span></span>
  <span class="pl-s"><span class="pl-pds">"</span>MATLAB: ode15s<span class="pl-pds">"</span></span>
  <span class="pl-s"><span class="pl-pds">"</span>SciPy: LSODA<span class="pl-pds">"</span></span>
  <span class="pl-s"><span class="pl-pds">"</span>SciPy: BDF<span class="pl-pds">"</span></span>
  <span class="pl-s"><span class="pl-pds">"</span>SciPy: odeint<span class="pl-pds">"</span></span>
  <span class="pl-s"><span class="pl-pds">"</span>deSolve: lsoda<span class="pl-pds">"</span></span>
  <span class="pl-s"><span class="pl-pds">"</span>Sundials: CVODE<span class="pl-pds">"</span></span>
  ]

wp <span class="pl-k">=</span> <span class="pl-c1">WorkPrecisionSet</span>(prob,abstols,reltols,setups;
                      names <span class="pl-k">=</span> names,print_names <span class="pl-k">=</span> <span class="pl-c1">true</span>,
                      save_everystep<span class="pl-k">=</span><span class="pl-c1">false</span>,appxsol<span class="pl-k">=</span>test_sol,
                      maxiters<span class="pl-k">=</span><span class="pl-c1">Int</span>(<span class="pl-c1">1e5</span>),numruns<span class="pl-k">=</span><span class="pl-c1">100</span>)
<span class="pl-c1">plot</span>(wp,title<span class="pl-k">=</span><span class="pl-s"><span class="pl-pds">"</span>Stiff 2: Hires<span class="pl-pds">"</span></span>,legend<span class="pl-k">=</span><span class="pl-c1">:topleft</span>)</pre></div>
<p><a target="_blank" rel="noopener noreferrer" href="https://user-images.githubusercontent.com/1814174/71537081-ef42ac00-28e4-11ea-950f-59c762ce9a69.png"><img src="https://user-images.githubusercontent.com/1814174/71537081-ef42ac00-28e4-11ea-950f-59c762ce9a69.png" alt="" style="max-width:100%;"></a></p>
</article></div>