genflux genflux gen dsl extend generat function interfac allow usag flux model gen generat function exampl avail genflux chain conv init glorot uniform maxpool relu conv init glorot uniform relu maxpool flatten dens initw glorot uniform dens initw glorot uniform softmax model compon probabilist program gen function vector float prob categor collect enumer eachcol prob allow train paramet via gradient descent object updat paramupd flux adam creat trace data batch loader constraint choicemap enumer trace weight generat constraint increment gradient accumul accumul param gradient trace perform adam updat reset gradient accumul appli updat println weight weight test accuraci mean test test println test set accuraci test accuraci test set accuraci