spikesort packag sort call spike extract electrophysiolog data record extra cellular main function assign combin spike templat pass filter data use viterbi algorithm code base follow paper herbst gammet ferrero hahnlos spike sort hidden markov model journal neurosci method introduct spike sort art decompos signal record extra cellular medium contribut individu cell contribut vari shape depend cell membran potenti dynam locat cell relat record probe needless server constrain various approxim settl plausibl solut hidden markov model hidden markov model sort extra cellular signal attribut singl cell describ set transit associ gaussian emiss probabl