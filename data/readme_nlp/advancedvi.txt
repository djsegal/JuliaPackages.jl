advancedvijl library variational bayesian inference julia time writing implementations variational inference vi interface algorithms implemented turingjl idea soon separate vi functionality turingjl package purpose package provide common interface implementations standard algorithms utilities goal ease ability packages turingjl write light wrapper advancedvijl integration example turingjl support automatic differentiation variational inference advi piece code tied turingjl conversion turingmodel logjoint function computes log denoting observations embedded turingmodel logjoint method compatible ad framework forwarddiffjl zygotejl turingjl able perform advi wip interface vi main interface functionality package vimodel alg alg default variational posterior provide vimodel alg variationalposterior represents family variational distributions initial parameters indexing starting distribution assumes exists implementation variationalupdate returns variational posterior corresponding parameters vimodel alg getqfunction getq function returning variationalposterior corresponding optimizevo algvariationalinferencead variationalposterior modelmodel optimizer truncatedadagrad gradvo algvariationalinference modelmodel args combinations variational objectives vo vi methods alg variational posteriors gradient estimators grad allows specify behaviors examples variational inference simple generative model following x x vectors denotes dimensional multivariate normal distribution set observations x x finding distribution x x mean obtain approximation distribution using advancedvijl generate observations set julia using distributions julia julia observations randn observations d julia define generative model x prior logpdf mvnormal ones prior generic function method julia likelihood sum logpdf mvnormal ones likelihood generic function method julia log likelihood observations prior log generic function method julia log randn checking mainly specifying approximate posterior family providing mapping distribution parameters distribution julia using distributionsad advancedvi julia using function getq turingdiagmvnormal exp getq generic function method choice algorithm subtype variationalinference julia perform vi advi advi advi advancedviforwarddiffad finally perform vi usual inferface call vi scenes takes care optimization returns resulting variational posterior julia vi log advi getq randn advi optimizing time turingdiagmvnormal arrayfloatarrayfloat look resulting elbo julia advancedvi elbo advi log unfortunately final value elbo diagnostic elbo metric eye training increase elbo means direction luckily simple indeed obtain closed form solution lazy conjugatepriorsjl julia true posterior using conjugatepriors julia pri mvnormal zeros ones julia trueposterior posterior pri pri mvnormal observations diagnormal dim comparing variational approximation looks pretty worth noting particular variational posterior overestimate variance conclude somewhat pretty picture julia using plots julia psamples rand trueposterior qsamples rand julia p histogram psamples label histogram qsamples alpha label julia title raw mu julia p histogram psamples label histogram qsamples alpha label julia title raw mu julia plot p p simple example using advancedjl directly minimize kldivergence distributions vi aim approximate true posterior approximate variational posterior maximizing elbo elbo qlog log observe express elbo negative kldivergence elbo qlog kl apply vi actual posterior data involved write minimizing kldivergence distributions try advancedvijl real quick applying using interface minimize kldivergence distributions julia using distributions distributionsad advancedvi julia target distribution mvnormal ones zeromeandiagnormal dim julia log logpdf log generic function method julia choice vi algorithm advi advi advi advancedviforwarddiffad specifying approximate posterior family providing mapping parameters distribution julia using function getq turingdiagmvnormal exp getq generic function method julia perform vi vi log advi getq randn info advi seen optimizer created objectid xddb advi optimizing time turingdiagmvnormal arrayfloatarrayfloat check elbo mentioned involve data negative kldivergence julia advancedvi elbo advi log empirical estimate worth noting actual value elbo tell quality fit particular directly minimizing kldivergence useful reach obtained true distribution quickly check meansquared error log log random set samples target julia zs rand julia mean abs logpdf zs logpdf zs look bad implementing training loop sometimes convenient roll training loop using vi psuedocode turingjl using turing advancedvi diffresults using turing variational using progressmeter assuming instance turing model model create logjoint elbo evaluation log variational makelogjoint model define objective variationalobjective variational elbo optimizer optimizer variational decayedadagrad vialgorithm alg advi variational distribution function getq optional implement convergence criterion function hasconverged args optional implement callback tracking stats function callback args train converged false step prog progressmeter progress numsteps diffresults diffresults gradientresult init step numsteps converged compute gradient objective value results stored diffresults advancedvi grad variationalobjective alg getq model diffresults extract gradient diffresult diffresults gradient diffresult apply optimizer multiplying stepsize apply optimizer update parameters whatever analysis callback args update converged hasconverged userdefined step progressmeter prog references jordan michael zoubin ghahramani tommi jaakkola lawrence saul introduction variational methods graphical models machine learning blei david alp kucukelbir jon mcauliffe variational inference review statisticians journal american statistical association kucukelbir alp rajesh ranganath andrew gelman david blei automatic variational inference stan advances neural information processing systems pp salimans tim david knowles fixedform variational posterior approximation stochastic linear regression bayesian analysis beal matthew james variational algorithms approximate bayesian infer