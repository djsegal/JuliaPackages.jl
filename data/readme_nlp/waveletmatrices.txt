waveletmatrices implementation wavelet matrix claude navarro wavelet matrix data structure represent immutable sequence unsigned integers supports queries efficiently waveletmatrix type defined follows struct waveletmatrix unsigned abstractbitvector abstractvector bits required encode unsigned integers elements type elements type bit vectors store elements efficiently pack sequence unsigned integers encode integers example store integers x x distinct integers setting ceillog choice basic operations available wavelet matrix getindexwmwaveletmatrix integer return th element wm rankunsigned wmwaveletmatrix integer count occurrences wm selectunsigned wmwaveletmatrix integer return position th occurrence wm example data rand x x wm waveletmatrix data wm rank x wm partialsort x wm