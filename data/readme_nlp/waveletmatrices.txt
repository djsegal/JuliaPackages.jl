waveletmatric implement wavelet matrix claud navarro wavelet matrix data structur repres immut sequenc unsign integ support queri effici waveletmatrix type defin follow struct waveletmatrix unsign abstractbitvector abstractvector bit requir encod unsign integ element type element type bit vector store element effici pack sequenc unsign integ encod integ exampl store integ distinct integ set ceil log choic basic oper avail wavelet matrix getindex waveletmatrix integ return element rank unsign waveletmatrix integ count occurr select unsign waveletmatrix integ return posit occurr exampl data rand waveletmatrix data rank partialsort