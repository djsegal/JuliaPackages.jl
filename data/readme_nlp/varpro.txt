varpro variable projection nonlinear squares model fitting approached optimization sum model errors minimized optimizing model parameters model parameters linear linear optimization algorithm inefficient parameters linear varpro algorithm recasts nonlinear parameters considered nonlinear optimizer details references embedded docs source code julia code translation extension matlab code found extensions involve handling complex inputs complex model optimization objective function remains real objective essentially l norm residual error vector usage learn varpro read reference usage julia differs somewhat matlab version version set fitcontext calling constructor following ctx fitcontext xinit ind fexp gexp required parameters vector data wish fit sampled times whatever independent variable vector weight vector selectively weighting data ones usually step vector xinit starting guess nonlinear parameters note xinit real complex share type integer basis functions linear parameters matrix ind specifies structure dphi matrix functions fexp gexp calculate phi dphi matrices following complete example fitting h strain ringdown values recently discovered gravity wave gw using varpro using pyplot using delimitedfiles function fexpalpha ctx ctx ctx ctxphi expalpha ctx ctxphi function gexpalpha ctx ctx ctxdphi ctx ctxphi ctxdphi fit complex exponentials measured data function expfit oneslength ind collect collect xinit complexrand rand ctx fitcontext xinit ind fexp gexp alpha wresid residnorm yest regression varproctx function main h readdlmhwhitenedtxt h complexh complex match xinit rnorm yest reg expfit printlnnorm residual error rnorm plot real labelmeasured h strain plot realyest labelmodeled h strain xlabeltime ylabelstrain titleh ringdown model legendlocupper savefigmodeledgwstrainpng main code produces following figure nonlinear optimizer varpro depends underlying nonlinear optimization algorithm default nlsol venerable fortran code s code compiled nlsoljll wrapped nlsoljl code theory discussed limitations supported julia fitting sum exponentials common varpro note tricky business optimzer takes step parameter parameters swamped rank current value varpro tries care svd regularizing throwing singular values reducing dimensionality references golub pereyra differentiation pseudoinverses nonlinear squares variables separate siam journal numerical analysis pp golub pereyra separable nonlinear squares variable projection method applications inverse rr pereyra scherer eds exponential data fitting applications bentham books isbn dianne leary bert rust variable projection nonlinear squares computational optimization applications april volume issue pp available abbott el al astrophysical implications binary black hole merger gw astrophysical journal letters volume dennis gay welsch adaptive nonlinear squares algorithm acm transactions mathematical software toms volume issue sept pp acm york ny usa dennis gay welsch algorithm nlsol adaptive nonlinear squares algorithm acm transactions mathematical software toms volume issue sept pp acm york ny usa