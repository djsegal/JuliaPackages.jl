matrixlm core functions obtain closedform squares estimates matrix linear models variance shrinkage adapted ledoit wolf extension matrixlm applications throughput genetic screens geneticscreens package associated paper matrix linear models throughput chemical genetic screens reproducible code details matrixlmnet related package implements algorithms penalized estimates matrix linear models associated paper sparse matrix linear models structured throughput data reproducible code details installation matrixlm package installed running using pkg pkgaddmatrixlm recent version using pkg pkgaddurl revmaster usage using matrixlm construct rawdata object consisting response variable rowcolumn predictors matrices passed dimensional arrays note contr function set treatment sum contrasts categorical variables stored dataframe default contr generates treatment contrasts specified categorical variables treat options include sum sum contrasts noint treatment contrasts intercept sumnoint sum contrasts intercept using dataframes using random dimensions matrices column covariates randomly generate matrix row covariates categorical variables continuous variables randomseed xdf hcatdataframecatvarrand catvarrand dataframerand contr function contrasts categorical variables treatment contrasts catvar sum contrasts catvar contr returns dataframe converted d array convertarrayfloat contrxdf catvar catvar treat sum row covariates size randomly generate data column covariates response variable rand rand randn transpose construct rawdata object dat rawdataresponse predictors squares estimates matrix linear models obtained running mlm object type mlm returned variables coefficient estimates coefficient variance estimates varb estimated variance errors sigma default mlm estimates row column main effects intercepts behavior suppressed setting hasxinterceptfalse haszinterceptfalse column weights target type variance shrinkage optionally supplied weights targettype respectively est mlmdat coefficient estimates accessed using coefest predicted values residuals obtained calling predict resid default functions data fit model predictors object passed predict newpredictors argument rawdata object passed resid newdata argument convenience fittedest return fitted values calling predict default arguments preds predictest resids residest statistics mlm object defined est sqrtestvarb obtained running tstat default tstat return corresponding statistics main effects estimated mlm returned ismainefftrue tstats tstatest permutation values statistics computed mlmperms function mlmperms calls function permpvals run permutations parallel illustrative example runs permutations specified argument default function permute shufflerows shuffles rows alternative functions permuting shufflecols passed argument permfun mlmperms calls mlm tstat user free specify keyword arguments mlm tstat default mlmperms call functions using default behavior nperms tstats pvals mlmpermsdat nperms additional details found documentation specific functions ledoit wolf improved estimation covariance matrix stock returns application portfolio selection journal empirical fin