matrixlm core function obtain close form squar estim matrix linear model varianc shrinkag adapt ledoit wolf extens matrixlm applic throughput genet screen geneticscreen packag associ paper matrix linear model throughput chemic genet screen reproduc code detail matrixlmnet relat packag implement algorithm penal estim matrix linear model associ paper spars matrix linear model structur throughput data reproduc code detail instal matrixlm packag instal run use pkg pkg add matrixlm recent version use pkg pkg add url rev master usag use matrixlm construct rawdata object consist respons variabl row column predictor matric pass dimension array note contr function set treatment sum contrast categor variabl store datafram default contr generat treatment contrast specifi categor variabl treat option includ sum sum contrast noint treatment contrast intercept sumnoint sum contrast intercept use datafram use random dimens matric column covari random generat matrix row covari categor variabl continu variabl random seed hcat datafram catvar rand catvar rand datafram rand contr function contrast categor variabl treatment contrast catvar sum contrast catvar contr return datafram convert array convert array float contr catvar catvar treat sum row covari size random generat data column covari respons variabl rand rand randn transpos construct rawdata object dat rawdata respons predictor squar estim matrix linear model obtain run mlm object type mlm return variabl coeffici estim coeffici varianc estim varb estim varianc error sigma default mlm estim row column main effect intercept behavior suppress set isxintercept fals iszntercept fals column weight target type varianc shrinkag option suppli weight targettyp respect est mlm dat coeffici estim access use coef est predict valu residu obtain call predict resid default function data fit model predictor object pass predict newpredictor argument rawdata object pass resid newdata argument conveni fit est return fit valu call predict default argument pred predict est resid resid est statist mlm object defin est sqrt est varb obtain run stat default stat return correspond statist main effect estim mlm return ismaineff true tstat stat est permut valu statist comput mlm perm function mlm perm call function perm pval run permut parallel illustr exampl run permut specifi argument default function permut shuffl row shuffl row altern function permut shuffl col pass argument permfun mlm perm call mlm stat user free specifi keyword argument mlm stat default mlm perm call function use default behavior nperm tstat pval mlm perm dat nperm addit detail found document specif function ledoit wolf improv estim covari matrix stock return applic portfolio select journal empir financ