pretendjl pretendjl test doubles library main idea annotate functions mockable easily stub calls function patch usage following examples demonstrate basic usage pretend framework pretend activate pretend framework annotate function mockable macro mockable add apply patch apply add test add apply patch conditionally apply add fallback test add test add verification mockable foo bar mockable bar spy foo test calledexactlyonce bar mocking thirdparty methods mockable base sin real fakesin real apply sin fakesin test sin mocking anonymous functions addcurry add mocked addcurry function macro apply add test add design notes mockable macro rewrites method definition wrapping logic switched pretendactivated returns true logic basically looks patch patch store method signature patch found called patch found patch returns fallback singleton object existing method body executed apply function sets patch store usersupplied patch functions running body exits current scope patch store unwound previous hence patch applied ensures clean slate whenever patches applied apply spy functions track executions mockable functions difference apply expects set patches spy patch mocking thirdparty methods mockable macro function definition little tricky mock third party function overcome issue define function package delegate call third party function annotate function mockable convenience mockable front thirdparty method signature expanded delegate function function name mocking anonymous functions functions class julia function created time fly common usage functions closures consider following function addcurry easy annotate addcurry mockable mock addcurry function returns add addcurry mock add mocked function follows add mocked addcurry related projects mocking libraries available pretendjl fit look alternatives mockingjl design mocks annotated call site function definition simplemockjl cool package implements mocking using cassettejl machineri