bayesianrecordlinkag collect method perform bayesian infer scale record linkag describ scale bayesian probabilist record linkag post hoc block applic california regist instal pkg add https github com brendanstat assignmentsolv pkg add https github com brendanstat bayesianrecordlinkag depend addit assignmentsolv modul follow packag load distribut datastructur statsbas statsfun sparsearray specialfunct date instal automat packag manag instal follow line pkg add distribut datastructur statsbas statsfun sparsearray specialfunct date method packag implement varieti methd describ mcveigh spahn murray allow probabilist bayesian record linkag model estim dataset involv hundr thousand million record throughout condit independec model record linkag employ categor comparison vector assum model ident outlin sadinl penal likelihood estim penal likelihood search hungarian penal likelihood search auction function allow sequenc model estim link subject increas penalti term inform sequenc construt set post hoc block penal likelihood search hungarian function reli hungarian algorithm solv assign intern penal likelihood search auction reli auction algorith auction algorithm dramat comput effici recommend penal likelihood search auction function post hoc block restrict markov chain mont carlo algorithm gibb trace gibb count function implement mcmc sampler estim posterior distribut linkag structur model paramet gibb trace retirn trace linkag structur store link persist specifc record pair ad delet wherea gibb count store mcmc iter record pair presemt function save trace model paramet addit return set object return object type parameterchain contain trace count link structur trace model paramet return object contain frequenc updat perform post hoc block third return object contain link structur type linkmatrix final step sampler mcmc move mcmc sampler model paramet updat condit linkag structur via gibb updat singleton post hoc block contain singl record pair gibb updat linkag structur block larger post hoc block local balanc move zanella prior distribut linkag structur current function provid evalu prior distribut linkag structur beta prior bipartit match sadinl prior appli exponenti penalti green mardia exampl provid exampl setup use bayesianrecordlinkag delimitedfil stringdist random comparison vector generat load data dataa vara readdlm data dataa txt string header true datab varb readdlm data datab txt string header true size dataa size datab field compar gnameind findfirst gname vec vara fnameind findfirst fname vec vara ageind findfirst age vec vara occupind findfirst occup vec vara defin function generat ordin comparison string use levenshtein sting distanc function levord string string levsim compar levenshtein levsim return int elseif levsim return int elseif levsim return int els return int defin function generat ordin comparison string use exact match function boolord string string return int elseif return int els return int generat ordin comparison ordarray array int undef ordarray levord dataa gnameind datab gnameind ordarray levord dataa fnameind datab fnameind ordarray boolord dataa ageind datab ageind ordarray boolord dataa occupind datab occupind load comparsionsummari object compsum comparisonsummari ordarray penal likelihood estim set penal likelihood paramet maxit maximum inter minincr increment penalti penalti start penalti valu epsscal epsilon scale valu auction algorithm defin flat prio priorm fill sum compsum nlevel prioru fill sum compsum nlevel comput prior mode model paramet assum dirichlet prior prior mode priorm compsum prior mode compsum count compsum run penal likelihood estim penlikseq penalti iter penal likelihood search auction compsum priorm prioru penalti minincr maxit maxit cluster fals updat fals epsiscal verbos fals post hoc block set post hoc block paramet npairscompthreshold maximum record pair allow post hoc block threshold initi weight threshold cluster thresholdinc threshold increment break larger block post hoc block use maximum weight penal likelihood sequenc edg weight maxw maximum weight vector penlikseq penlikseq compsum weightmat penal weight matrix maxw compsum rowlabel collabel maxlabel clusterthreshold iter bipartit cluster weightmat npairscompthreshold threshold thresholdinc connectedcompon rowlabel collabel maxlabel phblock posthocblock compsum restrict mcmc initi use solut found penalti maximum posthoc block threshold matchidx findfirst penalti maximum clusterthreshold row col steplink matchidx penlikseq linkmatrix bayesianrecordlinkag tupl link row col compsum nrow compsum ncol set seed random seed set flat prior share record pair link lpriorc nadd integ linkmatrix betabipartit logratiopn nadd run restrict mcmc sampler postchain transc gibb trace compsum phblock priorm prioru lpriorc randomwalk local balanc barker updat comput frequenc record pair link return count pair nonzero count cts linkcount postchain cts cts cts reduc record pair link half time bay estim cbay linkmatrix cts cts ntp count cbay row col exampl construct row match row nfp cbay nlink ntp println precis ntp cbay nlink println recal ntp block index sparsecomparisonsummari type avaiabl comparison vector comput record pair exampl shown note exampl construct simplicti effici method blockng index practic sparsecomparisonsummari object standard comparisonsummari object generat ordin comparison indsa int indsb int gnamecomp compar dataa gnameind datab gnameind levenshtein fnamecomp compar dataa fnameind datab fnameind levenshtein gnamecomp fnamecomp push indsa push indsb generat ordin comparison ordarray array int undef length indsa length indsa ordarray levord dataa indsa gnameind datab indsb gnameind ordarray levord dataa indsa fnameind datab indsb fnameind ordarray boolord dataa indsa ageind datab indsb ageind ordarray boolord dataa indsa occupind datab indsb occupind spcompsum sparsecomparisonsummari indsa indsb ordarray size dataa size datab custom type comparisonsummari obsidx array map record pair comparison vector indic column obsvec contain origin record pair obsvec array comparison vector observ data column correspond observ comparison vector zero entri indic miss valu comparison featur pair obsvecct array int observ comparison vector length size obsvec count array int vector store count comparison level field length sum nlevel obsct array int observ comparison field length obsct ncomp misct array int comparison miss comparison length obsct ncomp obsct misct npair nlevel array int level allow comparison cmap array int comparison count correspond levelmap array int level count correspond cadj array int cadj yield index count jjth level comparison length cadj ncomp rang cadj nlevel index count comparison nrow int record data base dimens input array ncol int record data base dimens input array npair int record pair nrow ncol ncomp int comparison comput third dimens input array sparsecomparisonsummari obsidx sparsematrixcsc map record pair comparison vector indic column obsvec contain origin record pair obsvec array comparison vector observ data column correspond observ comparison vector zero entri indic miss valu comparison featur pair obsvecct array int observ comparison vector length size obsvec count array int vector store count comparison level field length sum nlevel obsct array int observ comparison field length obsct ncomp misct array int comparison miss comparison length obsct ncomp obsct misct npair nlevel array int level allow comparison cmap array int comparison count correspond levelmap array int level count correspond cadj array int cadj yield index count jjth level comparison length cadj ncomp rang cadj nlevel index count comparison nrow int record data base dimens input array ncol int record data base dimens input array npair int record pair nrow ncol ncomp int comparison comput third dimens input array linkmatrix linkmatrix type store current linkag structur follow field row col array map row column row ccol row link column row unlink row col col row array map column row col row column link row column unlink col row nlink record pair count link nrow row equal nrow length row col ncol column ncol length col row connectedcompon rowlabel array compon assign row zero indic edg row collabel array compon assign col zero indic edg column rowperm array permut reorder row label ascend colperm array permut reorder column label ascend rowcount array row contain compon count forunassign label row includ rowcount contain count compon colcount array column contain compon count forunassign label column includ colcount contain count compon cumrow array cumul sum rowcount cumcol array cumul sum colcount nrow row node ncol column node ncompon compon posthocblock block row dict array map block set row contain block block col dict array map block set column contain block blocknrow array row contain block blocknrow length block row blockncol array column contain block blockncol length block col blocksingleton array bool blocksingleton true blocknrow block col blocknnz array int zero entri contain block blocknrow blockncol unless constructur run sparsecomparisonsummari zero entri spars matrix region correspond block count nrow row array contain block entri block row nrow ncol column array contain block entri block col ncol nblock block nblock maximum key block row maximum key block col nnz int total entir equal sum blocknnz parameterchain parameterchain type store trace linkag structur model paramet linktrac field set true linktrac field set fals count frequenc record pair link store type contain follow field array row column indic pair link count indici pair step iter appear nlink union array array total link step iter array paramet iter size nstep array paramet iter size nstep nstep int total step iter linktrac bool indic contain link count trace entir link structur refer green mardia bayesian align use hierarch model applic protein bioinformat biometrika mcveigh spahn murray scale bayesian probabilist record linkag post hoc block applic california regist arxiv preprint arxiv mauricio sadinl bayesian estim bipartit match record linkag journal american statist associ doi giacomo zanella inform propos local mcmc discret space journal american statist associ doi