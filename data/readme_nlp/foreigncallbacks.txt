foreigncallbacksjl callbacks executing foreign julia thread allowed interact julia runtime canonical exception baseasynccondition uvasyncsend event trigger mapped asynccondition uvasyncsend triggers handle coalesced invocation foreigncallbacks implements lockfreequeue pass data foreign thread julia callback data passed satisfy baseismutabletype basedatatypepointerfree example import foreigncallbacks struct message id int data ptrcvoid barrier base event callback foreigncallbacks foreigncallback message msg info received message id msg id notify barrier return gc preserve callback begin token foreigncallbacks foreigntoken callback ptr cfunction foreigncallbacks notify cvoid foreigncallbacks foreigntoken message sync threads spawn begin msg message cnull ccall ptr cvoid foreigncallbacks foreigntoken message token msg wait barri