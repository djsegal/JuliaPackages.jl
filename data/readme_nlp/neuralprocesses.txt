neuralprocess neuralprocess framework compos neural process built top flux neuralprocess juliacon link video neural process famili code reproduc imag experi convolut condit neural process gordon content introduct predefin experiment setup train manual principl avail model regress build block data generat train evalu exampl condit neural process neural process attent neural process convolut condit neural process packag implement detail introduct set neuralprocess meta learn meta learn concern learn map data set direct predict distribut neural process power class parametris map base encod data predefin experiment setup train eager start file train contain predefin experiment setup immedi exampl julia project train model convcnp data matern loss loglik epoch usag train data data model model num sampl num sampl batch size batch size loss loss start epoch start epoch epoch epoch evalu evalu evalu evalu num sampl evalu num sampl evalu model dir model dir bson bson option argument data data data set matern mixtur noisi mixtur weak period sawtooth mixtur append noisi data set noisi model model model conv corconvcnp append global mean sum introduc global latent variabl append amortis mean sum amortis observ nois append het heterogen observ nois num sampl num sampl sampl estim train loss default loglik elbo type int batch size batch size batch size type int default loss loss loss loglik loglik elbo start epoch start epoch set continu train type int default epoch epoch epoch train type int default evalu evalu model evalu forc import weight evalu object evalu forc import weight evalu object evalu num sampl evalu num sampl sampl estim evalu loss type int default evalu evalu task interpol train rang model dir model dir directori store model default model bson bson direct specifi file save model load help help messag exit manual principl model neuralprocess model consist encod decod model model encod decod encod take data produc abstract represent data decod take represent produc predict target input function represent code packag object data encod predict common represent particular repres function tupl correspond function indic encod decod collect call code transform function code implement function code code encod encod transform function context set function abstract represent target input express desir encod output function map inde code oper call complet hand code oper call partial encod decod complet coder encod decod compos simpler coder coder partial composit coder design coder compos use chain encod chain coder coder coder coder parallel use parallel exampl use encod output multipl encod multi head architectur encod chain split output process head splitter parallel head head default parallel represent combin concaten channel dimens materialis section readili extend addit design materialis coder likelihood coder output determinist code stochast code achiev append likelihood determinist coder chain deterministiclikelihood stochast coder chain heterogeneousgaussianlikelihood model run output encod sampl result sampl fed decod scenario encod output multipl encod parallel desir concaten encod tensor process decod achiev prepend materialis decod decod chain materialis heterogenousgaussian decod output predict data exampl decod produc mean varianc test input avail model regress packag export constructor architectur literatur name constructor refer condit neural process cnp garnelo rosenbaum neural process garnelo schwarz attent condit neural process acnp kim mnih attent neural process anp kim mnih convolut condit neural process convcnp gordon bruinsma convolut neural process convnp foong bruinsma gaussian neural process corconvcnp bruinsma requeima download link pretrain model instruct pretrain model run follow download pretrain model extract model tar xzvf model tar julia load model use neuralprocess neuralprocess experi flux convnp model model convnp het loglik matern bson run model mean lower upper sampl predict convnp randn float random context input randn float random context output randn float random target input pretrain model foong bruinsma download link interpol result pretrain model follow loglik model matern noisi mixtur weak period sawtooth mixtur cnp acnp convcnp het anp het convnp het elbo model matern noisi mixtur weak period sawtooth mixtur het anp het convnp het loglik model matern noisi mixtur weak period sawtooth mixtur het anp het convnp het pretrain model bruinsma requeima download link interpol result pretrain model follow loglik model noisi matern noisi noisi mixtur weak period noisi sawtooth noisi mixtur noisi convcnp corconvcnp anp het convnp het build block packag provid various build block compos encod decod build block constructor function avail easili construct block inform block obtain use built help function layernorm glue type constructor descript chain sequenc parallel parallel basic block type constructor descript batchedmlp batch mlp batch mlp batchedconv build conv batch cnn splitter split channel layernorm layer normalis meanpool mean pool sumpool sum pool advanc block type constructor descript attent attent attent mechan setconv set conv set convolut setconvpd set conv set convolut kernel function likelihood type constructor descript deterministiclikelihood deterministiclikelihood output fixedgaussianlikelihood gaussian likelihood fix varianc amortisedgaussianlikelihood gaussian likelihood fix varianc calcul split channel heterogeneousgaussianlikelihood gaussian likelihood input depend varianc coder type constructor descript materialis materialis sampl functionalcod code function space target input discretis uniformdiscretis discretis uniform densiti inputscod code target input mlpcoder rho sum phi coder data generat model train data generat data generat callabl integ batch iter generat tupl context input context output target input target output tensor rank dimens data dimens dimens featur dimens third dimens batch dimens data generat construct datagener take under stochast process stheno build gaussian process addit packag export follow process type descript sawtooth sawtooth process bayesianconvnp convolut neural process prior weight mixtur mixtur process train evalu experiment function export neuralprocess experi run model model run forward call argument context input context output target input argument model tensor rank dimens data dimens dimens featur dimens third dimens batch dimens convcnp batch size randn float random context input randn float random context output randn float random target input conveni packag export function predict run model input type vector produc predict mean lower upper credibl bound predict sampl mean lower upper sampl predict convcnp randn float random context input randn float random context output randn float random target input train train model train amongst requir loss function optimis loss function describ optimis found flux optimis applic adam probabl suffic train model evalu eval model train exampl train loss follow loss function export function descript loglik bias estim log expect likelihood exact model determinist encod elbo neural process elbo style loss exampl sampl log loss exact model determinist encod loss loglik num sampl sampl log loss probabl train model stochast encod loss loglik num sampl sampl elbo loss altern loglik loss elbo num sampl train exampl save load epoch current model top five model save file model written determin keyword bson train train model load model path exampl condit neural process simplest famili condit neural process cnp cnps employ determinist mlp base encod mlp base decod exampl provid implement simpl cnp framework encod map finit dimension vector space produc global determinist represent concaten test parallel object achiev encod parallel inputsencod simpli output target locat chain deterministiclikelihood form complet coder chain inputscod deterministiclikelihood chain represent deep set network implement mlpcoder object object receiv mlps construct pre pool network post pool network produc vector represent context set batch mlpcoder batch mlp dim dim dim dim hidden dim embed dim dim embed num layer num encod layer batch mlp dim dim embed dim hidden dim embed dim dim embed num layer num encod layer result represent chain deterministiclikelihood condit model deterministiclikelihood cnp decod mlp base materialis encod output concaten target input context set represent pass mlp output mean standard deviat target locat decod chain concaten target input context set represent default materialis concaten combin represent parallel object altern design summat multipl flow consid neuralprocess materialis pass result represent mlp base decod input dimension dimension target input plus dimension represent output dimens twice output dimension requir mean standard deviat locat batch mlp dim dim dim embed dim hidden dim embed dim dim num layer num decod layer heterogeneousgaussianlikelihood automat split input featur dimens treat half mean half standard deviat gaussian distribut heterogeneousgaussianlikelihood cnp model encod decod train predict follow mean lower upper sampl predict cnp randn float random context input randn float random context output randn float random target input neural process neural process extend cnps ad latent variabl model enabl nps captur joint gaussian margin distribut target set allow produc coher sampl extend cnps nps neuralprocces extrem easi simpli replac deterministiclikelihood compon mlpcoder heterogenousgaussian adjust output dimens encod produc mean varianc chang encod replac deterministiclikelihood follow mlpcoder heterogenousgaussian encod parallel chain inputscod deterministiclikelihood chain mlpcoder batch mlp dim dim dim dim hidden dim embed dim dim embed num layer num encod layer batch mlp dim dim embed dim hidden dim embed heterogenousgaussian split input channel dimens increas output dimens set encod accord dim dim embed num layer num encod layer main chang requir switch cnp heterogeneousgaussianlikelihood reus previous defin decod model encod decod note typic nps consid determinist latent represent easili achiev neuralprocess ad addit encod parallel object deterministiclikelihood increas decod dim accord repo built model form exampl includ determinist path emphasis eas switch condit latent variabl model neuralprocess attent neural process consid complic model demonstr easi implement neuralprocess attent neural process anp extend nps consid attent mechan determinist represent attent come built neuralprocess deploy chain parallel build block exampl implement anp determinist attent represent stochast gaussian global represent encod aggreg separ represent target input determinist attent represent iii stochast global represent encod parallel includ inputscod repres target set input chain inputscod deterministiclikelihood neuralprocess transform style multi head architectur attent emb input output finit dimension vector space mlp appli attent embed space constructor requir dimension input output desir dimension embed head employ head div dim embed num head dimension embed layer embed mlps anp employ attent determinist represent chain deterministiclikelihood chain attent dim dim dim dim dim embed dim embed num head num encod head num encod layer num encod layer deterministiclikelihood latent path form chain mlpcoder batch mlp dim dim dim dim hidden dim embed dim dim embed num layer num encod layer batch mlp dim dim embed dim hidden dim embed dim dim embed num layer num encod layer heterogeneousgaussianlikelihood decod anp mlp base form decod requir chang account dimension latent represent decod chain materialis batch mlp dim dim dim embed dim hidden dim embed dim num nois channel num layer num decod layer nois anp model encod decod convolut condit neural process final exampl consid convolut condit neural process convcnp key differ convcnp nps term implement encod data infinit dimension function space finit dimension vector space handl neuralpeocess functionalcod addit complet coder expect discretis object construct implement convolut condit neural process encod map function space functionalcod indic encod functionalcod exact repres function repres discretis function instead discretis unit discretis span minim context target input maxim context target input margin uniformdiscretis chain encod call set convolut direct map data set discretis function represent data consist channel specifi length scale twice inter space discretis function space map reproduc kernel hilbert space rkhs length scale correspond length scale kernel rkhs append densiti channel ensur encod inject set conv densiti true encod determinist stochast encod deterministiclikelihood decod chain decod transform function represent cnn build conv recept field size layer channel unit densiti discretis dimension model num channel account densiti channel num channel produc mean standard deviat set convolut map space encod space data set conv predict mean varianc heterogeneousgaussianlikelihood convcnp model encod decod packag packag current port academ code support data packag current built task plan add support data imag requir chang implement care test compon packag test test coverag near regress test packag gpu perform crucial regress test document document improv implement detail automat differenti tracker automat comput gradient custom gradient implement src util paramet handl packag functor handl paramet flux adher flux principl mean abstractarray paramet els train float float scalar train array wrap neuralprocess fix array unwrap neuralprocess unwrap fix runtim gpu acceler cuda support depthwis separ convolut depthwiseconv flux implement src gpu loop fusion caus issu gpu oftentim comput unrol