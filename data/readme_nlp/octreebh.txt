octreebh octreebh implement octre solv bodi use barn hut approxim name tree node carri inform sum compar effici packag provid main function find particl radius neighbor search calcul gravit acceler bodi system neighbor search gather scatter approach particular use smooth particl hydrodynam gravit acceler adopt monopol approxim distant particl cluster treat mass locat center mass boundari condit period mix period spatial dimens arbitrari posit integ quick start find particl search radius hsml center use octreebh use staticarray spatial dimens float npart particl hsml search radius boxsiz svector one period topnod length svector one size top tree node center topnod length center top tree ndoe hsml one npart hsml particl smooth length mass one npart particl mass random distribut particl svector rand npart store particl data struct data data hsml mass npart build tree tree buildtre center topnod length svector rand search center indic gather neighbor idx ngbs gather ngb tree hsml tree boxsiz indic scatter neighbor idx ngbs scatter ngb tree tree boxsiz constant hsml ngbs ident length idx ngbs length idx ngbs exampl exampl code visual visual quad tree structur particl configur illustr differ gather neighbor lower left scatter neighbor upper ident particular smooth length search radius constant exampl code nbodi solv gravit bodi system use leapfrog integr scheme author chia max planck institut extraterrestri physic cyhu astro gmail com