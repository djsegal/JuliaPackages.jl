naivenasflux naivenasflux naivenaslib enabl mutat oper arbitrari flux comput graph design neural architectur search nas mind purpos chang model desir follow oper support chang input output size layer paramet prune includ method rank neuron add layer model remov layer model add input layer remov input layer note naivenasflux function search model architectur check naivegaflux simpl proof concept basic usag add naivenasflux check basic usag naivenaslib verbos exampl quick rundown common oper input type channel imag invertex inputvertex fluxconv mutabl layer conv mutabl conv pad invertex batchnorm mutabl batchnorm nout conv relu conv explor graph test input conv invertex test output conv batchnorm test nin conv test nout conv test layertyp conv isa fluxconv test layertyp batchnorm isa fluxbatchnorm name vertic idea debug log purpos namedconv mutabl namedconv conv pad invertex test name namedconv namedconv concaten activ conc concat conc namedconv batchnorm test nout conc nout namedconv nout batchnorm residualconv mutabl residualconv conv nout conc nout conc pad conc elementwis addit oper add metadata name add add conc residualconv test name add add test input add conc residualconv comput graph evalu graph compgraph invertex add evalu function one float nout invertex test size graph nout add graph copi graphcopi copi graph mutat neuron test nout add nout residualconv nout conv nout namedconv nout add test nout add nout residualconv nout conv nout namedconv remov layer test graph remov batchnorm test graph add layer insert residualconv mutabl batchnorm nout relu test graph chang kernel size suppli pad size pad mutat weight namedconv kernelsizealign size pad appli mutat appli mutat graph note paramet chang size naivenasflux weight layer namedconv test size graph nout add mutat lazi default layer creat graph evalu size naivenasflux weight layer namedconv btw copi cours unaffect test size graphcopi naivenasflux built search polici cool stuff simpl exampl paramet prune model train xor function boilerpl creat model train use naivenasflux test import flux train mse import random random seed niter creat simpl model layerfun activationcontribut wrap layer comput prune metric model train mdens outsiz act mutabl dens nout outsiz act layerfun activationcontribut invertex inputvertex input fluxdens layer mdens invertex relu layer mdens layer sigmoid origin compgraph invertex layer train param opt adam loss mse train data xor truth tabl xor float float train model iter niter train loss origin param origin opt test loss origin tri prune hidden layer nprune prune random select neuron prune random copi origin nin prune random output nprune output prune random output rand nout org appli mutat prune random prune valuabl neuron accord metric activationcontribut prune copi origin nin prune output nprune output prune output neuron valu appli mutat prune prune valuabl neuron accord metric activationcontribut prune copi origin nin prune output nprune output prune output neuron valu appli mutat prune free lunch pleas test loss prune loss prune random loss prune loss origin metric calcul activationcontribut actual test loss prune loss origin atol toy exampl model layer effici fit data creat model train mutat use naivenasflux test import flux loss logitbinarycrossentropi import flux train glorot uniform use statist import random random seed niter layer exampl mconv outsiz act init glorot uniform mutabl conv nout outsiz act pad init init mavgpool mutabl meanpool mdens outsiz act mutabl dens nout outsiz act size input height width function model nconv invertex inputvertex fluxconv invertex nconv mconv relu mavgpool height width invariantvertex flux flatten mdens ident return compgraph invertex origin model train param opt org adam loss logitbinarycrossentropi agg mean train data xor ish class matric true function rand bool return float vcat hcat hcat float rand float float joke generat fals negat generat class class exampl batch catbatch tupl tupl cat dim hcat batch batchsiz mapfoldl catbatch batchsiz test test batch height width startloss loss origin test test train model iter niter train loss origin param origin batch height width opt org didn test loss origin test test startloss atol tri train model add conv layer train model creat model conv layer scratch disclaim experi intend usag librari meant evid method option hyperparamet tune strong favor avoid sporad failur add layer conv layer add layer copi origin function add conv mconv nout relu init idmap return mconv nout relu init idmap insert vertic add layer add conv layer initi ident map weight basic model potenti guarante idea reli exist layer provid gradient divers test add layer test origin test creat model conv layer model model opt add deepcopi opt org opt adam tri iter niter batch height width train loss origin param origin opt org train loss add layer param add layer opt add train loss model param model opt test loss add layer test test loss model test test loss origin test test contribut contribut welcom pleas file issu creat