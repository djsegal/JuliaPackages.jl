contentsecuritypolicy julia library aid integration contentsecuritypolicy headers web applications references mdn csp owasp csp strict csp wc csp cspwithgoogle csp cheatsheet cspbuilder djangocsp project status package active development changes occur todo register package improve support cspnonce csphash improve default strict policy improve overall configurability handle csp violation reports export nginx apache header configurations contributions suggestions questions welcome feature requests bug reports please issue discussion topic submit pr table contents installation usage examples web example import json api reference installation package installed via package manager pkg add contentsecuritypolicy installed providing url repository pkg add https github com charlieit contentsecuritypolicy jl usage examples using contentsecuritypolicy csp name shortening purposes using contentsecuritypolicy csp policy build content security policy policy set fallback fetch directives defaultsrc set valid sources images favicons imgsrc self data https enforcement upgradeinsecurerequests true custom directives supported customdirective foo bar output defaultsrc imgsrc self data upgradeinsecurerequests true customdirective foo bar report false policy strict policy edit existing policy modify multiple directives modify multiple directives policy pairs kwargs scriptsrc unsafeinline imgsrc self data modify single directive modify individually via directive name policy imgsrc csp wildcard build http headers contentsecuritypolicy header using contentsecuritypolicy http http header policy default true contentsecuritypolicy baseuri none defaultsrc self frameancestors none objectsrc none report default scriptsrc strictdynamic report header policy policy defaultsrc csp self report endpoint reportonly true http header policy contentsecuritypolicyreport defaultsrc self report endpoint build meta element construction automatically ignore directives supported meta element currently frameancestors reporturi report sandbox mdn csp directives csp meta policy reportto default defaultsrc self meta httpequiv contentsecuritypolicy content defaultsrc self obtain csp header dict policy csp defaultsrc csp self imgsrc csp self csp data reporturi apireports csp http policy output orderedcollectionsordereddictstring entries imgsrc data self defaultsrc self reporturi apireports web example mockup web application dynamic csp policies receive csp violation reports example app allow route handlers tailor csp policy response using contentsecuritypolicy dates http json random sockets middleware adding csp header response middleware set restrictive default policy allows route handlers change csp policy function cspmiddleware return function request httprequest function respond response httpresponse timestamp string round int datetimeunix default restrictive policy policy csp default true defaultsrc self scriptsrc none reportto false sandbox true reporturi reports timestamp report specific endpoint isnothing request context haskey request context csp acquire policy defined route log routepolicy request context csp info custom policy string routepolicy merge default handler provided policy policy policy routepolicy directives check header defined http hasheader response csp cspheader set csp policy header http setheader response http header policy return response return respond request handler posted csp violation reports handle posted csp reports function report request httprequest report string request body report posted reportstimestamp timestamp base parse int request context params timestamp log timestamp date println string timestamp unixdatetime timestamp log pretty json report json pretty report return http response report page restrictive csp policy function restrictive request httprequest obtain nonce nonce csp cspnonce set policy allowing scripts nonce enabling scripts modals sandbox mode request context csp csp scriptsrc nonce nonce sandbox allowscripts allowmodals html html body execute script typetextjavascript nonce nonce alert execute script execute script typetextjavascript alert authorised script body html return http response html page permissive csp policy function permissive request httprequest set permissive scriptsrc allow inline scripts request context csp csp scriptsrc self unsafeinline sandbox false html html body div idhellodiv script typetextjavascript documentgetelementbyidhelloinnerhtml scripts execute script script typetextjavascript alertscripts launch modals script body html return http response html setup http routing const csprouter http router http register csprouter restrictive restrictive http register csprouter permissive permissive handle incoming csp reports http register csprouter post reportstimestamp report server http serve csprouter cspmiddleware ip web example policy json file example configurationjson policy policy pathconfjson policy defaultsrc output element vectorstring unsafeeval unsafeinline data filesystem blob ws wss julia policy scriptsrc output element vectorstring unsafeeval unsafeinline api reference policy strict policy defaultpolicy progress default restrictive policy based various csp recommendations creating policy default true owasp csp cheatsheet mdn csp docs csp dead live csp strictcsp const directivetypes unionstring setstring vectorstring tuple bool defines acceptable values directive empty false values considered generating csp header policy directives abstractdict reportonly false parameter type description directives dictstring directivetypes set directives configure policy reportonly bool optional define policy report defaults false default constructor policies empty default julia policy report false policy directives pair default false reportonly false kwargs parameter type description directives pairstringdirectivetypes individual policies pair default bool optional add default directives default values defaults false reportonly bool optional define policy report defaults false kwargs directives optional directives keyword arguments automatically replaces directives examples policy scriptsrc imgsrc reportonly true imgsrc scriptsrc report true policy policy set defaultsrc defaultsrc csp self self set reporturi reporturi report endpoint reportto default sandbox allowdownloads https enforcement upgradeinsecurerequests true upgradeinsecurerequests true defaultsrc self report default sandbox allowdownloads reporturi report false policy json string parameter type description json string path json file json string build policy json configuration import json http http header policy policy parameter type description policy policy policy instance build csp header example http header policy default true contentsecuritypolicy baseuri none defaultsrc self frameancestors none objectsrc none report default scriptsrc strictdynamic csp meta policy policy except csp metaexcluded parameter type description policy policy policy instance except vectorstring optional set directives exclude meta element defaults cspmetaexcluded build meta element ignoring directives except example csp meta policy reportto default defaultsrc self meta httpequiv contentsecuritypolicy content defaultsrc self csp http policy policy parameter type description policy policy policy instance obtain csp headers dict example policy csp defaultsrc csp self imgsrc csp self csp data reporturi apireports csp http policy orderedcollectionsordereddictstring entries imgsrc data self defaultsrc self reporturi apireport