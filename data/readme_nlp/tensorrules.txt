tensorrul tensorrul provid macro type nabla tab enabl automat differenti librari zygot forwarddiff tensor tensoropt macro tensoroper tensorrul chainrulescor defin custom adjoint librari support chainrulescor julia use tensoroper tensorrul zygot julia function foo defin function einstein summat sum tensor return julia randn randn randn julia gradient foo tri obtain gradient foo zygot error intrins compil call stacktrac julia function foo tensor return julia gradient foo strategi tensorrul similar tensorgrad convert function contain tensor tensoropt macro detect tensor tensoropt express function definit convert inlin function defin custom adjoint rule generat function exampl follow definit function foo tensoropt conj sin tensor return convert code equival function foo foo sin foo return inlin foo tensoropt conj inlin foo tensor function rrule typeof foo foo function foo pullback inplaceablethunk thunk tensoropt conj tensoropt conj inplaceablethunk thunk tensoropt conj conj conj tensoropt conj conj conj inplaceablethunk thunk tensoropt conj conj conj tensoropt conj conj conj thunk tensoropt conj conj inplaceablethunk thunk tensoropt conj conj tensoropt conj conj return field return foo pullback function rrule typeof foo use thunk inplaceablethunk proper adjoint evalu unsupport featur captur macro defin macrotool pars expr limit captur macro index notat base type vcat type hcat unsupport pleas style design contract base ord ncon style unsupport pleas tensoropt specifi cost bond zygot support inplac oper tensor express pleas instead todo support frule support tensor block tensor begin support differenti appli rrule frule recurs add test differenti test zygot poor support differenti support inplaceablethunk version foo inplaceablethunk disabl thunk