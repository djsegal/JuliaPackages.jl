stablemap map preserves relative inputs mapped outputs maps course stablemap tries return vectors concretely typed example julia using stablemap forwarddiff benchmarktools info precompiling stablemap ce aac e af bcbbffe julia generic function method julia base inferencebarrier generic function method julia base inferencebarrier generic function method julia forwarddiff dual f f forwarddiff dual f f julia forwarddiff dual f f forwarddiff dual f f julia btime map ns allocations bytes element vectorreal dual julia btime stablemap ns allocation bytes element vectorforwarddiff dual float dual dual julia btime map ns allocations bytes element vectorreal dual julia btime stablemap ns allocation bytes element vectorforwarddiff dual float dual dual julia btime map ns allocations bytes element vectorreal dual julia btime stablemap s allocations bytes element vectorforwarddiff dual float dual dual julia btime map ns allocations bytes element vectorreal dual julia btime stablemap s allocations bytes element vectorforwarddiff dual float dual dual julia btime map ns allocations bytes element vectorforwarddiff dual float dual dual julia btime stablemap ns allocations bytes element vectorforwarddiff dual float dual dual julia btime map ns allocations bytes element vectorforwarddiff dual float dual dual julia btime stablemap ns allocations bytes element vectorforwarddiff dual float dual dual faster handling unions basemap currently slower functions return benefit returning concretelytyped arrays try promote returned objects type return union julia generic function method julia btime map ns allocations bytes element vector forwarddiff dual float dual dual julia btime stablemap ns allocations bytes element vectorunionforwarddiff dual float vectorforwarddiff dual float forwarddiff dual float dual dual julia btime map ns allocations bytes element vector dual forwarddiff dual float dual julia btime stablemap ns allocations bytes element vectorunionforwarddiff dual float vectorforwarddiff dual float dual forwarddiff dual float du