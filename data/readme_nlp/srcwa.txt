srcwa scatter matrix rigor coupl wave analysi implement julia solv maxwel equat period pattern multilay optic isotrop materi current support comput reflect transmiss layerwis absorpt arbitrari plane wave incid usag defin reciproc space grid use srcwa maximum reciproc space vector dnx dni grid creat grid reciproc space srcwa solv maxwel equt reciproc space electr magnet field dealt term frequenc reciproc space wavevector real space coordin defin high index reciproc lattic vector zeroth element vector element vector accuraci result cost comput time deal structur homeogen later direct result left zero scale grid desir frequenc period theta incid angl degre propag direct surfac normal phi azimuth angl degre lambda wavelength uni cell size epsilon ref reflect halfspac space devic relat permitt kin grid theta phi lambda epsilon ref obtain reciproc lattic vector defin incid wavelength real space unit cell size scale grid rcwa implement arbitrari plane wave incid condit theta set zero avoid numer singular suffici angl numer error overshadow imperfect normal incid choic length unit wavelength cell size arbitrari consist return valu free space wavevector aka frequenc diagon matric later reciproc wave vector kin incid wave vector requir calcul normal field compon imping plane wave reflect transmiss halfspac epsilon tra transmiss halfspac relat permitt refspac halfspac epsilon ref reflect halfspac effect imped mode traspac halfspac epsilon tra transmiss halfspac effect imped mode mode freespac free space effect imped mode normal sref matrix ref refspac scatter matrix reflect halfspac stra matrix tra traspac scatter matrix transmiss halfspac srcwa comput requir scatter matric halfspac reflect transmiss devic model zero thick correspond measur plane wave direct devic addit propag loss phase shift comput step first effect imped halfspac calcul normal free space minim simul model basic yield fresnel equat compris transmiss reflect layer build devic layer layer thick unit wavelength ep relat permitt layer plain ep comput mode plain layer matrix layer comput scatter matrix ep permitt insid inclus layer ep permitt outsid inclus layer fill fill fill factor inclus circft fill dnx dni fourier transform circular inclus real space reciproc space ellipft fill fill dnx dni fourier transform ellipt inclus real space reciproc space rectft fill fill dnx dni fourier transform rectangular inclus real space reciproc space use linearalgebra ep ep ep permitt distribut layer reciproc space thick layer layer pattern ep comput mode pattern layer matrix layer comput scatter matrix concaten sref stra plain layer homogen relat permitt construct simpl similar transmiss reflect halfspac addit relat imped incorpor absorpt phase shift pattern layer permitt function reciproc space vector obtain fourier transform wave reciproc lattic vector propag effect permitt coupl interfac scatter matrix devic obtain individu scatter matric reflect transmiss prepar sourc kin refspac calcul amplitud imping plane wave polar art reflect wave incid rte art refspac kin reflect power incid att transmit wave incid tte att traspac kin transmit power incid artm reflect wave incid rtm artm refspac kin reflect power incid attm transmit wave incid ttm attm traspac kin transmit power incid scatter matrix construct easi comput transmit reflect wave amplitud power incid polar absorpt sabov concaten sref scatter matrix layer layer sint layer sbelow stra scatter matrix layer layer ate absorpt sabov sint sbelow kin absorpt layer incid atm absorpt sabov sint sbelow kin absorpt layer incid simpl method calcul absorpt layer differ power electromagnet wave enter leav layer electr magnet field realgrid grid squar creat grid real space data sabov concaten sref scatter matrix layer layer sint layer sbelow stra scatter matrix layer layer ain aout bin bout stackamp sabov sint sbelow amplitud vector layer incid field expans ain aout bin bout realgrid calcul field real space actual electr magnet field insid layer comput amplitud use eigenmod layer amplitud plane wave compon transform eigenst layer comput amplitud compon convert compon electr magnet field transform real space grid refer whittak culshaw scatter matrix treatment pattern multilay photon structur phys rev marco liscidini dario gerac lucio claudio andreani sipe scatter matrix analysi period pattern multilay asymmetr unit cell birefring media phys rev raymond rumpf improv formul scatter matric semi analyt method thati consist convent progress electromagnet research