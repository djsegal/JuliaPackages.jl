srcwajl scattermatrix rigorously coupled wave analysis implemented julia solves maxwell equations periodically patterned multilayers optically isotropic materials currently supporting computation reflection transmission layerwise absorption arbitrary plane wave incidence usage defining reciprocal space grid using srcwa nx ny maximum reciprocal space vector nxnydnxdny gridn nxny create grids reciprocal space srcwa solves maxwell equtions reciprocal space electric magnetic fields dealt terms frequency k reciprocal space wavevector kx ky real space coordinate nx ny define highes index reciprocal lattice vector nx zeroth element vector nx element vector accuracy result cost computation time dealing structures homeogenous lateral directions resulting left zero scaling grid desired frequency periodicity theta e incident angle degrees propagation direction surface normal phi azimuth angle degrees lambda wavelength ax ay uni cell size epsilonref reflection halfspace space device relative permittivity kkxkykin gridk nxnythetaphilambdaaxayepsilonref obtain reciprocal lattice vectors define incident wavelength real space unit cell size scale grid rcwa implementation arbitrary plane wave incidence conditions theta set zero avoid numerical singularities sufficiently angle numerical errors overshadow imperfectly normal incidence choice length units wavelength cell size arbitrary consistent returned values freespace wavevector aka frequency k diagonal matrices lateral reciprocal wave vectors kx ky kin incident wave vector required calculation normalized field components impinging plane wave reflection transmission halfspace epsilontra transmission halfspace relative permittivity refspace halfspace kxkyepsilonref reflection halfspace effective impedance modes traspace halfspace kxkyepsilontra transmission halfspace effective impedance modes vkz modesfreespace kxky free space effective impedance modes normalization sref matrixref refspacev scattering matrix reflection halfspace stra matrixtra traspacev scattering matrix transmission halfspace srcwa computation require scattering matrices halfspaces reflection transmission device modeled zero thickness corresponding measurement plane wave directly device additional propagation losses phase shift computation steps firstly effective impedance halfspaces calculated normalized free space minimal simulation model basically yields fresnel equation comprised transmission reflection layer building device layer layer t thickness units wavelength eps relative permittivity l layerplain kxkykteps compute modes plain layer s matrixlayer lv compute scattering matrix l epsa permittivity inside inclusion layer epsb im permittivity outside inclusion layer fillx filly fill factor inclusion circft fillxdnxdny fourier transform circular inclusion real space reciprocal space ellipft fillxfillydnxdny fourier transform elliptic inclusion real space reciprocal space rectft fillxfillydnxdny fourier transform rectangular inclusion real space reciprocal space using linearalgebra eps epsa epsb permittivity distribution layer reciprocal space t thickness layer l layerpatterned kxkykteps compute modes patterned layer s matrixlayer lv compute scattering matrix l concatenate srefssstra plain layers homogenous relative permittivity constructed simple similar transmission reflection halfspaces addition relative impedance incorporate absorption phase shift patterned layers permittivity function reciprocal space vector obtained fourier transform waves reciprocal lattice vectors propagate effective permittivities couple interfaces scattering matrix device obtained individual scattering matrices reflection transmission ateatm preparesource kinrefspace nxny calculate amplitudes impinging plane wave te tm polarization arte s ate reflected wave incident te rte ap arterefspacekxkykin reflected power incident te atte s ate transmitted wave incident te tte ap attetraspacekxkykin transmitted power incident te artm s atm reflected wave incident tm rtm ap artmrefspacekxkykin reflected power incident tm attm s atm transmitted wave incident tm ttm ap attmtraspacekxkykin transmitted power incident tm scattering matrix constructed easy compute transmitted reflected wave amplitudes power te tm incident polarizations absorption sabove concatenate srefs scatter matrix layers layer sint s layer sbelow stra scatter matrix layers layer ate absorption sabovesintsbelowvatekin absorption layer te incidence atm absorption sabovesintsbelowvatmkin absorption layer tm incidence simple method calculates absorption layer difference power electromagnetic wave entering leaving layer electric magnetic fields realgrid gridxysquare create grid real space data sabove concatenate srefs scatter matrix layers layer sint s layer sbelow stra scatter matrix layers layer ainaoutbinbout stackamp sabovesintsbelowatm amplitude vectors layer tm incidence eh fieldexpansion ainaoutbinboutlv kxkykzknxnyrealgrid calculate fields real space actual electric magnetic fields inside layers computed amplitudes using eigenmodes layers amplitudes plane wave components transformed eigenstates layer compute amplitude component converted components electric magnetic field transformed real space grid references whittaker culshaw scatteringmatrix treatment patterned multilayer photonic structures phys rev b marco liscidini dario gerace lucio claudio andreani sipe scatteringmatrix analysis periodically patterned multilayers asymmetric unit cells birefringent mediaphys rev b raymond rumpf improved formulation scattering matrices semianalytical methods thatis consistent convention progress electromagnetics research b