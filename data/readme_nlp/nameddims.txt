nameddims nameddimsarray zerocost abstraction add names dimensions array core functionality nda nameddimsarray rand indexing nda nda nda functions taking dims keyword sumnda dims sumnda dims accessing names dimnamesnda returns tuple dimension names identifying dimension name dimnda returns numerical dimension named similarly dimnda returns unwrapping parentnda returns underlying abstractarray wrapped nameddimsarray unnaming unname ensures abstractarray nameddimsarray passed nameddimsarray unwraps otherwise returns abstractarray renaming renamenda newnames returns nameddimsarray newnames wrapping data refining names nameddimsarraynda names returns nameddimsarray unnamed dimensions nda getting names names errors names disagree dimensionally safe operations operation multiple nameddimarray compatible dimension names example trying nameddimsarraytimeones nameddimsarrayones throw error perform operation abstractarray nameddimsarray result names nameddimsarray bypass protection nameddimsarraytimeones parentnameddimsarrayones allowed partially named dimensions allow arrays dimensions names name treated wildcard dimensions named protected operating dimensions names result name wildcard name operands concrete name example nameddimsarraytimeones nameddimsarray ones allowed result nameddimsarraytimeones unless wildcard behaviour dimension name terrible dimension name goes package perform matrix multiplication abstractarray nameddimsarray dimensions name wildcard similarly transpose abstractvector dimension named usage writing functions accept nameddimsarray abstractarray common desire able write code call using nameddimsarray able nameddimsarray internally definition getting assertion nameddimsarray passed expected dimensions call nameddimsarray constructor expected names function operation corresponds pytorch refinenames following example function totalvariance data abstractmatrix ndata nameddimsarray data times locations locationvariance var ndata dims times calculate variance location return sum locationvariance dims locations total function matrix apply names ndata function unnamed types data nameddimsarray incompatible names error thrown example data mistakenly transposed dimension names locations times instead times locations data partially named locations name allowed combined named constructor yielding ndata expected names times locations pattern allows assertions correctness named inputs convenience compatibility unnamed input nameddimsarray zerocost abstraction basically compile existence time extending support functions common function support nameddimsarray adding support referring dimension name existing function operation return nameddimsarray array operations fallback dropping names illustrated following example function foo nda nameddimsarray args dims numericaldims dim nda dims convert form dims numerical dims rawresult foo parent nda args dims numericaldims call data newnames determinefoonames nda args workout names return nameddimsarraynewnamesrawresult wrap result functions packages add nameddimsarray support implement functions standard library pr appreciated caveats multiple dimensions names indexing name considered undefined behaviour r