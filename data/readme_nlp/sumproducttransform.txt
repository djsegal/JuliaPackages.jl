sumproducttransform experiment packag experi sumproducttransform network main advantag exact calcul likelihood packag emphasi flexibl mean super fast safe flexibl experiment creat testb paper sum product transform network exploit symmetri use invert transform toma pevni vasek smidl martin trapp ondrej polacek toma oberhub exampl gmm spn sptn pluto notebook exampl pluto packag depend regist packag sumproducttransform experiment implement general sum product network dens node background sum product transform network hierarch model tree structur compos follow node leafnod tractabl probabilisti distribut usual multivari normal distribut sumnod mixtur model compon productnod list sumnod productnod product random variabl assum independ transformationnod implement chang variabl formula pdf transform accord chang variabl theorem chang variabl transformationnod encapsul allow calcul logabsdet flow model prefer implement dens layer squar matric abl effici calcul determin jacobian invert repres svd decomposit udv unitari diagon unitari matric parametr gradient descend friend provid packag toy avail comment exampl gmm spn sptn use toyproblem sumproducttransform unitari flux setfield use toyproblem flower use distributionsad turingmvnorm use sumproducttransform scaleshift svddens flower float npetal creat gaussian mixtur model compon normal distribut leav covari singl sumnod turingmvnorm transform affin distribut svddens mvnormal covari turingdensemvnorm support zygot therefor construct prefer implement normal distribut fanci normal distribut zero diagon scaleshift instead svddens fit model data fit function size ncompon model sumnod transformationnod svddens turingmvnorm ncompon batchsiz nstep histori fit model batchsiz nstep calcul loglikelihood sampl logpdf model sampl model rand model creat simpl sumproductnetwork compon map ncompon sumnod transformationnod scaleshift turingmvnorm ncompon sumnod transformationnod scaleshift turingmvnorm ncompon productnod model sumnod compon fit final creat sumproducttransform network ncompon nlayer model transformationnod scaleshift turingmvnorm nlayer model sumnod transformationnod svddens model ncompon compat flux zygot model compat flux zygot paramet weight sumnod paramet transformationnod hit flux param model gradient logpdf differenti gradient logpdf model fit optim version train function util thread compat bijector svddens scaleshift ludens implement interfac bijector mean caution layer bijector verifi flux param return paramet exampl julia use flux julia use bijector julia flux param planarlay param regist layer flux flux functor planarlay flux param planarlay magic happen allow planarlay sumproducttransform ncompon nlayer model transformationnod planarlay turingmvnorm nlayer model sumnod transformationnod planarlay model ncompon histori fit model