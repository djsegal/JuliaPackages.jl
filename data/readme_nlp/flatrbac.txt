flatrbac flatrbac provides julia implementation level nist model role based access control aims ease process defining enforcing maintaining security policies package embodies essential aspects rbac described model subjectrole assignment permissionrole assignment subjects acquire permissions roles subjectrole assignment review subjects exercise permissions multiple roles adds additional features multiaction multiresource permissions define exert access control domains context package neither active role restrictions hierarchy sessions implemented project status package active development changes occur contributions suggestions questions welcome feature requests bug reports please issue pr table contents installation usage example concept overview permission scope role subject authorisation additional examples installation package installed via package manager pkg add flatrbac installed providing url repository pkg add usage example using flatrbac define subjects thirdparty subject id rdpartysystem define permissions readdatabase permission name readdb resources database actions read list createkey permission createkeyapikeycreate nameresourcesactions create roles grant permissions thirdpartyrole role name rdpartyapi grant thirdpartyrole readdatabase createkey alternatively thirdpartyrole role name rdpartyapi permissions readdatabase createkey grant roles subject grant thirdparty thirdpartyrole check subject authorised isauthorised thirdparty databaseread true isauthorised thirdparty apikeycreate true isauthorised thirdparty databasedelete false concept overview permission permission mechanism authorisation specifying actions subject perform resources permissions defined shorthand form nameresourcesactionsscope julia cruds permissionname admin resources actions create read update delete scopeflatrbac description crud admin permission admin create read update delete crud admin flatrbacnone julia shorthand permission admincreatereadupdatedelete crud admin permission admin create read update delete crud admin flatrbacnone permissions default wildcard values resources actions julia permission permission none permissions positive grant specified actions resource example permission example granted action actions example assert isauthorised example permission action fail permission docs scope scopes allow binding permissions custom domaintenants possession checks permissions default scope none julia permission exampleresourceaction permission example resource action flatrbacnone package provides implementation base scopes flatrbac type scope acts wildcard default grant access scope flatrbac type subtypes useful dealing resource possession conjunction ownershippossession checks application logic flatrbacnone type default scope default grant access none scope package provides default behaviour scope subtypes abstract type myscope flatrbacscope scoped permission exampleresourcereadmyscope permissionexample resource read myscope examples abstract type app myscope abstract type api myscope myscope grants access subtypes isauthorised permission resourcecrudmyscope permission resourcecrudapp scoped true true isauthorised permission resourcecrudmyscope permission resourcecrudapi scoped true true app grant access api isauthorised permission resourcecrudapp permission resourcecrudapi scoped true false app api grant access additional possession checks performed application level isauthorised permission resourcecrudapp permission resourcecrud scoped true true isauthorised permission resourcecrudapi permission resourcecrud scoped true true additional notes performance considerations scope docs role roles define authority level function context usually defined accordance job competency authority responsibility responsability package roles collection permissions assigned subjects allowing perform actions resources roles extend roles perma permission projectsread permission documentsexport rolea role name permissions perma julia permissions rolea element vectorpermission permission projects read none permission documents export none granted edit privileges documents assert isauthorised rolea permission documentsedit permb permission projectsdocumentsreadedit roleb role name permissions permb permc permission apilist rolec role name permissions permc extend permissions julia extend rolea roleb rolec element vectorpermission permission projects readedit none permission documents export none permission documents readedit none permission api list none rolea obtained privilege roleb assert isauthorised rolea permission documentsedit permissions roles revoked role revoke permissions revoke rolea roleb assert isauthorised rolea permission documentsedit example role name example grant example permission readallread element vectorpermission permissionreadallreadnone revoke example permission readallread permission note v revocation performed based permission equality future revocation ensure permission implies permission revoked role docs subject automated agent person relevant third party authorisation enforced role role name example permissions permission sysadmin subject id sysadmin name system admin roles role authorisation process verifying subject allowed access perform specific actions resource flatrbac subjects exercise permissions multiple roles authorisation logic default behaviour pseudocode granteduser permission grantedpermissionssubject permission regardless roles specific permissions satisfy condition authorising specify authorisation granted permission granted single role pseudocode granteduser permission grantedrole permission rolessubject singleroletrue trigger behaviour examples permission based authorisation checks coverage permission projectsapidatabasecreatereadupdate requirement permission databasecreatereadupdate isauthorised coverage requirement true coverage permission projectsapidatabasecreatereaddelete update action removed checking exactly createread update database requirement permission databasecreatereadupdate isauthorised coverage requirement false recommendation wary using complex permissions authorisation checks subject based authorisation checks storeperms permission viewbooksmoviesmusicview permission rentbooksbooksrent permission updatebooksmoviesmusicupdate permission rentrent permission updateupdate permission buybuyview storeroles authors view update resources role author storeperms update storeperms view customers temporarily rent books view buy role customer storeperms rentbooks storeperms buy employees rent update role employee storeperms rent storeperms update john subject id john grant john storeroles customer john customer rent buy books assert isauthorised john booksbuyrent view books movies music assert isauthorised john booksmoviesmusicview using singlerole julia subject id julia employees customers grant julia storeroles employee storeroles customer granted rent resource via employee role assert isauthorised julia moviesmusicfilesrent singlerole true true buy rent music granted via role rent employee role buy customer role assert isauthorised julia musicbuyrent singlerole true usage api isauthorisedsubject permission singlerolefalse scopedtrue kwargsbool additional examples web examples mini web application authorisation middleware using flatrbac using json using http using random import http handlers cookiemiddleware cookiemiddleware setup rbac logic setup rbac roles guest role guest permission view setup subjects const users subject id anonymous roles subject id guest roles guest mockup authentication session management actual production code const cookiename app mockup web session logic sessions dict string httpcookiescookie mockup login guest function mockuplogin req httprequest cookie http cookies cookie cookiename randstring sessions guest cookie respond cookie return http response setcookie http stringify cookie middleware map incoming requests app user session actual production code check request cookies matching session function sessionmiddleware handler return function req httprequest uname anonymous default anonymous cookiejar http handlers cookies req match findfirst name cookiename cookiejar isnothing match appcookie cookiejarmatch user filter kv kv value appcookie value sessions isempty user session unknown user return http response unauthorized uname user set user pass request req context user users findfirst id uname users return handler req middleware authorise access app resources function authorisation handler return function req httprequest user req context user resource string req context params resource check user granted view access resource flatrbac isauthorised user permission resource view return http response unauthorized req context subject user req context resource string resource return handler req mockup resource handler function handler req httprequest uname req context subject name resource req context resource return http response welcome uname access resource setup http server router http router http response http response http register router apiresource authorisation handler http register router post login mockuplogin empty http cookiejar servermiddleware router cookiemiddleware sessionmiddleware server http serve servermiddleware check anonymous view book resources info http statusexception false info httpmessagesresponse http unauthorized transferencoding chunked unauthorized authenticate guest info http post cookies true statusexception false info httpmessagesresponse http ok setcookie apprandstring transferencoding chunked guest view books info http cookiejar http cookiejar statusexception false info httpmessagesresponse http ok transferencoding chunked welcome guest access books close server http close serv