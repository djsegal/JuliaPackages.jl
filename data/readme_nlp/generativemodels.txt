generativemodel librari contain collect generat model trainabl conditionaldist conjuct flux model probabl measur diverg defin ipmeasur packag aim experi model easi exampl check build convent variat autoencod vae reconstruct mnist reconstruct mnist load mnist train dataset use mldataset flux train mnist traindata float flat reshap train size train gpu data flux data dataload flat batchsiz shuffl true defin paramet vae input length xlength latent vector zlength use conditionaldist xlength size flat zlength hdim int hdim defin encod diagon varianc latent dimens flux model wrap conditionalmvnorm flux model return tupl appropri paramet mvnormal mean varianc henc splitlay return vector zlength varianc constrain posit use conditionaldist splitlay map train output mean varianc enc map chain dens xlength hdim relu dens hdim relu splitlay zlength zlength ident softplus condit encod call rand encod conditionaldist encod conditionalmvnorm enc map decod return multivari normal scalar varianc dec map chain dens zlength relu dens hdim relu splitlay hdim xlength decod conditionalmvnorm dec map creat vae model train maxim elbo use generativemodel model vae zlength encod decod gpu loss elbo model flux param model opt adam info epoch loss flat flux train loss data opt test reconstruct correspond latent space shown model model cpu test test mnist testdata float plot reconstruct model test