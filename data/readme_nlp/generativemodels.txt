generativemodelsjl library contains collection generative models trainable conditionaldistsjl conjuction fluxjl models probability measures kl divergence defined ipmeasuresjl package aims experimenting models easy example check build conventional variational autoencoder vae reconstructs mnist reconstructing mnist load mnist training dataset using mldatasets flux trainx mnist traindata float flatx reshape trainx size trainx gpu data flux data dataloader flatx batchsize shuffle true define parameters vae input length xlength latent vector zlength using conditionaldists xlength size flatx zlength hdim hd int hdim define encoder diagonal variance latent dimension flux model wrapped conditionalmvnormal flux model return tuple appropriate parameters mvnormal mean variance hence splitlayer returns vectors zlength variance constrained positive using conditionaldists splitlayer mapping trained output mean variance encmap chain dense xlength hdim relu dense hdim hd relu splitlayer hd zlengthzlength identitysoftplus conditional encoder called randencoder conditionaldistsjl encoder conditionalmvnormal encmap decoder return multivariate normal scalar variance decmap chain dense zlength hd relu dense hd hdim relu splitlayer hdim xlength decoder conditionalmvnormal decmap create vae model train maximize elbo using generativemodels model vae zlength encoder decoder gpu loss elbo model ps flux params model opt adam info epoch loss flatx flux train loss ps data opt test reconstructions corresponding latent space shown model model cpu testx testy mnist testdata float p plotreconstructions model testx