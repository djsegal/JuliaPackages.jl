parallelstencil parallelstencil empow domain scientist write architectur agnost level code parallel perform stencil comput gpus cpus perform similar cuda achiev typic improv perform reach use cuda array program exampl shallow ice solver juliacon achiev near time perform correspond cuda array program implement absolut term reach theoret upper perform bound nvidia gpu defin effect throughput metric eff note eff common throughput metric section perform metric gpu perform solver report green cpu perform blue parallelstencil reli nativ kernel program capabl cuda base thread perform comput gpus cpus respect seamless interoper implicitglobalgrid render distribut parallel stencil base gpu cpu applic regular stagger grid trivial enabl close ideal weak scale real world applic thousand gpus moreov parallelstencil enabl hide communic comput simpl macro call particular restrict packag communic parallelstencil design conjunct implicitglobalgrid simplest usag domain scientist render fast interact develop massiv scalabl perform multi gpu applic readili access furthermor develop self contain approach solv nonlinear multi physic gpu supercomput julia reli parallelstencil implicitglobalgrid parallelstencil featur hide communic comput showcas close ideal weak scale demonstr poro hydro mechan real world applic gpus piz daint supercomput particular parallelstencil enabl write singl level julia code deploy cpu gpu conjuct implicitglobalgrid julia code run singl cpu thread thousand gpus cpus content parallel macro call stencil comput math close notat line exampl deploy gpu cpu line multi xpu exampl seamless interoper communic packag hide communic modul document callabl julia repl ijulia concis singl multi xpu miniapp depend instal question comment discuss refer parallel macro call simpl call parallel parallel function launch packag underneath parallel defin call init parallel stencil beforehand support cuda run gpu base thread cpu follow exampl outlin run parallel comput gpu use nativ kernel program capabl cuda underneath omit line repres omit argument init parallel stencil cuda parallel function diffus step parallel diffus step note array automat alloc hardwar chosen comput gpu cpu use provid alloc macro zero one rand stencil comput math close notat parallelstencil provid submodul comput finit differ math close notat finitediffer finitediffer finitediffer custom macro extend finit differ submodul stencil base numer method readili plug follow exampl complet function comput time step heat diffus solver use finitediffer use parallelstencil finitediffer parallel function diffus step lam inn inn lam inn return macro exampl describ modul document callabl julia repl ijulia julia use parallelstencil finitediffer julia help inn inn select inner element correspond help comput differ adjac element dimens select inner element remain dimens correspond inn note perform analogu oper dimens respect type finitediffer julia repl explor provid macro line exampl deploy gpu cpu concis heat diffus solver parallelstencil simpl boolean gpu defin run gpu cpu environ variabl julia num thread defin core latter const gpu true use parallelstencil use parallelstencil finitediffer static gpu init parallel stencil cuda float els init parallel stencil thread float parallel function diffus step lam inn inn lam inn return function diffus physic lam thermal conduct min minim heat capac length domain dimens numer gridpoint dimens time step space step dimens space step dimens space step dimens array initi zero zero zero initi condit heat capac temperatur gaussian anomali min data array exp exp size size size data array exp exp size size size assign correct boundari condit time loop min min lam time step heat diffus parallel diffus step lam diffus correspond file found line multi xpu exampl concis multi xpu heat diffus solver parallelstencil conjunct implicitglobalgrid readili deploy singl cpu thread thousand gpus cpus simpl boolean gpu defin run gpu cpu julia num thread defin core latter solver run process implicitglobalgrid creat automat implicit global comput grid base process solver run base process topolog explicit chosen user automat determin pleas refer document implicitglobalgrid inform const gpu true use implicitglobalgrid import mpi use parallelstencil use parallelstencil finitediffer static gpu init parallel stencil cuda float els init parallel stencil thread float parallel function diffus step lam inn inn lam inn return function diffus physic lam thermal conduct min minim heat capac length domain dimens numer gridpoint dimens time step init global grid space step dimens space step dimens space step dimens array initi zero zero zero initi condit heat capac temperatur gaussian anomali min data array exp exp size size size data array exp exp size size size assign correct boundari condit time loop min min lam time step heat diffus parallel diffus step lam updat halo final global grid diffus correspond file found thank implicitglobalgrid function call ad previous singl gpu cpu solver multi xpu solver omit unmodifi line repres use implicitglobalgrid function diffus physic numer init global grid space step dimens space step dimens space step dimens array initi initi condit heat capac temperatur gaussian anomali min data array exp exp size size size data array exp exp size size size time loop updat halo final global grid diffus result movi run applic gpus solv heat diffus heterogen heat capac gaussian anomali global comput grid size grid dimens plane middl dimens correspond file found seamless interoper communic packag hide communic previous multi xpu exampl parallelstencil seamless interoper implicitglobalgrid priori true communic packag allow explicit decid requir communic occur exampl mpi besid mpi seamless interoper implicitglobalgrid extend function moreov parallelstencil enabl hide communic comput simpl call hide communic follow exampl communic perform updat halo packag implicitglobalgrid hidden comput parallel diffus step hide communic begin parallel diffus step lam updat halo enabl close ideal weak scale real world applic thousand gpus cpus type hide communic julia repl obtain explan argument profil viscous stoke flow applic use nvidia visual profil nvvp graphic exemplifi updat veloc kernel split boundari inner domain comput latter overlap mpi communic halo exchang modul document callabl julia repl ijulia modul document call julia repl ijulia julia use parallelstencil julia help parallelstencil search parallelstencil init parallel stencil modul parallelstencil enabl domain scientist write level code parallel perform stencil comput deploy gpus cpus overview exampl macro function init parallel stencil parallel hide communic zero one rand advanc parallel indic parallel async synchron submodul parallelstencil finitediffer parallelstencil finitediffer parallelstencil finitediffer modul generat caller data descript function macro modul type functionnam macronam includ modulenam respect concis singl multi xpu miniapp miniapp regroup collect various code leverag parallelstencil implement architectur agnost level code parallel perform stencil comput gpus cpus miniapp target various challeng domain scienc studi multi physic coupl nonlinear challeng exist solv strategi pseudo transient relax deliv implicit solut differenti equat miniapp featur multi xpu version combin capabl parallelstencil implicitglobalgrid enabl multi gpu multi cpu execut unleash julia scale perform metric core processor gpus throughput orient system massiv parallel hide latenc scientif applic algorithm requir oper flop compar amount byte access main memori signific memori bound flop metric adequ report applic perform modern applic status motiv develop memori throughput base perform evalu metric eff evalu perform iter stencil base solver effect memori access eff sum twice memori footprint unknown field field depend histori updat iter field chang time effect memori access divid execut time iter sec defin effect memori throughput eff upper bound eff peak measur cpus gpu analogu defin eff metric assum evalu iter stencil base solver size larger cach size usag time block feasibl advantag reason assumpt real world applic concept includ field effect memori access depend histori flux field comput fli store chip defin theoret upper bound eff closer real upper bound progress use simpl array broadcast capabl gpu cpu array julia enabl close optim perform parallelstencil permit overcom limit top figur similar eas program miniapp content thermo mechan convect app viscous stoke app viscous stoke app acoust wave app acoust wave app scalar poros wave app hydro mechan poros wave app stay tune miniapp code follow similar structur permit serial thread cpu nvidia gpu execut line miniapp code permit enabl cuda gpu backend set gpu flag true miniapp interact execut julia repl includ multi xpu version use singl cpu gpu note optim perform miniapp script miniapp code launch shell use project depend project disabl array bound check check bound use optim level julia project check bound miniapp code note refer document supercomput centr instruct run julia scale instruct run piz daint gpu supercomput swiss nation supercomput centr found run octopus gpu supercomput swiss geocomput centr found thermo mechan convect app app thermalconvect thermal convect exampl combin viscous stoke flow advect diffus heat includ temperatur depend shear viscos miniapp resolv thermal convect cell earth mantl convect plume gif depict dimension temperatur field evolv convect cell plume result obtain run miniapp thermalconvect viscous stoke app app stoke viscous stoke flow exampl solv incompress stoke equat linear shear rheolog model configur repres buoyant inclus buoyant matrix figur depict upper panel dynam pressur field vertic veloc lower pannel log vertic momentum balanc residu log error norm evolut function pseudo transient iter result obtain run miniapp stoke viscous stoke app app stoke stoke multixpu viscous stoke flow exampl solv incompress stoke equat linear shear rheolog model configur repres buoyant spheric inclus buoyant matrix figur depict vertic slice cross section upper panel dynam pressur field vertic veloc lower panel log vertic momentum balanc residu log error norm evolut function pseudo transient iter numer resolut grid gpus local domain size gpu stoke stoke multixpu singl multi xpu implement respect multi xpu implement demonstr parallelstencil capabl hide comput communic perform implicitglobalgrid result obtain run multi xpu miniapp stoke multixpu nvidia titan gpus distribut physic distinct comput node multi xpu applic permit leverag distribut memori parallelis enabl scale calcul acoust wave app app acoust acoust wave exampl solv acoust wave use split veloc pressur formul anim depict dynam pressur field evolut function explicit time step result obtain run miniapp acoust acoust wave app app acoust acoust multixpu acoust wave exampl solv acoust wave use split veloc pressur formul anim depict slice dynam pressur field evolut function explicit time step achiev numer resolut grid gpus local domain size gpu acoust acoust multixpu singl multi xpu implement respect multi xpu implement demonstr parallelstencil capabl hide comput communic perform implicitglobalgrid result obtain run multi xpu miniapp acoust multixpu nvidia titan gpus distribut physic distinct comput node multi xpu applic permit leverag distribut memori parallelis enabl scale calcul scalar poros wave app app scalar porowav scalar poros wave exampl solv scalar solitari wave equat assum total pressur lithostat elimin solv total pressur explicit anim depict normalis poros effect pressur field evolut function explicit time step top row compact decompact rheolog ident result circular solitari wave rearrang soliton characterist size bottom row decompact occur faster rate compar compact result chimney shape featur hydro mechan poros wave app app hydromech hydro mechan poros wave exampl resolv solitari wave owe hydro mechan coupl remov lithostat pressur assumpt total fluid pressur explicit comput nonlinear stoke darci flow solver respect anim depict format fluid escap pipe phase media owe decompact weaken run miniapp hydromech top row evolut poros distribut effect pressur bottom row darci flux relat fluid solid motion solid porous matrix deform depend parallelstencil reli julia cuda packag cuda macrotool instal parallelstencil instal direct julia packag manag repl julia pkg add parallelstencil pkg test parallelstencil question comment discuss discuss technic issu pleas post julia discours gpu topic julia scale topic gpu distribut channel julia slack join visit discuss numer domain scienc issu pleas post julia discours numer topic model simul topic whichev topic fit issu refer omlin kwasniewski malvoisin podladchikov solv nonlinear multi physic gpu supercomput julia juliacon confer virtual reuber omlin multi physic invers gpu supercomput julia juliacon confer virtual omlin podladchikov port massiv parallel multi gpu applic julia nonlinear multi physic flow solver juliacon confer baltimor usa omlin podladchikov nonlinear multi physic solver cuda mpi julia pasc confer zurich switzerland besard foket sutter effect extens program unleash julia gpus ieee transact parallel distribut system doi tpds besard churavi edelman sutter rapid softwar prototyp heterogen distribut platform advanc engin softwar doi advengsoft mccalpin memori bandwidth machin balanc current perform comput ieee comput societi technic committe comput architectur tcca newslett decemb duretz podladchikov resolv hydromechan coupl dimens spontan channel porous fluid owe compact weaken geophys journal intern ggz