lowrankmodelsjl lowrankmodelsjl julia package modeling fitting generalized low rank models glrms glrms model data array low rank matrix include models data analysis principal components analysis pca matrix completion robust pca nonnegative matrix factorization means information glrms paper python interface package glrm implementation ho machine learning platform interfaces variety languages lowrankmodelsjl makes easy mix match loss functions regularizers construct model suitable particular data set particular supports using loss functions columns data array useful data types heterogeneous real boolean ordinal columns fitting model entries table useful data tables missing unobserved entries adding offsets scalings model destroying sparsity useful data poorly scaled installation install call pkg add lowrankmodels julia prompt generalized low rank models glrms form low rank model tabular data rows columns input array array object example data frame fine entries observed missing glrm fit ismissing entries desired model specified choosing rank model array loss functions losses regularizers rx ry data modeled matrix matrix found solving optimization minimize sum obs losses sumi rx sumj ry basic type lowrankmodelsjl glrm form glrm user specifies data abstractarray array sparse matrix data frame array loss functions losses regularizers rx ry rank user specify observed entries obs starting matrices x y obs list tuples indices observed entries matrix omitted entries matrix observed sparse matrix implicit zeros interpreted missing entries default discussion sparse matrices details x y initialization matrices represent starting guess optimization losses regularizers type loss regularizer respectively chosen list supported losses regularizers include losses quadratic loss quadloss hinge loss hingeloss logistic loss logisticloss poisson loss poissonloss weighted hinge loss weightedhingeloss l loss lloss ordinal hinge loss ordinalhingeloss periodic loss periodicloss multinomial categorical loss multinomialloss multinomial ordinal aka logit loss orderedmultinomialloss biggervs loss bvsloss ordinal data vs loss ovaloss categorical data constructors ordinal categorical losses argument maximum minimum maximum value variable using vs loss equivalent transforming categorical value hot vector using binary loss entry vector using biggervs loss equivalent transforming ordinal value boolean vector using binary loss entry vector default binary loss logistic loss regularizers quadratic regularization quadreg constrained squared euclidean norm quadconstraint l regularization onereg regularization zeroreg nonnegative constraint nonnegconstraint nonnegative matrix factorization sparse constraint onesparseconstraint orthogonal nnmf unit sparse constraint unitonesparseconstraint means simplex constraint simplexconstraint l regularization combined nonnegative constraint nonnegonereg fix features values y fixedlatentfeaturesconstrainty losses regularizers scaled example increase importance loss relative regularizer calling mulloss newscale users implement losses regularizers adjust internal parameters losses regularizers lossesjl regularizersjl details example example following code forms means model matrix using lowrankmodels losses quadloss minimize squared distance cluster centroids rx unitonesparseconstraint row assigned exactly cluster ry zeroreg regularization cluster centroids glrm glrm losses rx ry fit model call ch fit glrm runs alternating directions proximal gradient method glrm minimizing objective function ch convergence history technical details information losses argument array loss functions column example data set columns losses loss quadloss logisticloss hingeloss similiarly ry argument array regularizers column example data set columns ry regularizer quadreg quadreg fixedlatentfeaturesconstraint regularizes columns constrains third column equal examples missing data entries data table tell glrm observations fit model listing tuples indices obs obs exactly entries observed initialize model using glrm losses rx ry obs obs dataframe model ignore entry missing obs observations standard low rank models low rank models easily fit standard models pca means nonnegative matrix factorization following functions available pca principal components analysis qpca quadratically regularized principal components analysis rpca robust principal components analysis nnmf nonnegative matrix factorization means means code usage keyword argument valid glrm object initial value list observations standard low rank models scaling offsets choose lowrankmodelsjl add offset model scale loss functions regularizers columns pull model simply call glrm glrm losses rx ry offset true scale true transformation generalizes standardization common preprocessing technique applied pca offsets scaling code paper add offsets scalings previously unscaled models add offset model applying regularization row matrix enforcing column s using addoffset glrm scale loss functions regularizers calling equilibratevariance glrm scale columns associated quadloss huberloss loss functions probscale glrm fitting dataframes sounds happen dataframe df lying low rank model example import rdatasets df rdatasets dataset psych msq fear call glrm labels glrm df ch fit glrm fit glrm rank data using quadloss loss real valued columns hingeloss loss boolean columns ordinal hingeloss loss integer columns amount quadloss regularization scaling adding offset model described returns column labels columns fit model data types ignored nan values treated missing values missing ignored fit call signature function glrm df dataframe int losses loss rx quadreg ry quadreg offset true scale false probscale true nanstonas true modify losses regularizers offsets scaling using keyword arguments specify map data types losses define lossmap datatypes losses probabilisticlosses probabilisticlosses dict symbol real quadloss bool logisticloss ord multinomialordinalloss cat multinomialloss input array datatypes column data frame glrm datatypes lossmap lossmap call signature function glrm df dataframe int datatypes arraysymbol lossmap probabilisticlosses rx quadreg ry quadreg offset true scale false probscale true transformdatatonumbers true nanstonas true modify losses regularizers offsets scaling using keyword arguments fit data frame categorical values function expandcategoricals categorical columns boolean column level categorical variable example expandcategoricalsdf gender replace gender column column corresponding gendermale column corresponding genderfemale columns corresponding labels outside gender binary appear data set model intuition data set example try plotting columns labels similar features close fitting sparse matrices sparsely observed dataset encode data sparse matrix default lowrankmodels interprets sparse entries sparse matrix missing entries na values pass indices observed entries obs automatically glrmsparsematrixcsc called addition calling fitglrm glrm sparse matrix sparse variant proximal gradient descent algorithm fitglrm sparseproxgradparams kwargs instead interpret sparse entries zeros missing na entries glrm glrm sparsena false dataset dense terms observations sparse terms nonzero values sense fit model vanilla proximal gradient descent algorithm fitglrm proxgradparams kwargs parallel fitting experimental lowrankmodels makes julia v multithreading functionality fit models parallel fit lowrankmodel parallel using multithreading simply set threads command line starting julia export julianumthreads technical details optimization function fit alternating directions proximal gradient method minimize objective method guaranteed converge optimum local minimum code converging converging model dislike parameters tweak warm start algorithm starts glrm glrm initial estimates explicitly initialized randomly guess model try setting explicitly re getting stuck local minimum try reinitializing glrm construct initial random model obtain improves function fit sets fields glrm glrm fitting model particularly useful model generate warm start iterations prefer preserve original glrm glrm cross validation call function fit mutate arguments start easyoptimize loss function run fit change loss function glrmlosses newlosses warm start calling fit fit loss functions initialization guess warm start model try initializations provided lowrankmodels initsvd initializes model truncated svd matrix observed entries unobserved entries filled zeros initialization result provably solutions pca paper details initkmeanspp initializes model using modification kmeans algorithm data sets missing entries paper details fitting clustering models help achieving fits nonnegative matrix factorization initnndsvd initializes model using modification nndsvd algorithm implemented nmf package modification handles data sets missing entries replacing missing entries zeros optionally setting argument maxiters iteratively replace missing entries values imputed nndsvd call nndsvd matrix procedure similar soft impute method mazumder hastie tibshirani matrix completion parameters mentioned earlier lowrankmodels alternating proximal gradient descent derive estimates slightly procedures compute reconstruction compute gradient objective function compute model estimate entries observed method preferred missing entries hardware level optimizations chunking operations fit various caches method preferred missing entries fit dense method fit glrm proxgradparams kwargs fit sparse method fit glrm sparseproxgradparams kwargs method default glrm standard matrixarray method default glrm sparsematrixcsc proxgradparams sparseproxgradparams run respective methods default parameters stepsize step size controls speed convergence step sizes slow convergence ones cause divergence stepsize abstol algorithm stops decrease objective iteration abstollengthobs reltol algorithm stops decrease objective iteration reltol maxiter algorithm stops maximum rounds maxiter reached minstepsize algorithm stops stepsize decreases limit inneriter specifies proximal gradient steps moving vice versa default parameters proxgradparamsstepsizemaxiterinneriterabstolreltolminstepsizestepsize convergence ch convergence history success optimization monitored chobjective stores objective values chtimes captures times objective values achieved try plotting increase maxiter converge model imputation fitting glrm impute values imputeglrm maximum likelihood estimates entry imputemissingglrm imputes missing entries leaves observed entries unchanged sampleglrm draw posterior distribution conditioned fit values entry samplemissingglrm samples missing entries leaves observed entries unchanged cross validation useful functions available help check low rank model overfits test data set functions help choose adequate regularization model cross validation crossvalidateglrmglrm nfolds paramsparams verbosefalse usefoldsnone errorfnobjective initnone performs fold cross validation returns average loss folds specifically splits observations glrm nfolds builds glrms observations left fits glrm training set observations revealed glrm returns average loss test sets observations left glrm optional arguments usefolds build usefolds glrms instead nfolds glrms nfolds entries left usefolds defaults nfolds errorfn custom error function evaluate fit objective example imputation error setting errorfn errormetric init initialize fit using particular procedure example consider initinitsvd initialization options cvbyiterglrmglrm holdoutproportion paramsparams niters verbosetrue computes test error train error glrm trained splits observations training set holdoutproportion original observations test set holdoutproportion original observations performs paramsmaxiter iterations fitting algorithm training set niters times returns test train error function iteration regularization paths regularizationpathglrmglrm paramsparams regparamsexprangestoplength holdoutproportion verbosetrue chconvergencehistoryconvergencehistoryregpath computes train test error glrms varying scaling regularization scaling factor array regparams utilities gettrainandtestobs holdoutproportion splits observations obs train test set maximal value elements tuples observations respectively returns observedfeatures observedexamples train test sets scikitlearn library implements scikitlearnjl interface models available skglrm pca qpca nnmf kmeans rpca docstrings information qpca models support scikitlearnbasefit scikitlearnbasetransform interface examples apply pca iris dataset using lowrankmodels import scikitlearnbase using rdatasets require pkgaddrdatasets convert matrix dataset datasets iris sepallength sepalwidth petallength petalwidth scikitlearnbase fittransform pca maxiter fit means fake dataset gaussians using lowrankmodels import scikitlearnbase generate disjoint gaussians gaussian randn gaussian randn merge single dataset vcat gaussian gaussian model scikitlearnbase fit lowrankmodels kmeans count assigned gaussians set sum scikitlearnbase transform model notebook demonstrating means models inside scikitlearn pipeline hyperparameter tuned gridsearchcv citing package lowrankmodels published encourage cite software following bibtex citation article glrm title generalized low rank models author madeleine udell horn corinne zadeh reza boyd stephen doi archiveprefix arxiv eprint primaryclass statml journal foundations trends machine learning volume issn url