ellzerotrendfilt packag solv piecewis linear continu approxim subject hard limit regular penalti break exact solut obtain use dynam program piecewis quadrat function avoid combinatori complex naiv approach mathemat descript piecewis linear continu function segment set breakpoint valu function breakpoint formul constrain segment regulart solv discret set use fit pwl constrain fit pwl regular result function satisfi function fit pwl constrain fit pwl regular set breakpoint result function satisfi exampl constrain approxim continou piecewis approxim segment use ellzerotrendfilt plot sampl data data snp data solut constrain segment ivec yvec fvec fit pwl constrain data plot origin data plot data black lab snp plot solut segment plot ivec yvec circl lab cost round fvec plot solut segment plot ivec yvec circl lab cost round fvec exampl regular continou piecewis approxim cost breakpoint use ellzerotrendfilt plot sin sin sin rang stop length plot black lab sin sin sin minim automat integr function comput cost cost fit pwl regular plot circl lab norm round cost zeta plot plot