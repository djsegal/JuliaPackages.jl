sugarkelpjl implementation broch slagstad model growth composition saccharina latissima kelp main solve single frond sugarkelpsolve grids solved sugarkelpsolvegrid changes stated parameter values paper detailed changespdf package available registry installed import pkgpkgaddsugarkelp alternatively install repo slightly updated import pkgpkgadd examples running model examples running model single grid found examplesipynb example single using sugarkelp plots interpolations pyplot set initial conditions parameters ti start day days january date reference forcing data nd days run lat latitude effects change day length anc initial nitrogen reserve carbon reserve ti nd lat a n c setting forcing variables normally loaded data set generated time day corresponding forcing data days january arbitrary float integer ode solving library fails temp temperature degrees no nitrate concentration mmolm irr par irradiance mol photonsmday water velocity time temp cos time pi no cos time pi irr sin time pi repeat plot layout grid size legend false plot timetempylabel temp sp plot timenoxlabel day ylabel nitrate concentration mmolm sp plot timeirrylabel par mol photonsmday sp forcing variables converted interpolations kelp model access arbitrary time tempitp interpolations linearinterpolation timetemp noitp interpolations linearinterpolation timeno irritp interpolations linearinterpolation timeirr uitp interpolations linearinterpolation time model run parameter passed namedtuple run respiration model proposed broch solution results sugarkelp solve ti nd uitp tempitp irritp noitp lat a n c sugarkelp brochparams solutions contains raw output ode solver results refactored dataframe optionally array returned results dataframe table rendered useful convert results total carbon nitrogen masses reserves model returns requires parameters totalcarbon results sugarkelp brochparams ka results carbon sugarkelp brochparams cstruct totalnitrogen results sugarkelp brochparams ka results nitrogen sugarkelp brochparams nstruct plot layout grid size legend false plot results timeresults ylabel dm sp plot results timetotalcarbonxlabel day ylabel total carbon gc sp plot results timetotalnitrogenylabel total nitrogen gn sp example grid grid set initial conditions single ti nd a n c time generate d grid input data temp no d nitrate additional variable generated d diffuse attenuation coefficient d light attenuation example latter usually loaded file beneficial define constants drastically speeds larger grids const arrlon const arrlat const arrdep const arrt const arrtemp permutedims repeat cos arrt pi length arrlon length arrlat length arrdep permutedims repeat arrlat arrlat length arrlon length arrdep length arrt const arrno permutedims repeat cos arrt pi length arrlon length arrlat length arrdep repeat arrlon arrlon length arrlat length arrdep length arrt const arrirr permutedims repeat sin arrt pi length arrlon length arrlat permutedims repeat arrlat arrlat length arrlon length arrt const arrbeta permutedims repeat reverse length arrdep length arrlon length arrlat length arrt const arru permutedims repeat length arrt length arrlon length arrlat length arrdep grids directly fed grid solver returns array irr time provided satellite products temporal resolution models additionally fill value nan provided temporally sparse filtered function automatically parallelised threads start julia time results sugarkelp solvegrid ti nd a n c arrlon arrlat arrdep arrt arrno arrtemp arru arrirr arrt nan arrbeta sugarkelp brochparams output array nitrogen reservecarbon reservenitrate uptake dimension lonlatdeptime extract total carbon nitrogen totalcarbon results ka results cstruct totalnitrogen results ka results nstruct plot couple comparison plot layout grid size resultstime nd rand length arrlon rand length arrlat rand length arrdep plot resultstimeresults sp label arrlat arrlon arrdep plot resultstimetotalcarbonsp plot resultstimetotalnitrogensp plot ylabel dm sp legend bottomright plot sp xlabel day ylabel total carbon gc legend false plot sp ylabel total nitrogen gn legend false plot heatmap surfaces hms heatmap arrlonarrlattotalcarbon color cgrad bamako rev true colorbartitle total carbon gc heatmap arrlonarrlattotalnitrogen color lajolla colorbartitle total nitrogen gn heatmap arrlonarrlattotalcarbon totalnitrogen color cgrad lapaz rev true colorbartitle carbonnitrogen ratio plot hms layout grid size documentation documentation found