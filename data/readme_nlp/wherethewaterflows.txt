wherethewaterflows package allows calculate water flow paths digital elevation models dems package implements d flow routing algorithm basinfilling algorithm implementation recursive algorithm similar due recursion run stackoverflow error dems code reasonably fast flow routing dem antarctica e x depressions takes s laptop ryzen u example upslope calculated example manual using wherethewaterflows pyplot const wwf wherethewaterflows synthtic dem maxs mins function peaks randfac coords range pi pi length return coords coords sin coords cos coords sin coords cos coords randfac randn dem peaks slen dir nout nin pits bnds waterflows dem logupslope pits sinks wwf plotarea pits logupslope contours dem wwf plotareadem dem pits catchments figure wwf heatmap single catchment choose catchment findmax cc catchment dir cartesianindex wwf heatmap cc plot ms stream length figure wwf heatmap slen demf filldem dem pits dir lakedepth figure wwf heatmap demf dem postprocessing following function docs details catchment determine catchment set catchments determine catchment sink defined set catchmentflux total flux source particular catchment prunecatchments remove catchments size filldem fill depressions dem references callaghan mark extraction drainage networks digital elevation data comput vision graph download via google scholar extraction drainage networks digital elevation data braun willett efficient implicit parallel method solve stream power equation governing fluvial incision landscape evolution panel doi