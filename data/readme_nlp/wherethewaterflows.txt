wherethewaterflow packag implement flow rout algorithm basin fill algorithm allow calcul water pathway digit elev model dem littl effort fast memori effici algorithm grid provid pit constant map pit run laptop exampl upslop calcul exampl manual use wherethewaterflow pyplot const wwf wherethewaterflow synthtic dem max min function peak randfac coord rang length return coord coord sin coord cos coord sin coord cos coord randfac randn dem peak slen dir nout nin pit bnds waterflow dem log upslop pit sink plotarea pit log upslop contour dem plotarea dem dem pit catchment figur wwf heatmap stream length figur wwf heatmap slen demf fill dem dem pit dir lake depth figur wwf heatmap demf dem refer callaghan mark extract drainag network digit elev data comput vision graph pay wall