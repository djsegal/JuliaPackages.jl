gentracekerneldsljl package provides dsl constructing trace kernels stochastic maps traces gen generative functions generalized metropolishastings proposal distributions sequential monte carlo specifically trace kernels define type sequential monte carlo algorithm called smcp algorithm package viewed refactoring gen trace translator functionality described marco cusumanotowner thesis arxiv preprint automating involutive mcmc using probabilistic differentiable programming unlike gen trace transform dsl package enforce separation probablistic differentiable components trace translator users freely mix sampling deterministic transformations describe arbitrary stochastic transformations dsl kernel function declared using kernel macro kernel body contain deterministic julia code expressions familiar gen distargs samples gen distribution address genfnargs samples gen generative function address evaluates trace function return value kernelfnargs calls kernel defined function address evaluates return value gen shortened generative function kernel calls syntax splice choices top level caller choicemap kernels intended mh proposals accept current trace argument return tuple choicemap proposed values update trace choicemap specifying reverse move kernels inteded smc proposals written pairs forward backward kernel forward backward kernel accept previous subsequent model trace argument return tuple containing choicemap specifying proposed previous model choicemap backward forward kernel recover previous subsequent model gensmcp details kernel dsl proposals smc interoperation kernel dsl gen particle filtering library example gen example splitmerge proposal looks written dsl kernel function splitmergeproposal trace trace currently means switch mergemean trace m trace m return choicemap false choicemap else currently mean switch uniformcontinuous m m splitmean trace return choicemap true m m m m choicemap kernels passed genmetropolishastingstrace proposal metropolis hastings mcmc gensmcp sequential monte carlo examplejl exampl