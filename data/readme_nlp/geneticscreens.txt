geneticscreens pre postprocessing analysis throughput genetic screens using matrix linear models associated paper matrix linear models throughput chemical genetic screens reproducible code details scores implemented based collins et al geneticscreens extension matrixlm package provides core functions closedform squares estimates matrix linear models installation geneticscreens package installed running using pkg pkgaddgeneticscreens recent version using pkg pkgaddurl revmaster usage using geneticscreens geneticscreens package extends matrixlm functionality matrixlm functions preserved readme matrixlm provides examples usage core squares estimation functions user illustrative example consider simulated data tiny genetic screening experiment run single x plate experimental conditions monotonically dosage concentration levels replicated times mutants replicated times plate note simulated data exported csv files saved directory using dataframes using csv using random generate conditions dosage concentration levels xdosdf repeatdataframecondrepeat inner concrepeat write xdosdf csv csvwritexdosdfcsv xdosdf create dataframe concatenates conditions concentrations xdf repeatdataframecondconcstringxdosdfcond xdosdfconc write xdf csv csvwritexdfcsv xdf generate mutants replicated times zdf dataframemutrepeat write zdf csv csvwritezdfcsv zdf generate mutants replicates include spatial row column positions x plate zspatdf dataframemutrepeat rowrepeat inner colrepeat write zspatdf csv csvwritezspatdfcsv zspatdf contr sum contrasts concatenated conditionconcentrations xdf mutants zdf convert d arrays convertarrayfloat contrxdf condconc sum convertarrayfloat contrzdf mut sum total condition replicates rows size total mutant replicates plate columns size conditions size mutants size randomly generate response variable randomseed rand randn transpose write csv csvwritecsv dataframe readplate function designed simplify construction rawdata object genetic screening data rawdata obtain squares estimates matrix linear models users specify paths flat files experimental conditions row covariates colony sizeresponse mutants column covariates matrices stored readplate read data using csvread additional keyword arguments passed csvread files specified default csvread assumes row header delimiter columns matrix categorical variable experimental conditions readplate convert sum treatment contrasts using contr matrixlm package information contr condition variable name specified using xcvar argument type contrast specified using xctype columns matrix categorical variable mutants analogous argument names zcvar zctype additional variables retained resulting rawdata object example matrix concatenates conditions concentrations thereby creating distinct conditionconcentrations condition concentration treated condition condition concentration default conditionconcentrations mutants coded treatment contrasts coded sum contrasts example dat readplatexdfcsv csv zdfcsv xcvarcondconc xctypesum zcvarmut zctypesum monotonicity reasonable assumption consider concentrations conditions dosage slopes isxdostrue readplate code concentrations xconcentrationvar dosage slopes condition xconditionvar call getdoseslopes function assumes concentrations dosage slopes dat readplatexdosdfcsv csv zdfcsv isxdostrue xconditionvarcond xconcentrationvarconc zcvarmut zctypesum colonies grown edge plate tend larger compete resources try account spatial differences include power crossproduct terms centered row column indices example rows indexed columns indexed x plate desired degree polynomial specified spatdegree names variables store row column indices passed rowvar colvar respectively default spatdegree indicating spatial effects included rowvarrow colvarcolumn example instructed readplate include spatial effects degree polynomial dat readplatexdfcsv csv zspatdfcsv xcvarcondconc xctypesum zcvarmut zctypesum spatdegree rowvarrow colvarcol instead reading directly saved files run readplate dataframes loaded current session arguments convert condition mutant variables contrasts encode dosage slopes incorporate spatial effects remain approach useful user manually preprocess data run contr additional categorical covariates dat readplatexdf dataframe zdf xcvarcondconc xctypesum zcvarmut zctypesum finally readplate provides option standardize subtracting row medians dividing column iqrs user sets isystdtrue seen default isystdfalse standardized dat readplatexdf dataframe zdf xcvarcondconc xctypesum zcvarmut zctypesum isystdtrue mlm function matrixlm computes squares coefficient estimates matrix linear models returns object type mlm mlm objects include variables coefficient estimates coefficient variance estimates varb estimated variance errors sigma coding conditions mutants sum contrasts convenient interpretation main effects interactions respect average colony sizes avoid parameterization condition mutant left contrasts fed model mlmbackestsum extends mlm additionally estimating left sum contrasts conditions mutants default left sum contrasts estimated behavior modified setting isxsum iszsum false mlmbackestsum currently support estimation contrasts additional covariates included mlm mlmbackestsum function estimates row column main effects intercepts behavior suppressed setting isxinterceptfalse isznterceptfalse column weights target type variance shrinkage optionally supplied weights targettype respectively est mlmbackestsumdat note resulting matrix coefficient estimates rows experimental conditions plus row interceptmain effect columns mutants plus column interceptmain effect sizecoefest coef access function extended suppress returning left estimates isxsum iszsum set true matrixlm functions compute fitted values fitted predicted values predict residuals resid likewise extended include options suppressing left estimates example functions raise error user fails set isxsumtrue iszsumtrue fittedest raise dimension error fittedest isxsumtrue iszsumtrue estimates obtained call mlmbackestsum isxsum iszsum set true default output includes left sum contrasts conditions mutants sizecoefest isxsumtrue iszsumtrue matrix statistics defined est sqrtestvarb corresponding mlm object includes x interactions default tstat return corresponding statistics main effects estimated mlmbackestsum returned ismainefftrue sizetstatest analogous matrixlm mlmperms function mlmbackestsumperms computes permutation values include left estimates run permutations parallel illustrative example runs permutations specified argument default function permute shufflerows shuffles rows alternative functions permuting shufflecols passed argument permfun keyword arguments passed mlmbackestsum matrixlm tstat function specified user nperms tstats pvals mlmbackestsumpermsdat nperms geneticscreen package provides implementation collins et al scores run sscore function construct rawdata object encode experimental conditions mutants treatment contrasts intercepts running readplate arguments xctypenoint zctypenoint covariates included dat readplatexdf dataframe zdf xcvarcondconc xctypenoint zcvarmut zctypenoint isystdtrue default sscore function performs variance flooring adjustments described collins et al isvarfloortrue sscoredat analogous matrixlm mlmperms function sscoreperms computes permutation values scores spvals sscorepermsdat nperms additional details found documentation specific functions collins schuldiner krogan weissman strategy extracting analyzing scale quantitative epistatic interaction data genome biology r ledoit wolf improved estimation covariance matrix stock returns application portfolio selection journal empirical fin