xdiff express differenti packag packag uniqu differenti vector valu express einstein notat gradient scalar valu function typici machin learn pleas xgrad instead xgrad stabil version packag ad use featu frequent deriv vector valu function nevertheless continu use xdiff pleas pin espresso version support einstein notat xdiff express differenti packag support symbol approach find tensor deriv unlik automat differenti packag xdiff output readi deriv function symbol express suitabl optim code generat express differenti xdiff take express set exampl valu return express calcul valu deriv output variabl argument exampl valu similar expect data data type size exampl vector size scalar express semicolon exampl valu look expect data xdiff sum rand rand rand quot creat mem zero float creat mem zero float creat mem zero float tmp creat mem tmp zero float dtmp creat mem dtmp zero float tmp sum tmp dtmp tmp dtmp default xdiff generat high optim code set buffer store dictionari mem generat slower readabl express use vectorcodegen ctx dict codegen vectorcodegen xdiff sum ctx ctx rand rand rand quot tmp tmp dtmp tmp einstein index notat use eincodegen ctx dict codegen eincodegen xdiff sum ctx ctx rand rand rand quot tmp tmp dtmp dtmp dtmp tmp function differenti xdiff provid conveni interfac generat function deriv evalu use includ file function sum xdiff rand rand rand rand rand rand note xdiff tri extract function bodi written doesn smooth ommon function bodi isn avail function defin repl experi load function use includ filenam use modul limit loop support condit branch support loop condit oper introduc discontinu potenti result complex heavi piecewis express support express rewritten analyt form exampl loop rewritten aggreg function sum support condit express multipl plan pleas submit issu support specif featur level scalar express differenti follow express pars exgraph set primit express assign singl function call result exgraph evalu use exampl valu determin type shape variabl forward pass similar revers mode automat differenti deriv propag backward output input variabl unlik deriv aren repres valu instead symbol exprssion tensor express exploit similar pipelin act einstein notat tensor express transform einstein notat express einstein notat pars einraph index variant exgraph result eingraph evalu partial deriv comput use tensor element wise rule element tensor propag output input variabl option deriv express convert vector notat