forwarddiff forwarddiff forwarddiffjl chainrulesjl struct arrays warning package progress user api returns lazy representation derivative computes dfdx taking advantage laziness di convenience function materialize derivative gradient jacobian julia using random random seed julia using forwarddiff di using linearalgebra julia sin cos true julia rand julia rand julia prod lazy gradient prod julia prod materialize gradient multiplying adjointfloatsarraytuple float indices soneto soneto julia cumsum jacobian adjointfloatarrayfloat julia cumsum jacobianvector product element arrayfloat julia di di prod hessian sarraytuple float indices soneto soneto julia di di prod hessianvector product element sarraytuple float indices soneto note forwarddiffjl modelingtoolkitjl julia using modelingtoolkit julia variables operationx x x operationv v v julia sin cos x julia prod gradient adjointoperationstaticarrays sarraytuple operation indices soneto soneto conj identity x x identity x x x identity conj identity x x identity x x x julia cumsum jacobian adjointoperationarrayexpression conj conj identity conj identity conj identity conj identity conj identity identity conj identity identity conj identity identity conj identity identity julia cumsum jacobianvector product element arrayint julia cumsum jacobianvector product element arrayoperation v v v v v v julia di di prod hessian staticarrays sarraytuple operation indices soneto soneto conj identity x x identity identity identity x x identity x x identity identity x identity identity identity x identity identity x conj identity x x identity identity identity x x identity x x identity identity x identity identity identity x identity identity x conj identity x x identity identity identity x x identity identity x x identity x identity identity x identity identity identity x conj identity x x identity identity identity x x identity identity x x identity x identity identity x identity identity identity x conj identity x x identity identity x x identity identity x x identity identity x identity identity identity x identity identity identity x conj identity x x identity identity x x identity identity x x identity identity x identity identity identity x identity identity identity x julia di di prod hessianvector product element staticarrays sarraytuple operation indices soneto conj identity x x identity identity identity x x identity x x identity identity x identity identity identity x identity identity x v conj identity x x identity identity x x identity x x identity identity x identity identity identity x identity identity x v conj identity x x identity identity identity x x identity x x identity identity x identity identity identity x identity identity x v conj identity x x identity identity identity x x identity identity x x identity x identity identity x identity identity identity x v conj identity x x identity identity x x identity identity x x identity x identity identity x identity identity identity x v conj identity x x identity identity identity x x identity identity x x identity x identity identity x identity identity identity x v conj identity x x identity identity x x identity identity x x identity identity x identity identity identity x identity identity identity x v conj identity x x identity x x identity identity x x identity identity x identity identity identity x identity identity identity x v conj identity x x identity identity x x identity identity x x identity identity x identity identity identity x identity identity identity x v planned features gpu cpu dual cache userextensible scalar tensor derivative definitions function sparsity exploitation color vector support complex differentiation chainrulesjl plays nicely zygote forwarddiff source code follows yasguid