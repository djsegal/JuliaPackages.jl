fembasi contain interpol routin standard finit element function space ansatz coordin domain interpol function calcul symbol effici code concret exampl generat basi function standard node tetrahedron write code fembasi creat basi tet node quadrat tetrahedr element result code struct tet fembasi abstractbasi base pure function base size type tet return function base size type tet int return return base pure function base length type tet return function fembasi refer element coordin type tet return tensor tensor float function fembasi eval basi type tet vector vec assert length begin return function fembasi eval dbasi type tet vector vec vec assert length begin vec vec vec vec vec vec vec vec vec vec return unusu element defin exampl pyramid element descib ansatz implement defin shape function calculus take care defin partial deriv function code fembasi creat basi pyr node linear pyramid element eval code basi function intern variabl variabl dof basi hierarch basi function nurb common fem calcul calcul jacobian gradient variabl respect coordin exampl calcul displac gradient unit squar write use tensor quad vec vec grad vec result tensor tensor float