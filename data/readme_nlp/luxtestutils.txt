luxtestutilsjl utilities testing luxjl installation add luxtestutils warning testing package hence features weak dependencies reduce load times recommended exclusively package testing add dependency main package projecttoml exported functions testing using jetjl export simple macro jet allow testing code using jet help jet jet args callbroken false optbroken false run jet tests function arguments args jet fails compile julia version macro op keyword arguments callbroken marks testcall broken optbroken marks testopt broken additional arguments forwarded jet testcall jet testopt note instead specifying targetmodules call set preferences targetmodules using preferences jl example set targetmodules lux luxlib run using preferences setpreferences base uuid acdedffbb targetmodules lux luxlib example jet sum targetmodules base core jet sum targetmodules base core optbroken true gradient correctness help testgradients testgradients args kwargs compare gradients computed zygotejl reverse mode ad trackerjl reverse mode ad reversediffjl reverse mode ad forwarddiffjl forward mode ad finitedifferencesjl finite differences tip function completely compatible testjl arguments function test args inputs wrt gradients computed keyword arguments gputesting disables forwarddiff reversediff finitedifferences tests default false softfail true test fail gradients incorrect instead broken default false skiptrackerreversediffforwarddifffinitedifferences skip corresponding gradient computation check default false largearraysskipforwarddifffinitedifferences skip corresponding gradient computation check arrays forward mode finite differences efficient arrays default true largearraylength length array gradient computation considered default maxtotalarraysize treat array total size arrays value default trackerreversediffforwarddifffinitedifferencesbroken mark corresponding gradient test broken default false keyword arguments checkapprox atol absolute tolerance gradient comparisons default rtol relative tolerance gradient comparisons default atol epstypeofatol nans nans considered equal default false example using luxtestutils test randn testset showcase gradient testing begin testgradients sum abs testgradients prod internally checkapprox extends baseisapprox common follows exact function call isapprox passing runtime variables macro macros operate syntax hence directly variable inputs especially using package core package following mark float tests sum function broken using luxtestutils float float float rand eval interpolate runtime variable macro call eval jet sum callbroken float