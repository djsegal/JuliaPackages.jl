advancedprobabilisticcircuitsjl advancedprobabilisticcircuitsjl package probabilistic modelling inference using probabilistic circuits warning package heavy development easily change installation package currently registered install advancedprobabilisticcircuitsjl clone package manually add using julia package manage using pkgaddurl getting started following example illustrates construction probabilistic circuit density estimation using advancedprobabilisticcircuits mldatasets download iris dataset irisdownload iris features create leaf node passing required scope argument normal normal scope create product node specific partition using prod truncatednormal min eps truncatednormal min eps following shorthands partition prod normal partition prod truncatednormal min eps partition create sum nodes product node sum truncatednormal min eps truncatednormal min eps using scope sum normal scope sum prod truncatednormal min eps partition construct simple circuit pc sum prod sum prod truncatednormal min eps prod truncatednormal max prod normal prod normal probabilistic circuit defined circuit amendable form displayed repl truncatednormal min e max inf scope truncatednormal min e max inf scope truncatednormal min inf max scope truncatednormal min inf max scope normal scope normal scope normal scope normal scope normal scope normal scope note colour coding nodes indicate nodes properties evaluate unnormalize log density dataset calling logpdf circuit compute normalized log likelihood using loglikelihood using statistics lp logpdf pc llh model mean loglikelihood model llh pc optimise paramters using zygote follows using zygote ad using progressmeter plots visualisation progress results iters iterations learning rate results values zeros iters showprogress iters grads zygote gradient llh pc update pc grads values llh pc plot values optimization resulting circuit look similar truncatednormal min e max inf scope truncatednormal min e max inf scope truncatednormal min inf max scope truncatednormal min inf max scope normal scope normal scope normal scope normal scope normal scope normal scope adding additional leaf nodes package provides standard leaf nodes normal univariate gaussian truncatednormal truncated univariate gaussian indicator indicator function easily extend set leaf nodes using leaf macro import advancedprobabilisticcircuits support using specialfunctions required logbeta define beta distribution default values leaf beta realinterval define log density function function logpdf beta real namedtuple return params log params logp logbeta params params call leaf beta instead define support manually leaf example note package currently supports univariate leaves beta distribution leaf node probabilistic circuit pc sum beta beta beta normal note additionally define adjoint zygote refer zygote documentation adding additional internal nodes package proved sum product nodes internal nodes easily extended example implement custom internal node follows subtype nodetypes define node type struct customprodnode nodetype define custom node type constructor function cpnode type ns abstractnode real parameters rand length ns internal node parameters optional return advancedprobabilisticcircuits buildnode customprodnode parameters ns define custom log density function logpdf nodecustomprodnode sum logpdf children ref