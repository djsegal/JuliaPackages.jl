sklearn interfac distribut train flux instal use pkg pkg add fluxutil usag use flux fluxutil use fluxutil fit predict sklearn interfac time seri predict defin simpl lstm network model model chain lstm dens gpu sepifi loss function model vector abstractarray length seqsiz loss function seqsiz length seqsiz mse return float seqsiz equival loss seqloss mse spec namedtupl dict custom struct file defin spec epoch batchsiz seqsiz final creat optim opt estim est opt adamw est estim model loss opt spec fit fit estim fit sklearn minibatch log paramet syncron callback handl intern fit creat minibatch sequenc iter batch size unpack batchsiz spec sequenc length unpack seqsiz spec truncat backpropag featur dimens batch dimens time dimens zero float zero float fit est model train predict fill prealloc predict est difficult infer output shape model wihtout run fill similar predict est note type restrict abstractarray tupl abstractarray similar notion multipl input output kera deal time seri add dummi time dimens data input multidimension exampl size reshap dimens reshap definit function mymodel reshap distribut train mpi distribut train achiv mpi coupl line code ad fit intern intercept flux paramet updat step appli allreduc averag gradient diffrent process continu updat synchron paramet broadcast paramet rank rest backpropag start train nvidia gpus built mpi cuda support link templat run mpirun julia use mpi mpi init code load data code defin est fit est code predict mpi final complet exampl locat test mpi deal data data lazili subslic train process memori map read dataset hdf recommend usag function concat hdf util help concaten amount file singl file effici use hdf data fid readmmap fid readmmap fid util function chain lstm dens untrack track object notrack concaten paramet model singl vector net vec copi paramet vec net concaten gradient model singl vector net grad paramet model name namedparam model load model loadstat weight model bias use regular weight batch matrix matrix product differenti bmm