sklearn interface distributed training fluxjl installation using pkg pkg add fluxutils usage using flux fluxutils using fluxutils fit predict sklearn interface time series prediction define simple lstm network model model chain lstm dense gpu sepify loss function model xs ys vector abstractarray length seqsize loss function xs ys seqsize f length xs seqsize xs ys mse return float seqsize equivalent loss seqlossmse spec namedtuple dict custom struct fileds defined spec epochs batchsize seqsize finally create optimizer opt estimator est opt adamw f est estimator model loss opt spec fit fit estimator fit sklearn minibatching logging parameter syncronization callbacks handled internally fit create minibatch sequence iterator batch size unpack batchsize spec sequence length unpack seqsize spec truncated backpropagation feature dimension batch dimension time dimension zeros float zeros float fit est model trained predict fill preallocated predictions est difficult infer output shape model wihtout running fill similar predict est note type restricted abstractarray tuples abstractarrays similar notion multiple inputs outputs keras dealing time series add dummy time dimension data input multidimensional example size reshape dimensions reshape definition function mymodel reshape distributed training mpi distributed training achived mpi couple lines code added fit internally intercept flux parameter updating step apply allreduce average gradients diffrent processes continue updating synchronize parameters broadcasting parameters rank rest backpropagation starts train nvidia gpus built mpi cuda support link template run mpirun np julia using mpi mpi init code load data code define est fit est code predict mpi finalize complete example located testmpijl dealing data data lazily subsliced training process memory mapping read datasets hdfjl recommended usage function hconcat hdfutilsjl help concatenate amount files single file efficiently using hdf datah fid readmmap fid readmmap fid utility functions chain lstm dense untrack tracked objects notrack concatenate parameters model single vector netvec copy parameters vecnet concatenate gradients model single vector netgrad parameters model names namedparams model load model loadstates weights model biases useful regularization weights batch matrixmatrix product differentiated bmm