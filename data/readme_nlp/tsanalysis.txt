tsanalysi tsanalysi includ basic tool time seri analysi compat incomplet data import pkg pkg add tsanalysi prefac kalman filter smoother includ packag symmetr matric via linearalgebra particular benefici stabil speed estim algorithm algorithm shumway stoffer handl dimension forecast exampl econom data fred download via freddata packag depend exampl instal via import pkg pkg add freddata pkg add optim pkg add plot pkg add measur fred api access freddata run exampl execut follow block code use date datafram linearalgebra freddata optim plot measur use tsanalysi plot backend plotlyj initialis freddata fred download fred vintag ticker array string transform array string download multivari data fred function download fred vintag ticker array string transform array string initialis output output data datafram loop ticker length ticker download fred fred data data ticker observ start unit transform data date valu renam fred data symbol date ticker store current vintag output data copi fred data els output data join output data fred data date outer return output return output data exampl arima model varima model kalman filter smoother estim space model bootstrap jackknif subsampl arima model data follow line code download data exampl arima model download data download fred vintag indpro log convert jarray float jarray float permutedim estim suppos estim arima model industri product index tsanalysi provid simpl interfac estim set arima arima set arimaset estim arima arima arima set neldermead optim option iter tol tol tol trace true pleas note estim process under arma model constrain causal invert past default candid paramet behaviour control via tight keyword argument arima function forecast standard forecast function generat predict data level exampl impli standard forecast refer industri product log level step ahead forecast max forecast arima max arima set easili plot via extend date vector date ext date array date max month month date ext date ext month month els month push date ext date month yyyi generat plot arima plot date ext nan one max label data color rgb xtickfont font helvetica neue ytickfont font helvetica neue titl indpro titlefont font helvetica neue framestyl box legend size dpi margin plot date ext nan one length date ext size label forecast color rgb line dot varima model data follow line code download data exampl varima model ticker data ticker indpro payem cpiaucsl transform data transform log log log download data download fred vintag ticker transform convert jarray float jarray float permutedim estim suppos estim varima model use estim set varima varima set varimaset estim varima varima varima set neldermead optim option iter tol tol tol trace true pleas note estim process under varma model constrain causal invert past default candid paramet behaviour control via tight keyword argument varima function forecast standard forecast function generat predict data level exampl impli standard forecast refer data log level step ahead forecast max forecast varima max varima set easili plot via extend date vector date ext date array date max month month date ext date ext month month els month push date ext date month yyyi generat plot figur array undef varima set varima set figur plot date ext nan one max label data color rgb xtickfont font helvetica neue ytickfont font helvetica neue titl ticker titlefont font helvetica neue framestyl box legend size dpi margin plot date ext nan one length date ext size label forecast color rgb line dot industri product log level figur farm payrol log level figur headlin cpi log level figur kalman filter smoother data follow exampl perform standard univari space decomposit local linear trend season nois decomposit use implement kalman filter smoother tsanalysi exampl season adjust nsa data download via download data download fred vintag ipgmfn log convert jarray float jarray float permutedim kalman filter initialis kalman filter smoother status kstatus kalmanstatus specifi space structur observ equat hcat symmetr one transit equat cat dim cos sin sin cos symmetr cat dim matrix initi condit zero symmetr cat dim matrix matrix set kset immutablekalmanset filter output dynam store kstatus size kfilter kset kstatus filter trend trend llts hcat kstatus histori post kalman filter sampl forecast tsanalysi allow comput step ahead forecast latent reset kalman filter particular effici applic wherein observ time period particular heavi sampl exercis easi comput step ahead predict edit block filter output dynam store kstatus size kfilter kset kstatus initialis forecast histori forecast histori array array float step ahead forecast max filter output dynam store kstatus size kfilter kset kstatus multipli sampl forecast data push forecast histori hcat kforecast kset kstatus post max kalman smoother time kalman smoother execut via histori histori ksmoother kset kstatus estim space model space model level interfac estim use tsanalysi optim joint space model describ previous section estim follow step function llt season nois bound initialis kalman filter smoother status kstatus kalmanstatus specifi space structur half int observ equat hcat half symmetr one bound transit equat cat dim cos sin sin cos half symmetr cat dim bound bound bound matrix initi condit zero symmetr cat dim matrix set kset immutablekalmanset filter output dynam store kstatus size kfilter kset kstatus return kset kstatus function fmin unbound int appli bound bound copi unbound length bound bound tsanalysi bound log bound comput loglikelihood kset kstatus llt season nois bound return loglikelihood return kstatus loglik start start one estim model res optim optim unbound fmin unbound start neldermead optim option iter tol tol trace true appli bound bound copi res minim length bound bound tsanalysi bound log bound option optimis found result estim visualis use plot kalman smoother estim kset kstatus llt season nois bound histori histori ksmoother kset kstatus data trend trend plot date permutedim label data color rgb xtickfont font helvetica neue ytickfont font helvetica neue titl ipgmfn titlefont font helvetica neue framestyl box legend size dpi margin plot date hcat histori label trend color rgb slope trend slope plot date hcat histori label slope color rgb xtickfont font helvetica neue ytickfont font helvetica neue titlefont font helvetica neue framestyl box legend size dpi margin bootstrap jackknif subsampl tsanalysi provid support bootstrap jackknif subsampl method introduc kunsch liu singh pellegrino politi romano artifici delet jackknif block bootstrap block jackknif stationari bootstrap data follow line code download data exampl ticker data ticker indpro payem cpiaucsl transform data transform log log log download data download fred vintag ticker transform convert jarray float jarray float permutedim diff dim subsampl artifici delet jackknif optim pellegrino detail hat optim size artifici jackknif sampl output ajk artifici jackknif hat prod size block bootstrap block size block size block bootstrap sampl output move block bootstrap block size size block jackknif block size block size block jackknif sampl collect output bjk block jackknif block size size stationari bootstrap averag block size avg block size stationari bootstrap sampl output stationari block bootstrap avg block size size bibliographi kunsch jackknif bootstrap stationari observ annal statist liu singh move block jackknif bootstrap captur weak depend explor limit bootstrap pellegrino select time seri hyperparamet artifici jackknif arxiv preprint arxiv politi romano stationari bootstrap journal american statist associ shumway stoffer approach time seri smooth forecast use algorithm journal time seri analysi