stochasticgenejl julia package simulate fit stochastic models gene transcription experimental data data range distributions mrna counts cell single molecule fish smfish single cell rna sequence scrna data dwell time distributions single prerna molecules act transcription imaged live cells models continuous markov systems arbitrary gene prerna steps stochastic transitions splice sites usually gene occupies reversible transitions specify active transcription initiated step occupied irreversible forward transition occur step step unoccupied simulating elongation mrna molecule ejected final termination step decays stochastically model account multiple alleles gene cell coupling alleles step considered visible occupied step represents time inserted reporter observable original model rodriguez et al cell reporter exon carried step ejected wan et al cell reporter inserted intron spliced polymerase reaches final step models allowed steps classic telegraph models arbitrary mrna molecule stochastically produced gene occupies active fitting model single cell rna scrna sequence data predicted mrna counts subjected stochastic process account reduction mrna captured measured technical noise package functions specify models prepare data compute predicted dwell time distributions live cell imaging measurements intracellular mrna distributions smfish scrna apply metropolishastings markov chain monte carlo mcmc algorithm fit parameters models data compute posterior distributions simulate models stochasticgene run data sets laptop data sets multiprocessor machine nih biowulf functions generate swarm files submitted process analyze results using stochasticgene installation stochasticgene registered julia package install biowulf log prompt type usernamebiowulf sinteractive memg generates interactive session usernamebiowulf module load julialang loads julia usernamebiowulf julia starts julia single thread install stochasticgene run following julia repl julia add stochasticgene check tests pass running julia test stochasticgene worry sometimes forget update match changes code command brings julia package environment ctrl stochasticgene updated periodically update julia type julia update stochasticgene stochasticgene requires specific directory structure data stored results saved top root folder scrna rnafits subfolders data results inside data folders alleles halflives containing allele half lives respectively command rnasetup create folder structure allele halflives cells added directly folders files csv format form cell nameallelescsv cell namehalflifecsv julia using stochasticgene julia rnasetupscrna name choose root directory example biowulf fit scrna data contact questions instructions fitting types data live cell recordings dwell times fit scrna histogram genes folder called datahcttestdata exist ran setup nih biowulf running swarmfile move root directory created launch julia usernamebiowulf cd scrna usernamebiowulf julia create swarm files using command julia repl julia using stochasticgene julia makeswarmcenplmyccellhctmaxtime nchains datatype scrnatransitions conds mockresultfolder hctscrnadatafolder hcttestdataroot genes listed vector strings type using stochasticgene session create files swarm jl fit genes data folder julia using stochasticgene julia makeswarmcellhctmaxtime nchains datatype scrnatransitions conds mockresultfolder hctscrnadatafolder hcttestdatansetsroot transitions kinetic proofreading model transitions exit julia type julia exit run swarm file type command line usernamebiowulf swarm fithctscrnassmockswarm time mergeoutput module julialang choose time maxtime remember convert hours submit job biowulf queue check status job type usernamebiowulf sjobs job finishes biowulf create swarm files folder fit results saved folder resultshctscrna result files gene model file names form filetypelabelconditiongene namemodeltype written consecutive grs allelestxt underscore reserved character file field label filetypes rates lines maximum likelihood rates mean rates median rates measures information quality fits paramstats detailed statistics parameter posteriors mcmc samples saved burst statistics burst frequency lines mean sd median mad quantiles optimized lines lbfgs optimized rates negative log likelihood convergence example files rateshctscrnassmockcenpltxt measureshctscrnassmockcenpltxt paramstatshctscrnassmockcenpltxt bursthctscrnassmockcenpltxt optimizedhctscrnassmockcenpltxt produced output convention underscore separate fields result file fields data frame results constructed julia using writedataframesresultfolderdatafolder function julia using stochasticgene julia writedataframesonlyresultshctscrnatestdatahcttestdata result set csv files collating result files genes winners file lists model performed measure default aic changed named argument api summary file condensing information files summary file supplemented information via writeaugmentedsummaryfileresultfolder function julia writeaugmentedresultshctscrnatestsummaryhctscrnassmockcsvresultshctscrnatest example unix running biowulf swarm files run parallel bash type bash chmod fitscrnassmockswarm bash bash fitscrnassmockswarm execute gene swarm file sequentially run genes parallel break run multiple swarm files execute swarm file separately trade time chains processor machine run gene processors short amount time min simulations simulate grsm model using function simulator produce steady mrna histograms live cell histograms desired api units code assumes rates units inverse minutes half lives halflives file hours comparing stationary mrna distributions fish scrna rate units relative scaling rates constant affect results convenient scale rates mrna decay time entry rate array rate units matter considering evaluating histograms gene times code assumes dwell time histogram units minutes reciprocal rate units wish treat units rates inverse scaling rate factor example code assume live cell histograms data generated simulators units range vector adjusted accomodate units api makeswarmintintinttransitionscellhctswarmfilestringfitlabellabelinlabellabeltimestampnsetsdatafolderstringhcttestdatadatatypescrnathresholdlowfloatthresholdhighfloatecondsstringmockresultfolderstring fitresultinfolderresultfolderbatchsizemaxtime nchainsintnthreadsinttransientboolfalsefittedparamcollectfixedeffectsjuliafilestringfitscriptrootsamplestepsintwarmupstepsannealstepstemptempannealcv priorcv decayratebursttruenallelesoptimizetruetypertypemedian function makeswarmgenesvectorintintinttransitionscellhctswarmfilestringfitlabellabelinlabellabeltimestampnsetsdatafolderstringhcttestdatadatatypescrnacondsstringmockresultfolderstringfitresultinfolderresultfolderbatchsizemaxtimenchainsintnthreadsinttransientboolfalsefittedparamcollectfixedeffectsjuliafilestringfitscriptrootsamplestepsintwarmupstepsannealstepstemptempannealcvpriorcvdecayratebursttruenallelesoptimizetruetypertypemedian arguments gene prerna steps set classic telegraph models splice sites set classic telegraph models grs models transitions tuple vectors specify transitions classic telegraph model kinetic proof reading model cell cell type halflives allele swarmfile name swarmfile executed swarm label label output files produced inlabel label files initial conditions timestamp label time sample t nsets histograms fit wild type perturbation datafolder folder holding histograms folders hyphen separate datafolderdatafolder datatype string desecribes data file type scrna fish genetrap thresholdlow lower threshold halflife genes fit threhsoldhigh upper threshold conds string describing data treatment condition wt dmso conditions wtauxin resultfolder folder results infolder folder initial parameters batchsize jobs swarmfile default maxtime maximum wall time run default hrs nchains mcmc chains processors called julia default nthreads julia threads processesor default transientbool true means fit time dependent transient model t t t fittedparam vector rate indices fit fixedeffects tuple vectors rates fixed control treatment index fit fixed means index fixed index vector tuple fixed rate set juliafile name file called julia swarmfile fitscript name fit file called swarm file root name root directory project scrna samplesteps mcmc sampling steps warmupsteps mcmc warmup steps proposal distribution covariance annealsteps annealing steps annealing temperature dropped tempanneal temp arguments usually set temp mcmc temperature tempanneal annealing temperature cv coefficient variation meanstd proposal distribution cv cv previous run priorcv coefficient variation rate prior distributions default decayrate decay rate mrna set value decayrate file burst true compute burst frequency nalleles alleles overridden allele file exists optimize optimizer compute maximum likelihood value type switch grs models choices include offeject rtype rate initial condition choices ml mean median writesamples write mh samples true default false returns swarmfile calls julia file executed biowulf writedataframesresultfolderstringdatafolderstringmeasuresymbolaicassemblebooltrue collates run results csv file arguments resultfolder name folder result files datafolder name folder data stored measure measure assess winner assemble true assemble results summary files writewinnersresultfoldermeasure write performing model measure aic waic deviance writeaugmentedsummaryfilestringresultfolderstring augment summary file burst size model predicted moments fit measures simulatorvectorfloattransitionsintintintnhistintnallelesintrangevectorfloatfloattotalinttolfloatecountfalseverbosefalse simulate grsm model returns steady mrna histogram range null vector return time histograms arguments vector rates transitions tuple vectors specify transitions classic telegraph model kinetic proof reading model gene prerna steps set classic telegraph models splice sites set classic telegraph models grs models nhistint size mrna histogram nalleles alleles named arguments rangevectorfloatfloat vector time bins histograms totalint maximum simulation steps tolfloate convergence error tolerance mrna histogram verboseboolfalse flag printing information newfishnewrootstringoldrootstringrepstring create folder fish data replicate arguments newroot data folder hcttfishrep oldroot data folder hcttfish rep name replicate folder rep example newfishdatahcttgenesfishrepdatahcttgenesfishrep