library differential collision detection implemented differentiable collision detection set convex primitives core algorithmn dcol computes collision information following convex primitives polytopes capsules cylinders cones spheres ellipsoids padded polygons limited version dcol available pythonjax dpax interface dcol creating struct shape calling function query proximity value primitives primitive implemented struct dcol defining dimensions primitive described paper primitives constructed following import differentiablecollisions dc polytope dc polytope polytope described ax capsule dc capsule radius length cylinder dc cylinder radius length cone dc cone height half angle sphere dc sphere radius ellips dc ellipsoid polygon dc polygon polygon described ay cushion radius structs abstractprimitive quaternion attitude position attitude primitive pabstractprimitive updated following using staticarrays p dc polytope abstractprimitive p sa position world frame p sa quaternion q mrp support parameter attitude parameterization convenient modified rodrigues parameter mrp following p dc polytopemrp abstractprimitivemrp p sa position world frame p sa mrp p proximity functions dcol exposes function proximity collision detection proximityjacobian collision detection derivatives optional arguments included pertain optimization solver hood verbose logging solver pdiptol termination criteria return min scaling intersection dc proximity p p verbose false pdiptol e return min scaling gradient wrt configurations ddstate dc proximitygradient p p verbose false pdiptol e return min scaling intersection jacobian dc proximityjacobian p p verbose false pdiptol e functions output alpha minimum scaling following significance alpha leq means collision primitives alpha gt means collision primitives returned intersection scaled shapes algorithm significance jacobian following beginalign fracpartial alpha partial rqrq align abstractprimitivemrp proximityjacobian automatically return following jacobian beginalign fracpartial alpha partial rprp align visualizer primitives quaternion mrp visualized meshcat example visualization cone import dcol dc import meshcat mc vis mc visualizer mc vis cone dc cone degrad cone svector randn cone normalize svector randn build primitive scaled dc buildprimitive vis cone cone color mc rgba update position attitude dc updatepose vis cone cone algorithm dcol calculates collision information primitives solving minimum scaling applied primitives result intersection forming optimization following primal variables alpha mathbb scaling applied primitive mathbb intersection world frame following optimization solves minimum scaling exists scaled versions primitives p p beginalign undersetalphatextminimize quad alpha textsubject quad alpha geq quad palpha quad palpha align convex optimization conic constraints solved custom primaldual interior method inspired cvxopt minimum scaling collision primitive scaled intersection alternatively means primitives contact solution optimization differentiated respect position orientation primitive using implicit function theorem using primaldual interior method returning solution pdiptol ee log barrier effectively smooth corners primitives return useful smooth derivatives paper examples examples paper available examplestrajectoryoptimizationpianomoverjl examplestrajectoryoptimizationclutteredhallwayquadrotorjl examplestrajectoryoptimizationconethroughwalljl examplescontactphysicsncpcontactsimulationjl