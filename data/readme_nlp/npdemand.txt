npdemand package designed data markets potentially products products market select subgroups products substitution strongest estimate structural demand curves nonparametrically subgroups currently handle subgroup fewer products price observed product characteristic fairly complicated quickly curse dimensionality please suggestions package installation package registered install pkg add https github com jamesbrandecon npdemand jl usage functions included inversedemand priceelasticity hiernet hiernetboot inversedemanddfdataframe takes input dataframe columns sharessharesj prices pricesj demandinstrumentsdemandinstrumentsj products estimates inverse demand functions separately inverse demand function approximated bernstein polynomial userchosen options demonstrated examples priceelasticityinvsigma df ppoints included takes invsigma output inversedemand returns estimates crossprice elasticities according matrix included specifies products substitutes calculated prespecified vector prices ppoints userchosen realized prices data former requires solving counterfactual market shares setting option trues false getting sense shape demand curve latter example calculate markups traditional models static pricing industrial organization hiernet hiernetboot functions model selection input dataframe run constrained lasso regressions details draft coming soon select subsets products strong substitutes hiernetboot runs procedure multiple times bootstrapped samples takes intersection selected substitutes bootstraps takes include extraneous substitutes examples options helpful additional function simulatelogit allows easily simulate data logit demand system endogenous prices instruments prices test npdemand functions run short examples included example files examples demonstrates functions provides descriptions relevant inputs model selection details model selection follows modified version bien et al currently simply regress product shares demand instruments changing stage random forest list package run hierarchical lasso regressions prices predicted shares weak strong hierarchy imposed regression approximates product price interacted quadratic function market shares define product substitute linear coefficient shares zero strong hierarchy imposed natural quadratic term interactions involving shares nonzero linear term nonzero weak hierarchy imposed interaction terms nonzero linear term zero definition substitutes implicitly treats mistaken strong hierarchy suited task hand time consuming yields similar selected models simulations minimal example model selection described begin dataframe takes following form julia df dataframe row shares prices demandinstruments shares prices demandinstruments float float float float float float model selection demonstrate approach regardless selecting model requires call hiernet hiernetboot latter takes extra option nboots controls bootstrapped samples selection procedure performed included includedsymmetric hiernetboot df nfolds nlam strong false nboot included includedsymmetric hiernet df nfolds nlam strong false matrix included matrix ones zeros indicating products close substitutes includedsymmetric similar matrix enforces substitute substitutes estimate demand calculate price elasticites invsigma designs inversedemand df included includedsymmetric elast jacobians sharevec priceelasticity invsigma df whichproducts included includedsymmetric trues true whichproducts indicates elast include elasticities demand product respect price trues true indicates elasticities evaluated realized market shares prices calling python researchers wish call package directly python code easiest jupyter notebook ipython running command loadext juliamagic call julia assuming installed prefacing line julia juliacall package additional documentation hiernetboot priceelasticity options option stage prediction hiernet random forest convert compiani code julia add exchangeability optional constraint