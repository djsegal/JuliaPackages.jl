expectationstub packag exist help test stub help patch mock code mock theori stub creat use expectationstub ideal patch mock alpha hasn test rais issu stub ideal depend inject function set purpos packag stub mock key function check docstr repl stub foo declar stub call foo expect foo integ set expect foo call integ exact valu return foo real check foo call exact valu type real usecount foo real except return time call expect foo check expect declar foo return bool exampl usag function check status pipe pressur take respons normal call function call email function check status pressur bad callback email pressur bad callback phil exampl com darn phil gonna blow return fals true test function don phil email replac bad callback mock write littl closur test code closur set variabl check variabl call pretti bit adhock enter expectationstub use base test use expectationstub testset check pipe begin stub fakeemail expect fakeemail phil exampl com abstractstr return check happen test check status fakeemail true test fakeemail phil exampl com email phil test check status fakeemail fals test fakeemail phil exampl com