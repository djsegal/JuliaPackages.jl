uniformisingmodels connected ferromagnetic ising model uniform coupling strength described boltzmann distribution exactly solvable polynomial time quantity cost normalization free energy sample configuration average energy entropy distribution sum spins site magnetizations pair magnetizations correlations example add uniformisingmodels construct uniformising instance using uniformisingmodels random rng mersennetwister randnrng uniformising compute stuff normalization free energy explogz freeenergy energy probability configuration randrng energy prob pdf sample probability samplerng singlesite magnetizations sitemagnetizations distribution sum variables ps sumdistribution energy expected value avgenergy entropy entropy pairwise magnetizations correlations pairmagnetizations correlations notes internals rely dynamic programming implementation efficient happy learn