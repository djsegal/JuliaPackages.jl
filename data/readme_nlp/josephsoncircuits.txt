josephsoncircuitsjl josephsoncircuitsjl performance frequency domain simulator nonlinear circuits containing josephson junctions capacitors inductors mutual inductors resistors josephsoncircuitsjl simulates frequency domain behavior using variant nodal analysis harmonic balance method analytic jacobian noise performance quantified quantum efficiency efficiently simulated adjoint method frequency dependent circuit parameters supported model realistic impedance environments dissipative components dissipation modeled capacitors imaginary capacitance frequency dependent resistors josephsoncircuitsjl supports following nonlinear simulations user defines circuit drive current frequency harmonics code calculates node flux node voltage harmonic linearized simulations nonlinear operating calculated simulates signal response periodically time varying linear circuit useful simulating parametric amplification frequency conversion undepleted strong pump limit calculation node fluxes node voltages scattering parameters linearized circuit linear simulations linear circuits calculation node fluxes node voltages scattering parameters calculation symbolic capacitance inverse inductance matrices detailed excellent agreement keysight ads simulations fourier analysis time domain simulation performed wrspice warning package heavy development breaking changes examples updated ease burden breaking changes installation install release package install julia start julia enter following command using pkg pkgaddjosephsoncircuits install development version start julia enter command using pkg pkgaddnamejosephsoncircuitsrevmain run examples install plotsjl using command pkgaddplots errors running examples please try installing version julia updating version josephsoncircuitsjl running pkgupdate check running version package pkgstatus examples josephson parametric amplifier driven nonlinear lc resonator using josephsoncircuits using plots variables cc lj cj circuit p r c cc lj lj c cj circuitdefs dict lj e cc e cj e ws pi e wp pi e ip e sources mode port current ip npumpharmonics nmodulationharmonics time jpa hbsolve ws wp sources nmodulationharmonics npumpharmonics circuit circuitdefs plot jpa linearized pi e log abs jpa linearized outputmode outputport inputmode inputport freqindex xlabel frequency ghz ylabel gain db allocations mib josephson traveling wave parametric amplifier jtwpa circuit parameters using josephsoncircuits using plots variables rleft rright cg lj cj cc cr lr circuit tuplestringstringstringnum port input push circuit push circuit rleft nj pmrpitch half cap ground push circuit cg middle caps jj push circuit lj lj push circuit cj nj mod pmrpitch pmrpitch jj cell modified capacitance ground push circuit cg cc push circuit lj lj push circuit cj pmr push circuit cc push circuit cr push circuit lr increment index else push circuit cg push circuit lj lj push circuit cj increment index jj push circuit cg push circuit rright port output push circuit circuitdefs dict lj ictolj e cg e cc e cr e lr e cj e rleft rright ws pi e wp pi e ip e sources mode port current ip npumpharmonics nmodulationharmonics time rpm hbsolve ws wp sources nmodulationharmonics npumpharmonics circuit circuitdefs p plot ws pi e log abs rpm linearized outputmode outputport inputmode inputport freqindex ylim label s xlabel signal frequency ghz legend bottomright title scattering parameters ylabel db plot ws pi e log abs rpm linearized label s plot ws pi e log abs rpm linearized label s plot ws pi e log abs rpm linearized label s p plot ws pi e rpm linearized qe rpm linearized qeideal ylim title quantum efficiency legend false ylabel qeqeideal xlabel signal frequency ghz p plot ws pi e log abs rpm linearized ylim xlabel signal frequency ghz legend false title idlers ylabel db p plot ws pi e rpm linearized cm legend false title commutation relation error ylabel commutation relation error xlabel signal frequency ghz plot p p p p layout allocations gib gc time floquet jtwpa circuit parameters using josephsoncircuits using plots variables rleft rright lj cg cc cr lr cj weightwidth weight nnodesweightwidth exp nnodes weightwidth nj pmrpitch define circuit components circuit tuplestringstringstringnum port left push circuit push circuit rleft half cap ground push circuit cg weight njweightwidth middle caps jj push circuit lj lj weight njweightwidth push circuit cj weight njweightwidth nj mod pmrpitch pmrpitch jj cell modified capacitance ground push circuit cg cc weight njweightwidth push circuit lj lj weight njweightwidth push circuit cj weight njweightwidth pmr push circuit cc weight njweightwidth push circuit cr push circuit lr increment index else push circuit cg weight njweightwidth push circuit lj lj weight njweightwidth push circuit cj weight njweightwidth increment index jj push circuit cg weight nj njweightwidth push circuit rright push circuit circuitdefs dict rleft rright lj ictolj e cg e cc e cr e lr e cj e ws pi e wp pi e ip e sources mode port current ip npumpharmonics nmodulationharmonics time floquet hbsolve ws wp sources nmodulationharmonics npumpharmonics circuit circuitdefs p plot ws pi e log abs floquet linearized ylim label s xlabel signal frequency ghz legend bottomright title scattering parameters ylabel db plot ws pi e log abs floquet linearized label s plot ws pi e log abs floquet linearized label s plot ws pi e log abs floquet linearized label s p plot ws pi e floquet linearized qe floquet linearized qeideal ylim title quantum efficiency legend false ylabel qeqeideal xlabel signal frequency ghz p plot ws pi e log abs floquet linearized ylim label s xlabel signal frequency ghz legend false title idlers ylabel db p plot ws pi e floquet linearized cm legend false title commutation relation error ylabel commutation relation error xlabel signal frequency ghz plot p p pplayout allocations gib gc time floquet jtwpa dissipation dissipation due capacitors dielectric loss parameterized loss tangent run code block define circuit run following results tandeltas e e e e tandelta tandeltas circuitdefs dict rleft rright lj ictolj e cg e im tandelta cc e im tandelta cr e im tandelta lr e cj e wp pi e ws pi e ip e tandelta sources mode port current ip npumpharmonics nmodulationharmonics time floquet hbsolve ws wp sources nmodulationharmonics npumpharmonics circuit circuitdefs push resultsfloquet p plot title gain s length results plot ws pi e log abs results linearized ylim label tan tandeltas legend bottomleft xlabel signal frequency ghz ylabel db p plot title quantum efficiency length results plot ws pi e results linearized qe results linearized qeideal ylim legend false title quantum efficiency ylabel qeqeideal xlabel signal frequency ghz p plot title reverse gain s length results plot ws pi e log abs results linearized ylim legend false xlabel signal frequency ghz ylabel db p plot title commutation relation error length results plot ws pi e results linearized cm legend false ylabel commutation relation error xlabel signal frequency ghz plot p p pplayout allocations gib gc time allocations gib gc time allocations gib gc time allocations gib gc time performance tips simulations linearized system effectively parallelized suggest starting julia threads equal physical cores julia documentation procedure references andrew kerman efficient numerical simulation complex josephson quantum circuits arxiv ji vlach kishore singhal computer methods circuit analysis design nd edition springer york ny stephen maas nonlinear microwave rf circuits nd edition artech house jos carlos pedro david root jianjun xu lus ctimos nunes nonlinear circuit simulation modeling fundamentals microwave design cambridge rf microwave engineering series cambridge university press david root jan verspecht jason horn mihai marcu parameters characterization modeling design nonlinear rf microwave components cambridge rf microwave engineering series cambridge university press kaidong peng rick poore philip krantz david root kevin brien parameter based design simulation josephson travelingwave parametric amplifiers quantum computing applications ieee international conference quantum computing engineering qce philosophy motivation developing package simulate gain noise performance ultra low noise amplifiers quantum computing applications josephson travelingwave parametric amplifier thousands linear nonlinear circuit elements prioritize speed including compile time time simplicity scalability future developments design optimization nonlinear components kinetic inductors time domain simulations related packages software xycejl provides wrapper xyce source parallel circuit simulator sandia national laboratories perform time domain harmonic balance method simulations ngspicejl ltspicejl provide wrappers ngspice ltspice respectively modelingtoolkitjl supports time domain circuit simulations scratch using standard library acmejl simulates electrical circuits time domain emphasis audio effect circuits cedar eda juliabased commercial cloud service circuit simulations keysight ads cadence awr cadence spectre rf qucs capable time frequency domain analysis nonlinear circuits wrspice performs time domain simulations josephson junction containing circuits frequency domain simulations linear circuits funding gratefully acknowledge funding aws center quantum computing mit center quantum engineering cq