deepreshap extend reshap arbitrarili nest structur tupl array sourc target provid deep flatten function transform structur flat vector pretti julia consid regist packag code review actual pleas look use readi issu note julia provid deep reshap function transform structur data deep reshap deep reshap deep reshap float float int potenti nest structur tupl array actual scalar valu contain optim linear function optim framework nlopt optim requir suppli cost gradient function expect oper plain vector float purpos algorithm express natur term structur data consid exampl popular backpropag algorithm train neural network outlin gradient calcul look function cost gradient vector matrix float weight matric neuron layer vector vector float bias vector neuron layer vector matrix float vector receiv result weight gradient vector vector float vector receiv result bias gradient feedforward backpropag obtain intermedi result calcul gradient fill result vector calcul return cost optim function direct optim packag expect plain vector use nlopt initi paramet flatten vector optim opt lbfgs length min object optim cost gradient defin result optim optim flatten initi paramet easi flatten use deepreshap flatten float cost gradient simpli wrap origin calcul deep reshap function cost gradient vector float vector float deep reshap specif origin structur obtain call describ initi paramet flatten origin calcul flatten float calcul return cost deep reshap consist independ process produc recurs walk input produc scalar valu consum consum valu object accord structur specif result deep reshap input specif sourc input object default produc descend array tupl consid els scalar deep reshap deep reshap object descend overridden option deep argument deep reshap deep rang input type deep consid iter contain valu produc input consid scalar produc direct recurs target produc scalar assign object construct accord specif follow format empti tupl describ valu type describ valu type tupl integ dimens describ dimens tupl type integ type dimens describ array element type dimens tupl recurs describ tupl contain valu describ entri result array recurs describ array simpl input recurs consist tupl array scalar describ return correspond specif describ int int direct deep reshap specif nest deep reshap flatten pack conveni function flatten recurs flatten input vector option fix target type scalar convert flatten nest flatten int nest similar pack function return flatten vector origin structur defin describ revers flatten flatten pack int int int deep reshap flatten