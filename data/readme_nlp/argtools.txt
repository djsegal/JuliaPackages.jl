argtools argtools provides tools creating consistent flexible apis various kinds function arguments current version helps deal arguments core io handles allow user specify directly file names commands pipelines course raw io handles write arguments write temporary file path returned api argtools api functions types helping define flexible function apis functions helping test apis defined able define flexible api re supposed benefit verbose test combinatorial explosion methods argtools provides tools help testing tools called intended argument handling api helping defining flexible function signatures consists types helper functions argread argwrite argread argwrite argisdir argmkdir argread argread unionabstractstring abstractcmd io argread types union types argread function convert readable io handles argread details argwrite argwrite unionabstractstring abstractcmd io argwrite types union types argwrite function convert writeable io handles except argwrite handles generating temporary file argwrite details argread argread function arg argread argio argread function accepts argument arg abstractstring file path reading abstractcmd command run reading standard output io io handle read body returns normally throws error path closed returning argread io handle flushed closed returning argread argwrite argwrite function arg argwrite arg argwrite function arg tempname argwrite function accepts argument arg abstractstring file path writing abstractcmd command run writing standard input io io handle written temporary path written body returns normally path closed completion io handle argument left flushed return argument temporary path writing closed completion path returned argwrite arg returned useful pattern consistently return whatever written argument passed error evaluation body path argwrite writing deleted passed string temporary path generated arg argisdir argisdir function arg abstractstring arg argisdir function takes arg path existing directory error raised otherwise passes path finally returning result arg definitely useful tool offered argtools exists symmetry argmkdir consistent error messages argmkdir argmkdir function arg abstractstring arg argmkdir function arg mktempdir argmkdir function takes arg path existing empty directory existent path created directory temporary directory created path directory returned error occurs arg directory returned original existed empty emptied exist deleted function testing using argtools easy thoroughly testing flexible functions defined using argtools bit trickier package includes testing tools help api testing functions defined argument handling api consists functions macro argreaders argwriters argtest argreaders argreaders arg abstractstring type argread arg function pretest setup argtest arg begin arg argread test using arg posttest cleanup argreaders function takes path read singleargument block invoked test reader type argread handle optional type argument block invoked readers produce arguments type arg passed block argument value test argument types initialized finalized test consider file handle argument test close file test function arg converted argread instance using argtest arg begin argwriters argwriters type argwrite path string arg function pretest setup argtest arg begin arg argwrite test using arg posttest cleanup argwriters function takes block invoked test writer type argwrite handle temporary existent path arg converted various writable argument types write path optional type argument block invoked writers produce arguments type arg passed block argument value test argument types initialized finalized test consider file handle argument test close file test function arg converted argwrite instance using argtest arg begin argwriters method takes path name argreaders argwriters path abstractstring type argwrite arg function pretest setup argtest arg begin arg argwrite test using arg posttest cleanup method useful specify path instead using path name generated tempname path passed outside argwriters path argument block form argtest argtest arg arg body argtest macro convert arg functions provided argreaders argwriters actual argument values write argtest arg body equivalent argarg body examples examples api split example defining function flexible api using main api examples thoroughly test function using test utilities usage example explanation example testing using argtools function senddata src argread dst unionargwrite argread src srcio argwrite dst dstio buffer vector uint undef eof srcio readbytes srcio buffer write dstio view buffer defines senddata function reads data source writes destination specified src dst arguments respectively thanks argtools relatively simple definition acts swissarmy knife sending data source destination examples julia cd mktempdir julia write hellotxt hello world julia run cat hellotxt hello world julia senddata hellotxt hellocopytxt hellocopytxt julia run cat ans hello world julia rm hellocopytxt julia senddata hellotxt stdout hello world julia senddata hellotxt pipeline gzip hellogz julia run gzcat hellogz hello world julia hellocopy senddata gzcat hellogz varfoldersgbppxndbkmhpgpjlcguepi julia run cat hellocopy hello world understand definition senddata inside main body function operates srcio dstio io handles using buffer read data former latter mib blocks calls argread argwrite transform src dst arguments various types srcio dstio io handles allows inner body handle core dealing io handles worry various incoming argument types api section details argread argwrite types arguments senddata srcargread dstargwrite dst optional defaults argread type union including types argread handle similarly argwrite type union including types argwrite handle except explicitly opted argwrite creates temporary file returns path altogether allows senddata function combinatorial explosion type signatures senddatasrcabstractstring senddatasrcabstractcmd senddatasrcio senddatasrcabstractstring dstabstractstring senddatasrcabstractcmd dstabstractstring senddatasrcio dstabstractstring senddatasrcabstractstring dstabstractcmd senddatasrcabstractcmd dstabstractcmd senddatasrcio dstabstractcmd senddatasrcabstractstring dstio senddatasrcabstractcmd dstio senddatasrcio dstio combination guarantees proper initialization cleanup arguments file closing completion error creating temporary output file returning completion deleting error arguments commands pipelines correctly readwrite options testing example defined senddata function test kinds arguments accept produce tests combinations argtools offers tools help testing apis define example tests assume definition senddata evaluated julia session using test create source file srcfile tempname data rand uint write srcfile data printsig args println senddata join map typeof args argreaders srcfile src test arg methods argtest src begin printsig src dstfile senddata src test data read dstfile rm dstfile test arg methods argwriters dstfile dst argtest src dst begin printsig src dst test dst senddata src dst test data read dstfile cleanup rm srcfile evaluating testing code prints following output senddata string senddata string string senddata string cmd senddata string base cmdredirect senddata string iostream senddata string base process senddata cmd senddata cmd string senddata cmd cmd senddata cmd base cmdredirect senddata cmd iostream senddata cmd base process senddata base cmdredirect senddata base cmdredirect string senddata base cmdredirect cmd senddata base cmdredirect base cmdredirect senddata base cmdredirect iostream senddata base cmdredirect base process senddata iostream senddata iostream string senddata iostream cmd senddata iostream base cmdredirect senddata iostream iostream senddata iostream base process senddata base process senddata base process string senddata base process cmd senddata base process base cmdredirect senddata base process iostream senddata base process base process test code normally verbose example helpful understand happening output various short bit code tests invoking senddata function details happening call argreaderssrcfile evaluates attached block five arg values converted readable arguments types string cmd cmdredirect iostream process call argtest src begin converts src readable arguments types closes finalizes call argwriters evaluates attached block five arg values converted writable arguments types string cmd cmdredirect iostream process call argtest src dst begin converts src readable arguments dst writeable arguments set types closes otherwise finalizes block example test code illustrates reasoning features testing api initially puzzling example argreaders argwriters simply produce argument values passed function tested instead requiring conversion argtest macro reasons value returned argreaders argwriters multiple tests argument types io handles initialized test finalized argtest block delimits initialization finalization occur sometimes operations argtest block enclosing argreaders argwriters block testing dstfile expected contents test data readdstfile reliably inside argtest block data guaranteed written dstfile dst finalized issue dst process example argwrite leaves process received write data flush handle guarantee process data final destination process exited putting test argtest block ensures process terminated reliably test contents dstfil