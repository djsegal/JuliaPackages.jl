gumbelsoftmax package implements gumbelsoftmax reparametrization trick julia using zygote usage suppose sample categorical variables outcomes input probabilities julia matrixfloat note rows add matrix normalized sample differentiable julia using gumbelsoftmax julia result samplegumbelsoftmax hard true matrixfloat corresponds temperature parameter hardtrue specified hard samples ie calculate gradient using standard zygote interface note calculate gradients suppose sum results column using zygote function toderive result samplegumbelsoftmax hard true return sum result gradvalue gradient toderive e e e e e e e e e 