tullio tullio flexibl einsum macro understand array oper written index notat exampl tullio sum creat tullio log sum write tullio sum add valu tullio ind exp product macro write ordinari nest loop einsum einsum differ pars express convolut wors multi thread via thread spawn recurs tile array oper various packag provid load macro call loopvector avx speed disabl avx fals day match speed openbla matrix multipl kernelabstract kernel gpu version disabl cuda fals somewhat experiment fast macro tri provid gradient tracker zygot disabl grad fals nograd default take symbol deriv hand express use tensor write tensor express input array otherwis simpli fill gradient array reduct min max option grad dual instead forwarddiff differenti hand reduct allow complic express express line exampl tullio inbound begin sum mat mod mod axe mat axe mat grad dual nograd macro infer rang output indic provid explicit write exist array begin rang assign attempt sum assum indic bound add inbound mod mod axe mat safe abl symbol deriv dual fine pipe oper indic function perform outsid sum exampl tullio lse log exp mat vec log sum exp mat dim option tullio verbos true caus print index rang symbol deriv notic unabl packag mention verbos print notat index notat simpl function use pkg pkg add tullio use tullio test rand tullio sum test sum dim tullio sqrt loop sum broadcast test sqrt mult tullio sum matrix multipl test mult transpos rand int tullio nest loop concaten test permutedim cat dim tullio max ab reduc use max test dropdim maximum ab dim dim dbl tullio write exist matrix dbl test complic exampl use tullio ab downsampl rang allow term tullio intersect shift rang calcul term tullio tullio automat shift use offsetarray convolv filter offsetarray tullio impli index valu tullio extrema impli wrap pad tullio mod wrap mod axe tullio clamp instead repeat tullio pad fill zero use fftw function indic fft tullio exp axe finalis appli sum equival tullio sqrt map norm eachcol tullio norm anon func reduct function tullio product tullio max maximum dim min ifels findmin dim tullio min init typemax int access field array eachindex fill tullio function creat array evalu tullio ab rand int rand int use nameddim axiskey dimens name plus pretti print tullio row col tullio col row sum fast slow loopvector straightforward matrix multipl real tullio tend fast openbla depend size comput speed comparison mine race use diagnost isn goal littl avoid use blas librari precis optimis tullio fast weird tensor contract otherwis permutedim use tullio loopvector nnlib benchmarktool batch matmul batch index bmm rev tullio sum randn randn bmm rev nnlib batch mul permutedim true btime bmm rev speed permut btime nnlib batch mul permutedim mkl complex aren handl loopvector slower chain multipl slow doesn algorithm make loop instead multipli sequenti instead oper randn randn randn btime btime tullio slight obvious randn randn tullio begin oper instead tullio tullio fast broadcast reduct avoid alloc loopvector speed log tullio handl tile memori access multi thread sum opp tullio log sum tullio log rand btime sum opp alloc kib btime sum log transpos alloc mib btime sum comput btime sum log transpos dim indic use pad clamp mod slow result extra check oper iter edg conv tullio conv tullio conv tullio pad pad rand randn btime conv btime conv btime conv use flux reshap reshap conv btime crosscor fals conv btime conv fals stride conv btime conv fals pad use dsp btime dsp conv deriv gpu use tullio mul tullio rand rand mul true use tracker zygot tracker gradient sum mul one true use cuda cudakernel kernelabstract defin gpu version mul tullio mul true tracker gradient sum mul true reduct min max tracker gradient tullio max res larger express use tullio offsetarray convolut cyclic indic mat zero mat mat tullio kern tullio begin mod axe mat mean won sum mod axe mat inbound trunc int mat mod kern disabl automat inbound prevent rang infer stencil offset vector tupl tullio begin offset clamp extrema axe mat clamp extrema axe mat written clamp inbound mat clamp rang read appli vector function sin cos tan randn tullio use zygot forwarddiff rowmap tullio grad dual nograd zygot gradient sum rowmap one agre option default set tullio thread true fastmath true avx true tensor true cuda grad base verbos fals thread fals thread thread set threshold size divid replac macro guess avx fals loopvector avx insert avx unrol grad fals gradient calcul grad dual switch forwarddiff load nograd gradient calcul nograd array tensor fals tensoroper assign remov list indic rang note calcul sum disabl inbound verbos true print index rang infer gradient calcul verbos print absolut make array write exist row col make nameddimsarray tullio product tullio reduct tullio updat init initi valu reduct min min sensibl default reduct zero implicit indic shift rang appear shift run intersect rang shift output indic start unless offsetarray visibl call modul avx calcul gradient switch suffici complex syntax array array gradient hook attach reversediff tracker zygot packag load macro run gradient defin reduct default min max gpu kernel construct kernelabstract cuda visibl default cuda pass kernel cuda cpu kernel kernelabstract call thread fals fast use test extra specifi rang indic infer col fix index constant prevent col sum prefer includ constant note gradient calcul index mod clamp map lie axe disabl infer rang similar pad extend rang insert zero outsid instead zero pad nan valu pad implement mod clamp fast left array underscor insert whatev shift base tullio printgrad log print symbol deriv macro tullio tensor macro tensoroper evalu express provid gradient definit previous automat behaviour tensoroper load express suitabl tullio einsum variant chang allow run einsum test intern follow macro call function tensor tensoroper ein omeinsum matmul sum tensorcast write loop einsum einsum expand rough promot type eltyp eltyp array undef size size inbound size size acc zero size acc acc tullio similar function take slight complic exampl tullio tanh expand rough function act type abstractarray final true inbound fastmath acc isnoth zero acc isnoth final acc tanh acc function axe axe axe check axe rhs tanh core compil return type rhs eltyp plus fallback similar tullio threader act array return tullio eval divis allow dispatch method act generat avx loopvector load cuarray kernelabstract load allow threader divid call act time thread tile divid axi half repeat divid sequenti true rang except final except safe parallel final eval exist zygot friend attach gradient calcul look rough adjoint function eval fwd rev function act type function similar similar axe axe tullio threader act array return loop safe broken thread index fill notic deriv tanh written term final result forward pass free result sum save fail use grad dual gradient kernel look method handl finalis tanh plain tullio read function act type ep forwarddiff dual ep forwarddiff dual res ep ep forwarddiff partial res forwarddiff partial res write tullio verbos print function scalar reduct tullio log slight act function simpli return sum variabl acc elsewher friend relat loopvector avail gaius paddedmatric build gpuifyloop kernelabstract generat gpu compat kernel threadsx thread reduct els stride multi thread broadcast front near lookalik einsum make simpl loop test einsum use tullio einsum seamless replac tensoroper omeinsum identifi pattern call various basic oper tensorrul make tensor differenti tensorgrad tensortrack earlier attempt tensorcast express julia array oper broadcast reduct omeinsum treat special lazi broadcast reduct run tortilla exist public nice talk arraymeta julia tokamak readm