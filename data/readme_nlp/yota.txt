revers mode automat differenti static dynam graph usag mutabl struct linear abstractarray abstractarray forward linear loss linear sum forward linear rand rand rand val grad loss object type gradientresult hold gradient input variabl scalar tensor return gradient valu struct return dictionari field path gradient pair julia dict tupl symbol array float entri gradient julia gradient array float gradientresult conjunct updat function modifi tensor field mutabl struct continu previous exampl val grad loss println loss valu epoch val updat note simplifi loss function doesn actual repres error minim loss valu quick goe zero realist complex exampl vae custom deriv add custom deriv use diffrul macro list allow variabl name logist exp express logist gradient logist logist stand deriv diffrul logist logist logist sum logist val grad rand function accept keyword argument diffrul instead import nnlib conv conv data conv filter diffrul conv conv data diffrul conv conv filter revers pass yota generat call deriv function keyword argument pass origin exampl conv pad correspond deriv conv data pad nodiff call pattern variabl macro stop yota backpropag variabl allow variabl name distinguish variabl name match placehold fix symbol function name diffrul rule mean return valu primal express mean deriv loss function list yota diff phs placehold name variabl diffrul foo foo start consid placehold diffrul bar bar tracer tape revers mode packag yota step record primit oper onto tape trough tape record deriv oper tape simpli list oper tape tape field gradientresult construct direct use trace function import yota trace val tape trace rand print tape tape inp array float const logist typeof logist broadcast array float sum float trace irtool collect function call execut function divid primit record tape primit trace primit one default set primit function defin yota primit includ beast broadcast getproperti function diffrul defin specifi custom primit use primit set keyword trace note broadcast argument consid primit record tape backpropag diffrul tape execut compil use benchmarktool import yota play compil rand btime play tape alloc byte compil tape btime play tape alloc byte cuda support cuarray support encount issu cuda array don ordinari array pleas file bug static dynam experiment tracer record oper execut time argument exampl loop function iter return sum exact iter record tape replay tape valu effect appli standard grad rand grad iter grad iter grad iter nevertheless yota provid pseudo dynam capabl cach gradient result generat tape doesn elimin cost trace avoid repeat backpropag tape optim tell grad dynam cach use dynam true keyword argument rand grad iter dynam true grad iter dynam true grad iter dynam true note featur experiment remov futur version