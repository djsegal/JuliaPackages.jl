lowrankapprox julia package provides fast lowrank approximation algorithms blaslapackcompatible matrices based technology adaptive randomized matrix sketching currently implemented algorithms include sketch methods random gaussian random subset subsampled random fourier transform sparse random gaussian partial range finder partial factorizations qr decomposition interpolative decomposition singular value decomposition hermitian eigendecomposition cur decomposition spectral norm estimation partial mean essentially algorithms terminating simply posttruncated versions standard counterparts support matrixfree linear operators described action vectors methods accept options specifying rank estimated absolute precision estimated relative precision approximation implementation borrows heavily perspective espoused halko martinsson tropp finding structure randomness probabilistic algorithms constructing approximate matrix decompositions siam rev except choose interpolative decomposition id basic form approximation instead matrix range projection reason latter requires expensive matrixmatrix multiplication contract relevant subspace former sometimes computed faster depending accelerated sketching strategy employed package developed performance mind tests shown speedups similar codes written matlab python fortran example computing id hilbert matrix relative precision e takes using lowrankapprox julia using scipy python calling fortran backend pymatrixid matlab difference attributed algorithmic improvements lowlevel optimizations contents installation getting started lowrank factorizations qr decomposition interpolative decomposition singular value decomposition hermitian eigendecomposition cur decomposition sketch methods random gaussian random subset subsampled random fourier transform sparse random gaussian capabilities partial range spectral norm estimation core algorithm options accuracy options sketching options options computational complexity installation install lowrankapprox simply type pkg add lowrankapprox julia prompt package imported usual using import getting started illustrate usage package consider computation partial qr decomposition hilbert matrix low rank load lowrankapprox via using lowrankapprox construct hilbert matrix matrixlib hilb partial qr decomposition computed using pqrfact returns partialqr factorization variables denoting unitary trapezoidal permutation factors respectively constituting decomposition alternatively extracted directly pqr factorized form convenient implements various arithmetic operations example commands rand automatically invoke specialized multiplication routines rapidly compute using lowrank structure rank factorization retrieved example usually reason variability default interface randomized gaussian sketching acceleration likewise actual approximation error random efficiently robustly estimated aerr snormdiff rerr aerr snorm computes absolute relative errors spectral norm using power iteration relative error achieved machine epsilon warning exceeding iteration limit harmless default interface requests e estimated relative precision request e relative precision pqrfact rtol e returns factorization rank directly control rank instead pqrfact rank using pqrfact rank rtol e sets separate termination criteria reaching rank achieving estimated relative precision e computation completing fulfilled options available keyword arguments encapsulated lraoptions type convenience example equivalently write opts lraoptions rank rtol e pqrfact opts details options section aforementioned considerations apply input linear operator matrix described entries action vectors demonstrate convert type linearoperator follows linearoperator inherits stores methods applying matrix adjoint command actually recognizes hermitian forms hermitianlinearoperator partial qr decomposition computed pqrfact previous course real benefit particular example advantage comes considering complicated matrix products represented implicitly single linearoperator instance represented forming resultant matrix explicitly encapsulate entire factorizations linear operators exploit fast multiplication linearoperator linear operators scaled added composed using usual syntax methods lowrankapprox transparently support matrices linear operators lowrank factorizations detail various lowrank approximations implemented nominally return compact factorization types storing matrix factors structured form factorizations provide optimized multiplication routines furthermore rank factorization queried matrix approximant defined reconstructed matrix concreteness exposition assume following size factorization rank note matrix identities interpreted equalities approximation precision qr decomposition partial qr decomposition factorization orthonormal columns upper trapezoidal permutation vector decomposition computed pqrfact args explicitly pqr args former returns partialqr factorization access methods factor type matrix factor type uppertrapezoidal permutation type vector permutation type columnpermutation represented structured matrices complete arithmetic operations permit alternative approximation formula factorization form additionally supports squares solution leftdivision compute partial qr decomposition pivoting rows instead columns necessarily constructing matrix transpose explicitly writing pqrfact args similarly pqr default interface equivalent pqrfact args transpose generate subset partial qr factors efficiency options methods modify input matrix copy data enforce actually depends type input sketch method potentially efficient versions reserve overwrite available pqrfact pqr respectively interpolative decomposition id id based approximation rd sk sk set skeleton columns rd set redundant columns interpolation matrix follows sk rd sk matrix id computed idfact args sk rd id args type idpackedv defines factor implicitly represent entire id via sk sk columns type vector rd rd columns type vector permutation type vector permutation type columnpermutation factor type matrix actually produce id id id sk rd returns id factorization directly compared factorization access methods factor type matrix factor type idpackedv addition defined idpackedv partial qr decomposition id computed instead finding skeleton rows opposed columns idfact args default interface equivalent passing argument moreover modifying versions available idfact id singular value decomposition svd partial svd factorization respectively orthonormal columns diagonal nonincreasing nonnegative real entries computed psvdfact args psvd args factorization type partialsvd access methods factor type matrix factor type vector factor type matrix vt factor type matrix note underlying svd routine forms output vt easier extract squares solution supported using leftdivision furthermore singular values required psvdvals args hermitian eigendecomposition partial hermitian eigendecomposition hermitian matrix factorization orthonormal columns diagonal nondecreasing real entries similar partial hermitian svd computed pheigfact args vals vecs pheig args followed julia convention letting vals denote eigenvalues comprising vecs denote eigenvector matrix factorization type partialhermitianeigen access methods values vals type vector vectors vecs type matrix supports squares solution leftdivision eigenvalues desired instead vals pheigvals args cur decomposition cur decomposition factorization cols rows consist columns rows respectively invrowscols basis rows columns computed curfact args rows cols cur args former type curpackedu hermitiancurpackedu hermitian symmetriccurpackedu symmetric access methods cols cols columns type vector rows rows rows type vector produce corresponding cur decomposition cur cur rows cols returns cur factorization hermitiancur hermitian symmetriccur symmetric access methods factor type matrix factor type factorization factor type matrix addition defined curpackedu type hermitiancur type symmetriccur transpose note conditioning issues stored explicitly factored form nominally type svd practically partialhermitianeigen type hermitiancurpackedu partialsvd otherwise convenient arithmetic operations modifying versions available curfact cur sketch methods matrix sketching core component package proper critical performance matrix sketch takes form sampling matrix sketches similarly constructed sampling multiplying idea contains compressed representation rank approximately efficiently processed recover information default sketch method defines gaussian random matrix sketch methods specified using keyword sketch example setting opts lraoptions sketch srft args equivalently opts lraoptions args opts sketch srft passing idfact opts computes id sketching via subsampled random fourier transform srft directly idfact sketch srft list supported sketch methods disable sketching altogether opts sketch none addition integration lowrank factorization methods sketches generated independently sketch args interfaces include sketchleft args compute sketchleft args compute sketch args compute sketch args compute provide adaptive routines automatically sketch increasing specified error tolerance met detected termination unaccelerated partial qr decomposition adaptive sketching forms basis essentially level algorithms lowrankapprox called sketchfact args sketch detailed interface available sketchfact trans args random gaussian canonical sampling matrix gaussian random matrix entries drawn independently standard normal distribution real imaginary drawn independently complex sketch method set opts sketch randn support power iteration improve accuracy spectral gap rank computes simply hermitian instead intermediate matrix products orthogonalized stability generic gaussian sketching complexity principle expensive stage computing fast lowrank approximation practice effective somewhat serious effort develop sketch methods lower computational cost addressed following techniques random subset simplest matrix sketch random subset rows columns complexity appropriate specified opts sketch sub linear growth matrix dimension obviously attractive note method fail matrix sufficiently regular contains isolated entries random subselection implemented type abstractmatrix subsampled random fourier transform srft alternative approach based imposing structure sampling matrix srft form applying left random permutation matrix size discrete fourier transform dft random diagonal unitary scaling due dft structure applied log operations beware constant method set opts sketch srft real srft implementation real arithmetic separately computing real imaginary standard realreal dft abstractmatrix types supported sparse random gaussian modification gaussian sketching provide sparse random gaussian sampling scheme wherein restricted nonzeros depending dimension contracted considering concreteness row nonzero columns coverage maintained spreading nonzero indices rows complexity computing sparse gaussian sketching specified opts sketch sprn implemented type abstractmatrix power iteration supported subsequent matrix application devolve cost capabilities provide useful relevant algorithms follows matrix partial range basis partial range rank matrix orthonormal columns basis computed prange args fast range approximation using sketching supported default interface computes basis column space capture row space instead prange args equivalent computing partial range resulting matrix orthonormal rows satisfies approximate row column spaces simultaneously prange args possibly modifying version available prange spectral norm estimation spectral norm rapidly computed using randomized power iteration via err snorm args similarly spectral norm difference matrices computed err snormdiff args admits convenient efficient test accuracy lowrank approximations core algorithm underlying algorithm lowrankapprox pivoted qr decomposition magnitudes pivots providing estimate approximation error incurred truncation rank terminating variant lapack routine geqp partial qr decomposition constructed leveraged id support various factorizations due fundamental importance perform optional determinant maximization postprocessing obtain strong rankrevealing qr rrqr decomposition ensures select column pivots improve numerical precision stability options numerous options exposed lraoptions type cover logical function accuracy options accuracy lowrank approximation spectral norm controlled following parameters atol absolute tolerance approximation default rtol relative tolerance approximation default eps rank maximum rank approximation default parameter specifies independent termination criterion computation completes met currently atol rtol checked qr pivot magnitudes accuracy approximately guaranteed resulting errors correct iterative rrqr postprocessing available maxdetniter maximum iterations determinant maximization default maxdettol relative tolerance determinant maximization default maxdettol postprocessing otherwise parameter specifies independent termination criterion options impact factorizations qr involve level approximations based qr example computing id via rrqr guarantees interpolation matrix satisfies maxabs maxdettol assuming termination due maxdetniter parameters atol rtol spectral norm estimation routines snorm snormdiff specify requested precision scalar norm output sketching options following parameters govern matrix sketching sketch sketch method none randn default srft sub sprn sketchrandnniter power iterations gaussian sketching default sketchfactadap compute sketched factorization adaptively successively doubling sketch default true false takes effect rank single sketch rank partially factorized sketchfactrandnsamp oversampling function gaussian sketching default sketchfactsrftsamp oversampling function srft sketching default sketchfactsubsamp oversampling function subset sketching default oversampling functions input desired approximation rank return corresponding sketch designed able capture probability oversampling function sparse random gaussian sketching due special form options available options include nb computational block size various settings default pheigorthtol eigenvalue relative tolerance identify degenerate subspaces eigenvectors reorthonormalized combat lapack issue default sqrteps pqrfactretval string containing keys indicating outputs return pqrfact default qr orthonormal matrix trapezoidal matrix interpolation matrix id snormniter maximum iterations spectral norm estimation default verb print verbose messages sparingly default true note pqrfact returns permutation vector specification pqrfactretval pqrfactretval qr output factorization type partialqr otherwise type partialqrfactors simply container type defined arithmetic operations keys ignored computational complexity summarize leading computational costs factorization function depending sketch type assume input abstractmatrix size numerical rank min cost compute entry adaptive computation essentially priori function none randn sub srft sprn pqr log id log svd log pheig log cur log cost id default columnoriented version obtain operation count roworiented id simply switch roles note pheig applicable square matrices remain unchanged sketchfactadap true exception following costs sketch srft log sketch sprn log uniformly funct