bulklmmjl bulklmm julia package performing genome scans multiple traits bulk sizes using linear mixed models lmms suitable eqtl mapping thousands traits markers bulklmm performs permutation testing lmms taking account relatedness individuals multithreading matrix operations speed computations current implementation genome scans degree freedom tests choices adding additional covariates future releases cover scenario degrees freedom tests linear mixed model lmm consider univariate trait measured population related individuals kinship matrix trait vector follow following linear model beta epsilon epsilon sigmag sigmae matrix covariates include intercept candidate genetic markers optionally background covariates variance components sigmag sigmae denote genetic random error variance components respectively single trait scan single trait candidate marker likelihood ratio test compare model candidate genetic marker including intercept background covariates process repeated marker generate genome scan result reported lod log likelihood ratio units users specify variance components estimated using ml maximum likelihood reml restricted maximum likelihood scans performed variance components estimated null separately marker latter approach slower accurate permutation tests single trait null hypothesis individual genetic marker associated trait traits correlated according kinship matrix identity genetic variance component zero standard permutation test shuffle trait data randomly appropriate instead rotate data using eigen decomposition kinship matrix decorrelates data shuffle data rescaling standard deviations scans multiple traits scans multiple traits performed running univariate lmms combination trait marker exploring algorithms optimizing process judicious approximations multithreading package multithreading speed operations start julia mutliple threads advantage threads computer capable speedups obtained spreading distributing computation mutliple computers example application bxd spleen expression data demonstrate basic usage bulklmmjl example applying package bxd mouse strains data successfully installed package load current julia session using bulklmm using csv delimitedfiles dataframes statistics bxd data accessible published github repo bulklmmjl package csv files databxddata directory raw bxd traits bxdtraitswithmissingcsv contains missing values removing missings load bxd traits data bulklmmdir dirname pathof bulklmm phenofile joinpath bulklmmdir databxddataspleenphenonomissingcsv pheno readdlm phenofile header false phenoprocessed pheno exclude header transcript id columns sex required data format traits csv txt files values separated column observations bxd strains particular trait row observations traits particular mouse strain load bxd genotypes data raw bxd genotypes file bxdgenoprobcsv contains columns contains complement genotype probabilities column immediately preceded odd columns calling function readbxdgeno read bxd genotype file excluding columns genofile joinpath bulklmmdir databxddataspleenbxdgenoprobcsv geno readdlm genofile header false genoprocessed geno required data format genotypes csv txt files values separated column observations genotype probabilities bxd strains particular marker row observations marker particular mouse strain bxd data size phenoprocessed strains traits size genoprocessed strains markers compute kinship matrix genotype probabilities using function calckinship kinship calckinship genoprocessed calculate single trait scanning example conduct genomewide association mappings th trait ran function scan inputs trait darray column geno matrix kinship matrix traitid phenoy reshape phenoprocessed traitid time singleresults scan phenoy genoprocessed kinship allocations mib output structure singleresults stores model estimates variance components vc environmental variance heritability estimated null intercept model lod scores obtainable vcs environmental variance heritability geneticvariancetotalvariance singleresults sigmae singleresults hnull lod scores calculated single trait vcs estimated null intercept model singleresults lod bulklmmjl supports permutation testing single trait gwas simply run function scan input optional keyword argument permutationtest true permutations passed keyword argument nperms permutations example package permutation testing permutations time singleresultsperms scan phenoy genoprocessed kinship permutationtest true nperms original false allocations mib input original false suppress default performing genome scans original trait output singleresultsperms matrix lod scores dimension nperms column lod scores markers permuted copy row markerspecific lod scores permuted copies size singleresultsperms maxlods vec mapslices maximum singleresultsperms dims thrs map quantile maxlods plot bulklmm lod scores th trait compare results running gemma note results gemma run gemma linux machine input files trait th trait x genetic markers kinship matrix finally convert lrt values corresponding lod scores alternatively simply load results obtained following procedures mentioned resulting lod scores gemma txt file databxddatagemmabxdtraitgemmalodtxt reproducing figure following steps read gmapcsv phenocovarcsv databxddata directory gmapfile joinpath bulklmmdir databxddatagmapcsv ginfo csv read gmapfile dataframe phenocovarfile joinpath bulklmmdir databxddataphenocovarcsv pinfo csv read phenocovarfile dataframe utility functions plotting package named bigriverplotsjl released soon downloading package run using bigriverplots information genetic markers chromosome measured chrbxd string ginfo chr chrbxd reshape chrbxd information genetic markers mb length chromosome measured posbxd ginfo mb posbxd reshape posbxd lodbxd singleresults lod load bulklmm lod scores results gemmaresultspath joinpath bulklmmdir databxddatagemmabxdtraitgemmalodtxt lodgemma readdlm gemmaresultspath load gemma lod scores results available package traitname pinfotraitid trait name th trait functions package bigriverplotsjl run vecstepsbxd bigriverplots getchromosomesteps posbxd chrbxd unique chr id vchrnamesbxd unique chrbxd generate distances coordinates xbxd ybxd bigriverplots getqtlcoord posbxd chrbxd lodbxd xbxdgemma ybxdgemma bigriverplots getqtlcoord posbxd chrbxd lodgemma qtlplot xbxd ybxd vecstepsbxd vchrnamesbxd label bulklmmjl xlabel locus chromosome ylims title single trait traitname lod scores plot bulklmm lods plot xbxd ybxdgemma color purple label gemma legend true plot gemma lods hline thrs color red linestyle dash label plot thresholds multiple traits scanning lods multiple traits runtime performance start julia multiple threads following instructions starting julia repl multithreads switch multithreaded julia kernel using jupyter notebooks run function bulkscannull matrices traits genome markers kinship fourth required input parallelized tasks recommend julia threads started threaded julia executed program linux server intel xeon silver cpu ghz lod scores k bxd traits time multipleresultsalltraits bulkscannull phenoprocessed genoprocessed kinship nb threads nthreads allocations gib gc time output multipleresultsalltraits matrix lod scores dimension times column lod scores performing gwas trait size multipleresultsalltraits visualize multipletrait scan results plotting utility function ploteqtl generate eqtl plot functions plotting utilities available package bigriverplotsjl future easily access plotting function script plotutilsvisualsutilsjl running following commands using recipesbase plots plots plotmeasures colorschemes include joinpath bulklmmdir plotutils visualsutilsjl following example plot lod scores calling function specifying optional argument thr ploteqtl multipleresultsalltraits pheno ginfo pinfo thr installation package bulklmmjl installed running using pkg pkg add bulklmm install julia repl press enter pkg mode add bulklmm recent release package obtained running using pkg pkg add url rev main contact contribution feedback bugs please post issue github contact maintainer zifan yu directly fork repository send pull request contributions wish check bulklmmjl releas