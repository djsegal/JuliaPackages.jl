fluxopttools package contains utilities enhance training fluxjl models train using optim optimjl train flux models flux version example using flux zygote optim fluxopttools statistics chain dense tanh dense linrange pi pi sin loss mean abs zygote refresh pars flux params lossfun gradfun fg p optfuns loss pars res optim optimize optim onlyfg fg p optim options iterations storetrace true utility provided package function optfuns returns functions p vectorized version pars bfgs typically convergence properties adam optimizer benchmark bfgs red beats adagrad tuned step size blue stochastic bfgs implemented repository green performs computational time perspective lbfgs times slower adam additionnal memory complexity traditional bfgs algorithm times slower adam similar memory burden slbfgs code benchmark runtestsjl visualize loss landscape based loss landscape visualization define plot recipe loss landscape plotted using plots contourf log loss pars color turbo npoints lnorm landscape plotted selecting random directions extending current pars distance lnorm normpars negative positive random directions loss evaluations npoints flatten unflatten package flattening reassembling types fluxparams zygotegrads vectors functions zeros pars creates vector length sumlength pars copy pars store pars vector copy pars reverse zeros grads creates vector length sumlength grads copy grads store grads vector copy grads reverse hood functions returned optfuns form optim understands references stochastic quasinewton adaptive step lengths scale adrian wills thomas schn visualizing loss landscape neural nets hao li zheng xu gavin taylor christoph studer tom goldstein