fluxopttool packag contain util enhanc train flux model train use optim optim train flux model flux version exampl use flux zygot optim fluxopttool statist chain dens tanh dens linrang sin loss mean ab zygot refresh par flux param lossfun gradfun optfun loss par res optim optim optim optim option iter store trace true util provid packag function optfun return function vector version par bfgs typic converg properti adam optim benchmark bfgs red beat adagrad tune step size blue stochast bfgs implement repositori green perform code benchmark runtest visual loss landscap defin plot recip loss landscap plot use plot plot loss par npoint seriestyp contour landscap plot select random direct extend current par distanc norm par negat posit random direct loss evalu npoint flatten unflatten packag flatten reassembl type flux param zygot grad vector function zero par creat vector length sum length par copyto par store par vector copyto par revers zero grad creat vector length sum length grad copyto grad store grad vector copyto grad revers hood function return optfun form optim understand refer stochast quasi newton adapt step length scale adrian will thoma sch