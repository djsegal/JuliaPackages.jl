geometric multigrid speed geometric multigrid solver pure julia benchmark example mg solver demonstrating approximately linear solution time scaling length solution vector usage define matrix solution julia using geometricmultigrid julia function setupd type float zeros poisson fieldvector julia setupd define source term solve julia julia mg julia print iterations iterations julia element fieldvectorfloat matrixfloat check solution julia true version set multigrid solvestate julia st mgstate zero solvestatefloat residual residual residual level grid grid dimension grid resitricted restricting x grid produce singular equation system solved allocation julia allocated mg st julia st solvestatefloat residual e residual e julia st element fieldvectorfloat matrixfloat method geometric multigrid methods recursive approach solve linear algebra stemming partial differential equations posed structured numerical grid algebraic multigrid methods apply broader class typically fast geometric multigrid applicable fine grid restricted coarsened grid faster solve solution prolongated fine grid remaining frequency errors smoothed package coarse grid simply half size dimension restriction operation sum local prolongation copy recursively halving solution prolongated top level process called cycle default smoother iterations gausssidel method benchmark plot results solution time approximately linear scaling vector length implementation geometric multigrid methods regular spatial connectivity grid define restriction prolongation operators concepts built package using fieldvector type simply wrapper multidimensional array julia setupd julia element fieldvectorfloat matrixfloat julia data matrixfloat julia cartesianindices tupleunitrangeint unitrangeint cartesianindex cartesianindex cartesianindex cartesianindex cartesianindex cartesianindex cartesianindex cartesianindex cartesianindex julia norm inf include buffer elements data field holds cartesianindices range field excluding buffer elements default buffer layer element thick boundaries note fieldvector acts d vector default despite underlying multidimensional data buffer allows linear algebra functions applied shown extension fieldvector matrices fieldmatrix type currently type defines symmetric matrices lengthdims subdiagonals held dimensional array poisson function builds matrix zerosum rows requirement conservative poisson equations dv da julia setupd julia fieldmatrixfloat arrayfloat matrixfloat julia diag data matrixfloat julia eigen values element vectorfloat e wrapper allows familiar linear algebra functions losing underlying geometric structure data fast custom linear algebra functions defined norm dot dot mul finally solvestate recursive type holds required arrays mg funct