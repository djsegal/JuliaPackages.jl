diffeqoper construct finit differ oper discret partial differenti equat boundari condit method line reduc system ordinari differenti equat solv differentialequ center upwind oper provid domain dimens arbitrarili space grid accuraci dimens space grid optim convolut routin nnlib care avoid unnecessari alloc oper concretis array bandedmatrix spars matrix simplest shown figur oper act set sampl function grid grid interior boundari input numer oper vector output vector sampl deriv deriv request numer deriv oper construct grid centereddiffer argument indic deriv mean oper exact round polynomi degre lower deriv oper boundari condit oper comput deriv interior grid simpl boundari condit construct dirichlet eltyp definit deriv calcul oper matric abus notat particular exampl linear oper boundari condit affin oper form matrix constant vector consequ concret matrix oper interpol polynomi degre adjac grid near middl grid deriv approxim interpol polynomi centr defin polynomi valu requir close boundari fit polynomi interpol leftmost rightmost includ ghost append boundari numer deriv linear combin valu polynomi interpol vector coeffici linear combin call stencil take valu ghost return valu interior matrix boundari condit oper act matrix output vector valu interior boundari interior valu valu sampl ghost grid boundari shown valu assign interpol polynomi satisfi left hand boundari condit satisfi hand boundari condit boundari condit provid librari precis valu affin function interior valu affin oper dimens dimens natur store vector deriv boundari condit oper similar matric dimens valu natur store matrix take deriv downward axi easi matric act columnwis horizont deriv transpos matric deriv rightward axi easi code easi read haven seen function argument valu natur store dimension array julia multipl oper defin vector matrix appli oper matrix array requir complic error prone seri reshap axi permut function type deriv boundari condit oper parameteris axi oper act deriv oper axi suppli type paramet simpl centereddiffer equival centereddiffer row wise deriv centereddiffer sheet wise centereddiffer axi centereddiffer boundari condit complic doc multidimbc suppos multipl dimens don current constructor constructor follow centereddiffer deriv int approxim int len int coeff func upwinddiffer deriv int approxim int len int coeff func argument direct dimens discret assum differenc occur column deriv deriv discret approxim discret term space discret oper uniform discret array oper uniform discret len length discret direct oper coeff func oper argument coeffici function set coeffici oper coeff func coeffici set constant coeff func abstractarray length match len coeffici constant spatial depend dimension deriv oper act valu dimens deriv oper action oper lazi mean memori alloc similar oper action perform build oper matric addit mul perform alloc applic oper concret follow concret provid array sparsematrixcsc bandedmatrix blockbandedmatrix addit function spars overload effici matrix type oper dimension deriv bandedmatrix dimension oper blockbandedmatrix concret act vec contract oper concret ordinari matrix matter dimens contract act kroncker product formul action built matrix match action vec boundari condit oper boundari condit implement ghost node approach discret valu interior domain boundari valu oper discret closur domain use nxn oper satisfi boundari condit period boundari condit constructor periodicbc provid period boundari condit oper robin boundari condit variabl correspond form similar boundari robinbc abstractarray abstractarray abstractarray addit follow helper exist neumann dirichlet dirichletbc dirichlet type dirichletbc zero zero fix grid neumann union abstractvector neumannbc abstractvector abstractvector boundari condit implement general robin boundari condit vector coeffici repres condit form generalbc abstractarray abstractarray abstractarray oper action boundari condit oper act lazili append appropri valu array build ghost extend version deriv oper act util special array type requir copi interior data concret follow concret provid array sparsematrixcsc addit function spars overload effici matrix type oper oper sparsematrixcsc concret act vec ghostderiv oper derivativeoper boundari condit oper produc ghostderiv oper composit oper concret follow concret provid array sparsematrixcsc bandedmatrix addit function spars overload effici matrix type oper oper bandedmatrix unless boundari condit periodicbc sparsematrixcsc concret act vec matrix free oper matrixfreeoper arg size opnorm true ishermitian fals matrixfreeoper linear oper action explicit defin function jacobian vector product oper jacvecoper abstractarray union autodiff true ishermitian fals opnorm true jacvecoper linear oper act function oper mul function oper composit multipli diffeqoper build diffeqoperatorcomposit ad diffeqoper build diffeqoperatorcombin multipli diffeqoper scalar produc diffeqscaledoper inherit appropri action effici compos oper action compos oper action util nnlib cach effici convolut oper dimension combin